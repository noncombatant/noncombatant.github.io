if("undefined"==typeof tiger)var tiger={};"undefined"==typeof tiger.components&&(tiger.components={}),"undefined"==typeof tiger.components.ad&&(tiger.components.ad={}),"undefined"==typeof tiger.components.annotation&&(tiger.components.annotation={}),"undefined"==typeof tiger.components.blogdropdown&&(tiger.components.blogdropdown={}),"undefined"==typeof tiger.components.duiModal&&(tiger.components.duiModal={}),"undefined"==typeof tiger.components.forms&&(tiger.components.forms={}),"undefined"==typeof tiger.components.forms.modals&&(tiger.components.forms.modals={}),"undefined"==typeof tiger.components.forms.search&&(tiger.components.forms.search={}),"undefined"==typeof tiger.components.groupchats&&(tiger.components.groupchats={}),"undefined"==typeof tiger.components.header&&(tiger.components.header={}),"undefined"==typeof tiger.components.header.notifications&&(tiger.components.header.notifications={}),"undefined"==typeof tiger.components.invites&&(tiger.components.invites={}),"undefined"==typeof tiger.components.invites.menuItems&&(tiger.components.invites.menuItems={}),"undefined"==typeof tiger.components.invites.modals&&(tiger.components.invites.modals={}),"undefined"==typeof tiger.components.navpanels&&(tiger.components.navpanels={}),"undefined"==typeof tiger.components.notifications&&(tiger.components.notifications={}),"undefined"==typeof tiger.components.post&&(tiger.components.post={}),"undefined"==typeof tiger.components.post.button&&(tiger.components.post.button={}),"undefined"==typeof tiger.components.post.media&&(tiger.components.post.media={}),"undefined"==typeof tiger.components.post.meta&&(tiger.components.post.meta={}),"undefined"==typeof tiger.components.promotions&&(tiger.components.promotions={}),"undefined"==typeof tiger.components.spinner&&(tiger.components.spinner={}),"undefined"==typeof tiger.components.user&&(tiger.components.user={}),"undefined"==typeof tiger.icons&&(tiger.icons={}),"undefined"==typeof tiger.icons.actions&&(tiger.icons.actions={}),"undefined"==typeof tiger.icons.essential&&(tiger.icons.essential={}),"undefined"==typeof tiger.icons.places&&(tiger.icons.places={}),"undefined"==typeof tiger.messages&&(tiger.messages={}),"undefined"==typeof tiger.messages.postAction&&(tiger.messages.postAction={}),"undefined"==typeof tiger.messages.time&&(tiger.messages.time={}),"undefined"==typeof tiger.section&&(tiger.section={}),"undefined"==typeof tiger.section.header&&(tiger.section.header={}),"undefined"==typeof tiger.section.sidebar&&(tiger.section.sidebar={}),"undefined"==typeof tiger.utils&&(tiger.utils={}),define("app/editor/config/paths",[],function(){"use strict";return{proxiedPath:"/proxy/iframe?url="}}),define("singleton/IframeResizer",["underscore","app/editor/config/paths"],function(e,n){"use strict";function s(t,s){function o(e,t,n){n.setAttribute(e,t)}if(t&&s){var i=e.filter(document.getElementsByTagName("iframe"),function(o){var i=decodeURI(o.src),t=decodeURI(s),a=n.proxiedPath+encodeURIComponent(t);return e.contains([t,a],i)});e.each(["width","height"],function(n){"number"==typeof t[n]&&e.each(i,o.bind(void 0,n,t[n]))})}}function o(s){var o,n=s.data,i=window.location.protocol+"//"+window.location.host;if((s.origin===i||s.origin.match(t))&&n){if(e.isObject(n)&&n.kinja)return n.kinja;try{o=JSON.parse(n).kinja}catch(e){}return o||!1}}var t,i;return t=/^https?:\/\/(\w+\.)?(kinja.com|gawker-labs.com|localhost:7000|kinja\.dev:9000)$/,i={start:function(){function t(t){var e=o(t);e&&e.resizeFrame&&e.sourceUrl&&s(e.resizeFrame,e.sourceUrl),e&&e.getUrl&&t.source.postMessage({kinja:{url:window.location.href}},t.origin)}window.addEventListener("message",t),window._K_MSGS&&e.each(window._K_MSGS,t),window.removeEventListener("message",window._K_MSG_L),delete window._K_MSG_L}}}),function(){"use strict";define("module/Main",["jquery","singleton/Feature","singleton/RavenConfig","singleton/Trackers","singleton/DeviceController","singleton/PerfTracker","module/ads/ads.controller","app/MarionetteApp","singleton/CurrentUser","singleton/CurrentBlog","lib/kriteo","module/foundation/Foundation5","lib/polyfills/json-null-old-android"],function(n,e,s,t,o,i,a,r){function c(){s.init(),e.isOn("no3rdparty")?t.loadDummy():(t.load(),o.setDevice(),a.startAds()),r.start(),e.isOn("frontendtiming")&&window.setTimeout(function(){i.start()},0)}return n.ajaxSetup({cache:!0}),{start:c}})}(),define("templates/tiger/messages",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.messages.areYouSureToDisconnect=function(){return"Are you sure you want to disconnect this account?"},t.DEBUG&&(e.messages.areYouSureToDisconnect.soyTemplateName="tiger.messages.areYouSureToDisconnect"),e.messages.settingsSaved=function(){return"Settings saved successfully."},t.DEBUG&&(e.messages.settingsSaved.soyTemplateName="tiger.messages.settingsSaved"),e.messages.confirmationEmail=function(){return"Confirmation email has been sent."},t.DEBUG&&(e.messages.confirmationEmail.soyTemplateName="tiger.messages.confirmationEmail"),e.messages.blogPropertySaved=function(){return"Blog property saved successfully."},t.DEBUG&&(e.messages.blogPropertySaved.soyTemplateName="tiger.messages.blogPropertySaved"),e.messages.blogPropertyCreated=function(){return"Blog property created successfully."},t.DEBUG&&(e.messages.blogPropertyCreated.soyTemplateName="tiger.messages.blogPropertyCreated"),e.messages.blogPropertyDeleted=function(){return"Blog property deleted successfully."},t.DEBUG&&(e.messages.blogPropertyDeleted.soyTemplateName="tiger.messages.blogPropertyDeleted"),e.messages.ownerSet=function(){return"New owner has been set."},t.DEBUG&&(e.messages.ownerSet.soyTemplateName="tiger.messages.ownerSet"),e.messages.cannotDisconnectLoginAccount=function(){return"You cannot disconnect your login account from Kinja. Please switch your login account, save, and try again."},t.DEBUG&&(e.messages.cannotDisconnectLoginAccount.soyTemplateName="tiger.messages.cannotDisconnectLoginAccount"),e.messages.repliesDisabled=function(n,s,t){return'<div class="twelve columns end mbx"><div class="reply-create media"><div class="img mrm icon--svg">'+e.icons.discussion.bubbleClose(null,null,t)+'</div><div class="bd proxima"><span class="msg text-small text-light">This discussion is closed</span></div></div></div>'},t.DEBUG&&(e.messages.repliesDisabled.soyTemplateName="tiger.messages.repliesDisabled"),e.messages.imageUploadError=function(){return"Image upload error."},t.DEBUG&&(e.messages.imageUploadError.soyTemplateName="tiger.messages.imageUploadError"),e.messages.assetRecommended=function(){return"Media recommended."},t.DEBUG&&(e.messages.assetRecommended.soyTemplateName="tiger.messages.assetRecommended"),e.messages.assetUnrecommended=function(){return"Removed media recommendation."},t.DEBUG&&(e.messages.assetUnrecommended.soyTemplateName="tiger.messages.assetUnrecommended"),e.messages.amazonBestSellerReport=function(){return"<p><small>If the blog list is omitted, all blogs will be taken into account. If the limit is set to 0, no limit is set.</small></p>"},t.DEBUG&&(e.messages.amazonBestSellerReport.soyTemplateName="tiger.messages.amazonBestSellerReport"),e.messages.amazonTagReport=function(){return"<p><small>Beware: If the checkbox above is unchecked, Amazon statistics and posts will both be filtered by the date picker. This means that earnings and orders for posts which were published earlier will <strong>not</strong> be shown here.</small></p>"},t.DEBUG&&(e.messages.amazonTagReport.soyTemplateName="tiger.messages.amazonTagReport")}),define("templates/tiger/components/notifications/button",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.components.notifications.button=function(n,a,s){var o='<a href="#" class="js_notification-trigger hide-for-medium-down toolbar-icon notifications-menu is-loaded '+(n.notificationCount>0?"has-notification":"")+'" title="'+(n.notificationCount>999?e.messages.notifications({count:n.notificationCount},null,s):"Notifications")+'" data-dropdown="notifications-menu"><span class="icon-circle icon-notifications"></span>',i=""+(n.notificationCount>999?"infinite":n.notificationCount>99?"hundred":1==n.notificationCount?"only-one":"");return o+='<span class="notification-count js_notification-count '+t.$$escapeHtmlAttribute(i)+'">'+e.components.notifications.count(n,null,s)+"</span></a>"},n.DEBUG&&(e.components.notifications.button.soyTemplateName="tiger.components.notifications.button"),e.components.notifications.count=function(e){var s="",n=""+(e.notificationCount>999?"∞":e.notificationCount?t.$$escapeHtml(e.notificationCount):"");return s+=n?t.$$escapeHtml(n):""},n.DEBUG&&(e.components.notifications.count.soyTemplateName="tiger.components.notifications.count")}),define("templates/tiger/components/header/notifications",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.header.notifications.notificationsEmpty=function(){return'<li class="text-center pvm js_notification-item">You have no unread notifications.</li>'},n.DEBUG&&(t.components.header.notifications.notificationsEmpty.soyTemplateName="tiger.components.header.notifications.notificationsEmpty"),t.components.header.notifications.notificationsSpinner=function(n,s,e){return'<li class="js_spinner notifications-spinner">'+t.components.spinner.bounce(null,null,e)+"</li>"},n.DEBUG&&(t.components.header.notifications.notificationsSpinner.soyTemplateName="tiger.components.header.notifications.notificationsSpinner"),t.components.header.notifications.globalNotificationsDropdown=function(n,s,e){return'<section class="notif-list"><div class="notif-list-scroll-wrapper"><ul class="js_notification-list menu-list"></ul></div><ul class="menu-list see-all-link"><li class="more"><div class="show-for-large-up"><a class="js_event-link js_see-all-notifications" data-ga="[Notifications Menu, See All Notifications Click]" href="//kinja.com/dashboard/notifications">See all notifications</a></div><div class="show-for-medium-down"><a class="button secondary hide icon--svg u-highlighted js_event-link js_see-all-notifications" data-ga="[Notifications Menu, See All Notifications Click]" href="//kinja.com/dashboard/notifications">See all notifications'+t.icons.essential.chevronRight(null,null,e)+"</a></div></li></ul></section>"},n.DEBUG&&(t.components.header.notifications.globalNotificationsDropdown.soyTemplateName="tiger.components.header.notifications.globalNotificationsDropdown"),t.components.header.notifications.globalNotificationEvent=function(e,o,s){var n="";switch(e.item.variant){case"PresentableApproval":n+=t.components.header.notifications.approval(e,null,s);break;case"PresentableUserFollow":n+=t.components.header.notifications.userfollow(e,null,s);break;case"PresentableBlogFollow":n+=t.components.header.notifications.blogfollow(e,null,s);break;case"PresentableMessage":n+=t.components.header.notifications.message(e,null,s);break;case"PresentablePostFollow":n+=t.components.header.notifications.postfollow(e,null,s);break;case"PresentablePostLikeGroup":n+=e.item.sourceAuthorData&&e.item.sourceAuthorData.id?t.components.header.notifications.postlikegroup(e,null,s):"";break;case"PresentableReply":n+=t.components.header.notifications.reply(e,null,s);break;case"PresentableRepost":n+=t.components.header.notifications.repostpost(e,null,s);break;case"PresentableShare":n+=t.components.header.notifications.sharepost(e,null,s);break;case"PresentablePendingMembership":n+=t.components.header.notifications.pendingmembership(e,null,s);break;case"PresentableMembershipResponse":n+=t.components.header.notifications.membershipresponse(e,null,s)}return n+='<span class="unread-marker"></span>'},n.DEBUG&&(t.components.header.notifications.globalNotificationEvent.soyTemplateName="tiger.components.header.notifications.globalNotificationEvent"),t.components.header.notifications.blogfollow=function(n,o,s){return'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.screenName)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.add(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.avatar.id,"avt-small",n.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.defaultBlog.displayName)+'</span><span class="event-msg">started following you.</span></span></div></div></a>'},n.DEBUG&&(t.components.header.notifications.blogfollow.soyTemplateName="tiger.components.header.notifications.blogfollow"),t.components.header.notifications.approval=function(n,o,s){return'<a href="http://'+e.$$escapeHtmlAttribute(null==n.item.sourceBlogData?null:n.item.sourceBlogData.canonicalHost)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.add(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar">'+((null==n.item.sourceBlogData?null:n.item.sourceBlogData.avatar)?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.sourceBlogData.avatar.id,"avt-small",n.item.sourceBlogData.avatar.format)))+'" />':'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.imgPath))+'icons/icon-kinja-nav.png" />')+'</span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==n.item.sourceBlogData?null:n.item.sourceBlogData.displayName)+'</span><span class="event-msg">'+(s.features.approvemessage?"approved you":"started following you")+"</span></span></div></div></a>"},n.DEBUG&&(t.components.header.notifications.approval.soyTemplateName="tiger.components.header.notifications.approval"),t.components.header.notifications.reply=function(n,r,s){var i,o="",a=(n.item.reply,null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName);return o+=(s.features.hide_pending_replies&&!(null==n.item.postData?null:n.item.postData.approved)?'<span class="pending-label">Pending approval</span>':"")+'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(null==n.item.postData?null:n.item.postData.permalink))+'" data-ga="[Notifications Menu, Reply Notification Click]" class="js_event-link event-reply icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.bubble(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center">',i="avt-small",o+='<span class="avatar">'+((null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.avatar)?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.sourceAuthorData.avatar.id,i,n.item.sourceAuthorData.avatar.format)))+'" />':'<span class="avatar-default"></span>')+'</span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(a)+'</span><div class="text-normal text-small">replied to you:</div><div class="msg-excerpt">'+e.$$truncate(e.$$filterNoAutoescape(null==n.item.postData?null:n.item.postData.plaintext),80,!0)+"</div></span></div></div></a>"},n.DEBUG&&(t.components.header.notifications.reply.soyTemplateName="tiger.components.header.notifications.reply"),t.components.header.notifications.postlikegroup=function(n,a,o){var i="",s=n.item.sourceAuthorsData.length;return i+='<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(null==n.item.postData?null:n.item.postData.permalink))+'" data-ga="[Notifications Menu, Recommend Group Notification Click]" class="js_event-link event-like icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.star(null,null,o)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.sourceAuthorData.avatar.id,"avt-small",n.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt">'+((null==n.item.postData?null:n.item.postData.headline)?1==s?'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and one other recommended <strong>'+e.$$filterNoAutoescape(null==n.item.postData?null:n.item.postData.headline)+"</strong>.</span>":s>1?'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and '+e.$$escapeHtml(n.item.sourceAuthorsData.length)+" others recommended <strong>"+e.$$filterNoAutoescape(null==n.item.postData?null:n.item.postData.headline)+"</strong>.</span>":'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+' </span><span class="event-msg">recommended <strong>'+e.$$filterNoAutoescape(null==n.item.postData?null:n.item.postData.headline)+"</strong>.</span></span>":1==s?'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and one other recommended your post.</span></span>':s>1?'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and '+e.$$escapeHtml(n.item.sourceAuthorsData.length)+" others recommended your post</strong>.</span></span>":'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+' </span><span class="event-msg">recommended your post.</span></span>')+"</span></div></div></a>"},n.DEBUG&&(t.components.header.notifications.postlikegroup.soyTemplateName="tiger.components.header.notifications.postlikegroup"),t.components.header.notifications.message=function(n,o,s){return'<div><div class="row collapse" data-ga="[Notifications Menu, Message Notification Click]"><div class="col small-2 center">'+t.icons.actions.lightning(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.avatar.id,"avt-small",null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+'</span> messaged you:<br><span class="msg-excerpt">'+e.$$escapeHtml(n.item.message)+"</span></span></div></div></div>"},n.DEBUG&&(t.components.header.notifications.message.soyTemplateName="tiger.components.header.notifications.message"),t.components.header.notifications.postfollow=function(){return""},n.DEBUG&&(t.components.header.notifications.postfollow.soyTemplateName="tiger.components.header.notifications.postfollow"),t.components.header.notifications.sharepost=function(n,o,s){return'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(null==n.item.sharedData?null:n.item.sharedData.permalink))+'" data-ga="[Notification Menu, Menu - Share Notification]" class="js_event-link event-share icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.externalLink(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.sourceAuthorData.avatar.id,"avt-small",n.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared your post as <strong>'+e.$$filterNoAutoescape(null==n.item.sharedData?null:n.item.sharedData.headline)+"</strong></span></span></div></div></a>"},n.DEBUG&&(t.components.header.notifications.sharepost.soyTemplateName="tiger.components.header.notifications.sharepost"),t.components.header.notifications.repostpost=function(n,o,s){return""+(n.item.postActionData?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.item.postActionData.post.permalink))+'" data-ga="[Notification Menu, Menu - Repost Notification]" class="js_event-link event-share icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.externalLink(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.sourceAuthorData.avatar.id,"avt-small",n.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt">'+(n.item.postActionData.post.headline?'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared <strong>'+e.$$filterNoAutoescape(n.item.postActionData.post.headline)+"</strong> to "+e.$$escapeHtml(null==n.item.postActionData?null:n.item.postActionData.blog.displayName)+"</span>":'<span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared your reply to '+e.$$escapeHtml(null==n.item.postActionData?null:n.item.postActionData.blog.displayName)+"</span>")+"</span></div></div></a>":"")},n.DEBUG&&(t.components.header.notifications.repostpost.soyTemplateName="tiger.components.header.notifications.repostpost"),t.components.header.notifications.globalNotificationsButton=function(n,a,s){var i="",o=""+(n.notificationCount>999?"infinite":n.notificationCount>99?"hundred":1==n.notificationCount?"only-one":"");return i+='<a class="js_notif show-for-large-up js_menu-button '+(n.notificationCount?"has-notification":"")+'" data-dropdown="js_notifications--dropdown" data-ga="[Notifications Menu, Notifications Menu Click, '+(n.notificationCount?"New":"Neutral")+']">'+(n.notificationCount?'<span class="js_notifications-count notif-circle '+e.$$escapeHtmlAttribute(o)+'">'+t.components.header.notifications.count(n,null,s)+"</span>":'<span class="notif-circle">'+t.icons.actions.lightning(null,null,s)+"</span>")+'</a><a class="js_notif show-for-medium-down js_offcanvas-notif js_menu-button '+(n.notificationCount?"has-notification":"")+'" data-ga="[Notifications Menu, Notifications Menu Click, '+(n.notificationCount?"New":"Neutral")+']">'+(n.notificationCount?'<span class="js_notifications-count notif-circle '+e.$$escapeHtmlAttribute(o)+'">'+t.components.header.notifications.count(n,null,s)+"</span>":'<span class="notif-circle">'+t.icons.actions.lightning(null,null,s)+"</span>")+"</a>"},n.DEBUG&&(t.components.header.notifications.globalNotificationsButton.soyTemplateName="tiger.components.header.notifications.globalNotificationsButton"),t.components.header.notifications.count=function(t){return""+(t.notificationCount>999?"∞":e.$$escapeHtml(t.notificationCount))},n.DEBUG&&(t.components.header.notifications.count.soyTemplateName="tiger.components.header.notifications.count"),t.components.header.notifications.userfollow=function(n,o,s){return'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.screenName)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.add(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.sourceAuthorData.avatar.id,"avt-small",n.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==n.item.sourceAuthorData?null:n.item.sourceAuthorData.displayName)+'</span><span class="event-msg">started following you.</span></span></div></div></a>'},n.DEBUG&&(t.components.header.notifications.userfollow.soyTemplateName="tiger.components.header.notifications.userfollow"),t.components.header.notifications.pendingmembership=function(n,o,s){return'<div data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg u-full"><div class="row collapse"><div class="col small-2 center">'+t.icons.places.user(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.invitedByData.avatar.id,"avt-small",n.item.invitedByData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name"></span><span class="event-msg"><strong>'+e.$$escapeHtml(n.item.invitedByData.displayName)+'</strong> invited you to be an author on their blog <a href="http://'+e.$$escapeHtmlAttribute(n.item.blogData.canonicalHost)+'">'+e.$$escapeHtml(n.item.blogData.displayName)+'</a></span></span></div></div><div class="dui row collapse notification__btn-cont"><div class="col small-offset-2 small-5"><a class="button small js_invite-btn" data-accepting="true">Accept</a></div><div class="col small-5"><a class="button small secondary js_invite-btn" data-accepting="false">Decline</a></div></div></div>'},n.DEBUG&&(t.components.header.notifications.pendingmembership.soyTemplateName="tiger.components.header.notifications.pendingmembership"),t.components.header.notifications.membershipresponse=function(n,o,s){return'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(n.item.blogData.displayName)+'/manage" data-ga="[Notifications Menu, Membership Response Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.places.user(null,null,s)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(n.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.item.inviteeData.avatar.id,"avt-small",n.item.inviteeData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(n.item.inviteeData.displayName)+'</span><span class="event-msg">'+(n.item.accepted?"accepted your invitation.":"declined your invitation.")+"</span></span></div></div></a>"},n.DEBUG&&(t.components.header.notifications.membershipresponse.soyTemplateName="tiger.components.header.notifications.membershipresponse")}),define("app/notifdropdown/NotificationButton",["backbone.marionette","app/account/account.channel","templates/tiger/messages","templates/tiger/components/notifications/button","templates/tiger/components/header/notifications"],function(e,t){"use strict";var n=e.ItemView.extend({template:tiger.components.header.notifications.globalNotificationsButton,tagName:"span",attributes:function(){return{"data-ga":"["+["Notifications Menu","Notifications Button Click",this.model.get("notificationCount")?"New":"Neutral"].join(", ")+"]"}},activeClass:"active",modelEvents:{"change:notificationCount":"render"},render:function(){e.ItemView.prototype.render.apply(this)},doClick:function(e){this.model.isLoggedIn()?this.toggleClass():(e.stopPropagation(),this.requireLogin())},requireLogin:function(){t.trigger("loginRequired",{source:"notificationButton"})},toggleClass:function(){this.$el.toggleClass(this.activeClass)}});return n}),define("apiclient/notification",["config","apiclient/apirequest","apiclient/gettoken"],function(n,t,e){"use strict";var o,i=n.api.mantle.url,s=n.api.notification.url;return o={getNotificationCount:t.getJson(e.append(s+"/notification/views/unseenCount")),deleteNotification:t.deleteJson(e.append(s+"/notification/{{notificationId}}")),getNotifications:t.getJson(e.append(i+"/notifications/paginated/{{userId}}",e.fresh))}}),define("app/notifdropdown/notificationCount.model",["backbone","singleton/CurrentUser","apiclient/notification"],function(t,e,n){"use strict";var s=t.Model.extend({defaults:{notificationCount:0,inSync:!1},sync:function(i,a,s){var t=e.get("token"),o=e.isLoggedIn();return o&&t&&-1===t.indexOf("dummy-")?n.getNotificationCount({userId:e.id},s):void 0},isNew:function(){return!this.get("inSync")},parse:function(e){return{notificationCount:parseInt(e.data,10)||0,inSync:!0}},markAsRead:function(){this.empty(),this.save()},empty:function(){this.set({notificationCount:0})},remove:function(){this.empty(),this.stopListening()}});return s}),define("model/Notification",["backbone","apiclient/profile"],function(t,e){"use strict";var n=t.Model.extend({sync:function(s,t,n){switch(s){case"delete":return e.deleteNotification({notificationId:t.get("id")});case"update":case"create":return n.acceptingInvite?e.acceptMembershipInvitation({invitationId:t.get("invitationId")},n):e.rejectMembershipInvitation({invitationId:t.get("invitationId")},n)}}});return n}),define("templates/tiger/messages/time",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.messages.time.oneSecondAgo=function(n,s,t){return""+e.messages.time.relativeTime({type:"seconds"},null,t)},n.DEBUG&&(e.messages.time.oneSecondAgo.soyTemplateName="tiger.messages.time.oneSecondAgo"),e.messages.time.someSecondsAgo=function(t,s,n){return""+e.messages.time.relativeTime({type:"seconds",amount:t.seconds},null,n)},n.DEBUG&&(e.messages.time.someSecondsAgo.soyTemplateName="tiger.messages.time.someSecondsAgo"),e.messages.time.oneMinuteAgo=function(n,s,t){return""+e.messages.time.relativeTime({type:"minute"},null,t)},n.DEBUG&&(e.messages.time.oneMinuteAgo.soyTemplateName="tiger.messages.time.oneMinuteAgo"),e.messages.time.someMinutesAgo=function(t,s,n){return""+e.messages.time.relativeTime({type:"minutes",amount:t.minutes},null,n)},n.DEBUG&&(e.messages.time.someMinutesAgo.soyTemplateName="tiger.messages.time.someMinutesAgo"),e.messages.time.oneHourAgo=function(n,s,t){return""+e.messages.time.relativeTime({type:"hours"},null,t)},n.DEBUG&&(e.messages.time.oneHourAgo.soyTemplateName="tiger.messages.time.oneHourAgo"),e.messages.time.someHoursAgo=function(t,s,n){return""+e.messages.time.relativeTime({type:"hours",amount:t.hours},null,n)},n.DEBUG&&(e.messages.time.someHoursAgo.soyTemplateName="tiger.messages.time.someHoursAgo"),e.messages.time.oneDayAgo=function(n,s,t){return""+e.messages.time.relativeTime({type:"days"},null,t)},n.DEBUG&&(e.messages.time.oneDayAgo.soyTemplateName="tiger.messages.time.oneDayAgo"),e.messages.time.someDaysAgo=function(t,s,n){return""+e.messages.time.relativeTime({type:"days",amount:t.days},null,n)},n.DEBUG&&(e.messages.time.someDaysAgo.soyTemplateName="tiger.messages.time.someDaysAgo"),e.messages.time.oneMonthAgo=function(n,s,t){return""+e.messages.time.relativeTime({type:"months"},null,t)},n.DEBUG&&(e.messages.time.oneMonthAgo.soyTemplateName="tiger.messages.time.oneMonthAgo"),e.messages.time.someMonthsAgo=function(t,s,n){return""+e.messages.time.relativeTime({type:"months",amount:t.months},null,n)},n.DEBUG&&(e.messages.time.someMonthsAgo.soyTemplateName="tiger.messages.time.someMonthsAgo"),e.messages.time.oneYearAgo=function(n,s,t){return""+e.messages.time.relativeTime({type:"years"},null,t)},n.DEBUG&&(e.messages.time.oneYearAgo.soyTemplateName="tiger.messages.time.oneYearAgo"),e.messages.time.someYearsAgo=function(t,s,n){return""+e.messages.time.relativeTime({type:"years",amount:t.years},null,n)},n.DEBUG&&(e.messages.time.someYearsAgo.soyTemplateName="tiger.messages.time.someYearsAgo"),e.messages.time.relativeTime=function(e){e=e||{};var n="";switch(e.type){case"seconds":n+=e.amount&&"1"!=e.amount?t.$$escapeHtml(e.amount)+" seconds ago":"1 second ago";break;case"hours":n+=e.amount&&"1"!=e.amount?t.$$escapeHtml(e.amount)+" hours ago":"an hour ago";break;case"days":n+=e.amount&&"1"!=e.amount?t.$$escapeHtml(e.amount)+" days ago":"yesterday";break;case"weeks":n+=e.amount&&"1"!=e.amount?t.$$escapeHtml(e.amount)+" weeks ago":"a week ago";break;case"months":n+=e.amount&&"1"!=e.amount?t.$$escapeHtml(e.amount)+" months ago":"a month ago";break;case"years":n+=e.amount&&"1"!=e.amount?t.$$escapeHtml(e.amount)+" years ago":"1 year ago";break;case"future":n+=t.$$escapeHtml(e.Mddyyhmma);break;case"minutes":n+=e.amount&&"1"!=e.amount?'<span class="'+(e.timestamp?"minutedisplay-"+t.$$escapeHtmlAttribute(e.timestamp):"")+'">'+t.$$escapeHtml(e.amount)+"</span> minutes ago":'<span class="'+(e.timestamp?"minutedisplay-"+t.$$escapeHtmlAttribute(e.timestamp):"")+'">A</span> minute ago';break;case"today":n+="Today "+t.$$escapeHtml(e.hmma);break;case"yesterday":n+="Yesterday "+t.$$escapeHtml(e.hmma);break;case"pastweek":n+=t.$$escapeHtml(e.day)+" "+t.$$escapeHtml(e.hmma);break;case"greaterthanweek":n+=t.$$escapeHtml(e.Mddyyhmma);break;default:n+="Just now"}return n},n.DEBUG&&(e.messages.time.relativeTime.soyTemplateName="tiger.messages.time.relativeTime")}),define("singleton/DateUtils",["singleton/Renderer","moment","templates/tiger/messages/time"],function(t,e){"use strict";var n={getRelativeTime:function(l){var n=Math.round(((new Date).getTime()-parseInt(l,10))/1e3),s=Math.round(n/60),o=Math.round(n/3600),i=Math.round(n/86400),a=Math.round(n/2592e3),r=Math.round(n/31536e3),e=t.renderTemplate,c="";return c=60>n?1===n?e(tiger.messages.time.oneSecondAgo):e(tiger.messages.time.someSecondsAgo,{seconds:n}):60>s?1===s?e(tiger.messages.time.oneMinuteAgo):e(tiger.messages.time.someMinutesAgo,{minutes:s}):24>o?1===o?e(tiger.messages.time.oneHourAgo):e(tiger.messages.time.someHoursAgo,{hours:o}):30>i?1===i?e(tiger.messages.time.oneDayAgo):e(tiger.messages.time.someDaysAgo,{days:i}):12>a?1===a?e(tiger.messages.time.oneMonthAgo):e(tiger.messages.time.someMonthsAgo,{months:a}):1===r?e(tiger.messages.time.oneYearAgo):e(tiger.messages.time.someYearsAgo,{years:r}),c.textContent.replace(/^\s+|\s+$/g,"")},getMDYYYYHHMM:function(t){return e(t).format("M/D/YYYY H:mm")},getMDYYYY:function(t){return e(t).format("M/D/YYYY")},getDateTimeLocalString:function(t){return e(t).format("YYYY-MM-DDTHH:mm:ss")},getTimeInMilliseconds:function(e){return new Date(e).getTime()}};return n}),define("collection/Notifications",["underscore","backbone","model/Notification","singleton/CurrentUser","singleton/DateUtils","singleton/Feature","apiclient/notification"],function(e,t,n,s,o,i,a){"use strict";var r=t.Collection.extend({model:n,initialize:function(s,n){t.Collection.prototype.initialize.call(this,s,n),this.options=e.extend(this.options,n||{})},sync:function(n,o,e){var t=i.isOn("pendingmember");return a.getNotifications({markAsRead:!0,userId:s.id,maxReturned:5,pinPending:t},e)},parse:function(t){return!t||!t.data||!t.meta||t.meta.error||t.meta.success&&t.meta.success!==!0?[]:e.map(t.data.items,function(e){return e.relativeTime=o.getRelativeTime(e.createdAt),e.variant=e.$variant,e})}});return r}),define("app/notifdropdown/notifdropdown.app",["jquery","app/notifdropdown/NotificationButton","app/notifdropdown/notificationCount.model","collection/Notifications","singleton/CurrentUser","singleton/EventDispatcher","app/MarionetteApp","app/account/account.channel"],function(s,o,i,l,n,a,e,r){"use strict";var t,c;return t={notifications:null,notificationCountModel:null,notificationDropdown:null,notificationOffcanvas:null,initialize:function(){var e=new l;this.notifications=e,this.initNotificationButton()},initNotificationButton:function(){this.notificationCountModel=new i,n.onLoggedIn.done(function(){this.notificationCountModel.fetch()}.bind(this)),n.on("clearNotifications",function(){this.notificationCountModel.markAsRead()},this);var t=new o({el:e.notificationRegion.el,model:this.notificationCountModel});s(e.notificationDropdownRegion.el).one("opened.fndtn.dropdown",function(){var e;this.notificationDropdown||(e=this.initNotificationDropdown(),e.done(function(){this.notificationDropdown.trigger("opened:notifications")}.bind(this)))}.bind(this)),t.render(),e.notificationRegion.attachView(t)},initNotificationDropdown:function(){var o=s.Deferred();return require(["module/NotificationListModule"],function(s){this.notificationDropdown=new s({el:e.notificationDropdownRegion.el,collection:this.notifications,model:n}),this.notificationDropdown.on("opened:notifications",function(){n.isLoggedIn()&&(t.notificationDropdown.render(),this.notifications.fetch({reset:!0})),this.notificationCountModel.empty()},this),e.notificationDropdownRegion.attachView(this.notificationDropdown),o.resolve()}.bind(this)),o},remove:function(){a.off(null,null,this),n.off(null,null,this),r.off(null,null,this),this.notificationDropdown&&(this.notificationDropdown.off(null,null,this),this.notificationDropdown=null),this.notificationCountModel&&(this.notificationCountModel.remove(),this.notificationCountModel=null)}},c={initialize:function(){return t.initialize()},fetch:function(){t.notifications.fetch()},remove:function(){t.remove()}}}),define("gawkerlib/analytics/analytics_config_prod",[],function(){"use strict";var e={rootUrl:"http://kinja.com/api/analytics/",rootUrlWoProtocol:"//kinja.com/api/analytics/"};return e}),!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(c){for(var s,o,a=String(c),t=0,r=n,i="";a.charAt(0|t)||(r="=",t%1);i+=r.charAt(63&s>>8-t%1*8)){if(o=a.charCodeAt(t+=.75),o>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");s=s<<8|o}return i}),t.atob||(t.atob=function(c){if(s=String(c).replace(/=+$/,""),s.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,s,o,i=0,r=0,a="";t=s.charAt(r++);~t&&(o=i%4?64*o+t:t,i++%4)?a+=String.fromCharCode(255&o>>(-2*i&6)):0)t=n.indexOf(t);return a})}(),define("lib/base64.min",function(){}),define("module/KinjaAnalytics",["jquery","gawkerlib/analytics/analytics_config_prod","lib/base64.min"],function(e,t){"use strict";var n={session:{},context:{},setContext:function(e,t,n){this.context.blogId=e,this.context.contextType=t,this.context.id=n},createPayload:function(e,t,n,s,o,i,a,r){var c={blogId:e,eventType:t,targetType:n,targetId:s,contextType:o,contextId:i,eventAttributes:a,eventAttributesExtended:r};return c},pushEvent:function(t,n,e,s,o){var i=this.createPayload(this.context.blogId?String(this.context.blogId):null,t,n,e?String(e):null,this.context.contextType,this.context.id?String(this.context.id):null,s,o);this.writeEvent(i)},setSession:function(e){return!!("string"==typeof e.agid&&"string"==typeof e.asid&&e.ping)&&(this.session.globalId=e.agid,this.session.sessionId=e.asid,this.session.ping=e.ping,!0)},getEventMeta:function(){var e={context:this.context,session:this.session};return e},writeEvent:function(n){var s=btoa(JSON.stringify(n)),o=t.rootUrlWoProtocol,i=Math.floor(1e3*Math.random()+1),a=o+"t/event.js?e="+s+"&cb="+i,r=this;e.ajax(a,{type:"GET",success:function(e){r.setSession(e.data)},xhrFields:{withCredentials:!0},crossDomain:!0})}};return n}),define("view/posttools/BlogFollowToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","singleton/CurrentUser"],function(t,n,o,i,e){"use strict";var s,a;return s=function(e,t){return n.map(t,function(t){return"."+e+'[data-blogid="'+t+'"]'}).join(", ")},a=i.extend({events:{"click .js_followblogforuser":"followBlogForUser","click .js_unfollowblogforuser":"unfollowBlogForUser"},initialize:function(){var t=n.debounce(this.update,1e3);e.onAuthStateChange(t.bind(this)),this.on("update",t,this)},update:function(s){var n;return s=s||{},n=s.el||t("body"),e.onAuth.done(function(){this.resetControls(n),this.removePlaceholderBtn(n),e.isLoggedIn()?(this.updateBlogFollows(e.get("followedBlogIds"),"follow"),this.hideOwnBlogs()):this.resetControls(n)}.bind(this)),this},updateBlogFollows:function(n,e){var o=s("js_follow-blog-controls",n);t(o).find(".js_followblogforuser").toggleClass("hide","follow"===e).end().find(".js_unfollowblogforuser").toggleClass("hide","unfollow"===e)},hideOwnBlogs:function(){var o=s("js_follow-blog-controls",n.pluck(e.getBlogs(),"id"));t(o).addClass("hide")},resetControls:function(e){e.find(".js_unfollowblogforuser").addClass("hide"),e.find(".js_followblogforuser").removeClass("hide")},followBlogForUser:function(e){return this.blogFollowAction(e),!1},unfollowBlogForUser:function(e){return this.blogUnfollowAction(e),!1},blogFollowAction:function(s){var a=t(s.currentTarget).closest(".js_follow-blog-controls"),n=parseInt(a.attr("data-blogid"),10),i="profileFollowList"===t(s.currentTarget).attr("data-analytics-target")?"profileFollowList":"header";o.pushEvent("FOLLOW","BLOG",n,{uiElement:i}),e.requireLogin("blogfollow").done(function(){return-1===e.get("followedBlogIds").indexOf(n)&&void e.followBlog(n).done(function(){this.updateBlogFollows([n],"follow")}.bind(this))}.bind(this))},blogUnfollowAction:function(s){var o=t(s.currentTarget).closest(".js_follow-blog-controls"),n=parseInt(o.attr("data-blogid"),10);e.requireLogin("blogunfollow").done(function(){e.unfollowBlog(n).done(function(){this.updateBlogFollows([n],"unfollow")}.bind(this))}.bind(this))},removePlaceholderBtn:function(e){e=e||t("body"),e.find(".js_list-control__empty").addClass("hide")}})}),define("view/modal/duimodal.defaultBehavior",["jquery","backbone.marionette"],function(e,t){"use strict";var n=t.Behavior.extend({events:{"click .js_close":"onCloseModal"},onShow:function(){e("body").addClass("disable-scroll");var t=e(this.view.bodyRegion.el);window.setTimeout(function(){t.addClass("dui-modal-body-animate")},100),this.contentBlurAdd(),this.$("img[data-src]").each(function(){var t=e(this);t.attr("src",t.data("src")).removeData("src")})},onCloseModal:function(){this.view.close(),this.contentBlurRemove(),e("body").removeClass("disable-scroll")},onCloseModalTimeout:function(e){var t=this;window.setTimeout(function(){t.onCloseModal()},e)},contentBlurAdd:function(){e(".js_page-content, .js_global-nav-wrap").addClass("blur-content")},contentBlurRemove:function(){e(".js_page-content, .js_global-nav-wrap").removeClass("blur-content")}});return n}),define("view/behaviors/googleAnalytics.behavior",["jquery","underscore","backbone.marionette","singleton/Utils"],function(e,n,s,o){"use strict";var t=s.Behavior.extend({events:{"click [data-ga]:not(form)":"onGAClick","submit form[data-ga]":"onGASubmit"},onGAClick:function(t){var n,o=e(t.currentTarget),s=o.closest("a[href]").eq(0);return this.logGAEvent(t),s.length&&(n=s.attr("href"),!/^((http|https):)?\/\//.test(n)||"_blank"===s.attr("target")||t.shiftKey||t.ctrlKey||t.metaKey||(t.preventDefault(),window.setTimeout(function(){window.location.href=n},500))),!0},onGASubmit:function(t){var n=e(t.currentTarget),s=n.attr("action"),o=n.serialize();this.logGAEvent(t),t.preventDefault(),window.setTimeout(function(){window.location.href=s+"?"+o},500)},logGAEvent:function(o){var a=e(o.currentTarget),s=a.attr("data-ga").replace(/[[\]]/g,"").split(/\s*,\s*/g),s=s.map(function(e){return n.contains(t.validKeys,e)?t.replacePlaceholder(e):e}),i=["send","event"].concat(s);window.ga.apply(this,i)}},{validKeys:["js_pageType","js_pageUrl"],replacePlaceholder:function(e){var t=o.getKinjaMeta();switch(e=e.replace(/js_/g,"")){case"pageType":return t.pageType;case"pageUrl":return window.location.url;default:return""}}});return t}),define("templates/tiger/components/blogdropdown",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.components.blogdropdown.globalBlogDropdown=function(n,l,i){if(o='<div class="top-tools">'+("search"!=n.pageType?'<div class="search-box search show-for-medium-down">'+e.components.forms.search.simpleSearch(n,null,i)+'<div class="divider show-for-medium-down"></div></div>':"")+'<div class="js_login-links show-for-medium-down login-links">'+(n.isLoggedIn?"":'<a href="#" class="login-button button inverse js_login-link" data-ga="[User Menu, Login/Signup Click, js_pageType]">Log in / Sign up</a>')+"</div>"+(n.blog&&""!=n.blog?e.components.blogdropdown.blogfollowbutton(n,null,i):"")+"</div>",n.blogGroup&&n.blogGroup.length){o+='<ul class="blog-list related-blog-list"><li class="title">Related blogs</li>';for(var s,o,r=n.blogGroup,c=r.length,a=0;c>a;a++)s=r[a],o+='<li><a href="http://'+t.$$escapeHtmlAttribute(s.canonicalHost)+'" data-ga="[Kinja Menu, Related Blog Click, '+t.$$escapeHtmlAttribute(s.name)+']" class="icon--svg u-prepended">'+(s.avatar?'<img data-src="'+t.$$escapeHtmlAttribute(window.kinja.imageUrl(s.avatar.id,"avt-small",s.avatar.format))+'" width="16" height="16" class="icon icon-prepend" />':'<img data-src="//x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png" width="16" height="16" class="icon icon-prepend" />')+t.$$escapeHtml(s.displayName)+"</a></li>";o+="</ul>"}return o+='<ul class="blog-list gmg-blog-list"><li class="title">Blogs you may like</li>'+e.components.globalBlogLinks(null,null,i)+"</ul>"},n.DEBUG&&(e.components.blogdropdown.globalBlogDropdown.soyTemplateName="tiger.components.blogdropdown.globalBlogDropdown"),e.components.blogdropdown.blogfollowbutton=function(n,i,s){var o="";return s.features.follow_plus,o+='<ul class="show-for-medium-down"><li class="js_follow-controls js_follow-blog-controls follow-controls--blog-menu" data-blogid="'+t.$$escapeHtmlAttribute(n.blog.id)+'"><a href="#" class="js_followblogforuser button list-entity__button--follow follow-state following list-control--active svg-icon--white hide"><span>Follow '+t.$$escapeHtml((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"")+"</span>"+e.icons.essential.adDMSall(null,null,s)+'</a><a href="#" class="js_unfollowblogforuser button list-entity__button--following follow-state following list-control--active svg-icon--white hide"><span>Following '+t.$$escapeHtml((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"")+"</span>"+e.icons.essential.checkmarkSmall(null,null,s)+"</a></li></ul>"},n.DEBUG&&(e.components.blogdropdown.blogfollowbutton.soyTemplateName="tiger.components.blogdropdown.blogfollowbutton")}),define("templates/tiger/components/forms/search",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.forms.search.simpleSearch=function(n,o,s){return'<form method="GET" class="search search-simple" '+(n.formId?'id="'+e.$$escapeHtmlAttribute(n.formId)+'" name="'+e.$$escapeHtmlAttribute(n.formId)+'" ':"")+"action=\"/search\" onsubmit=\"window.ga('send', 'event', 'Search', 'Submit', '"+e.$$escapeHtmlAttribute(e.$$escapeJsString(n.pageType))+'\');"><div class="input-with-icon"><span class="icon--svg">'+t.icons.essential.search(null,null,s)+'</span><input type="text" placeholder="Search '+e.$$escapeHtmlAttribute((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"Kinja")+'" name="q"'+(n.query?' value="'+e.$$escapeHtmlAttribute(n.query)+'"':"")+' class="mbn" autocomplete="off" data-focus-on-display/></div></form>'},n.DEBUG&&(t.components.forms.search.simpleSearch.soyTemplateName="tiger.components.forms.search.simpleSearch"),t.components.forms.search.advancedSearch=function(n,o,s){return'<form method="GET"'+(n.formClasses?'class="'+e.$$escapeHtmlAttribute(n.formClasses)+' search" ':' class="search"')+(n.formId?' id="'+e.$$escapeHtmlAttribute(n.formId)+'" name="'+e.$$escapeHtmlAttribute(n.formId)+'" ':"")+(n.action?' action="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.action))+'"':"")+"onsubmit=\"window.ga('send', 'event', 'Search', 'Submit', '"+e.$$escapeHtmlAttribute(e.$$escapeJsString(n.pageType))+'\');"><div class="input-with-icon mbx mtm"><span class="icon--svg">'+t.icons.essential.search(null,null,s)+'</span><input type="text" placeholder="Search '+e.$$escapeHtmlAttribute((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"Kinja")+'" name="q"'+(n.query?' value="'+e.$$escapeHtmlAttribute(n.query)+'"':"")+' class="man" autocomplete="off" data-focus-on-display/></div></form>'},n.DEBUG&&(t.components.forms.search.advancedSearch.soyTemplateName="tiger.components.forms.search.advancedSearch")}),define("templates/tiger/components/bloglinks",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.globalBlogLinks=function(){var o="",i="my2vnuuejg3jt9yqbx3z",a="rnxqtvv6advgidzfs6am",r="pch44wvo0v6acpdlt0f6",c="fdj3buryz5nuzyf2k620",l="eh1hvjxamru5z6aobgwc",d="aqhdzcldymb9mkltfhxh",s="ghxlwgdztvqerb4zptdx",n="u0939doeuioaqhspkjyc",t="fdmagj52rhclnn6dfoig";return o+='<li><a href="http://deadspin.com" data-ga="[Kinja Menu, Blogs You May Like Click, Deadspin]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(a,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Deadspin</a></li><li><a href="http://gawker.com" data-ga="[Kinja Menu, Blogs You May Like Click, Gawker]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(i,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Gawker</a></li><li><a href="http://gizmodo.com" data-ga="[Kinja Menu, Blogs You May Like Click, Gizmodo]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(c,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Gizmodo</a></li><li><a href="http://io9.com" data-ga="[Kinja Menu, Blogs You May Like Click, io9]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(l,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />io9</a></li><li><a href="http://jalopnik.com" data-ga="[Kinja Menu, Blogs You May Like Click, Jalopnik]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(d,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Jalopnik</a></li><li><a href="http://jezebel.com" data-ga="[Kinja Menu, Blogs You May Like Click, Jezebel]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(r,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Jezebel</a></li><li><a href="http://kotaku.com" data-ga="[Kinja Menu, Blogs You May Like Click, Kotaku]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(s,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Kotaku</a></li><li><a href="http://lifehacker.com" data-ga="[Kinja Menu, Blogs You May Like Click, Lifehacker]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(n,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Lifehacker</a></li><li><a href="http://sploid.gizmodo.com/" data-ga="[Kinja Menu, Blogs You May Like Click, Sploid]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(t,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Sploid</a></li>'},n.DEBUG&&(t.components.globalBlogLinks.soyTemplateName="tiger.components.globalBlogLinks")}),define("templates/tiger/components/duiModal",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.duiModal.layout=function(n,s,t){return'<a class="js_close modal-close-x">'+e.icons.essential.close(null,null,t)+'</a><div class="dui dui-modal-body"></div>'},t.DEBUG&&(e.components.duiModal.layout.soyTemplateName="tiger.components.duiModal.layout")}),define("templates/tiger/components/navpanels",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.navpanels.duiGlobalMenuPanel=function(n,s,t){return'<div class="dui-menu dui-modal fullscreen-modal left"><a class="js_close modal-close-x">'+e.icons.essential.close(null,null,t)+'</a><div class="dui dui-modal-body nav-dropdown"><div id="js_blogmenu--offcanvas">'+e.components.blogdropdown.globalBlogDropdown(n,null,t)+"</div></div></div>"},t.DEBUG&&(e.components.navpanels.duiGlobalMenuPanel.soyTemplateName="tiger.components.navpanels.duiGlobalMenuPanel")}),define("app/modalmenu/globalmenu",["jquery","backbone.marionette","singleton/CurrentUser","view/posttools/BlogFollowToolView","view/modal/duimodal.defaultBehavior","view/behaviors/googleAnalytics.behavior","app/account/account.channel","templates/tiger/components/blogdropdown","templates/tiger/components/forms/search","templates/tiger/components/bloglinks","templates/tiger/components/duiModal","templates/tiger/components/navpanels"],function(e,r,c,s,o,i,a){"use strict";function t(){e("body").removeClass("disable-scroll")}function n(){e("body").addClass("disable-scroll")}var l;return l=r.Layout.extend({template:tiger.components.navpanels.duiGlobalMenuPanel,regions:{loginRegion:".js_login-links",bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:o},GoogleAnalyticsBehavior:{behaviorClass:i}},initialize:function(){c.onLoggedIn.done(function(){this.triggerMethod("CloseModal")}.bind(this)),e(document).on("open.fndtn.reveal","[data-reveal]",t),e(document).on("close.fndtn.reveal","[data-reveal]",n)},onClose:function(){e(document).off("open.fndtn.reveal","[data-reveal]",t),e(document).off("close.fndtn.reveal","[data-reveal]",n)},events:{"click .js_login-link":"onLoginClick"},onLoginClick:function(e){e.preventDefault(),a.trigger("loginRequired",{source:"loginButton"})},serializeData:function(){return{blog:this.model.get("blog"),pageType:this.model.get("pageType"),blogGroup:this.model.get("blogGroup"),isLoggedIn:this.model.isLoggedIn()}},onRender:function(){this.$(".gmg-blog-list").before(e(".related-blog-list").clone()),this.blogfollowtool=new s({el:this.$el})},onShow:function(){this.blogfollowtool.update({el:this.$el})}})}),define("templates/tiger/section/navbar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.section.navbar=function(n,d,s){var o,a,c,i="",l=((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"","BlogLogo"),r=(null==n.blog?null:n.blog.logo)?window.kinja.imageUrl(n.blog.logo.id,l,n.blog.logo.format):"";return""+("gawker"==(null==n.blog?null:n.blog.name)||"lifehacker"==(null==n.blog?null:n.blog.name)||"deadspin"==(null==n.blog?null:n.blog.name)||"kotaku"==(null==n.blog?null:n.blog.name)||"jezebel"==(null==n.blog?null:n.blog.name)||"io9"==(null==n.blog?null:n.blog.name)||"jalopnik"==(null==n.blog?null:n.blog.name)||"gizmodo"==(null==n.blog?null:n.blog.name)?" gmglogos":""),i+="<!-- "+(n.md5?" md5! ":"")+' --><div class="navwrap--outer js-navwrap--outer"><nav class="js_global-nav-wrap js_top-nav global-nav notransition shown"><div class="global-nav__left global-nav__triggers">',a=!!(n.blogList&&n.blogList.length>1),o="dashboard"==n.pageType||"manageblog"==n.pageType,i+=(o&&a?'<a class="js_show-dashboard-blogs show-dashboard-blogs show-for-medium-down icon--svg u-prepended">'+t.icons.essential.chevronLeft(null,null,s)+"</a>":"")+'<a class="js_mobile-menu-button hamburger-trigger hamburger-trigger--mobile'+(o&&a?" js_hamburger-trigger hide":"")+'" data-ga="[Kinja Menu, Menu Click, js_pageType]"><span class="icon-dustinburger"><span></span><span></span><span></span></span></a><div class="f-dropdown-ct"><a data-dropdown="global-blog" class="js_menu-button hamburger-trigger hamburger-trigger--desktop" data-ga="[Kinja Menu, Menu Click, js_pageType]"><span class="icon-dustinburger"><span></span><span></span><span></span></span></a>',c=""+(n.blogGroup&&n.blogGroup.length?"dropdown-wide":""),i+='<div class="proxima f-dropdown content nav-dropdown main-menu hide-for-medium-down '+e.$$escapeHtmlAttribute(c)+'" id="global-blog" data-dropdown-content><div id="js_blogmenu--dropdown">'+t.components.blogdropdown.globalBlogDropdown(n,null,s)+'</div></div><a href="#" id="global-search-trigger" class="search-trigger icon--svg u-prepended u-highlighted--onhover u-undecorated" data-dropdown="global-search" data-ga="[Kinja Menu, Search Click, js_pageType]">'+t.icons.essential.search(null,null,s)+t.icons.essential.close(null,null,s)+'</a><div class="f-dropdown content nav-dropdown search-dropdown hide-for-medium-down" id="global-search" data-dropdown-content><form method="GET" action="/search" data-ga="[Search, Submit, js_pageType]"><div class="input-with-icon icon--svg">'+t.icons.essential.search(null,null,s)+'<input id="global-search-input" type="search" name="q" placeholder="Search '+e.$$escapeHtmlAttribute((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"Kinja")+'" autocomplete="off" /></div></form></div></div></div><div class="global-nav__right global-nav__triggers js_right-user-bar">'+(s.features.fasttoken2?'<div class="js_loggedout" style="display:none">'+t.section.navbarRightLogin(null,null,s)+'</div><div class="js_loggedin" style="display:none">'+t.section.navbarRightUserBar(null,null,s)+"</div>":"")+'</div><div class="global-nav__center row"><div class="logo-wrapper large-6 columns large-offset-4">'+(n.title?n.mobileTitle?'<h1 class="js_mobile-title global-nav--title show-for-medium-down">'+e.$$escapeHtml(n.mobileTitle)+'</h1><h1 class="global-nav--title hide-for-medium-down">'+e.$$escapeHtml(n.title)+"</h1>"+(o?'<h1 class="js_dashboard-mobile-title-blogs global-nav--title hide">'+e.$$escapeHtml(n.title)+"</h1>":""):'<h1 class="global-nav--title">'+e.$$escapeHtml(n.title)+"</h1>":'<a href="//'+e.$$escapeHtmlAttribute((null==n.blog?null:n.blog.canonicalHost)?n.blog.canonicalHost:"")+'" class="logo" title="'+e.$$escapeHtmlAttribute((null==n.blog?null:n.blog.displayName)?n.blog.displayName:"")+'" data-ga="[Kinja Menu, Logo/Blog Title Click, js_pageType]">'+(""!=r?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(r))+'" alt="" />':e.$$escapeHtml((null==n.blog?null:n.blog.displayName)?n.blog.displayName:""))+"</a>"+(n.blog.id?'<div class="follow-controls follow-controls--header js_follow-controls js_follow-blog-controls" data-blogid="'+e.$$escapeHtmlAttribute(n.blog.id)+'"><a href="#" class="js_followblogforuser follow-controls__link icon--svg u-prepended u-highlighted" title="Follow'+(n.blog&&n.blog.displayName?" "+e.$$escapeHtmlAttribute(n.blog.displayName):"")+'" data-ga="[Kinja Menu, Follow Link Click, js_pageType]">'+t.icons.essential.add(null,null,s)+'Follow</a><a href="#" class="js_unfollowblogforuser follow-controls__link hide icon--svg u-prepended u-highlighted" title="Unfollow'+(n.blog&&n.blog.displayName?" "+e.$$escapeHtmlAttribute(n.blog.displayName):"")+'" data-ga="[Kinja Menu, Unfollow Link Click, js_pageType]">'+t.icons.essential.checkmark(null,null,s)+"Following</a></div>":""))+'</div></div><div class="proxima f-dropdown nav-dropdown content notif-menu" id="js_notifications--dropdown" data-dropdown-content>'+t.components.header.notifications.notificationsSpinner(null,null,s)+'</div><div class="proxima f-dropdown nav-dropdown content channels-menu" id="js_channels--dropdown" data-dropdown-content></div><div class="js_global-user scrollable-container noskimlinks noskimwords"><div class="proxima f-dropdown nav-dropdown content user-menu user-menu--mobile" id="js_usermenu--dropdown" data-dropdown-content></div></div></nav></div>'},n.DEBUG&&(t.section.navbar.soyTemplateName="tiger.section.navbar"),t.section.navbarBlogTitle=function(n,o,s){return(s.features.superuser&&s.features.superuser_notif?'<div class="momjeans-overlay js_momjeans-overlay">'+t.icons.places.momjeans(null,null,s)+"</div>":"")+'<a href="/" class="blog-title__logo site-logo js_blog-title__logo'+(n.isGmgBlog?" gmgLogos":"")+(n.showLogo?" no-fade-transition fade-in":"")+'" title="'+e.$$escapeHtmlAttribute(n.blogDisplayName)+'">'+(n.isGmgBlog?'<img class="blog-title__img logo-'+e.$$escapeHtmlAttribute(n.blogName)+'" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.imageAssetPath))+"logos/navbar/logo-"+e.$$escapeHtmlAttribute(n.blogName)+'.png" alt="" />':""!=n.logoSrc?'<img class="blog-title__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.logoSrc))+'" alt="" />':'<div class="blog-title__txt header-title proxima">'+e.$$escapeHtml(n.blogDisplayName)+"</div>")+'</a><div class="search-button"><span class="icon icon-search js_search-button__open-icon search-button__open-icon"></span></div>'},n.DEBUG&&(t.section.navbarBlogTitle.soyTemplateName="tiger.section.navbarBlogTitle"),t.section.navbarSearchBar=function(t,s,n){return(n.features.superuser&&n.features.superuser_notif?'<div class="momjeans-overlay js_momjeans-overlay"><span class="icon icon-momjeans"></span></div>':"")+'<a href="/" class="blog-title__logo site-logo js_blog-title__logo'+(t.isGmgBlog?" gmgLogos":"")+" no-fade-transition"+(t.showLogo?" fade-in":"")+'" title="'+e.$$escapeHtmlAttribute(t.blogDisplayName)+'">'+(t.isGmgBlog?'<img class="blog-title__img logo-'+e.$$escapeHtmlAttribute(t.blogName)+'" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(t.imageAssetPath))+"logos/navbar/logo-"+e.$$escapeHtmlAttribute(t.blogName)+'.png" alt="" />':""!=t.logoSrc?'<img class="blog-title__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(t.logoSrc))+'" alt="" />':'<div class="blog-title__txt header-title proxima">'+e.$$escapeHtml(t.blogDisplayName)+"</div>")+'</a><form method="GET" action="/search" class="search-bar__form js_search-bar__form" data-ga="[Search, Submit, js_pageType]"><span class="icon icon-search search-bar__icon"></span><input type="text" class="search-bar__field js_search-bar__field" name="q" placeholder="Search '+e.$$escapeHtmlAttribute(t.blogDisplayName)+'" autocomplete="off" /><div class="search-button"><span class="icon icon-x-small js_search-button__close-icon search-button__close-icon"></span></div></form><div class="search-button--placeholder"><span class="icon icon-search search-button__open-icon"></span></div>'},n.DEBUG&&(t.section.navbarSearchBar.soyTemplateName="tiger.section.navbarSearchBar"),t.section.navbarRightUserBar=function(n,o,s){return n=n||{},(s.features.channels?'<span class="notification-trigger"><a class="show-for-medium-up js_channels js_menu-button" data-dropdown="js_channels--dropdown"><span class="notif-circle"><span class="icon"><svg class="channels-icon" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>icon-hashmark</title><path d="M8.785 12h-2.97l-.552 3.16c-.097.553-.612.923-1.16.825-.543-.096-.907-.62-.81-1.174L3.785 12H.938C.42 12 0 11.556 0 11c0-.552.417-1 .938-1h3.197l.7-4H1.938C1.42 6 1 5.556 1 5c0-.552.417-1 .938-1h3.246L5.737.84c.097-.552.612-.922 1.16-.824.543.096.907.618.81 1.174L7.215 4h2.97l.552-3.16c.097-.552.612-.922 1.16-.824.543.096.907.618.81 1.174L12.215 4h2.847c.518 0 .938.444.938 1 0 .552-.417 1-.938 1h-3.197l-.7 4h2.897c.518 0 .938.444.938 1 0 .552-.417 1-.938 1h-3.246l-.553 3.16c-.097.553-.612.923-1.16.825-.543-.096-.907-.62-.81-1.174L8.785 12zm.35-2h-2.97l.7-4h2.97l-.7 4z" fill="#000" fill-rule="evenodd"/></svg></span></span></a></span>':"")+'<span class="js_notif-wrapper notification-trigger">'+(s.features.fasttoken2?t.components.header.notifications.globalNotificationsButton({notificationCount:0},null,s):"")+'</span><div class="user-trigger" data-ga="[User Menu, Menu Click, js_pageType]"><a class="js_menu-button js_usermenu-button show-for-large-up" data-dropdown="js_usermenu--dropdown" title="User dropdown"><span class="js_avatar avatar" style="'+(n.avatar?"background-image: url("+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.avatar.url))+")":"")+'"></span></a><a class="js_offcanvas-user show-for-medium-down"><span class="js_avatar avatar" style="'+(n.avatar?"background-image: url("+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.avatar.url))+")":"")+'"></span></a></div>'},n.DEBUG&&(t.section.navbarRightUserBar.soyTemplateName="tiger.section.navbarRightUserBar"),t.section.navbarRightLogin=function(){return'<a href="#" class="login-button button tiny inverse js_login-link" data-ga="[User Menu, Login/Signup Click, js_pageType]">Log in / Sign up</a>'},n.DEBUG&&(t.section.navbarRightLogin.soyTemplateName="tiger.section.navbarRightLogin")}),define("templates/tiger/icons/actions/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.icons.actions.arrowBottomLeft=function(){return'<svg class="svg-icon svg-arrow-bottom-left"><use xlink:href="#iconset-arrow-bottom-left" /></svg>'},t.DEBUG&&(e.icons.actions.arrowBottomLeft.soyTemplateName="tiger.icons.actions.arrowBottomLeft"),e.icons.actions.arrowBottomRight=function(){return'<svg class="svg-icon svg-arrow-bottom-right"><use xlink:href="#iconset-arrow-bottom-right" /></svg>'},t.DEBUG&&(e.icons.actions.arrowBottomRight.soyTemplateName="tiger.icons.actions.arrowBottomRight"),e.icons.actions.arrowBottom=function(){return'<svg class="svg-icon svg-arrow-bottom"><use xlink:href="#iconset-arrow-bottom" /></svg>'},t.DEBUG&&(e.icons.actions.arrowBottom.soyTemplateName="tiger.icons.actions.arrowBottom"),e.icons.actions.arrowLeft=function(){return'<svg class="svg-icon svg-arrow-left"><use xlink:href="#iconset-arrow-left" /></svg>'},t.DEBUG&&(e.icons.actions.arrowLeft.soyTemplateName="tiger.icons.actions.arrowLeft"),e.icons.actions.arrowRight=function(){return'<svg class="svg-icon svg-arrow-right"><use xlink:href="#iconset-arrow-right" /></svg>'},t.DEBUG&&(e.icons.actions.arrowRight.soyTemplateName="tiger.icons.actions.arrowRight"),e.icons.actions.arrowTop=function(){return'<svg class="svg-icon svg-arrow-top"><use xlink:href="#iconset-arrow-top" /></svg>'},t.DEBUG&&(e.icons.actions.arrowTop.soyTemplateName="tiger.icons.actions.arrowTop"),e.icons.actions.arrowTopLeft=function(){return'<svg class="svg-icon svg-arrow-top-left"><use xlink:href="#iconset-arrow-top-left" /></svg>'},t.DEBUG&&(e.icons.actions.arrowTopLeft.soyTemplateName="tiger.icons.actions.arrowTopLeft"),e.icons.actions.arrowTopRight=function(){return'<svg class="svg-icon svg-arrow-top-right"><use xlink:href="#iconset-arrow-top-right" /></svg>'},t.DEBUG&&(e.icons.actions.arrowTopRight.soyTemplateName="tiger.icons.actions.arrowTopRight"),e.icons.actions.blogAdd=function(){return'<svg class="svg-icon svg-blog-add"><use xlink:href="#iconset-blog-add" /></svg>'},t.DEBUG&&(e.icons.actions.blogAdd.soyTemplateName="tiger.icons.actions.blogAdd"),e.icons.actions.closeSmall=function(){return'<svg class="svg-icon svg-close-sm"><use xlink:href="#iconset-close-sm" /></svg>'},t.DEBUG&&(e.icons.actions.closeSmall.soyTemplateName="tiger.icons.actions.closeSmall"),e.icons.actions.disabled=function(){return'<svg class="svg-icon svg-disabled"><use xlink:href="#iconset-disabled" /></svg>'},t.DEBUG&&(e.icons.actions.disabled.soyTemplateName="tiger.icons.actions.disabled"),e.icons.actions.dollar=function(){return'<svg class="svg-icon svg-dollar"><use xlink:href="#iconset-dollar" /></svg>'},t.DEBUG&&(e.icons.actions.dollar.soyTemplateName="tiger.icons.actions.dollar"),e.icons.actions.dollarCircle=function(){return'<svg class="svg-icon svg-dollar-circle"><use xlink:href="#iconset-dollar-circle" /></svg>'},t.DEBUG&&(e.icons.actions.dollarCircle.soyTemplateName="tiger.icons.actions.dollarCircle"),e.icons.actions.flag=function(){return'<svg class="svg-icon svg-flag"><use xlink:href="#iconset-flag" /></svg>'},t.DEBUG&&(e.icons.actions.flag.soyTemplateName="tiger.icons.actions.flag"),e.icons.actions.fullscreen=function(){return'<svg class="svg-icon svg-fullscreen"><use xlink:href="#iconset-fullscreen" /></svg>'},t.DEBUG&&(e.icons.actions.fullscreen.soyTemplateName="tiger.icons.actions.fullscreen"),e.icons.actions.gear=function(){return'<svg class="svg-icon svg-gear"><use xlink:href="#iconset-gear" /></svg>'},t.DEBUG&&(e.icons.actions.gear.soyTemplateName="tiger.icons.actions.gear"),e.icons.actions.heart=function(){return'<svg class="svg-icon svg-heart"><use xlink:href="#iconset-heart" /></svg>'},t.DEBUG&&(e.icons.actions.heart.soyTemplateName="tiger.icons.actions.heart"),e.icons.actions.information=function(){return'<svg class="svg-icon svg-information"><use xlink:href="#iconset-information" /></svg>'},t.DEBUG&&(e.icons.actions.information.soyTemplateName="tiger.icons.actions.information"),e.icons.actions.login=function(){return'<svg class="svg-icon svg-login"><use xlink:href="#iconset-login" /></svg>'},t.DEBUG&&(e.icons.actions.login.soyTemplateName="tiger.icons.actions.login"),e.icons.actions.logout=function(){return'<svg class="svg-icon svg-logout"><use xlink:href="#iconset-logout" /></svg>'},t.DEBUG&&(e.icons.actions.logout.soyTemplateName="tiger.icons.actions.logout"),e.icons.actions.lightning=function(){return'<svg class="svg-icon svg-lightning"><use xlink:href="#iconset-lightning" /></svg>'},t.DEBUG&&(e.icons.actions.lightning.soyTemplateName="tiger.icons.actions.lightning"),e.icons.actions.moveLeft=function(){return'<svg class="svg-icon svg-move-left"><use xlink:href="#iconset-move-left" /></svg>'},t.DEBUG&&(e.icons.actions.moveLeft.soyTemplateName="tiger.icons.actions.moveLeft"),e.icons.actions.moveRight=function(){return'<svg class="svg-icon svg-move-right"><use xlink:href="#iconset-move-right" /></svg>'},t.DEBUG&&(e.icons.actions.moveRight.soyTemplateName="tiger.icons.actions.moveRight"),e.icons.actions.moveTop=function(){return'<svg class="svg-icon svg-move-top"><use xlink:href="#iconset-move-top" /></svg>'},t.DEBUG&&(e.icons.actions.moveTop.soyTemplateName="tiger.icons.actions.moveTop"),e.icons.actions.moveBottom=function(){return'<svg class="svg-icon svg-move-bottom"><use xlink:href="#iconset-move-bottom" /></svg>'},t.DEBUG&&(e.icons.actions.moveBottom.soyTemplateName="tiger.icons.actions.moveBottom"),e.icons.actions.reload=function(){return'<svg class="svg-icon svg-reload"><use xlink:href="#iconset-reload" /></svg>'},t.DEBUG&&(e.icons.actions.reload.soyTemplateName="tiger.icons.actions.reload"),e.icons.actions.userAdd=function(){return'<svg class="svg-icon svg-user-add"><use xlink:href="#iconset-user-add" /></svg>'},t.DEBUG&&(e.icons.actions.userAdd.soyTemplateName="tiger.icons.actions.userAdd"),e.icons.actions.userRemove=function(){return'<svg class="svg-icon svg-user-remove"><use xlink:href="#iconset-user-remove" /></svg>'},t.DEBUG&&(e.icons.actions.userRemove.soyTemplateName="tiger.icons.actions.userRemove"),e.icons.actions.writePaper=function(){return'<svg class="svg-icon svg-write-paper"><use xlink:href="#iconset-write-paper" /></svg>'},t.DEBUG&&(e.icons.actions.writePaper.soyTemplateName="tiger.icons.actions.writePaper"),e.icons.actions.zoomOut=function(){return'<svg class="svg-icon svg-zoom-out"><use xlink:href="#iconset-zoom-out" /></svg>'},t.DEBUG&&(e.icons.actions.zoomOut.soyTemplateName="tiger.icons.actions.zoomOut"),e.icons.actions.clock=function(){return'<svg class="svg-icon svg-clock"><use xlink:href="#iconset-clock" /></svg>'},t.DEBUG&&(e.icons.actions.clock.soyTemplateName="tiger.icons.actions.clock"),e.icons.actions.clockSmall=function(){return'<svg class="svg-icon small svg-clock--small"><use xlink:href="#iconset-clock--small" /></svg>'},t.DEBUG&&(e.icons.actions.clockSmall.soyTemplateName="tiger.icons.actions.clockSmall"),e.icons.actions.write=function(){return'<svg class="svg-icon svg-write"><use xlink:href="#iconset-write" /></svg>'},t.DEBUG&&(e.icons.actions.write.soyTemplateName="tiger.icons.actions.write"),e.icons.actions.writeSmall=function(){return'<svg class="svg-icon small svg-write--small"><use xlink:href="#iconset-write--small" /></svg>'},t.DEBUG&&(e.icons.actions.writeSmall.soyTemplateName="tiger.icons.actions.writeSmall"),e.icons.actions.share=function(){return'<svg class="svg-icon svg-share"><use xlink:href="#iconset-share" /></svg>'},t.DEBUG&&(e.icons.actions.share.soyTemplateName="tiger.icons.actions.share"),e.icons.actions.quote=function(){return'<svg class="svg-icon svg-quote"><use xlink:href="#iconset-quote" /></svg>'},t.DEBUG&&(e.icons.actions.quote.soyTemplateName="tiger.icons.actions.quote"),e.icons.actions.playIcon=function(){return'<svg class="svg-icon svg-quote"><use xlink:href="#icon-play" /></svg>'},t.DEBUG&&(e.icons.actions.playIcon.soyTemplateName="tiger.icons.actions.playIcon")}),define("app/navigation/userButton.view",["backbone.marionette","singleton/Utils","templates/tiger/components/header/notifications","templates/tiger/section/navbar","templates/tiger/icons/actions/usage"],function(e,t){"use strict";var n=e.ItemView.extend({ui:{avatar:".js_avatar"},template:tiger.section.navbarRightUserBar,modelEvents:{"change:avatar":"updateAvatar"},updateAvatar:function(){var e=this.model.get("avatar");this.ui.avatar.css("background-image","url("+t.imageUrl(e.id,"avt-small",e.format)+")")}});return n}),define("app/navigation/loginButton.view",["backbone.marionette","app/account/account.channel","templates/tiger/section/navbar"],function(e,t){"use strict";var n=e.ItemView.extend({template:tiger.section.navbarRightLogin,events:{"click .js_login-link":"onLoginClick"},onLoginClick:function(e){e.preventDefault(),t.trigger("loginRequired",{source:"loginButton"})}});return n}),define("singleton/BlogInfo",["underscore","singleton/CurrentBlog"],function(e,t){"use strict";var n={adEnabledSites:[{name:"Gizmodo",id:4},{name:"Gawker",id:7},{name:"io9",id:8},{name:"Kotaku",id:9},{name:"Deadspin",id:11},{name:"Jalopnik",id:12},{name:"Lifehacker",id:17},{name:"Jezebel",id:39},{name:"GizmodoES",id:19292},{name:"Guanabee",id:86551},{name:"studioatgawker",id:4541888},{name:"The fusion project",id:10698056},{name:"XperiaZ",id:471472023},{name:"BetterState",id:473241793},{name:"IBM",id:474911957},{name:"BusinessTravelersToolkit",id:476089313},{name:"SonyEntertainmentNetwork",id:476783795},{name:"WonderFilled",id:499874619},{name:"OreoWonderFilled",id:499964452},{name:"RandomHouseAudio",id:506884481},{name:"Gizmodo Live",id:509173099},{name:"RayDonovan",id:509473310},{name:"Kotaku Live Blog",id:510669784},{name:"Defamer",id:512288369},{name:"collaboratory",id:709976306},{name:"Doomsday Castle",id:813471273},{name:"fiestahero",id:1256311089},{name:"Metlife",id:1300181229},{name:"Porsche",id:1434801322},{name:"crashplan",id:1444734969},{name:"Quirky G.E",id:1460862244},{name:"Netflix",id:1463118792},{name:"3dprintingtoolkit",id:1467567363},{name:"goodtobebad",id:1467571985},{name:"Oliver Kovacs",id:1484116755},{name:"Over Rated",id:1521570730},{name:"biz product",id:1525133490},{name:"Playboy",id:1173588042,gptNetworkId:6487541,gptSiteName:"playboy.kinja"},{name:"Sploid",id:487662860}],gmgBlogs:["gawker","lifehacker","deadspin","kotaku","jezebel","io9","jalopnik","gizmodo"],currentBlogIsGmgBlog:function(){return e.find(this.gmgBlogs,function(e){return t.name===e})}};return n}),define("app/navigation/blogTitle.view",["backbone.marionette","singleton/CurrentBlog","singleton/EventDispatcher","singleton/BlogInfo","singleton/Feature","templates/tiger/section/navbar"],function(n,e,t,s,o){"use strict";var i=n.ItemView.extend({template:tiger.section.navbarBlogTitle,tagName:"div",className:"blog-title",ui:{blogLogo:".js_blog-title__logo",searchIcon:".js_search-button__open-icon"},triggers:{"click @ui.searchIcon":"open.searchbar"},attributes:{href:"/",title:e.displayName||""},fadeIn:function(){this.ui.blogLogo.addClass("fade-in")},fadeOut:function(){this.ui.blogLogo.removeClass("fade-in")},serializeData:function(){return{blogName:(e||{}).name,blogDisplayName:e.displayName||"",isGmgBlog:s.currentBlogIsGmgBlog(),logoSrc:this.options.logoSrc||"",imageAssetPath:this.options.imageAssetPath,showLogo:this.options.showLogo}},onRender:function(){o.isOn("gns")&&this.ui.blogLogo.removeClass("no-fade-transition"),this.listenTo(t,"logoHidden.topbar",this.fadeIn),this.listenTo(t,"logoShown.topbar",this.fadeOut)}});return i}),define("app/navigation/searchBar.view",["backbone.marionette","singleton/CurrentBlog","singleton/BlogInfo","singleton/EventDispatcher","singleton/Feature","templates/tiger/section/navbar"],function(n,e,s,t,o){"use strict";var i=n.ItemView.extend({template:tiger.section.navbarSearchBar,tagName:"div",className:"search-bar",ui:{searchForm:".js_search-bar__form",searchField:".js_search-bar__field",closeSearchIcon:".js_search-button__close-icon",blogLogo:".js_blog-title__logo"},events:{keyup:"onKeyup","click @ui.closeSearchIcon":"onCloseSearchButtonClick"},onCloseSearchButtonClick:function(){this.ui.closeSearchIcon.removeClass("fade-in"),this.ui.searchForm.removeClass("open")},onKeyup:function(e){27===e.keyCode&&this.onCloseSearchButtonClick()},fadeIn:function(){this.ui.blogLogo.addClass("fade-in")},fadeOut:function(){this.ui.blogLogo.removeClass("fade-in")},serializeData:function(){return{blogName:(e||{}).name,blogDisplayName:e.displayName||"",isGmgBlog:s.currentBlogIsGmgBlog(),logoSrc:this.options.logoSrc||"",imageAssetPath:this.options.imageAssetPath,showLogo:this.options.showLogo}},onRender:function(){this.ui.searchForm.on("transitionend webkitTransitionEnd oTransitionEnd",function(e){"width"===e.originalEvent.propertyName&&this.ui.searchForm.hasClass("open")?this.ui.closeSearchIcon.addClass("fade-in"):"width"===e.originalEvent.propertyName&&this.trigger("closed.searchbar")}.bind(this)),o.isOn("gns")&&(this.listenTo(t,"logoHidden.topbar",this.fadeIn),this.listenTo(t,"logoShown.topbar",this.fadeOut))},onDomRefresh:function(){this.ui.searchField.focus(),this.ui.searchForm.addClass("open")}});return i}),define("app/navigation/topbar.layout",["jquery","underscore","backbone.marionette","lib/foundation/foundation","app/MarionetteApp","app/notifdropdown/notifdropdown.app","app/modalmenu/globalmenu","app/navigation/userButton.view","app/navigation/loginButton.view","app/navigation/blogTitle.view","app/navigation/searchBar.view","module/ads/model/ads.slotModel","view/behaviors/googleAnalytics.behavior","singleton/EventDispatcher","singleton/CurrentUser","singleton/Feature","singleton/Utils","singleton/WindowController","module/ads/ads.events"],function(e,j,v,p,f,s,m,d,c,l,r,u,h,i,a,n,g,o,b){"use strict";var t="splash"===g.getKinjaMeta().pageType,y=v.Layout.extend({ui:{menuDropdown:"#global-blog",mobileMenuDropdown:".js_mobile-menu-button",notifDropdown:"#global-notifications",notifDropdownButton:".js_notif",navIcon:".js_nav-icon",kinjaIcon:".js_kinja-icon",userDropdown:"#global-user",rightUserBar:".js_right-user-bar",globalSearchDropdown:"#global-search",globalSearchInput:"#global-search-input",globalSearchTrigger:"#global-search-trigger",dashboardBlogSelectorBtn:".js_show-dashboard-blogs",hamburgerBtn:".js_hamburger-trigger",mobileTitle:".js_mobile-title",dashboardMobileTitleBlogs:".js_dashboard-mobile-title-blogs"},regions:{userButtonRegion:".js_right-user-bar",blogTitleRegion:".js_blog-title-region"},behaviors:{GoogleAnalyticsBehavior:{behaviorClass:h}},events:{"opened.fndtn.dropdown @ui.menuDropdown":"onDropdownOpened","closed.fndtn.dropdown @ui.menuDropdown":"onDropdownClosed","opened.fndtn.dropdown @ui.userDropdown":"onDropdownOpened","closed.fndtn.dropdown @ui.userDropdown":"onDropdownClosed","click .right-off-canvas-toggle":"fetchNotifications","click @ui.mobileMenuDropdown":"openModalGlobalmenu","opened.fndtn.dropdown @ui.globalSearchDropdown":"onGlobalSearchOpened","closed.fndtn.dropdown @ui.globalSearchDropdown":"onGlobalSearchClosed","click @ui.dashboardBlogSelectorBtn":"openBlogSelector"},initialize:function(){this.model.onAuthStateChange(this.onModelAuthenticated.bind(this))},onRender:function(){},initializeAutohide:function(){var s,c=!!window.kinja.meta.blogSales&&window.kinja.meta.blogSales.adsEnabled,i=function(){this.$el.addClass("fixed"),o.scrollAutohide(this.$el,{waypoint:e(".js_page")}),this.$el.removeClass("notransition")}.bind(this),r=function(){this.$el.removeClass("fixed"),o.unbindScrollAutohide()}.bind(this),a=function(){(e(".js_site-header").length||t)&&(this.showBlogLogo(),t||(this.setupScroll(),this.refreshBlogLogo())),n.isOn("splashy_ad")?(s=function(){0!==this.$el.offset().top?o.registerWaypoint(this.$el.parent(),0,function(e){"down"===e?i():r()}.bind(this)):i()}.bind(this),n.isOn("ad_module")?c?window.kinjaads.queue.push({zoneType:u.zoneTypes.SPLASHYTOP,onRenderEnded:s}):s():this.listenToOnce(b,"kinjaads.disabled kinjaads.SPLASHYTOP.displayed kinjaads.SPLASHYTOP.hide",s)):i()}.bind(this);n.isOn("gns")?this.model.onAuth.done(a):a()},mainLogoHidden:function(){var t=e(window),n=20,s=e(".js_site-header").offset().top-n,o=t.width()>799,i=t.scrollTop();return i>s&&o},setupScroll:function(){var t=e(window),a=20,n=e(".js_site-header").offset().top-a,r=function(){var e=t.scrollTop();e>n&&s?i.trigger("logoHidden.topbar"):i.trigger("logoShown.topbar"),this.ui.navIcon.toggleClass("hide",e>n),this.ui.kinjaIcon.toggleClass("hide",n>e)}.bind(this),s=t.width()>799,o=j.throttle(r,100);t.on("scroll.topbar",o),this.listenTo(i,"orientation:change",function(){s=t.width()>799})},showUserButton:function(){var e=new d({model:a});this.userButtonRegion.show(e)},showLoginButton:function(){var e=new c;this.userButtonRegion.show(e)},showBlogLogo:function(){var s=this.blogTitleRegion.$el||e(this.blogTitleRegion.el),o=new l({logoSrc:s.data("logoSrc"),imageAssetPath:s.data("imageAssetPath"),showLogo:!t&&this.mainLogoHidden()});o.on("open.searchbar",this.showSearchBar.bind(this)),this.blogTitleRegion.show(o),n.isOn("gns")||t||this.refreshBlogLogo()},refreshBlogLogo:function(){e(window).trigger("scroll")},showSearchBar:function(){var n=this.blogTitleRegion.$el||e(this.blogTitleRegion.el),s=new r({logoSrc:n.data("logoSrc"),imageAssetPath:n.data("imageAssetPath"),showLogo:!t&&this.mainLogoHidden()});this.listenTo(s,"closed.searchbar",this.showBlogLogo),this.blogTitleRegion.show(s)},onModelAuthenticated:function(){n.isOn("fasttoken2")?this.model.isLoggedIn()?s.initialize():s.remove():this.model.isLoggedIn()?(this.showUserButton(),s.initialize()):(this.showLoginButton(),s.remove()),e(window.document).foundation()},onDropdownOpened:function(n){var t=n.target.id;e("[data-dropdown="+t+"]").addClass("active"),e("body").addClass(t+"-open")},onDropdownClosed:function(n){var t=n.target.id;e("[data-dropdown="+t+"]").removeClass("active"),e("body").removeClass(t+"-open")},manualCloseDropdown:function(){p.libs.dropdown.close(this.ui.menuDropdown)},fetchNotifications:function(){s.fetch()},onGlobalSearchOpened:function(){this.ui.globalSearchInput.focus(),this.ui.globalSearchTrigger.addClass("active")},onGlobalSearchClosed:function(){this.ui.globalSearchInput.blur(),this.ui.globalSearchTrigger.removeClass("active")},openBlogSelector:function(t){var n=this;t.stopPropagation(),e(".dashboard-blog-selector").height(e(document).height()),e(".dashboard-blog-selector").removeClass("hide"),this.ui.dashboardBlogSelectorBtn.addClass("hide"),this.ui.hamburgerBtn.removeClass("hide"),this.ui.mobileTitle.addClass("hide"),this.ui.dashboardMobileTitleBlogs.removeClass("hide"),e("body").on("click.hidemenu",function(){n.closeBlogSelector()})},closeBlogSelector:function(){this.ui.dashboardBlogSelectorBtn.removeClass("hide"),this.ui.hamburgerBtn.addClass("hide"),this.ui.mobileTitle.removeClass("hide"),this.ui.dashboardMobileTitleBlogs.addClass("hide"),e(".dashboard-blog-selector").addClass("hide"),e("body").off("click.hidemenu")},openModalGlobalmenu:function(){var e=new m({model:a});f.duimodalregion.show(e)}});return y}),define("templates/tiger/components/user/your-blogs",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.user.yourBlogsItem=function(n,a,s){var o="",i=s.features.no_offcanvas_manageblog;return o+='<a href="http://'+e.$$escapeHtmlAttribute(n.blogData.canonicalHost)+'" class="hover-icon" data-ga="[User Menu, My Blogs Click - '+e.$$escapeHtmlAttribute(n.blogData.displayName)+']">'+(n.blogData.avatar&&n.blogData.avatar.id?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.blogData.avatar.id,"avt-small",n.blogData.avatar.format)))+'" class="icon icon-prepend" alt="" />':'<img src="//x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png" class="icon icon-prepend" alt="" />')+e.$$escapeHtml(n.blogData.displayName)+"</a>"+(i?'<a class="icon--svg u-ultralight u-highlighted--onhover show-for-medium-down" href="https://kinja.com/manage/'+e.$$escapeHtmlAttribute(n.blogData.name)+'">'+t.icons.places.settings(null,null,s)+"</a>":"")},n.DEBUG&&(t.components.user.yourBlogsItem.soyTemplateName="tiger.components.user.yourBlogsItem")}),define("app/navigation/blogItem.view",["backbone.marionette","templates/tiger/components/user/your-blogs"],function(e){"use strict";var t=e.ItemView.extend({template:tiger.components.user.yourBlogsItem,tagName:"li",className:"ownblog js_ownblog",serializeData:function(){return{blogData:this.model.attributes}}});return t}),define("templates/tiger/components/user/profile-menu",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.components.user.globalProfileMenuContent=function(n,o,s){return'<ul class="user-links"><li class="display-name"><img src="'+t.$$escapeHtmlAttribute(t.$$filterNormalizeUri(window.kinja.imageUrl(n.currentUser.avatar.id,"avt-small",n.currentUser.avatar.format)))+'" class="avatar"><span data-username="'+t.$$escapeHtmlAttribute(n.currentUser.screenName)+'" class="js_display-name">'+t.$$escapeHtml(n.currentUser.displayName)+'</span></li><li class="hover-icon"><a href="//kinja.com/'+t.$$escapeHtmlAttribute(n.currentUser.screenName)+'" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Your profile click, js_pageType]">'+e.icons.places.user(null,null,s)+'Your profile</a></li><li class="hover-icon"><a href="#" class="js_compose-post-button readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Compose Post Click, js_pageType]">'+e.icons.actions.write(null,null,s)+'Compose post</a></li><li class="hover-icon"><a href="//kinja.com/settings" class="js_settings-link readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Account Settings Click, js_pageType]">'+e.icons.actions.gear(null,null,s)+'Account Settings</a></li><li class="hover-icon">'+(s.features.activenow?'<a href="//kinja.com/dashboard/activenow" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Active Now View Click, js_pageType]">':'<a href="//kinja.com/dashboard" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Private View Click, js_pageType]">')+e.icons.places.home(null,null,s)+'Dashboard</a></li><li class="hover-icon"><a href="//kinja.com/manage'+(n.currentBlogName&&n.isMemberCurrentBlog?"/"+t.$$escapeHtmlAttribute(n.currentBlogName):"")+'" data-ga="[User Menu, New Manage Blog Click, js_pageType]" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.places.settings(null,null,s)+(n.currentBlogName&&n.isMemberCurrentBlog?"Manage "+t.$$escapeHtml(n.blogName):"Manage blogs")+"</a></li>"+(s.features.superuser&&("frontpage"==n.pageType||"permalink"==n.pageType)?'<li class="js_manageblog hover-icon hide"><a href="#" class="js_manageblog-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Manage Blog Click, js_pageType]">'+e.icons.places.lock(null,null,s)+"Superuser Settings</a></li>":"")+'<li class="js_salestools hover-icon hide"><a href="#" class="js_salestools-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Business Tool Click, js_pageType]">'+e.icons.essential.bubble(null,null,s)+"Biz Tools"+(n.blogName?" for "+t.$$escapeHtml(n.blogName):"")+'</a></li><li class="js_promotions hover-icon hide"><a href="#" class="js_promotions-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Promotions Click, js_pageType]">'+e.icons.essential.starCircle(null,null,s)+'Active Promotions</a></li><li class="js_superuser-tools hover-icon hide"><a href="#" class="js_createblog-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Create Blog Click, js_pageType]">'+e.icons.actions.blogAdd(null,null,s)+"Create blog</a></li>"+(s.features.superuser?'<li class="js_superuser-tools hide"><a href="?superuser=off" class="hover-icon icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Hide Mom Jeans Click, js_pageType]">'+e.icons.essential.star(null,null,s)+"Hide Mom Jeans</a></li>":'<li class="js_superuser-tools hide"><a href="?superuser" class="hover-icon icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Show Mom Jeans Click, js_pageType]">'+e.icons.essential.star(null,null,s)+"Show Mom Jeans</a></li>")+'<li class="hover-icon"><a href="#" class="js_logout-link icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Logout Click, js_pageType]">'+e.icons.actions.logout(null,null,s)+'Logout</a></li></ul><div class="divider"></div><ul class="title-ownblogs"><li class="title">My blogs</li></ul><ul class="js_myblogs myblogs"></ul>'},n.DEBUG&&(e.components.user.globalProfileMenuContent.soyTemplateName="tiger.components.user.globalProfileMenuContent")}),define("templates/tiger/icons/places/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.icons.places.avatar=function(){return'<svg class="svg-icon svg-avatar"><use xlink:href="#iconset-avatar" /></svg>'},t.DEBUG&&(e.icons.places.avatar.soyTemplateName="tiger.icons.places.avatar"),e.icons.places.avatarBig=function(){return'<svg class="svg-icon svg-avatar-big"><use xlink:href="#iconset-avatar-big" /></svg>'},t.DEBUG&&(e.icons.places.avatarBig.soyTemplateName="tiger.icons.places.avatarBig"),e.icons.places.blog=function(){return'<svg class="svg-icon svg-blog"><use xlink:href="#iconset-blog" /></svg>'},t.DEBUG&&(e.icons.places.blog.soyTemplateName="tiger.icons.places.blog"),e.icons.places.hashmark=function(){return'<svg class="svg-icon svg-hashmark"><use xlink:href="#iconset-hashmark" /></svg>'},t.DEBUG&&(e.icons.places.hashmark.soyTemplateName="tiger.icons.places.hashmark"),e.icons.places.home=function(){return'<svg class="svg-icon svg-home"><use xlink:href="#iconset-home" /></svg>'},t.DEBUG&&(e.icons.places.home.soyTemplateName="tiger.icons.places.home"),e.icons.places.key=function(){return'<svg class="svg-icon svg-key"><use xlink:href="#iconset-key" /></svg>'},t.DEBUG&&(e.icons.places.key.soyTemplateName="tiger.icons.places.key"),e.icons.places.lock=function(){return'<svg class="svg-icon svg-lock"><use xlink:href="#iconset-lock" /></svg>'},t.DEBUG&&(e.icons.places.lock.soyTemplateName="tiger.icons.places.lock"),e.icons.places.mail=function(){return'<svg class="svg-icon svg-mail"><use xlink:href="#iconset-mail" /></svg>'},t.DEBUG&&(e.icons.places.mail.soyTemplateName="tiger.icons.places.mail"),e.icons.places.mailSmall=function(){return'<svg class="svg-icon small svg-mail--small"><use xlink:href="#iconset-mail--small" /></svg>'},t.DEBUG&&(e.icons.places.mailSmall.soyTemplateName="tiger.icons.places.mailSmall"),e.icons.places.momjeans=function(){return'<svg class="svg-icon svg-momjeans"><use xlink:href="#iconset-momjeans" /></svg>'},t.DEBUG&&(e.icons.places.momjeans.soyTemplateName="tiger.icons.places.momjeans"),e.icons.places.settings=function(){return'<svg class="svg-icon svg-settings"><use xlink:href="#iconset-settings" /></svg>'},t.DEBUG&&(e.icons.places.settings.soyTemplateName="tiger.icons.places.settings"),e.icons.places.sharedpostSmall=function(){return'<svg class="svg-icon small svg-sharedpost--small"><use xlink:href="#iconset-sharedpost--small" /></svg>'},t.DEBUG&&(e.icons.places.sharedpostSmall.soyTemplateName="tiger.icons.places.sharedpostSmall"),e.icons.places.user=function(){return'<svg class="svg-icon svg-user"><use xlink:href="#iconset-user" /></svg>'},t.DEBUG&&(e.icons.places.user.soyTemplateName="tiger.icons.places.user"),e.icons.places.users=function(){return'<svg class="svg-icon svg-users"><use xlink:href="#iconset-users" /></svg>'},t.DEBUG&&(e.icons.places.users.soyTemplateName="tiger.icons.places.users")}),define("app/navigation/userMenu.view",["jquery","underscore","backbone","backbone.marionette","app/navigation/blogItem.view","singleton/Feature","singleton/CurrentBlog","singleton/Utils","module/KinjaAnalytics","view/behaviors/googleAnalytics.behavior","templates/tiger/components/user/profile-menu","templates/tiger/icons/actions/usage","templates/tiger/icons/places/usage"],function(i,t,c,a,r,o,e,n,s,l){"use strict";require(["module/PlacesIconModule"],function(){}),require(["module/ActionsIconModule"],function(){});var d=a.CompositeView.extend({events:{"click .js_logout-link":"onLogoutClick","click .js_createblog-link":"onCreateBlogClick","click .js_manageblog-link":"onManageBlogClick","click .js_salestools-link":"onSalesClick","click .js_promotions-link":"onPromotionsClick","click .js_channels-link":"onChannelsClick"},ui:{composeButton:".js_compose-post-button",superuserButtons:".js_superuser-tools",salesButtons:".js_salestools",blogButtons:".js_manageblog",promotionsButton:".js_promotions"},collection:new c.Collection,itemView:r,itemViewContainer:".js_myblogs",template:tiger.components.user.globalProfileMenuContent,behaviors:function(){return this.options.offcanvas?{GoogleAnalyticsBehavior:{behaviorClass:l}}:{}},initialize:function(){this.listenTo(this.model.get("membership"),"add",this.render),this.listenTo(this.model,"change:screenName change:displayName",this.render)},onRender:function(){if(this.model.isLoggedIn()){var r,s=this.model.get("screenName"),c=this.model.get("defaultBlogId"),a=o.isOn("editor_own_page_test")?window.location.search:"",l=t.any(["OWNER","AUTHOR","ADMIN"],function(t){return this.model.hasRole(t,e.id)}.bind(this));a+=l?("?"===a[0]?"&":"?")+"blogid="+e.id:"",this.ui.composeButton.attr("href","//"+n.getKinjaHost()+"/write"+a),this.model.isSuperuser()?this.ui.superuserButtons.removeClass("hide"):this.ui.superuserButtons.remove(),this.model.isSalesperson()||this.model.isSuperuser()&&o.isOn("superuser")?this.ui.salesButtons.removeClass("hide"):this.ui.salesButtons.remove(),(this.model.isSalesperson()||this.model.isSuperuser()&&o.isOn("superuser")||e.isGmgBlog&&this.model.hasRole("ADMIN",e.id))&&this.ui.promotionsButton.removeClass("hide"),this.model.hasRole("ADMIN",e.id)||this.model.isSuperuser()&&e.id?this.ui.blogButtons.removeClass("hide"):this.model.isSuperuser()?this.ui.blogButtons.remove():i(".js_manageblog-link ").hide(),r=t.sortBy(this.model.getBlogs(),function(e){return e.id===c&&e.name!==s&&(e.name=s,e.canonicalHost=s+".kinja.com"),(e.id===c?"0":"1")+e.name}),this.collection.reset(r)}},serializeData:function(){var s=t.map(this.model.get("membership").models,function(e){return e.get("blogId")}),o=t.indexOf(s,e.id)>-1;return{blogName:e.displayName,currentUser:this.model.toJSON(),currentBlogName:e.name,isMemberCurrentBlog:o,pageType:n.kinjaMeta.pageType}},onLogoutClick:function(t){var e=n.getKinjaMeta().pageType;t.preventDefault(),this.model.logout(),("dashboard"===e||"manageblog"===e)&&(window.location.pathname.indexOf("notifications")>-1?s.setContext(null,"NOTIFICATIONS"):s.setContext(null,"DASHBOARD"),s.pushEvent("LOGOUT"))},onCreateBlogClick:function(e){e.preventDefault(),require(["module/BlogSettingsModule"],function(e){e.controller.showCreateBlog()})},onManageBlogClick:function(e){e.preventDefault(),require(["module/BlogSettingsModule"],function(e){e.controller.showManageBlog()})},onSalesClick:function(e){e.preventDefault(),require(["module/BusinessModule"],function(e){e.controller.showBusinessTools()})},onPromotionsClick:function(e){e.preventDefault(),window.location.href="http://"+n.getKinjaHost()+"/dfp/promotions"},onChannelsClick:function(e){e.preventDefault(),i(".js_channels-off-canvas-toggle").click()}});return d}),define("app/modalmenu/usermenu",["backbone.marionette","view/modal/duimodal.defaultBehavior","app/navigation/userMenu.view","templates/tiger/components/duiModal","templates/tiger/components/navpanels"],function(e,t,n){"use strict";var s;return s=e.Layout.extend({template:tiger.components.duiModal.layout,regions:{bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:t}},onRender:function(){var e=new n({model:this.model,offcanvas:!0});this.bodyRegion.show(e),this.$(".dui-modal-body").addClass("nav-dropdown")}})}),define("templates/tiger/components/spinner",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.spinner.bounce=function(){return'<span class="spinner bounce"><span class="one"></span><span class="two"></span><span class="three"></span></span>'},t.DEBUG&&(e.components.spinner.bounce.soyTemplateName="tiger.components.spinner.bounce"),e.components.spinner.gifthaw=function(){return'<div class="animationContainer"><svg width="26" height="12" viewBox="0 0 26 12" version="1.1" xmlns="http://www.w3.org/2000/svg" class="loading-animation loading-animation--small grey"><circle cx="4" cy="6" r="3" class="circle-1" /><circle cx="4" cy="6" r="3" class="circle-2" /><circle cx="13" cy="6" r="3" class="circle-3" /><circle cx="22" cy="6" r="3" class="circle-4" /></svg></div>'},t.DEBUG&&(e.components.spinner.gifthaw.soyTemplateName="tiger.components.spinner.gifthaw")}),define("app/modalmenu/notifmenu",["jquery","backbone.marionette","collection/Notifications","view/modal/duimodal.defaultBehavior","templates/tiger/components/duiModal","templates/tiger/components/navpanels","templates/tiger/components/spinner"],function(t,e,n,s){"use strict";var o,i=e.ItemView.extend({template:tiger.components.spinner.bounce});return o=e.Layout.extend({notificationListLoaded:null,template:tiger.components.duiModal.layout,regions:{bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:s}},initNotificationList:function(){var e=t.Deferred();return require(["module/NotificationListModule"],function(t){e.resolve(t)}),e},onRender:function(){this.notificationListLoaded||(this.bodyRegion.show(new i),this.notificationListLoaded=this.initNotificationList()),this.notificationListLoaded.done(function(t){var e=new n,s=new t({collection:e,model:this.model});this.bodyRegion.show(s),e.fetch({reset:!0}),this.$(".dui-modal-body").addClass("nav-dropdown")}.bind(this))}})}),define("app/navigation/secondaryNav.view",["jquery","backbone","backbone.marionette"],function(e,n,t){"use strict";var s=n.Model.extend({defaults:{open:!1}}),o=t.Layout.extend({model:new s,modelEvents:{"change:open":"listEventHandler"},initialize:function(){var e,t;this.animation=this.options.animation,this.animation&&this.$el.addClass("animated-secondary-nav"),e=new i({el:".js_toggle-secondary-nav",model:this.model}),t=new a({el:".js_secondary-nav-wrapper",model:this.model})},listEventHandler:function(){var t=this;this.model.get("open")?e("body").on("click.hidemenu",function(){t.model.set("open",!1)}):e("body").off("click.hidemenu")}}),i=t.ItemView.extend({events:{click:"openSecondaryNav"},initialize:function(){var t=this.$el.parents(".js_secondary-nav-btn-wrapper");e(".js_global-nav-wrap").on("autohide.pushdown.show",function(){t.addClass("shown")}).on("autohide.pushdown.hide",function(){t.removeClass("shown")})},openSecondaryNav:function(e){e.stopPropagation(),this.model.set("open",!0)}}),a=t.ItemView.extend({modelEvents:{"change:open":"toggleOpen"},toggleOpen:function(){this.model.get("open")&&(this.$el.height(e(document).height()),e(window).scrollTop(0)),this.$el.toggleClass("hide",!this.model.get("open"))}});return o}),define("templates/tiger/section/header/success-box",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,t,n){e.section.header.successBox=function(t,o,s){return'<div class="proxima success-box js_success_box" style="display: none">'+(t.dismissable?'<a href="#" class="js_close close icon--svg u-darkened--onhover">'+e.icons.actions.closeSmall(null,null,s)+"</a>":"")+'<span class="msg">'+n.$$filterNoAutoescape(t.message)+"</span></div>"},t.DEBUG&&(e.section.header.successBox.soyTemplateName="tiger.section.header.successBox"),e.section.header.moreWarnings=function(e){return'<div class="proxima success-box js_additional-warnings"><a href="#">'+n.$$escapeHtml(e.count)+" more warnings</a></div>"},t.DEBUG&&(e.section.header.moreWarnings.soyTemplateName="tiger.section.header.moreWarnings")}),define("view/SuccessBox",["jquery","view/BaseView","templates/tiger/section/header/success-box"],function(e,t){"use strict";var n=t.extend({events:{"click .js_close":"close","click .js_open-channels":"openChannels"},initialize:function(t){this.options=e.extend({message:"",dismissable:!0,url:null,permanent:!1,hidden:!1,timeout:2500},t)},render:function(){var t=this.options,n=this.soyToHtml(tiger.section.header.successBox,{message:this.getHtml(t.message),dismissable:t.dismissable});e("#js_success-box-container").append(n),this.setElement(e(".js_success_box:last")),this.options.hidden||this.$el.fadeIn(300),t.warningBox&&this.$el.addClass("warning-box"),window.setTimeout(function(){this.options.permanent||this.close()}.bind(this),t.timeout),null!==this.options.url&&this.$el.on("click",function(){return window.location=this.options.url,!1}.bind(this)).addClass("linked")},close:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.slideUp("fast",this.remove.bind(this))},attachMoreWarningsBox:function(t){var n=this.soyToHtml(tiger.section.header.moreWarnings,{count:t});e("#js_success-box-container").append(n),e("#js_success-box-container .js_additional-warnings a").click(function(t){t.preventDefault(),e(this).parent().hide(),e(".js_success_box").show()})},openChannels:function(t){e(".js_channels-off-canvas-toggle").click(),t.preventDefault()}});return n}),define("templates/tiger/section/sidebar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.section.sidebar.sidebarModule=function(e,a,n){var o="",s=e.trendingStories.length&&e.adsEnabled&&!n.features.leftrail_notrending,i=e.popularStories.length;return o+='<div class="sidebar-content js_sidebar-container js_sidebar">'+(n.features.newsletter_fs?'<div class="js_newsletter-btn--subscribe"></div>':"")+(s?'<div class="sidebar-module trending-module js_leftrailmodule">'+t.section.sidebar.leftrailTrending({posts:e.trendingStories,postsJson:e.trendingStoriesJson,permalinkPost:e.permalinkPost},null,n)+"</div>"+t.section.sidebar.containedAdContainer({preload:!0},null,n):"")+(i?'<div class="sidebar-module js_leftrailmodule leftrailmodule--popular'+(s?" invisible":"")+'">'+t.section.sidebar.leftrailPopular({popularPosts:e.popularStories,permalinkPost:e.permalinkPost,blogDisplayName:e.blogDisplayName,recommendedByScreenName:e.recommendedByScreenName,recommendedByDisplayName:e.recommendedByDisplayName},null,n)+'<div class="leftrailmodule--promotion js_leftrailmodule--promotion js_ad-promotion ad-promotions-container row"><div class="column">'+t.components.ad.leftrailPromotion({pp_position:"sidebar"},null,n)+"</div></div></div>"+(s?"":t.section.sidebar.containedAdContainer({preload:!0},null,n)):"")+"</div>"},n.DEBUG&&(t.section.sidebar.sidebarModule.soyTemplateName="tiger.section.sidebar.sidebarModule"),t.section.sidebar.leftrailTrendingImage=function(t,r,s){var o="",n=t.post.image,i=""+(n?"":(null==t.post.defaultBlogLogo?null:t.post.defaultBlogLogo.id)?"placeholder--logo":"placeholder--avatar"),a=""+(n?e.$$escapeHtml(window.kinja.imageUrl(n.id,"KinjaMedium",n.frozenFormat)):(null==t.post.defaultBlogLogo?null:t.post.defaultBlogLogo.id)?e.$$escapeHtml(window.kinja.imageUrl(t.post.defaultBlogLogo.id,"original",t.post.defaultBlogLogo.frozenFormat)):(null==t.post.defaultBlogAvatar?null:t.post.defaultBlogAvatar.id)?e.$$escapeHtml(window.kinja.imageUrl(t.post.defaultBlogAvatar.id,"original",t.post.defaultBlogAvatar.frozenFormat)):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png");return o+='<span class="trending-image-wrapper"><span class="img--16x9 '+e.$$escapeHtmlAttribute(i)+'"'+(s.features.lazy_trending_module||s.features.personalized_trending_module?"":" style=\"background-image: url('"+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a))+"')\"")+'role="img" aria-label="'+e.$$escapeHtmlAttribute(t.post.headline)+'" alt="'+e.$$escapeHtmlAttribute(t.post.headline)+'"></span></span>'},n.DEBUG&&(t.section.sidebar.leftrailTrendingImage.soyTemplateName="tiger.section.sidebar.leftrailTrendingImage"),t.section.sidebar.leftrailTrending=function(a,C,o){var s="",h=3,j=o.features.fullheadline?130:73,n=(a.posts[0],o.features.lazy_trending_module||o.features.personalized_trending_module);s+="<header><h2>"+(n?"<strong>You</strong> may also like":"<strong>Popular</strong> from all blogs")+'</h2></header><div class="trending-reel js_trending-reel clearfix'+(n?" lazy-trending":"")+'" '+(a.postsJson?'data-posts="'+e.$$escapeHtmlAttribute(a.postsJson)+'"':"")+'><div class="index-wrapper">';for(var u=a.posts,b=u.length,r=0;b>r;r++)c=u[r],m=(c.image,"Trending module click, position "+e.$$escapeHtml(r+1)+", js_pageType"),s+=h>r?'<div class="index-img-wrap reel__item js_reel__item"><div class="reel__thumb"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(c.permalink))+'" data-ga="['+e.$$escapeHtmlAttribute(m)+']">'+t.section.sidebar.leftrailTrendingImage({post:c},null,o)+'<span class="index-img-num"></span></a></div></div>':"";s+='</div><div class="trending-progress js_trending-progress clearfix">';for(g=h,d=0;g>d;d++)s+='<div class="trending-progress__segment js_trending-progress__segment"><div class="segment__fill"></div></div>';s+='</div><div class="reel-wrap"><div class="reel js_reel">';for(var p=a.posts,v=p.length,l=0;v>l;l++){var c,d,m,g,i=p[l],y=""+t.utils.relativeTime({time:i.publishTime},null,o),f=""+(n?"[Author Name]":e.$$escapeHtml(window.kinja.stripHtmlTags(i.authorName,""))),_=n?"[Blog Name]":i.defaultBlogName,w=n?"[Headline]":i.headline,O=n?"[Publish Time]":y,x=n?"[Post Link]":i.permalink;s+='<a class="reel__feature sidebar-item js_reel__feature'+(0==l?" active":"")+'" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(x))+'" data-ga="[Trending module click, position main, js_pageType]">'+t.section.sidebar.leftrailTrendingImage({post:i},null,o)+'<div class="trending-description-wrapper"><div class="reel__feature-description" style="background-color:#ffffff;min-height:93px"><div class="meta meta--source js_trending-source"><strong>'+e.$$escapeHtml(_)+"</strong>"+(f?" &middot; "+e.$$filterNoAutoescape(f):"")+'</div><h4 class="headline js_headline">'+e.$$filterNoAutoescape(window.kinja.truncateHtml(w,j))+'</h4><div class="meta js_meta"><time>'+e.$$filterNoAutoescape(O)+"</time></div></div></div></a>"}return s+="</div></div></div>"},n.DEBUG&&(t.section.sidebar.leftrailTrending.soyTemplateName="tiger.section.sidebar.leftrailTrending"),t.section.sidebar.leftrailPopular=function(n,m,d){var s,i,a="",h=3,l=""+(n.recommendedByDisplayName&&n.recommendedByScreenName?e.$$escapeHtml(n.recommendedByScreenName):n.recommendedByDisplayName&&n.popularPosts.length?e.$$escapeHtml(n.popularPosts[0].authorScreenName):""),c=l&&n.recommendedByDisplayName;a+="<header><h2>"+(c?'<strong>Recent</strong> from <a href="//kinja.com/'+e.$$escapeHtmlAttribute(l)+'">'+e.$$escapeHtml(n.recommendedByDisplayName)+"</a>":n.blogDisplayName?"<strong>Popular</strong> from "+e.$$escapeHtml(n.blogDisplayName):"<strong>Popular</strong> in your network")+"</h2></header>";for(var r=n.popularPosts,u=r.length,o=0;u>o;o++)s=r[o],i=s.image,a+=h>o?t.section.sidebar.leftrailPopularItem({index:o+1,headline:s.headline,imageUrl:i?window.kinja.imageUrl(i.id,"KinjaCenteredMedium",i.frozenFormat):"",permalink:s.permalink,authorName:s.authorName,isCurrentPost:!!n.permalinkPost&&n.permalinkPost.permalink==s.permalink,isRecommended:c,blogName:s.defaultBlogName,replyCount:s.replyCount,likeCount:s.likeCount,viewCount:s.viewCount,publishTime:s.publishTime},null,d):"";return a},n.DEBUG&&(t.section.sidebar.leftrailPopular.soyTemplateName="tiger.section.sidebar.leftrailPopular"),t.section.sidebar.leftrailPopularItem=function(n,l,s){var i,a,o="",r=s.features.fullheadline?130:73,c="Popular stories click, position "+e.$$escapeHtml(n.index)+", js_pageType";return o+='<div class="sidebar-item'+(n.isCurrentPost?" highlighted":"")+(n.isRecommended?" recommended":"")+'"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.permalink))+'" data-ga="['+e.$$escapeHtmlAttribute(c)+']">'+(n.imageUrl?'<span class="img--16x9"><span class="data-overlay"><ul>'+(n.likeCount?"<li>"+t.section.sidebar.numberFormat({number:n.likeCount},null,s)+t.icons.essential.star(null,null,s)+"</li>":"")+(n.replyCount?"<li>"+t.section.sidebar.numberFormat({number:n.replyCount},null,s)+t.icons.essential.bubble(null,null,s)+"</li>":"")+(n.viewCount?"<li>"+t.section.sidebar.numberFormat({number:n.viewCount},null,s)+t.icons.essential.flame(null,null,s)+"</li>":"")+"</ul></span>"+(n.imageUrl?'<span class="img--16x9" style="background-image: url('+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.imageUrl))+')" role="img" aria-label="'+e.$$escapeHtmlAttribute(n.headline)+'" alt="'+e.$$escapeHtmlAttribute(n.headline)+'"></span>':"")+"</span>":""),i=""+e.$$escapeHtml(window.kinja.stripHtmlTags(n.authorName,"")),o+='<div class="meta meta--source"><strong>'+e.$$escapeHtml(n.blogName)+"</strong>"+(i?" &middot; "+e.$$filterNoAutoescape(i):"")+'</div><h4 class="headline">'+e.$$filterNoAutoescape(window.kinja.truncateHtml(n.headline,r))+"</h4>",a=""+t.utils.relativeTime({time:n.publishTime},null,s),o+='<div class="meta"><time>'+e.$$filterNoAutoescape(a)+"</time></div></a></div>"},n.DEBUG&&(t.section.sidebar.leftrailPopularItem.soyTemplateName="tiger.section.sidebar.leftrailPopularItem"),t.section.sidebar.containedAdContainer=function(e,s,n){return e=e||{},"<div"+(e.preload?' id="js_leftrailmodule--preloadedad"':"")+' class="sidebar-module js_contained-ad-container contained-ad-container js_leftrailmodule invisible"><div class="contained-ad-shaft js_contained-ad-shaft"><div class="contained-ad-wrapper js_contained-ad-wrapper notransform"><div class="ad-pad"></div>'+t.components.ad.leftRail(null,null,n)+'<div class="ad-pad"></div></div></div></div>'},n.DEBUG&&(t.section.sidebar.containedAdContainer.soyTemplateName="tiger.section.sidebar.containedAdContainer"),t.section.sidebar.containedAdContents=function(e,s,n){return e=e||{},'<div class="contained-ad-shaft js_contained-ad-shaft"><div class="contained-ad-wrapper js_contained-ad-wrapper">'+(e.isEmpty?"":'<div class="ad-pad"></div>'+t.components.ad.leftRail(null,null,n)+'<div class="ad-pad"></div>')+"</div></div>"},n.DEBUG&&(t.section.sidebar.containedAdContents.soyTemplateName="tiger.section.sidebar.containedAdContents"),t.section.sidebar.numberFormat=function(t){return""+(t.number<1e3?e.$$escapeHtml(t.number):t.number>1e3&&t.number<1e6?e.$$escapeHtml(Math.round(t.number/1e3*10)/10)+"K":e.$$escapeHtml(Math.round(t.number/1e6*10)/10)+"M")},n.DEBUG&&(t.section.sidebar.numberFormat.soyTemplateName="tiger.section.sidebar.numberFormat")}),define("templates/tiger/components/ad/ads",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,t,n){e.components.ad.zoneSimple=function(e){var i="",t="MOBILE"==e.type,s=Math.floor(89999999*Math.random())+1e7,o=e.media&&"INSTREAM_VIDEO"==e.media;return i+='<div class="ad-unit js_ad-unit'+(t?" hide-contents":"")+" ad-"+n.$$escapeHtmlAttribute(e.cssClass)+" js_ad-"+n.$$escapeHtmlAttribute(e.cssClass)+'">'+(t?'<div class="ad-mobile-inner"><p class="ad-label proxima"><small class=" proxima">Advertisement</small></p>':"")+'<div id="ad-container-'+n.$$escapeHtmlAttribute(s)+'" class="ad-container js_ad-container"'+(o?'data-media-type="'+n.$$escapeHtmlAttribute(e.media)+'"':"")+'data-zone-type="'+n.$$escapeHtmlAttribute(e.type)+'"'+(e.forcedAdZone?' data-forced-ad-zone="'+n.$$escapeHtmlAttribute(e.forcedAdZone)+'"':"")+(e.postId?' data-post-id="'+n.$$escapeHtmlAttribute(e.postId)+'"':"")+(e.pp_position?'data-pp-position="'+n.$$escapeHtmlAttribute(e.pp_position)+'"':"")+">"+(o?'<span id="js_instream_video-placeholder-'+n.$$escapeHtmlAttribute(s)+'" class="js_instream-video-placeholder"></span>':"")+"</div>"+(t?'<p class="ad-label-bottom"></p></div>':"")+"</div>"},t.DEBUG&&(e.components.ad.zoneSimple.soyTemplateName="tiger.components.ad.zoneSimple"),e.components.ad.tracker=function(t,s,n){return t=t||{},""+e.components.ad.zoneSimple({type:"TRACKER",cssClass:"tracker",forcedAdZone:null!=t.postAdZone?t.postAdZone:null,postId:null!=t.postId?t.postId:null},null,n)},t.DEBUG&&(e.components.ad.tracker.soyTemplateName="tiger.components.ad.tracker"),e.components.ad.topBanner=function(n,s,t){return""+e.components.ad.zoneSimple({type:"TOP_BANNER",cssClass:"top-banner"},null,t)},t.DEBUG&&(e.components.ad.topBanner.soyTemplateName="tiger.components.ad.topBanner"),e.components.ad.billboard=function(n,s,t){return""+e.components.ad.zoneSimple({type:"BILLBOARD",cssClass:"billboard"},null,t)},t.DEBUG&&(e.components.ad.billboard.soyTemplateName="tiger.components.ad.billboard"),e.components.ad.billboardDynamic=function(n,s,t){return""+e.components.ad.zoneSimple({type:"BILLBOARD_DYNAMIC",cssClass:"billboard--dynamic"},null,t)},t.DEBUG&&(e.components.ad.billboardDynamic.soyTemplateName="tiger.components.ad.billboardDynamic"),e.components.ad.leftRail=function(n,s,t){return""+e.components.ad.zoneSimple({type:"LEFT_RAIL",cssClass:"left-rail"},null,t)},t.DEBUG&&(e.components.ad.leftRail.soyTemplateName="tiger.components.ad.leftRail"),e.components.ad.mobile=function(n,s,t){return""+e.components.ad.zoneSimple({type:"MOBILE",cssClass:"mobile"},null,t)},t.DEBUG&&(e.components.ad.mobile.soyTemplateName="tiger.components.ad.mobile"),e.components.ad.mobileSecond=function(n,s,t){return"<h1>INSERT TABOOLA HERE</h1>"+e.components.ad.zoneSimple({type:"MOBILE_SECOND",cssClass:"mobile_second--dynamic"},null,t)},t.DEBUG&&(e.components.ad.mobileSecond.soyTemplateName="tiger.components.ad.mobileSecond"),e.components.ad.adhesion=function(n,s,t){return""+e.components.ad.zoneSimple({type:"ADHESION",cssClass:"adhesion"},null,t)},t.DEBUG&&(e.components.ad.adhesion.soyTemplateName="tiger.components.ad.adhesion"),e.components.ad.preroll=function(){return'<div id="foreplay" class="reveal-modal js_foreplay foreplay proxima noskimlinks noskimwords" data-reveal><div id="jwPlayerVideo"></div><a href="#" class="close js_foreplay-close">You can skip this ad in 5 seconds.</a></div>'},t.DEBUG&&(e.components.ad.preroll.soyTemplateName="tiger.components.ad.preroll"),e.components.ad.promotion=function(t,i,n){var s="",o=""+(t.mobile?"PROMOTION_MOBILE":"PROMOTION");return s+=e.components.ad.zoneSimple({type:o,media:t.media,cssClass:"promotion",pp_position:t.pp_position},null,n)},t.DEBUG&&(e.components.ad.promotion.soyTemplateName="tiger.components.ad.promotion"),e.components.ad.leftrailPromotion=function(t,s,n){return""+e.components.ad.zoneSimple({type:"PROMOTION_SIDEBAR",cssClass:"promotion-sidebar",pp_position:t.pp_position},null,n)},t.DEBUG&&(e.components.ad.leftrailPromotion.soyTemplateName="tiger.components.ad.leftrailPromotion"),e.components.ad.splashyTop=function(n,s,t){return""+e.components.ad.zoneSimple({type:"SPLASHYTOP",cssClass:"splashy-top"},null,t)},t.DEBUG&&(e.components.ad.splashyTop.soyTemplateName="tiger.components.ad.splashyTop"),e.components.ad.splashyBottom=function(n,s,t){return""+e.components.ad.zoneSimple({type:"SPLASHYBOTTOM",cssClass:"splashy-bottom"},null,t)},t.DEBUG&&(e.components.ad.splashyBottom.soyTemplateName="tiger.components.ad.splashyBottom"),e.components.ad.instreamVideo=function(t,s,n){return'<div class="ad-instream ad-instream--elastic"><div class="elastic__wrapper">'+e.components.ad.zoneSimple({type:"INSTREAM_VIDEO",media:t.media,cssClass:"video",pp_position:t.pp_position},null,n)+"</div></div>"},t.DEBUG&&(e.components.ad.instreamVideo.soyTemplateName="tiger.components.ad.instreamVideo")}),define("lib/jquery.stickem",["jquery"],function(e){"use strict";var t,s=e(window),i=e(".js_global-nav-wrap"),a=i.find(".f-dropdown"),n="down",o=s.scrollTop();s.on("scroll.stickem.global",function(){var e=s.scrollTop();n="down",o>e&&(n="up"),o=e}),t=function(t,n){this.elem=t,this.$elem=e(t),this.options=n,this.metadata=this.$elem.data("stickem-options"),this.$win=e(window)},t.prototype={defaults:{item:".stickem",container:".stickem-container",stickClass:"stickit",stickPushdownClass:"pushdown",endStickClass:"stickit-end",offset:0,start:0,onStick:null,onUnstick:null},init:function(){var t=this;return t.config=e.extend({},t.defaults,t.options,t.metadata),t.setWindowHeight(),t.getItems(),t.bindEvents(),t},bindEvents:function(){var t=this;t.$win.on("scroll.stickem",e.proxy(t.handleScroll,t)),t.$win.on("resize.stickem",e.proxy(t.handleResize,t))},destroy:function(){var e=this;e.$win.off("scroll.stickem"),e.$win.off("resize.stickem")},getItem:function(i,o){var n=this,s=e(o),t={_stickemSelf:n,$elem:s,elemHeight:s.height(),$container:s.parents(n.config.container),isStuck:!1};n.windowHeight>t.elemHeight?(t.containerHeight=t.$container.outerHeight(),t.containerInner={border:{bottom:parseInt(t.$container.css("border-bottom"),10)||0,top:parseInt(t.$container.css("border-top"),10)||0},padding:{bottom:parseInt(t.$container.css("padding-bottom"),10)||0,top:parseInt(t.$container.css("padding-top"),10)||0}},t.containerStart=t.$container.offset().top-n.config.offset+n.config.start+t.containerInner.padding.top+t.containerInner.border.top,t.containerInnerHeight=t.$container.height(),t.scrollFinish=t.containerStart-n.config.start+(t.containerInnerHeight-t.elemHeight),t.containerInnerHeight>t.elemHeight&&n.items.push(t)):t.$elem.removeClass(n.config.stickClass+" "+n.config.endStickClass)},getItems:function(){var t=this;t.items=[],t.$elem.find(t.config.item).each(e.proxy(t.getItem,t))},handleResize:function(){var e=this;e.getItems(),e.setWindowHeight()},handleScroll:function(){if(t=this,t.items.length>0)for(var e,t,i,s=t.$win.scrollTop(),o=0,r=t.items.length;r>o;o++)e=t.items[o],e.isStuck&&(s<e.containerStart||s>e.scrollFinish)||s>e.scrollFinish?(e.$elem.removeClass(t.config.stickClass).removeClass(t.config.stickPushdownClass),s>e.scrollFinish&&e.$elem.addClass(t.config.endStickClass),i=e.isStuck,e.isStuck=!1,i&&t.config.onUnstick&&t.config.onUnstick(e,n)):e.isStuck===!1&&s>e.containerStart&&s<e.scrollFinish&&(a.hasClass("open")&&e.$elem.addClass(t.config.stickPushdownClass),e.$elem.removeClass(t.config.endStickClass).addClass(t.config.stickClass),e.isStuck=!0,t.config.onStick&&t.config.onStick(e,n))},setWindowHeight:function(){var e=this;e.windowHeight=e.$win.height()-e.config.offset}},t.defaults=t.prototype.defaults,e.fn.stickem=function(e){return this.destroy=function(){this.each(function(){new t(this,e).destroy()})},this.each(function(){new t(this,e).init()})}}),define("app/leftrail/leftrailContainedItem.view",["jquery","backbone.marionette","lib/amd-wrapped/modernizr","singleton/WindowController","module/ads/ads.events","templates/tiger/section/sidebar","templates/tiger/components/ad/ads","templates/tiger/section/sidebar","lib/jquery.stickem"],function(a,o,i,n,s){"use strict";var e,t=a(window);return e=o.ItemView.extend({_isStatic:!1,template:tiger.section.sidebar.containedAdContents,ui:{containedAd:".js_contained-ad-wrapper",adContainer:".js_ad-container",adShaft:".js_contained-ad-shaft",adUnit:".js_ad-unit"},tagName:"section",className:"js_contained-ad-container contained-ad-container leftrailmodule js_leftrailmodule invisible notransform",serializeData:function(){return{isEmpty:this.options.isEmpty||!1}},onRender:function(e){e&&e.hasOwnProperty("isStatic")&&(this._isStatic=e.isStatic);var s,o=this.$el.outerHeight(!0);this.listenTo(this,"dom:appended",function(){s=this.$el.offset().top-t.scrollTop(),n.isPartiallyVisible(this.$el)?this.onVisible():this.$el.offset().top+o/2>=t.scrollTop()?this.$el.waypoint({handler:function(e){"down"===e&&(this.onVisible(),this.$el.waypoint("destroy"))}.bind(this),offset:"100%"}):this.$el.waypoint({handler:function(e){"up"===e&&(this.onVisible(),this.$el.waypoint("destroy"))}.bind(this),offset:-this.$el.outerHeight()})})},onVisible:function(){var e=this.ui.adContainer,t=e.attr("id");!t||e.hasClass("initialized")?this.reveal():(this.listenTo(s,"kinjaads."+t+".displayed",function(e){this.reveal(e.zone)}),s.trigger("ads.dynamicad.load",e,"LEFT_RAIL_DYNAMIC"))},resize:function(){this.$el.addClass("short")},resizeAd:function(){this.ui.containedAd.length&&this.ui.containedAd.addClass("short")},reveal:function(t){this.ui.adContainer.length&&(this.ui.adContainer.height()<e.adHeights.LARGE&&this.resizeAd(t),i.touch||this._isStatic||this.preparePushdownSticky()),this.$el.removeClass("invisible")},preparePushdownSticky:function(){this.$el.stickem({container:this.ui.adShaft,item:".js_contained-ad-wrapper",stickClass:"waypoint--fixed js_ah-pushdown",onStick:function(e,t){e.$elem.removeClass("notransform"),"down"===t&&e.$elem.removeClass("frombottom")},endStickClass:"waypoint--unfixed",onUnstick:function(e,t){e.$elem.addClass("notransform"),n.translateElement(e.$elem),"up"===t&&e.$elem.addClass("frombottom")}.bind(this),offset:e.stickemOffset})}},{adHeights:{SMALL:250,LARGE:600},stickemOffset:20})}),define("templates/tiger/utils/relative-time",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.utils.relativeTime=function(t,s,n){return t=t||{},""+(t.time?e.messages.time.relativeTime({type:t.time.relative.type,amount:t.time.relative.amount,hmma:t.time.hmma,day:t.time.day,Mddyyhmma:t.time.Mddyyhmma},null,n):"")},t.DEBUG&&(e.utils.relativeTime.soyTemplateName="tiger.utils.relativeTime")}),define("app/leftrail/trendingReel.view",["jquery","underscore","backbone.marionette","singleton/WindowController","singleton/Utils","singleton/Renderer","singleton/Feature","templates/tiger/utils/relative-time"],function(e,r,i,d,s,c,o){"use strict";var t,n,l,a="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationEnd animationend";return n=function(){return d.isLargeUp()},t=n(),l=i.ItemView.extend({_reelIndex:0,_mouseInReel:!1,_mouseInItem:!1,ui:{progressBar:".js_trending-progress",progressSegments:".js_trending-progress__segment",reel:".js_reel",reelItem:".js_reel__item",reelFeature:".js_reel__feature"},events:{"mouseenter @ui.reelItem":"onMouseenterReelItem","mouseleave @ui.reelItem":"onMouseleaveReelItem",mouseenter:"onMouseinteract",mouseleave:"onMouseinteract"},render:function(){var a=i.getOption(this,"posts")||JSON.parse(e.attr(this.el,"data-posts")||"[]"),d=e(this.el).find(".js_reel__item"),l=e(this.el).find(".js_reel__feature"),u=o.isOn("personalized_trending_module")||o.isOn("lazy_trending_module");this.bindUIElements(),this.delegateEvents(),u&&(d.find(".img--16x9").each(function(e,n){var t=a[e].image||a[e].defaultBlogLogo||a[e].defaultBlogAvatar,o=t?s.imageUrl(t.id,"KinjaMedium",t.format):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png";n.style["background-image"]="url('"+o+"')"}),l.find(".img--16x9").each(function(e,n){var t=a[e].image||a[e].defaultBlogLogo||a[e].defaultBlogAvatar,o=t?s.imageUrl(t.id,"KinjaMedium",t.format):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png";n.style["background-image"]="url('"+o+"')"}),l.each(function(s,n){var t=a[s],o=c.renderTemplate(tiger.utils.relativeTime,{time:t.publishTime});e.attr(n,"href",t.permalink),e(n).find(".js_headline").html(t.headline),e(n).find(".js_trending-source").html("<strong>"+t.defaultBlogName+"</strong> &middot "+t.authorNameOrByline),e(n).find(".js_meta").html(e("<time>").html(o))}),e(this.el).addClass("loaded")),t&&this._startTicking(),e(window).on("resize.trendingModule",r.throttle(function(){var e=n();t&&!e?this._resetTicking():!t&&e&&this._startTicking(),t=e}.bind(this),500))},onMouseenterReelItem:function(t){this._showItem(e(t.currentTarget).index(),!0),this._mouseInItem=!0},onMouseleaveReelItem:function(){this._mouseInReel||this._showItem(this._reelIndex,!0),this._mouseInItem=!1},onMouseinteract:function(e){return this._mouseInReel="mouseenter"===e.type,this._mouseInItem||this._showItem(this._reelIndex,!0),!0},_startTicking:function(){this.ui.progressBar.addClass("ticking"),this._reelIndex=0,this._showItem(this._reelIndex)},_resetTicking:function(){this.ui.progressBar.removeClass("ticking"),this.ui.progressSegments.removeClass("ticking").off(a)},_showItem:function(e,n){var s=this.ui.reelItem.length,t=this.ui.reelItem.eq(e);t.hasClass("active")||(this.ui.reelItem.removeClass("active"),t.width(),t.addClass("active")),this.ui.reelFeature.filter(".active").removeClass("active").addClass("inactive").end().eq(e).removeClass("inactive").addClass("active"),n||this.ui.progressSegments.eq(e).addClass("ticking").one(a,function(){this._reelIndex=(this._reelIndex+1)%s,0===this._reelIndex&&this._resetTicking(),this._showItem(this._reelIndex)}.bind(this))}})}),define("app/leftrail/leftrailContainedList.view",["jquery","backbone.marionette","view/behaviors/googleAnalytics.behavior","app/leftrail/leftrailContainedItem.view","module/ads/model/ads.slotModel","app/leftrail/trendingReel.view","module/ads/ads.events","singleton/WindowController","singleton/Feature","singleton/Utils","lib/waypoints"],function(e,n,c,s,r,a,t,o,i,l){"use strict";var d,u=e(".js_main__content"),h=e(".js_page"),m=e(".js_sidebar-actual-container"),f=e(window).height(),p=e("#js_leftrailmodule--preloadedad").outerHeight(!0);return d=n.CollectionView.extend({_isNextEmpty:!1,behaviors:{GoogleAnalyticsBehavior:{behaviorClass:c}},ui:{leftrailmodules:".js_leftrailmodule",preloadedAd:"#js_leftrailmodule--preloadedad"},itemView:s,render:function(){var h,m,p,g,v,s=e('.js_ad-container[data-zone-type="LEFT_RAIL"]'),f=s.attr("id"),c=r.zoneTypes,d=e.Deferred(),u=e.Deferred(),b=l.getKinjaMeta(),j=!!b.blogSales&&b.blogSales.adsEnabled;this.isClosed=!1,this.bindUIElements(),o.isMediumDown()||s.length&&(s.hasClass("js_slot-hidden")||s.hasClass("js_slot-inactive"))?this.bindChildren(!1):s.length&&s.hasClass("js_slot-displayed")?this.bindChildren(!0):i.isOn("splashy_ad")?e.when(d,u).done(function(e){this.bindChildren(e)}.bind(this)):e.when(d).done(function(e){this.bindChildren(e)}.bind(this)),h=["kinjaads.disabled","kinjaads."+f+".hide","ads."+c.LEFT_RAIL+".inactive"].join(" "),p="kinjaads."+f+".displayed",this.listenToOnce(t,h,function(){d.resolve(!1)}).listenToOnce(t,p,function(){d.resolve(!0)}),i.isOn("ad_module")&&(j?(g=["kinjaads.disabled","kinjaads."+c.SPLASHYTOP+".hide","ads."+c.SPLASHYTOP+".inactive","kinjaads."+c.SPLASHYTOP+".displayed"].join(" "),this.listenToOnce(t,g,function(){u.resolve()}),window.kinjaads.queue.push({zoneType:c.SPLASHYTOP,onRenderEnded:u.resolve})):u.resolve()),m=this.$(".js_trending-reel"),m.length>0&&(v=new a({el:this.$(".js_trending-reel"),posts:n.getOption(this,"trendingPosts")}),v.render())},bindChildren:function(i){var e,t=this,n=this._isLongPage();t.ui.leftrailmodules.each(function(){return e=new s({el:this}),e.bindUIElements(),e.$el.hasClass("contained-ad-container")&&(n||e.resize(),!i)?void e.remove():(e.delegateEvents(),t.addChildViewEventForwarding(e),t.children.add(e),e.onRender({isStatic:!n}),void e.trigger("dom:appended"))}),n&&!o.isMediumDown()&&i&&this.bindNewAdWaypoint()},addNewModule:function(){var t=this.getItemView(),e=this._isNextEmpty?new t({isEmpty:!0}):new t;this._isNextEmpty=!this._isNextEmpty,e.render(),this.$el.append(e.$el),e.trigger("dom:appended")},bindNewAdWaypoint:function(){this.$el.waypoint({handler:function(e){"down"===e&&(this.$el.waypoint("destroy"),this.getRemainingHeight()>2*p&&(this.addNewModule(),this.bindNewAdWaypoint()))}.bind(this),offset:f-this.$el.outerHeight()+250})},getRemainingHeight:function(){return h.outerHeight(!0)-this.$el.outerHeight(!0)},_isLongPage:function(){return u.outerHeight(!0)>m.outerHeight(!0)}})}),define("view/footer.view",["jquery","underscore","backbone.marionette","view/behaviors/googleAnalytics.behavior"],function(e,t,n,s){"use strict";var o=n.ItemView.extend({behaviors:{GoogleAnalyticsBehavior:{behaviorClass:s}},onRender:function(){var n=e(window),o=n.height(),s=t.throttle(function(){n.scrollTop()+o>this.$el.offset().top&&(window.ga("send","event","Footer","scroll","complete",{nonInteraction:1}),n.off("scroll.footer"))}.bind(this),1e3);n.on("scroll.footer",s)}});return o}),define("templates/tiger/icons/essential/definitions",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.icons.essential.definitions=function(){return'<svg id="svggroup--essential" class="hide"><symbol id="iconset-search" viewBox="0 0 15 15"><path d="M9.5 8C11.433 8 13 6.433 13 4.5S11.433 1 9.5 1 6 2.567 6 4.5 7.567 8 9.5 8zm-3.233-.975c.196-.195.518-.19.708 0 .195.195.19.517 0 .708l-4.95 4.95c-.195.194-.517.19-.707 0-.195-.196-.19-.518 0-.708l4.95-4.95zM9.5 9C7.015 9 5 6.985 5 4.5S7.015 0 9.5 0 14 2.015 14 4.5 11.985 9 9.5 9z" /></symbol><symbol id="iconset-add" viewBox="0 0 18 18"><path d="M9 2.494C9 2.226 8.776 2 8.5 2c-.268 0-.5.22-.5.494V8H2.494C2.226 8 2 8.224 2 8.5c0 .268.22.5.494.5H8v5.506c0 .268.224.494.5.494.268 0 .5-.22.5-.494V9h5.506c.268 0 .494-.224.494-.5 0-.268-.22-.5-.494-.5H9V2.494z" /></symbol><symbol id="iconset-add--small" viewBox="0 0 10 10"><path d="M6 1.007C6 .45 5.552 0 5 0c-.556 0-1 .45-1 1.007V4H1.007C.45 4 0 4.448 0 5c0 .556.45 1 1.007 1H4v2.993C4 9.55 4.448 10 5 10c.556 0 1-.45 1-1.007V6h2.993C9.55 6 10 5.552 10 5c0-.556-.45-1-1.007-1H6V1.007z"></path></symbol><symbol id="iconset-site-default" viewBox="0 0 18 18"><path d="M9 16.158c3.953 0 7.158-3.205 7.158-7.158 0-3.953-3.205-7.158-7.158-7.158-3.953 0-7.158 3.205-7.158 7.158 0 3.953 3.205 7.158 7.158 7.158zM9 17c-4.418 0-8-3.582-8-8s3.582-8 8-8 8 3.582 8 8-3.582 8-8 8z"/><path d="M9 16.158c1.97 0 3.79-3.143 3.79-7.158 0-4.015-1.82-7.158-3.79-7.158S5.21 4.985 5.21 9c0 4.015 1.82 7.158 3.79 7.158zM9 17c-2.558 0-4.632-3.582-4.632-8S6.442 1 9 1s4.632 3.582 4.632 8S11.558 17 9 17z"/><path d="M2.742 4.674c1.69.883 3.947 1.383 6.345 1.383 2.396 0 4.65-.5 6.34-1.38l-.39-.746c-1.564.82-3.684 1.29-5.95 1.29-2.27 0-4.39-.47-5.955-1.28l-.39.746zm.39 9.403c1.564-.817 3.686-1.288 5.955-1.288 2.266 0 4.386.47 5.95 1.28l.39-.75c-1.69-.88-3.944-1.38-6.34-1.38-2.398 0-4.654.5-6.345 1.38l.39.744z"/><path d="M8.58 8.58H1.083v.84H8.58v7.496h.84V9.42h7.496v-.84H9.42V1.083h-.84V8.58z" /></symbol><symbol id="iconset-zoom-in" viewBox="0 0 18 18"><path d="M9 4.494C9 4.226 9.224 4 9.5 4c.268 0 .5.22.5.494V7h2.506c.268 0 .494.224.494.5 0 .268-.22.5-.494.5H10v2.506c0 .268-.224.494-.5.494-.268 0-.5-.22-.5-.494V8H6.494C6.226 8 6 7.776 6 7.5c0-.268.22-.5.494-.5H9V4.494zM9.5 13C6.462 13 4 10.538 4 7.5S6.462 2 9.5 2 15 4.462 15 7.5 12.538 13 9.5 13zm-4.877-1.36l-3.48 3.51c-.194.194-.188.514 0 .703.196.195.51.196.704.002l3.48-3.51c-.304-.275-.416-.34-.704-.706zM9.5 14c3.59 0 6.5-2.91 6.5-6.5S13.09 1 9.5 1 3 3.91 3 7.5 5.91 14 9.5 14z" /></symbol><symbol id="iconset-star" viewBox="0 0 18 18"><path d="M9.005 13.115L4.083 16.88l1.895-6.07-4.943-3.563 6.094.014L9 1.01l1.866 6.25 6.093-.01-4.93 3.563 1.89 6.07z" /></symbol><symbol id="iconset-star--giant" viewBox="0 0 24 24"><path d="M12 17.8l-7.053 4.908 2.488-8.225-6.848-5.19 8.592-.176L12 1l2.82 8.117 8.593.175-6.848 5.19 2.488 8.226z" /></symbol><symbol id="iconset-star-circle" viewBox="0 0 18 18"><path d="M9 17c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zM9 3.7c.093 0 .185.06.208.158l1.146 3.39 3.413.085c.104 0 .185.073.22.17.034.097 0 .207-.08.267l-2.72 2.175.972 3.44c.03.096 0 .206-.09.266-.05.04-.097.05-.14.05-.05 0-.09-.02-.13-.05L9 11.61l-2.81 2.04c-.036.038-.082.05-.13.05-.045 0-.09-.012-.138-.05-.07-.06-.104-.17-.08-.266l.97-3.44L4.095 7.77c-.08-.06-.115-.17-.08-.267.034-.097.127-.17.22-.17l3.412-.085 1.134-3.39c.04-.098.13-.158.22-.158z" /></symbol><symbol id="iconset-chevron-right" viewBox="0 0 18 18"><path d="M6.165 3.874c-.217-.204-.22-.53-.008-.73.206-.192.56-.195.776.008l5.902 5.48c.11.102.165.236.165.37-.002.126-.055.262-.165.365l-5.902 5.478c-.217.204-.564.207-.776.007-.206-.193-.21-.525.008-.728L11.69 9 6.165 3.873z" /></symbol><symbol id="iconset-chevron-right--small" viewBox="0 0 10 10"><path d="M7.782 4.497L3.272.207c-.287-.274-.763-.278-1.054 0-.292.277-.29.724.002 1L6.205 5 2.22 8.79c-.288.273-.292.726-.002 1.002.293.28.763.276 1.054 0l4.51-4.29C7.926 5.363 8 5.18 8 5c.002-.183-.072-.364-.218-.503z" /></symbol><symbol id="iconset-flame" viewBox="0 0 18 18"><path d="M3.923 10.89c0 2.678 2.447 5.17 5.077 5.17s5.077-2.492 5.077-5.17c0-1.752-.618-3.036-1.977-4.664-1.196-1.433-1.154-3.453-1.093-3.453-.356-.04-2.164 2.918-2.49 5.764-.507 1.5-2.29 1.018-2.543-.126-.245-.62-.296-1.97-.296-2.47 0-.5-1.755 2.72-1.755 4.95zm2.962-2.617c.25.344.63.345.72.077.185-2.933 2.015-5.63 2.643-6.247.78-.766 1.7-1.444 1.984-.915.072.135-.047.438-.167.826-.267.863-.412 2.224.738 3.602C13.883 6.912 15 8.516 15 10.89c0 3.2-2.86 6.11-6 6.11s-6-2.912-6-6.11c0-2.018 1.45-5.456 2.972-6.798l.198-.17c.233-.197.806-.146.715.164-.837 2.85 0 4.187 0 4.187z" /></symbol><symbol id="iconset-flame--giant" viewBox="0 0 24 24"><path d="M9.004 10.954c.353.496.89.497 1.02.112.262-4.217 2.854-8.093 3.743-8.98C14.872.984 16.177.01 16.577.77c.103.194-.065.63-.235 1.187-.378 1.242-.583 3.198 1.046 5.18 1.532 1.86 3.112 4.166 3.112 7.58 0 4.597-4.052 8.783-8.5 8.783s-8.5-4.186-8.5-8.782c0-3.652 2.056-7.844 4.21-9.773l.28-.243c.33-.285 1.143-.212 1.014.234-1.186 4.096 0 6.018 0 6.018z" /></symbol><symbol id="iconset-logo-kinja" viewBox="0 0 18 18"><path d="M2.898 8.293c.746.24 1.423.978 1.734 1.495.31.517 2.246 3.78 2.905 4.916.726 1.253 1.743 1.294 2.308 1.294h4.125s-3.023-5.378-3.943-6.846c-.622-.994-1.452-1.11-2.374-1.11H2.1C2.093 8.042 3 7.065 5 7c2-.065 5.284.006 6.64 0 1.354-.006 2.046-.727 2.33-1.195.284-.468 2.03-3.8 2.03-3.8S8.793 1.995 6.992 2c-1.21.006-1.734.647-2.197 1.41l-2.792 4.6c-.01.017.007.07.017.098 0 0 .35.018.878.186z" /><</symbol><symbol id="iconset-bubble" viewBox="0 0 18 18"><path d="M6.292 13.952l.34-.503.577.1c.43.07.86.11 1.29.11 3.65 0 6.56-2.65 6.56-5.84 0-3.186-2.91-5.836-6.57-5.836-3.657 0-6.566 2.65-6.566 5.836 0 1.918 1.054 3.7 2.83 4.84l.437.256c0 .18-.375 2.06-.57 2.54-.054.132 1.12-.71 1.66-1.51zm-2.01-.426C2.3 12.254 1 10.182 1 7.832 1 4.06 4.358 1 8.5 1 12.642 1 16 4.06 16 7.832c0 3.774-3.36 6.833-7.5 6.833-.495 0-.978-.047-1.447-.13-.32.473-2.45 2.172-3.165 2.4-.714.226-.823-.164-.51-.713.313-.548.903-1.95.903-2.696z" /></symbol><symbol id="iconset-bubble--giant" viewBox="0 0 24 24"><path d="M6.094 18.506C3.324 16.678 1.5 13.7 1.5 10.32 1.5 4.9 6.2.5 12 .5s10.5 4.398 10.5 9.82c0 5.425-4.702 9.823-10.5 9.823-.694 0-1.37-.067-2.025-.187-.45.68-3.432 3.123-4.432 3.45-1 .326-1.15-.235-.713-1.024.438-.788 1.264-2.802 1.264-3.876z" /></symbol><symbol id="iconset-checkmark" viewBox="0 0 18 18"><path d="M14.855 5.87c.192-.195.195-.523 0-.722-.19-.194-.51-.2-.706 0l-7.418 7.62-2.88-2.978c-.19-.195-.515-.2-.71-.002-.19.194-.194.525.003.726L6.38 13.85c.095.1.224.15.353.15.128 0 .257-.047.355-.147l7.767-7.982z" /></symbol><symbol id="iconset-checkmark--small" viewBox="0 0 10 10"><path d="M.292 5.078c-.39.4-.388 1.044-.002 1.442l2.038 2.15c.313.344 1.125.526 1.703 0L9.71 2.746c.39-.402.388-1.046 0-1.445-.39-.402-1.014-.4-1.4 0l-5.11 5.39L1.69 5.075C1.31 4.683.68 4.68.293 5.078z"></path></symbol><symbol id="iconset-close" viewBox="0 0 18 18"><path d="M1.737 1.12c-.16-.158-.44-.164-.61.006-.165.165-.172.443-.005.61L7.885 8.5l-6.763 6.764c-.167.167-.16.445.005.61.17.17.45.164.61.005L8.5 9.11l6.763 6.764c.16.158.44.164.61-.006.165-.164.172-.442.005-.61L9.115 8.5l6.763-6.764c.167-.167.16-.445-.005-.61-.17-.17-.45-.164-.61-.005L8.5 7.89 1.737 1.12z" /></symbol><symbol id="iconset-close--small" viewBox="0 0 10 10"><path d="M2.884 1.47c-.394-.394-1.03-.395-1.42-.005-.392.393-.387 1.026.006 1.42L3.586 5 1.47 7.116c-.394.394-.395 1.03-.005 1.42.393.392 1.026.387 1.42-.006L5 6.414 7.116 8.53c.394.394 1.03.395 1.42.005.392-.393.387-1.026-.006-1.42L6.414 5 8.53 2.884c.394-.394.395-1.03.005-1.42-.393-.392-1.026-.387-1.42.006L5 3.586 2.884 1.47z" /></symbol><symbol id="iconset-facebook" viewBox="0 0 18 18"><path d="M7.003 17l-.006-7H4l.006-3h2.997V4.995C7.003 2.408 8.457 1 10.808 1c1.126 0 1.91.082 2.192.12v2.877h-1.447c-1.278 0-1.526.597-1.526 1.472V7h2.866l-.403 3h-2.47l.007 7H7.003z" /></symbol><symbol id="iconset-twitter" viewBox="0 0 18 18"><path d="M12.077 2c-1.812 0-3.282 1.582-3.282 3.534 0 .277.03.547.085.806-2.728-.148-5.147-1.555-6.766-3.693-.283.522-.445 1.13-.445 1.777 0 1.226.58 2.308 1.46 2.942-.54-.02-1.05-.178-1.49-.443v.045c0 1.712 1.13 3.14 2.63 3.465-.28.08-.57.124-.87.124-.21 0-.418-.022-.62-.063.418 1.404 1.63 2.426 3.067 2.455-1.125.94-2.54 1.51-4.078 1.51-.267 0-.528-.02-.785-.05 1.46 1 3.185 1.59 5.04 1.59 6.037 0 9.34-5.39 9.34-10.06 0-.153-.005-.306-.01-.457.64-.5 1.197-1.12 1.637-1.83-.59.28-1.22.47-1.885.557.677-.437 1.198-1.13 1.443-1.955-.633.405-1.336.7-2.084.858C13.88 2.43 13.028 2 12.08 2" /></symbol><symbol id="iconset-googleplus" viewBox="0 0 18 18"><path d="M13.657 13.42c0 .914-.4 1.74-1.202 2.475-.4.354-.916.62-1.545.796-.573.208-1.245.31-2.017.31-1.402 0-2.575-.264-3.52-.795C4.457 15.645 4 14.938 4 14.085c0-.62.2-1.18.6-1.68.43-.59 1.002-1.033 1.718-1.327.658-.324 1.46-.487 2.403-.487.03 0 .798-.15.827-.15-.458-.382-.653-.57-.653-1.04 0-.355.043-.665.214-.93h-.472c-1.058 0-1.903-.574-2.618-1.28-.686-.708-1.03-1.56-1.03-2.565 0-.972.43-1.812 1.288-2.52C7.106 1.37 8.09 1 9.236 1H14l-1.073.796h-1.502c.486.236.872.604 1.16 1.105.284.59.428 1.166.428 1.725 0 1.032-.472 1.9-1.416 2.608-.373.295-.63.546-.773.752-.115.147-.172.383-.172.707 0 .325.444.84 1.33 1.548.573.413 1.002.87 1.288 1.37.258.472.387 1.076.387 1.812zM11.31 4.483c-.145-.705-.46-1.29-.95-1.75-.487-.488-1.06-.73-1.72-.73-.604-.025-1.077.18-1.422.62-.373.46-.517 1.057-.43 1.787.143.73.473 1.337.99 1.824.517.51 1.076.766 1.68.766.66 0 1.162-.243 1.506-.73.373-.486.488-1.082.345-1.787zm.153 10.713c.55-.38.826-.862.826-1.445 0-1.7-2.757-2.05-3.06-2.05-.88 0-1.667.19-2.356.573-.69.403-1.033.873-1.033 1.41 0 .54.304 1.01.91 1.413.58.403 1.295.605 2.15.605 1.13 0 1.983-.167 2.56-.503z" fill-rule="evenodd"/></symbol><symbol id="iconset-external-link" viewBox="0 0 18 18"><path d="M3.006 17C1.898 17 1 16.103 1 14.994V5.006C1 3.898 1.897 3 3.006 3H5.5c.276 0 .5.224.5.5s-.224.5-.5.5H3.006C2.45 4 2 4.45 2 5.006v9.988C2 15.55 2.45 16 3.006 16h9.988C13.55 16 14 15.55 14 14.994V11.5c0-.276.224-.5.5-.5s.5.224.5.5v3.494C15 16.102 14.103 17 12.994 17H3.006zM10 1.5c0-.276.228-.5.51-.5h5.98c.51 0 .51.5.51.51v5.98c0 .282-.232.51-.5.51-.276 0-.5-.228-.5-.51V2.75l-8.095 8.1c-.206.204-.548.197-.75-.004-.207-.207-.205-.545-.002-.748L15.247 2H10.51c-.282 0-.51-.232-.51-.5z" /></symbol><symbol id="iconset-link" viewBox="0 0 18 18"><path d="M8.72 13.36l-2.044 2.017c-.954.952-2.418.797-3.05.083L2.53 14.18c-.942-.93-.59-2.446 0-3.072.96-1.017 3.698-3.656 3.698-3.656.952-.975 2.245-1.038 3.27 0 1.023 1.038.97.997.97.997.262.26.64.21.835 0 .195-.22.16-.58-.102-.85l-.94-.93c-1.31-1.35-3.322-1.3-4.61 0l-3.68 3.75c-1.28 1.26-1.28 3.38 0 4.68l.92.93c.627.63 1.45.96 2.337.96.887 0 1.71-.335 2.334-.966L9.4 14.17c.263-.266.263-.555 0-.82-.263-.266-.673 0-.673 0zm.56-8.72l2.044-2.017c.954-.952 2.418-.797 3.05-.083l1.095 1.28c.94.93.59 2.446 0 3.072-.96 1.017-3.7 3.656-3.7 3.656-.95.975-2.25 1.038-3.27 0s-.97-.997-.97-.997c-.26-.26-.64-.21-.84 0-.2.22-.16.58.1.85l.944.93c1.31 1.35 3.327 1.3 4.61 0l3.68-3.75c1.284-1.26 1.284-3.38 0-4.68l-.92-.93c-.62-.63-1.443-.96-2.33-.96-.888 0-1.71.334-2.335.965L8.6 3.825c-.262.266-.262.555 0 .82.264.266.674 0 .674 0z" /></symbol><symbol id="iconset-image" viewBox="0 0 18 18"><path d="M1 2.994v12.012c0 .548.446.994.995.994h14.01c.55 0 .995-.445.995-.994V2.994c0-.548-.446-.994-.995-.994H1.995C1.445 2 1 2.445 1 2.994zm-1 0C0 1.894.893 1 1.995 1h14.01C17.107 1 18 1.895 18 2.994v12.012c0 1.1-.893 1.994-1.995 1.994H1.995C.893 17 0 16.105 0 15.006V2.994z"/><path d="M1.38 15.804L5.807 8.24l-.86.007 3.682 6.068c.17.288.573.324.8.073l2.5-2.82-.74.01 4.514 4.832c.188.202.504.213.706.024.203-.19.213-.505.025-.707l-4.515-4.83c-.2-.216-.543-.212-.74.008l-2.5 2.82.8.07L5.8 7.728c-.197-.324-.67-.32-.86.007L.51 15.298c-.137.24-.057.545.18.684.24.14.546.06.685-.178zM12 9c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm0 1c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/></symbol><symbol id="iconset-burner" viewBox="0 0 18 18"><path d="M14.24 10.837c-.39.175-.853.28-1.387.28-.27 0-.593-.044-.955-.126-.344-.07-.713-.19-1.093-.32-.284-.1-1.218-.51-1.31-.54-.158-.06-.32-.093-.488-.093-.175 0-.336.038-.493.096-.092.035-1.035.444-1.32.545-.38.136-.748.247-1.093.326-.36.083-.68.127-.95.127-.53 0-.99-.103-1.39-.28-.22-.1-.55-.353-.65-.46-.17-.18-.34-.39-.502-.634-.38-.57-.635-1.22-.712-1.934l-.006.14c.268-1.33 1.078-2.07 2.03-2.07 1.53 0 2.884.31 4.662 1.284 0 0 .266.147.41.147.146 0 .43-.143.43-.143 1.78-.974 3.137-1.282 4.666-1.282.95 0 1.762.74 2.038 2.057l-.002-.14c-.076.72-.33 1.364-.71 1.94-.162.24-.335.453-.507.633-.1.105-.43.36-.657.46zm1.907-.61c.453-.684.76-1.463.853-2.33l-.007-.137C16.635 6.053 15.48 5 14.083 5c-1.672 0-3.175.34-5.093 1.393C7.092 5.34 5.59 5 3.916 5c-1.397 0-2.55 1.053-2.91 2.76L1 7.897c.093.867.4 1.646.853 2.33.33.498.664.846.9 1.036.114.1.332.24.64.38.503.223 1.09.357 1.754.357.346 0 .732-.052 1.154-.15.39-.086.79-.207 1.2-.354.31-.108.6-.223.87-.34.16-.068.6-.248.647-.248.045 0 .474.18.636.25.27.115.56.23.865.338.41.147.813.268 1.195.355.42.1.805.15 1.15.15.666 0 1.25-.13 1.755-.35.31-.14.528-.28.65-.39.228-.18.56-.53.89-1.03zm-9.99-2.604c-.155-.077-.316-.133-.483-.17-.53-.118-1.078-.037-1.605.164-.22.08-.38.164-.48.223l-.24.146.03.28c.07.623.45 1.266 1.22 1.502.34.11.77.117 1.27.05.3-.044.63-.115.95-.206.19-.053.373-.11.54-.167.1-.034.174-.062.22-.078l.735-.285-.628-.477c-.07-.052-.2-.145-.394-.273-.315-.21-.69-.444-1.13-.696l-.02-.013zm.243 1.19s-.447.1-.654.13c-.374.05-.68.046-.878-.017-.367-.114-.48-.485-.48-.485s.76-.2 1.093-.12c.1.02.92.5.92.5zm5.42-1.177c-.437.252-.813.485-1.128.696-.192.128-.322.22-.39.273l-.63.477.74.285c.042.016.117.044.218.078.167.057.35.114.542.167.33.09.652.162.96.205.493.068.92.06 1.27-.05.762-.235 1.146-.88 1.214-1.502l.03-.28-.24-.145c-.1-.06-.263-.142-.475-.223-.52-.2-1.07-.282-1.6-.164-.16.037-.32.093-.48.17l-.02.013zm.7.68c.333-.075 1.09.125 1.09.125s-.11.38-.475.49c-.202.07-.507.07-.88.02-.265-.032-.64-.15-.64-.15s.808-.45.904-.472z" /></symbol><symbol id="spinner" viewBox="0 0 37 12" stroke="#aaa" fill="none"><circle cx="6" cy="6" r="4"><animate attributeName="r" begin="0s" dur="0.65s" values="0;4" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/><animate attributeName="stroke-opacity" begin="0s" dur="0.65s" values="0;1" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="6" cy="6" r="4"><animate attributeName="cx" begin="0s" dur="0.65s" values="6;19" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="19" cy="6" r="4"><animate attributeName="cx" begin="0s" dur="0.65s" values="19;32" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="32" cy="6" r="4"><animate attributeName="r" begin="0s" dur="0.65s" values="4;0" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/><animate attributeName="stroke-opacity" begin="0s" dur="0.65s" values="1;0" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle></symbol><symbol id="iconset-tools--giant" viewBox="0 0 24 24"><path d="M12 5.5c1.38 0 2.5-1.12 2.5-2.5S13.38.5 12 .5 9.5 1.62 9.5 3s1.12 2.5 2.5 2.5zm0 18c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5-2.5 1.12-2.5 2.5 1.12 2.5 2.5 2.5zm0-9c1.38 0 2.5-1.12 2.5-2.5S13.38 9.5 12 9.5 9.5 10.62 9.5 12s1.12 2.5 2.5 2.5z" /></symbol></svg>'},t.DEBUG&&(e.icons.essential.definitions.soyTemplateName="tiger.icons.essential.definitions")}),define("templates/tiger/icons/essential/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.icons.essential.search=function(){return'<svg class="svg-icon svg-search"><use xlink:href="#iconset-search" /></svg>'},t.DEBUG&&(e.icons.essential.search.soyTemplateName="tiger.icons.essential.search"),e.icons.essential.add=function(){return'<svg class="svg-icon svg-add"><use xlink:href="#iconset-add" /></svg>'},t.DEBUG&&(e.icons.essential.add.soyTemplateName="tiger.icons.essential.add"),e.icons.essential.adDMSall=function(){return'<svg class="svg-icon small svg-add--small"><use xlink:href="#iconset-add--small" /></svg>'},t.DEBUG&&(e.icons.essential.adDMSall.soyTemplateName="tiger.icons.essential.adDMSall"),e.icons.essential.siteDefault=function(){return'<svg class="svg-icon svg-site-default"><use xlink:href="#iconset-site-default" /></svg>'},t.DEBUG&&(e.icons.essential.siteDefault.soyTemplateName="tiger.icons.essential.siteDefault"),e.icons.essential.zoomIn=function(){return'<svg class="svg-icon svg-zoom-in"><use xlink:href="#iconset-zoom-in" /></svg>'},t.DEBUG&&(e.icons.essential.zoomIn.soyTemplateName="tiger.icons.essential.zoomIn"),e.icons.essential.star=function(){return'<svg class="svg-icon svg-star"><use xlink:href="#iconset-star" /></svg>'},t.DEBUG&&(e.icons.essential.star.soyTemplateName="tiger.icons.essential.star"),e.icons.essential.starGiant=function(){return'<svg class="svg-icon giant stroked svg-star--giant"><use xlink:href="#iconset-star--giant" /></svg>'},t.DEBUG&&(e.icons.essential.starGiant.soyTemplateName="tiger.icons.essential.starGiant"),e.icons.essential.starCircle=function(){return'<svg class="svg-icon svg-star-circle"><use xlink:href="#iconset-star-circle" /></svg>'},t.DEBUG&&(e.icons.essential.starCircle.soyTemplateName="tiger.icons.essential.starCircle"),e.icons.essential.chevronRight=function(){return'<svg class="svg-icon svg-chevron chevron--right"><use xlink:href="#iconset-chevron-right" /></svg>'},t.DEBUG&&(e.icons.essential.chevronRight.soyTemplateName="tiger.icons.essential.chevronRight"),e.icons.essential.chevronRightSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--right"><use xlink:href="#iconset-chevron-right--small" /></svg>'},t.DEBUG&&(e.icons.essential.chevronRightSmall.soyTemplateName="tiger.icons.essential.chevronRightSmall"),e.icons.essential.chevronBottom=function(){return'<svg class="svg-icon svg-chevron chevron--bottom"><use xlink:href="#iconset-chevron-right" /></svg>'},t.DEBUG&&(e.icons.essential.chevronBottom.soyTemplateName="tiger.icons.essential.chevronBottom"),e.icons.essential.chevronBottomSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--bottom"><use xlink:href="#iconset-chevron-right--small" /></svg>'},t.DEBUG&&(e.icons.essential.chevronBottomSmall.soyTemplateName="tiger.icons.essential.chevronBottomSmall"),e.icons.essential.chevronLeft=function(){return'<svg class="svg-icon svg-chevron chevron--left"><use xlink:href="#iconset-chevron-right" /></svg>'},t.DEBUG&&(e.icons.essential.chevronLeft.soyTemplateName="tiger.icons.essential.chevronLeft"),e.icons.essential.chevronLeftSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--left"><use xlink:href="#iconset-chevron-right--small" /></svg>'},t.DEBUG&&(e.icons.essential.chevronLeftSmall.soyTemplateName="tiger.icons.essential.chevronLeftSmall"),e.icons.essential.chevronTop=function(){return'<svg class="svg-icon svg-chevron chevron--top"><use xlink:href="#iconset-chevron-right" /></svg>'},t.DEBUG&&(e.icons.essential.chevronTop.soyTemplateName="tiger.icons.essential.chevronTop"),e.icons.essential.chevronTopSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--top"><use xlink:href="#iconset-chevron-right--small" /></svg>'},t.DEBUG&&(e.icons.essential.chevronTopSmall.soyTemplateName="tiger.icons.essential.chevronTopSmall"),e.icons.essential.flame=function(){return'<svg class="svg-icon svg-flame"><use xlink:href="#iconset-flame" /></svg>'},t.DEBUG&&(e.icons.essential.flame.soyTemplateName="tiger.icons.essential.flame"),e.icons.essential.flameGiant=function(){return'<svg class="svg-icon giant stroked svg-flame--giant"><use xlink:href="#iconset-flame--giant" /></svg>'},t.DEBUG&&(e.icons.essential.flameGiant.soyTemplateName="tiger.icons.essential.flameGiant"),e.icons.essential.kinja=function(){return'<svg class="svg-icon svg-logo-kinja"><use xlink:href="#iconset-logo-kinja" /></svg>'},t.DEBUG&&(e.icons.essential.kinja.soyTemplateName="tiger.icons.essential.kinja"),e.icons.essential.bubble=function(){return'<svg class="svg-icon svg-bubble"><use xlink:href="#iconset-bubble" /></svg>'},t.DEBUG&&(e.icons.essential.bubble.soyTemplateName="tiger.icons.essential.bubble"),e.icons.essential.bubbleGiant=function(){return'<svg class="svg-icon giant stroked svg-bubble--giant"><use xlink:href="#iconset-bubble--giant" /></svg>'},t.DEBUG&&(e.icons.essential.bubbleGiant.soyTemplateName="tiger.icons.essential.bubbleGiant"),e.icons.essential.checkmark=function(){return'<svg class="svg-icon svg-checkmark"><use xlink:href="#iconset-checkmark" /></svg>'},t.DEBUG&&(e.icons.essential.checkmark.soyTemplateName="tiger.icons.essential.checkmark"),e.icons.essential.checkmarkSmall=function(){return'<svg class="svg-icon small svg-checkmark--small"><use xlink:href="#iconset-checkmark--small" /></svg>'},t.DEBUG&&(e.icons.essential.checkmarkSmall.soyTemplateName="tiger.icons.essential.checkmarkSmall"),e.icons.essential.close=function(){return'<svg class="svg-icon svg-close"><use xlink:href="#iconset-close" /></svg>'},t.DEBUG&&(e.icons.essential.close.soyTemplateName="tiger.icons.essential.close"),e.icons.essential.closeSmall=function(){return'<svg class="svg-icon small svg-close--small"><use xlink:href="#iconset-close--small" /></svg>'},t.DEBUG&&(e.icons.essential.closeSmall.soyTemplateName="tiger.icons.essential.closeSmall"),e.icons.essential.facebook=function(){return'<svg class="svg-icon svg-facebook"><use xlink:href="#iconset-facebook" /></svg>'},t.DEBUG&&(e.icons.essential.facebook.soyTemplateName="tiger.icons.essential.facebook"),e.icons.essential.twitter=function(){return'<svg class="svg-icon svg-twitter"><use xlink:href="#iconset-twitter" /></svg>'},t.DEBUG&&(e.icons.essential.twitter.soyTemplateName="tiger.icons.essential.twitter"),e.icons.essential.googleplus=function(){return'<svg class="svg-icon svg-googleplus"><use xlink:href="#iconset-googleplus" /></svg>'},t.DEBUG&&(e.icons.essential.googleplus.soyTemplateName="tiger.icons.essential.googleplus"),e.icons.essential.externalLink=function(){return'<svg class="svg-icon svg-external-link"><use xlink:href="#iconset-external-link" /></svg>'},t.DEBUG&&(e.icons.essential.externalLink.soyTemplateName="tiger.icons.essential.externalLink"),e.icons.essential.burner=function(){return'<svg class="svg-icon svg-burner"><use xlink:href="#iconset-burner" /></svg>'},t.DEBUG&&(e.icons.essential.burner.soyTemplateName="tiger.icons.essential.burner"),e.icons.essential.link=function(){return'<svg class="svg-icon svg-link"><use xlink:href="#iconset-link" /></svg>'},t.DEBUG&&(e.icons.essential.link.soyTemplateName="tiger.icons.essential.link"),e.icons.essential.image=function(){return'<svg class="svg-icon svg-image"><use xlink:href="#iconset-image" /></svg>'},t.DEBUG&&(e.icons.essential.image.soyTemplateName="tiger.icons.essential.image"),e.icons.essential.spinner=function(){return'<svg class="svg-icon svg-image"><use xlink:href="#spinner" /></svg>'},t.DEBUG&&(e.icons.essential.spinner.soyTemplateName="tiger.icons.essential.spinner"),e.icons.essential.toolsGiant=function(){return'<svg class="svg-icon giant stroked svg-tools--giant"><use xlink:href="#iconset-tools--giant" /></svg>'},t.DEBUG&&(e.icons.essential.toolsGiant.soyTemplateName="tiger.icons.essential.toolsGiant"),e.icons.essential.facebook__C17=function(){return'<svg class="svg-icon svg-facebook"><use xlink:href="#iconset-facebook" /></svg>'},t.DEBUG&&(e.icons.essential.facebook__C17.soyTemplateName="tiger.icons.essential.facebook__C17"),e.icons.essential.twitter__C17=function(){return'<svg class="svg-icon svg-twitter"><use xlink:href="#iconset-twitter" /></svg>'},t.DEBUG&&(e.icons.essential.twitter__C17.soyTemplateName="tiger.icons.essential.twitter__C17"),e.icons.essential.googleplus__C17=function(){return'<svg class="svg-icon svg-googleplus"><use xlink:href="#iconset-googleplus" /></svg>'},t.DEBUG&&(e.icons.essential.googleplus__C17.soyTemplateName="tiger.icons.essential.googleplus__C17"),e.icons.essential.chevronBottomSmall__C17=function(){return'<svg class="svg-icon small svg-chevron--small chevron--bottom"><use xlink:href="#iconset-chevron-right--small" /></svg>'},t.DEBUG&&(e.icons.essential.chevronBottomSmall__C17.soyTemplateName="tiger.icons.essential.chevronBottomSmall__C17"),e.icons.essential.closeSmall__C17=function(){return'<svg class="svg-icon small svg-close--small"><use xlink:href="#iconset-close--small" /></svg>'},t.DEBUG&&(e.icons.essential.closeSmall__C17.soyTemplateName="tiger.icons.essential.closeSmall__C17")}),define("module/EssentialIconModule",["jquery","templates/tiger/icons/essential/definitions","templates/tiger/icons/essential/usage"],function(e){"use strict";var t=e("#svggroup--essential");t&&t.length||e("#js_svg-definitions").append(e.trim(tiger.icons.essential.definitions()))}),define("model/Feature",["underscore","backbone","apiclient/feature"],function(t,n,e){"use strict";var s=n.Model.extend({defaults:{sticky:!0,regions:[]},sync:function(o,t,s){var n={};switch(o){case"create":return n=t.set({enabled:!0}).toJSON(),e.createFeature(n,s);case"update":if(t.changedAttributes())return n=t.changedAttributes(),n.modelId=t.id,e.updateFeature(n,s);window.alert("No feature settings were changed.");break;case"read":case"delete":case"enable":case"disable":return e[o+"Feature"]({modelId:t.id},s);case"segment":return e.getSegmentFeature()}},parse:function(e){var t;return t=e.meta&&e.meta.success===!0?e.data:e},validate:function(o){var e=t.extend(t.clone(this.attributes),o||{}),n=e.defaultValue||"",s=e.values||"";if(!e.name)return"Name not specified";if(!e.id||this.attributes.name!==e.name){if(!e.name.match(/^[a-z]/))return"Name must start with a lowecase letter";if(!e.name.match(/^[a-z0-9_]+$/))return"Name can only use the following: a-z 0-9 _"}return!s||s.length<2?"No values":e.abTesting!==!1||"%"===n.substr(n.length-1)||n&&-1!==s.indexOf(n)?void 0:"Invalid default value"},toggle:function(){var e=this,t=e.get("enabled")?"disable":"enable";e.sync(t,e,{success:function(t){return!!e.set({enabled:!e.get("enabled")})&&void e.trigger("sync",e,t)}})}});return s}),define("collection/Feature",["backbone","model/Feature","singleton/CurrentBlog","apiclient/feature"],function(s,o,e,t){"use strict";var n=s.Collection.extend({model:o,sync:function(o,i,n){var s={};return e.canonicalHost&&(s.blog=e.canonicalHost),n.withAuthor&&(s.withAuthor=!0),n.compact&&(s.compact=!0),"read"===o?this.blogId?t.getBlogFeatures({blogId:this.blogId},n):t.getAjaxFeatures(s,n):void 0},blacklist:{476822046:"off"},getBetaFeatures:function(){return new n(this.filter(function(e){return"BETA"===e.get("type")}))},parse:function(e){return e.data},getDirtyModels:function(){var t=this.models.filter(function(e){return e.get("isDirty")}),e=this.blacklist;return t.map(function(t){var n=parseInt(t.get("id"),10);return e.hasOwnProperty(n)&&t.set("value",e[n]),t.get("id")+"="+t.get("value")}).join("&")}});return n}),define("singleton/FeatureThrottling",["jquery","backbone","underscore","lib/amd-wrapped/modernizr","singleton/Feature","singleton/CurrentUser","singleton/Utils","model/Feature","collection/Feature","apiclient/feature","gawkerlib/jquery.parseParams"],function(e,h,n,u,t,a,d,c,o,l){"use strict";var r="_",i="kinja_feature_segment",s="kinja_feature_measurement_2507",m=h.Model.extend({initialize:function(){t.isOn("throttle")&&(a.onLoggedIn.done(function(){e.removeCookie(i,{path:"/"}),this.checkFeatures()}.bind(this)),this.checkFeatures(),"off"!==t.value("throttle_measuring")&&this.measureThrottledFeature(t.value("throttle_measuring")))},checkFeatures:function(){var o=n.map(n.filter(e("body")[0].className.split(" "),function(e){return 0===e.indexOf("mf_")}),function(e){return e.substr(3)});e.when(this.getFeatureSegment(),this.getFeatures()).done(function(r,c){var i=this.lookupFeaturesToChange(r,c,o),a=n.map(n.extend({},i.reloading,i.silent),function(e,t){return t+"="+e});a.length>0&&(e.removeCookie(s,{path:"/"}),t.isOn("throttle_instant")?(t.syncCookies(a.join("&")),n.keys(i.reloading).length>0&&document.location.reload()):e(window).on("beforeunload",function(){t.syncCookies(a.join("&"),!0)}))}.bind(this))},measureThrottledFeature:function(n){var o=t.value(n),i=n+"="+o;e.cookie(s)||void 0===o||(l.sendPerHourFeatureTick({featureName:n,featureValue:o}),e.cookie(s,i,{path:"/",expires:1/24}))},getFeatureSegment:function(){var n=e.cookie(i),t=e.Deferred();return n?t.resolve(parseInt(n,10)):a.onAuth.done(function(){var e=new c;e.sync("segment",e,{success:function(e){e.meta&&e.meta.success&&e.meta.success===!0&&t.resolve(e.data)}})}),t},getFeatures:function(){var t,s=e.Deferred(),n=new o,a="kinja_feature_collection",i=!0,r=parseInt(d.getKinjaMeta().featuresLastUpdate,10),c=u.localstorage;return n.on("sync",function(){s.resolve(n),c&&(t={featuresLastUpdate:r,features:n.invoke("pick",["name","abTesting","possibleValues","source","defaultValue","blogValue"])},window.localStorage.setItem(a,JSON.stringify(t)))}),c&&(t=JSON.parse(window.localStorage.getItem(a)),t&&parseInt(t.featuresLastUpdate,10)===r&&(s.resolve(new o(t.features)),i=!1)),i=!0,i===!0&&n.fetch({compact:!0,disableToken:!0}),s},lookupFeaturesToChange:function(o,i,s){var a=o/100,e={reloading:{},silent:{}};return s=s||[],i.each(function(o){var i,c=0;n.contains(s,o.get("name"))||(o.get("abTesting")===!0?(i=n.last(n.filter(o.get("possibleValues"),function(e){var t=a>c;return c+=e.percentage,t})),t.value(o.get("name"))!==i.name&&(e.reloading[o.get("name")]=i.name)):"user"===o.get("source")&&(t.value(o.get("name"))!==o.get("defaultValue")&&t.value(o.get("name"))!==o.get("blogValue")?e.reloading[o.get("name")]=r:e.silent[o.get("name")]=r))}),e}});return new m}),define("lib/amd-wrapped/jquery.scrollTo",["jquery"],function(e){function n(e){return"object"==typeof e?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,s){e(window).scrollTo(t,n,s)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var n,t=this,s=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);return s?(n=(t.contentWindow||t).document||t.ownerDocument||t,/webkit/i.test(navigator.userAgent)||"BackCompat"==n.compatMode?n.body:n.documentElement):t})},e.fn.scrollTo=function(i,o,s){return"object"==typeof o&&(s=o,o=0),"function"==typeof s&&(s={onAfter:s}),"max"==i&&(i=9e9),s=e.extend({},t.defaults,s),o=o||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(o/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function u(e){d.animate(r,o,s.easing,e&&function(){e.call(this,i,s)})}if(null!=i){var c,l=this,d=e(l),a=i,r={},h=d.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}if(a=e(a,this),!a.length)return;case"object":(a.is||a.style)&&(c=(a=e(a)).offset())}e.each(s.axis.split(""),function(g,m){var o,i="x"==m?"Left":"Top",n=i.toLowerCase(),e="scroll"+i,p=l[e],f=t.max(l,m);c?(r[e]=c[n]+(h?0:p-d.offset()[n]),s.margin&&(r[e]-=parseInt(a.css("margin"+i))||0,r[e]-=parseInt(a.css("border"+i+"Width"))||0),r[e]+=s.offset[n]||0,s.over[n]&&(r[e]+=a["x"==m?"width":"height"]()*s.over[n])):(o=a[n],r[e]=o.slice&&"%"==o.slice(-1)?parseFloat(o)/100*f:o),s.limit&&/^\d+$/.test(r[e])&&(r[e]=r[e]<=0?0:Math.min(r[e],f)),!g&&s.queue&&(p!=r[e]&&u(s.onAfterFirst),delete r[e])}),u(s.onAfter)}}).end()},t.max=function(t,r){if(n="x"==r?"Width":"Height",s="scroll"+n,!e(t).is("html,body"))return t[s]-e(t)[n.toLowerCase()]();var n,s,o="client"+n,i=t.ownerDocument.documentElement,a=t.ownerDocument.body;return Math.max(i[s],a[s])-Math.min(i[o],a[o])}}),define("lib/ios-orientationchange-fix",["jquery"],function(e){return function(t){function f(){var t,n="";e(document).find("input[placeholder]").each(function(){t=e(this),n=t.attr("placeholder"),t.removeAttr("placeholder").attr("placeholder",n)})}function d(){n.setAttribute("content",g),o=!0}function h(){n.setAttribute("content",p),o=!1}function m(e){s=e.accelerationIncludingGravity,r=Math.abs(s.x),l=Math.abs(s.y),c=Math.abs(s.z),t.orientation&&180!==t.orientation||!(r>7||(c>6&&8>l||8>c&&l>6)&&r>5)?o||d():o&&h()}if(t.addEventListener&&t.addEventListener("orientationchange",f,!1),i=navigator.userAgent,/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(i)&&i.indexOf("AppleWebKit")>-1&&(a=t.document,a.querySelector)){var s,i,a,r,c,l,n=a.querySelector("meta[name=viewport]"),u=n&&n.getAttribute("content"),p=u+",maximum-scale=1",g=u+",maximum-scale=10",o=!0;n&&(t.addEventListener("orientationchange",d,!1),t.addEventListener("devicemotion",m,!1))}}(window),{}}),define("module/BaseApp",["jquery","underscore","lib/amd-wrapped/modernizr","module/Main","view/BaseView","singleton/CurrentUser","singleton/CurrentBlog","singleton/EventDispatcher","singleton/Feature","singleton/Utils","app/navigation/topbar.layout","app/navigation/userMenu.view","app/modalmenu/usermenu","app/modalmenu/notifmenu","app/navigation/secondaryNav.view","view/SuccessBox","app/MarionetteApp","app/leftrail/leftrailContainedList.view","view/footer.view","app/account/account.channel","module/KinjaAnalytics","module/ads/ads.events","module/EssentialIconModule","singleton/FeatureThrottling","lib/jquery.cookie","lib/amd-wrapped/jquery.scrollTo","lib/ios-orientationchange-fix","lib/waypoints","templates/tiger/icons/essential/usage","templates/tiger/components/ad/ads"],function(e,w,y,j,g,t,c,s,n,i,h,u,d,m,f,p,a,v,b,l,o,_){"use strict";var r,O;return r=function(e){require(["module/LoginModule"],function(t){e(t.controller)})},O=g.extend({successBox:null,el:e("body"),$secondaryNavBtn:e(".js_secondary-nav-btn-wrapper"),events:{"click .js_offcanvas-user":"onOffcanvasUser","click .js_offcanvas-notif":"onOffcanvasNotif","click .js_usermenu-button":"onUsermenuButtonClick"},initialize:function(){j.start(),n.isOn("tap")&&require(["lib/fastclick"],function(e){e.attach(document.body)}),"resettoken"===this.getPageType()||"gettoken"===this.getPageType()?this.resetToken():(this.initApp(),"admin"!==i.getKinjaMeta().pageType&&this.initSubViews())},start:function(){},initApp:function(){var o=function(n){var t=e.cookie("kinja_features");!n.isSuperUser()||t&&-1!==t.indexOf("all_on=")||(e.cookie.raw=!0,t&&""!==t?e.cookie("kinja_features",t+"|all_on=on"):e.cookie("kinja_features","all_on=on"),e.cookie.raw=void 0)};n.isOn("frontendtiming")&&window.markUserTime("currentuser_load"),t.load(window._user).done(function(){if(o(t),n.isOn("frontendtiming")){var e=t.isLoggedIn()?"currentuser_loaded_loggedin":"currentuser_loaded_loggedout";e+="-"+(n.isOn("webpack")?"webpack":"require"),e+="-"+(c.blogGroup||"default"),window.markUserTime(e)}}).fail(function(){e("body").addClass("read-only")}),t.onLoggedIn.done(this.handleLogin.bind(this)),s.on("modal:incompleteRegistration:success",function(){window.ga("send","event","Sign up",t.get("authName"),c.displayName)},this),s.on("all",this.trigger,this),n.isOn("userstats")&&this.statsTracker(),n.isOn("analyticstracking")&&this.initAnalyticsTracking(),e("body").addClass("js_initialized "+(y.touch?"touch":"no-touch")),e("#ad-970x250-container").length&&n.isOn("dynamic_billboard")&&e("div.basement").first().waypoint({handler:function(t){"down"===t&&(e("#ad-970x250-container").append(tiger.components.ad.billboardDynamic()),_.trigger("ads.dynamicad.load",e(".js_ad-billboard--dynamic .js_ad-container"),"BILLBOARD_DYNAMIC"))},offset:function(){return window.innerHeight+100},triggerOnce:!0}),this.listenTo(l,"loginRequired",this.onLoginRequired).listenTo(l,"loginCancelled",this.onLoginCancelled).listenTo(t,"incompleteRegistration",this.onIncompleteRegistration)},initSubViews:function(){var t,o=e(a.notificationDropdownRegion.el).length>0,s=e(".js_site-footer");this.initLeftrailContained(),n.isOn("channels")&&this.initChannels(),n.isOn("trendingfeed_mobile")&&"permalink"===i.getKinjaMeta().pageType&&this.initMobileTrendingModule(),n.isOn("newsletter_fs")&&this.initSubscriptionModule(),o&&this.initTopbar(),n.isOn("maintenance_mode")&&this.showMaintenanceMessage(),this.setupSuccessBox(),s.length&&(t=new b({el:s}),t.bindUIElements(),t.delegateEvents(),t.onRender()),n.isOn("featurepanel")&&require(["module/FeaturePanelModule"],function(e){e.start()})},isGoogleBot:function(){return window.navigator.userAgent.toLowerCase().indexOf("googlebot")>0},displayWarningMessage:function(t,n){if(0===t.length||"1"===e.cookie(n))return!1;var s=function(){return t.addClass("hide"),e.cookie(n,"1",{expires:30,path:"/"}),!1};t.removeClass("hide").find("a.close").on("click",s)},showMaintenanceMessage:function(){var t=e(".js_maintenance");t.length>0&&t.removeClass("hide")},setupSuccessBox:function(){s.on("successbox:display",function(e){null!==this.successBox&&this.successBox.close(),this.successBox=new p(e),this.successBox.render()},this),s.on("successbox:close",function(){null!==this.successBox&&this.successBox.close()},this)},initLeftrailContained:function(){var e=new v({el:".js_sidebar"});e.render()},initMobileTrendingModule:function(){var t=e(".post-content > p"),n=t.length>3?2:t.length;e(t[n]).after('<div class="trendingfeed-inset-container js_trendingfeed-inset-container hide-for-large-up"></div>'),require(["module/MobileTrendingModule"],function(e){e.start()})},initTopbar:function(){var o,e=i.pageTypes,a=[e.editor,e.usersettings,e.splash,e.dashboard,e.manageblog,e.leaderboard,e.performancestats],s=-1!==a.indexOf(i.getKinjaMeta().pageType),n=new h({el:".js_global-nav-wrap",model:t});n.bindUIElements(),n.onRender(),s||/iemobile/.test(window.navigator.userAgent.toLowerCase())||n.initializeAutohide(),this.$secondaryNavBtn.length>0&&(s||this.$secondaryNavBtn.addClass("transition shown"),o=new f({el:"body",animation:!s}))},onOffcanvasUser:function(){var e=new d({className:"dui-modal fullscreen-modal right dui-menu",model:t,tab:"user"});return a.duimodalregion.show(e),!1},onOffcanvasNotif:function(){var e=new m({className:"dui-modal fullscreen-modal right dui-menu",model:t,tab:"notif"});return a.duimodalregion.show(e),!1},onUsermenuButtonClick:w.once(function(){var e=new u({model:t});a.userDropdownRegion.show(e)}),initChannels:function(){require(["module/ChannelsApp"],function(e){e.start()})},initSubscriptionModule:function(){require(["module/SubscriptionModule"],function(e){e.start()})},handleLogin:function(){t.isSuperUser()&&n.isOn("superuser")&&n.isOn("superuser_notif")&&e(".js_top-nav-wrap").addClass("momjeans-notifier"),e("body").addClass("loggedin")},resetToken:function(){var e=t.get("token");return e&&0===e.indexOf("dummy-")?window.location.href=window.location.protocol+"//"+window.location.host:t.token().done(function(){window.setTimeout(function(){window.location.reload()},1e3)}).fail(function(){window.location.href="/"}),!1},statsTracker:function(){var t="__k_iut",n=e(".js_stats"),s=n.data("trackurl"),o=!1;(!e.cookie(t)||e.cookie(t)<(new Date).getTime()-2592e6)&&(o=!0,e.cookie(t,(new Date).getTime(),{path:"/",expires:365})),n.data("unique",o),s&&(o&&(s+="&unique=true"),n.append('<img src="'+s+'" style="display: none;">'))},initAnalyticsTracking:function(){t.on("logoutReset",function(){o.pushEvent("LOGOUT",null,null,null)}),s.on("modal:login:closed",function(e){o.pushEvent("LOGIN","AUTHENTICATION",t.get("authName"),{uiElement:e.source||"default"})}),s.on("modal:incompleteRegistration:success",function(e){o.pushEvent("REGISTER","AUTHENTICATION",t.get("authName"),{uiElement:e.source||"default"})}),s.on("analytics:postSaved",function(e){"PUBLISHED"===e.data.status&&e.data.id===e.data.starterId&&o.pushEvent("PUBLISH_STARTER","POST",e.data.id,null)}),s.on("analytics:replySaved",function(e){"PUBLISHED"===e.data.status&&e.data.id!==e.data.starterId&&o.pushEvent("PUBLISH_REPLY","POST",e.data.id,null)})},onLoginRequired:function(e){r(function(n){var t=e?e.source:"default";n.showOptions(t),window.ga("send","event","Authentication flow","Prompt login","source: "+t)})},onLoginCancelled:function(e){o.pushEvent("LOGIN","CANCELLED","closeModal",{uiElement:e.source||"default"})},onIncompleteRegistration:function(){r(function(e){e.showIncompleteRegistration()})}})}),define("singleton/util/loadEditor",["underscore","jquery","singleton/Feature","singleton/StringUtils"],function(t,e,n,s){"use strict";function o(c,l,i){var n,a,r,o=e("head>meta[id="+l+"-css-url]");1===o.length?(n=o.attr("content"),a=0,r=function(){var e=t.find(document.styleSheets,function(e){return s.endsWith(e.href,n)});return"undefined"!=typeof e},document.createStyleSheet?document.createStyleSheet(n):e("head").append('<link rel="stylesheet" type="text/css" href="'+n+'" />'),o.remove(),require([c],function(){if(r())i.apply();else var e=window.setInterval(function(){(r()||a>99)&&(window.clearInterval(e),i.apply()),a+=1},250)})):require([c],i)}function i(){var t=e.Deferred();return n.isOn("webpack")?require(["module/MarionetteEditor","stylesheets/editor.css"],function(){require(["app/editor/editor.app"],t.resolve)}):o("module/MarionetteEditor","editor",function(){require(["app/editor/editor.app"],t.resolve)}),t.promise()}return i}),define("app/mixins/HighlightBox",["jquery","singleton/EventDispatcher"],function(e,t){"use strict";var n={insertHighlightBox:function(n,f,m,u){var s=n===!1?f:e(n.target),o=n===!1?Math.round(s.width()*m/100):Math.round(n.pageX-s.offset().left),i=n===!1?Math.round(s.height()*u/100):Math.round(n.pageY-s.offset().top),l=s.width()-50,d=50,c=s.height()-50,h=50,r=Math.round((o>l?l-50:d>o?0:o-50)+s.offset().left),a=Math.round((i>c?c-50:h>i?0:i-50)+s.offset().top),p=n!==!1?" create-annotation":"",g='<div class="annotationHighlightBox'+p+'" style="top:'+a+"px; left:"+r+'px;"></div>';return n===!1?t.on("imageAnnotationsClose",function(){e(".annotationHighlightBox").remove()},this):t.on("removeReplyForm",function(){e(".annotationHighlightBox").remove()},this),e(".annotationHighlightBox").remove(),e("body").prepend(g),{top:a,left:r}}};return n}),define("apiclient/annotation",["config","singleton/Feature","apiclient/apirequest","singleton/Utils"],function(e,t,n,s){"use strict";var o;return o={getAnnotations:n.getJson(e.api.core.url+"/annotation/starter/{{starterId}}",{filterDismissed:!0,cache:!!t.isOn("cachecomments")&&s.shouldGetCached})}}),define("templates/tiger/components/annotation",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.annotation.newSingleAnnotation=function(n,o,s){return'<span class="js_annotation-footnote annotation-footnote" data-annotation-id="'+e.$$escapeHtmlAttribute(n.reply.id)+'"'+(null!=n.x&&null!=n.y?' data-annotation-x="'+e.$$escapeHtmlAttribute(n.x)+'" data-annotation-y="'+e.$$escapeHtmlAttribute(n.y)+'" data-image-chompid="'+e.$$escapeHtmlAttribute(n.imageChompId)+'" data-annotation-type="image"':' data-annotation-type="text" ')+' ><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.reply.permalink))+'" class="js_annotation-footnote-link annotation-footnote-link proxima">P</a>'+t.components.annotation.annotationInset(n,null,s)+"</span>"},n.DEBUG&&(t.components.annotation.newSingleAnnotation.soyTemplateName="tiger.components.annotation.newSingleAnnotation"),t.components.annotation.annotationInset=function(n,u,s){o="",c=s.features.hide_pending_replies&&n.reply&&!(null==n.reply?null:n.reply.approved),o+='<div class="annotation-inset-under js_annotation-inset-'+e.$$escapeHtmlAttribute(n.id)+' hide" data-annotation-id="'+e.$$escapeHtmlAttribute(n.id)+'"><div class="hide-annotation right cursor-pointer" id="annotation_'+e.$$escapeHtmlAttribute(n.id)+'">'+t.icons.essential.closeSmall(null,null,s)+'</div><div class="annotation-content">'+(c&&!(null==n.reply?null:n.reply.newpost)?t.components.groupchats.unapprovedAnnotationWarning(null,null,s)+'<div class="js_annotation-content hide">':'<div class="js_annotation-content">')+e.$$filterNoAutoescape(n.reply.excerptWithAssets)+'<footer class="row proxima"><div class="medium-8 columns"><span class="floated-container img-30"><span class="avatar"><span class="img-border mbn mrm"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.reply.author.avatar.id,"avt-large",n.reply.author.avatar.format)))+'" class="avatar" alt="" /></span></span><span class="txt blogname proxima text-upper text-strong text-light txt-30">';for(var o,r,c,i="",l=n.reply.blogs,d=l.length,a=0;d>a;a++)r=l[a],i+=r.id==n.reply.author.defaultBlogId?'<a class="text-light" href="http://'+e.$$escapeHtmlAttribute(r.canonicalHost)+'" target="_self">'+e.$$escapeHtml(n.reply.author.displayName)+"</a>":"";return o+=(i?e.$$filterNoAutoescape(i):e.$$escapeHtml(n.reply.author.displayName))+'</span></span></div><div class="medium-4 columns medium-text-right text-center txt-30"><a class="text-light text-small view-discussion" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.reply.permalink))+'">View discussion&nbsp;&gt;&gt;</a></div></footer></div></div></div>'},n.DEBUG&&(t.components.annotation.annotationInset.soyTemplateName="tiger.components.annotation.annotationInset")}),define("app/AnnotationApplet",["jquery","underscore","backbone.marionette","view/BaseView","singleton/EventDispatcher","singleton/Feature","singleton/util/loadEditor","singleton/DeviceController","app/mixins/HighlightBox","apiclient/annotation","templates/tiger/components/annotation"],function(e,t,o,i,d,a,r,s,c,l){"use strict";var n=e(window),u=i.extend(t.extend({},c,{annotationsFootnotesMax:5,_annotationTypeImage:"image",annotationApiResult:null,events:{"click .js_annotation-footnote-link":"toggleAnnotation","click .hide-annotation":"hideAllAnnotations","click .ellipsis":"expandFootnotes","click .js_annotatable-image":"annotateHandler","click .js_pending-reply-switch":"showPending"},initialize:e.noop,startApp:function(){this.isMobile=s.isTabletLike()||s.isMobileLike(),this.allowReplies=this.model.get("allowReplies")&&!e("body").hasClass("read-only"),(!this.isMobile||a.isOn("mobileannotation"))&&(e(".post-content").addClass("new-annotation"),!this.allowReplies||this.isMobile?this.enableImageAnnotations(!0):this.enableImageAnnotations(),this.model&&this.model.get("isStarter")===!0&&(this.model.on("AnnotationCreated",function(e){this.addNewAnnotation(e)},this),this.annotationApiResult=l.getAnnotations({starterId:this.model.get("starterId")}).then(function(e){return e.items}),this.getAnnotationReplies({type:"starter",discussions:!0})),this.model.on("annotation:remove",this.removeAnnotation.bind(this)),d.on("annotation:fromReplies",this.getAnnotationReplies.bind(this)))},getAnnotationReplies:function(e){this.annotationApiResult.done(function(n){var s="permalink"===e.type?t.filter(n,function(t){return t.replyId===e.replyId}):e.discussions?t.filter(n,function(e){return e.reply.approved}):n;this.renderAnnotations(s)}.bind(this))},renderAnnotations:function(o){var n,i=this,a=o,s=t.where(a,{annotationType:this._annotationTypeImage.toUpperCase()});this.$(".annotation-footnote-wrapper").empty(),s.length&&(n=t(s).filter(function(e){return e.reply}),t(n).each(function(n){var s=n.imageChompId,t=e('[data-chomp-id="'+s+'"]').parents(".has-image");0===t.children(".annotation-footnote-wrapper").length&&t.append('<span class="annotation-footnote-wrapper clearfix"></span>'),t.children(".annotation-footnote-wrapper").append(i.renderAnnotationTemplate(n))})),this.updateFotenoteNumbers(),this.addEllipsis()},renderAnnotationTemplate:function(e){var t=this.soyToHtml(tiger.components.annotation.newSingleAnnotation,e);return t},addEllipsis:function(){var n=this,s=e(".annotation-footnote-wrapper");t.each(s,function(a){var o=e(a),s=o.find(".annotation-footnote"),i=s.length;t.each(s,function(s,t){t>n.annotationsFootnotesMax-1&&t!==i-1&&e(s).addClass("ellipsable hide")}),i>n.annotationsFootnotesMax+1&&0===o.find(".ellipsis").length&&s.last().before('<span class="ellipsis">...</span>')})},updateFotenoteNumbers:function(){var n=e(".js_annotation-footnote-link");e(n).length&&t.each(n,function(t,n){e(t).html(n+1)})},expandFootnotes:function(n){var t=e(n.target);t.siblings(".ellipsable").removeClass("hide"),t.remove()},toggleAnnotation:function(t){var s=e(t.target),n=s.parents(".annotation-footnote");t.preventDefault(),n.hasClass("selected")?this.hideAllAnnotations():this.openAnnotation(t,n)},openAnnotation:function(a,t){var s,o,i=this;this.hideAllAnnotations(),t.addClass("selected").find(".annotation-inset-under").removeClass("hide"),t.data("annotation-type")===this._annotationTypeImage&&(s=t.data("image-chompid"),o=e('[data-chomp-id="'+s+'"]'),this.insertHighlightBox(!1,o,t.data("annotation-x"),t.data("annotation-y"))),n.on("keyup.hideAnnotations",function(e){(void 0!==e.keyCode&&27===e.keyCode||void 0!==e.which&&27===e.which)&&i.hideAllAnnotations()}),n.on("click.hideAnnotations",function(t){0===e(t.target).parents(".annotation-footnote-wrapper").length&&i.hideAllAnnotations()})},hideAllAnnotations:function(t){t&&t.stopPropagation(),e(".annotation-footnote").removeClass("selected"),e(".annotation-inset-under").addClass("hide"),e(".annotationHighlightBox").length&&e(".annotationHighlightBox:not(.create-annotation)").remove(),n.off("keyup.hideAnnotations"),n.off("click.hideAnnotations")},enableImageAnnotations:function(i){var n,s=e('article:not(reframe-post) img[data-chomp-id][src!=""]'),o=[];if(s.length){for(n=0,s;n<s.length;n+=1)o.push(e(s[n]).data("chomp-id"));t.each(t.unique(o),function(n){var t=e("[data-chomp-id="+n+"]").first();i||t.closest("a").length||t.addClass("js_annotatable-image cursor-crosshair")})}},annotateHandler:function(o){var i,a,c,l,d,u,h,m,f,p,g,v,b,s=this,j="image",t=e(o.currentTarget);return this.hideAllAnnotations(),i=t.offset(),a=t.width(),c=t.height(),l=t.attr("width"),d=t.attr("height"),v=t.data("asset-url"),h=t.data("chomp-id"),u=o.pageX-i.left,f=o.pageY-i.top,p=Math.round(u/a*100),g=Math.round(f/c*100),b=function(e){e.$el.find(".reply-annotation").remove(),e.$el.find("input.js_annotationType").val("IMAGE"),e.$el.find("input.js_imageUrl").val(v),e.$el.find("input.js_imageChompId").val(h),e.$el.find("input.js_imageWidth").val(l||a),e.$el.find("input.js_imageHeight").val(d||c),e.$el.find("input.js_x").val(p),e.$el.find("input.js_y").val(g)},m=function(t){r().then(function(){require(["app/editor/editor.app","app/MarionetteApp"],function(n,i){var a=s.addCommentRegion(i,e('<div class="js_replyform "/>').css({position:"absolute",top:0}).prependTo("body"));a.once("editor:post:save",function(e){s.addNewAnnotation({model:e})}),n.annotatePost(t,o,j)})})},m(this.model),n.on("keyup.hideAnnotations",function(e){(void 0!==e.keyCode&&27===e.keyCode||void 0!==e.which&&27===e.which)&&s.hideAllAnnotations()}),n.on("click.hideAnnotations",function(t){0===e(t.target).parents(".replyform").length&&s.hideAllAnnotations()}),!1},addCommentRegion:function(t,s){var e=t.commentRegion,n=!!e&&e.currentView;return(!n||n.confirmRemove())&&(e&&(e.reset(),e.off()),e=new o.Region({el:s}),t.addRegions({commentRegion:e})),e},addNewAnnotation:function(o){t.defaults(o.model,{get:function(e){return this[e]}});var n=o.model,r=n.get("imageChompId"),c={id:n.id,x:n.get("x")?n.get("x"):null,y:n.get("y")?n.get("y"):null,imageChompId:r,reply:{permalink:n.get("permalink"),excerptWithAssets:n.get("excerptWithAssets")?n.get("excerptWithAssets"):n.get("display"),author:n.get("author"),blogs:n.get("blogs"),id:n.id,newpost:!0}},i=e('[data-chomp-id="'+r+'"]'),s=i.parents(".has-image"),a=s.find(".annotation-footnote-wrapper");a.length?a.append(this.renderAnnotationTemplate(c)):(s.append('<span class="annotation-footnote-wrapper clearfix"></span>'),s.find(".annotation-footnote-wrapper").append(this.renderAnnotationTemplate(c))),this.insertHighlightBox(!1,i,n.get("x"),n.get("y")),e('[data-annotation-id="'+n.get("id")+'"]').removeClass("hide").parents(".js_annotation-footnote").addClass("selected"),this.updateFotenoteNumbers(),this.addEllipsis()},removeAnnotation:function(t){e('[data-annotation-id="'+t+'"]').remove(),this.updateFotenoteNumbers(),this.addEllipsis()},showPending:function(t){t.preventDefault();var n=e(t.target).parents(".annotation-content");n.find(".js_toggle-pending").addClass("hide"),n.find(".js_annotation-content").removeClass("hide")}}));return u}),define("singleton/util/hostname",[],function(){"use strict";function e(e){return e.replace(/^www\./,"")}function t(e){var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}function s(s){return e(t(s))===t(n)}var n;return n=e(window.location.host),{removeWWW:e,sameHost:s}}),define("singleton/util/externalLinks",["singleton/util/hostname"],function(e){"use strict";return{openInNewTabs:function(t){t.find("a").each(function(n,t){e.sameHost(t.hostname)||t.setAttribute("target","_blank")})}}}),define("singleton/PostInsetTools",["underscore","jquery","singleton/Renderer","singleton/Utils","singleton/Feature","singleton/util/hostname","singleton/util/externalLinks"],function(s,r,c,o,i,n,a){"use strict";function e(){}var t;return e.prototype={render:function(e){var t=e.find(".js_inset");a.openInNewTabs(t),this.markExternalInsets(t),i.isOn("empty_thumbnail_test")||this.hideEmptyThumbnails(e)},hideEmptyThumbnails:function(e){var t=e.find(".referenced-item img");t.each(function(o,e){function t(){e.naturalHeight&&e.naturalWidth||s.addClass("hide")}var n=r(e),s=n.parents(".referenced-item-image");e.complete?t():n.load(t)})},markExternalInset:function(t,s){var e,o,i;n.sameHost(s)||(e=t.querySelector(".js_readmore .js_external-text"),e&&(i=n.removeWWW(s),o='<span class="hostname">'+i.split(".").join(".&#x200b;")+"</span>",t.querySelector(".js_readmore").innerHTML=e.innerText+" "+o))},markExternalInsets:function(e){e.find(".referenced-item").each(function(t,e){this.markExternalInset(e,s.last(e.querySelectorAll("a")).hostname)}.bind(this))},soyToHtml:function(t,n,s){var e=o.getRenderableData(n,s);return c.renderTemplate(t,e.data,e.injected)}},t||(t=new e)}),define("app/post/common/post.layout",["underscore","backbone.marionette","singleton/CurrentUser","singleton/Utils","singleton/Feature","module/KinjaAnalytics"],function(t,s,e,n,o,i){"use strict";var a=s.Layout.extend(t.extend({regions:{post:".post"},ui:{likeButton:".js_like",likeIcon:".js_like_icon",likeCountPlaceholder:".js_like_count",replyButton:".js_reply-to-post",metaContainer:".meta-container",metaTools:".js_meta-tools"},triggers:{"click @ui.likeButton":"posttools:like","click @ui.replyButton":"posttools:reply"},events:{approval:"_removePendingStyling","click @ui.likeIcon":"onRecommendTracking"},modelEvents:{"change:liked":"_updateLikeIconClasses","posttools:post:likeCount:updated":"_updateLikeCount"},updateUserState:function(){e.onAuth.done(function(){e.isLoggedIn()?this._updateLikeIconClasses():this._removeLikeIconClass()}.bind(this)),e.onLoggedIn.done(this._updateLikeIconClasses.bind(this))},togglePostToolsVisibility:function(e){o.isOn("newstream")?this.ui.metaTools.toggleClass("hide",e):this.ui.metaContainer.toggleClass("without-dropdown",e)},onRecommendTracking:function(e){var t="groupChat"===e.currentTarget.parentElement.getAttribute("data-analytics-target");n.getKinjaMeta().pageType!==n.pageTypes.permalink||t||i.pushEvent("RECOMMENDATION","POST",this.model.id,{uiElement:e.currentTarget.getAttribute("data-analytics-target")})},_removePendingStyling:function(s,e){var n=this.$el.closest(".js_branch-list");t.each(e.approvedReplyIDs,function(e){n.find("#reply_"+e).removeClass("reply--unapproved")})},_updateLikeIconClasses:function(){this.ui.likeIcon.toggleClass("active",this.model.get("liked"))},_removeLikeIconClass:function(){this.ui.likeIcon.removeClass("active")},_updateLikeCount:function(){var e=parseInt(this.ui.likeButton.data("likecount"),10)||0,t=e>0,e=this.model.get("liked")?e+1:t?e-1:0;this.ui.likeButton.data("likecount",e),this.ui.likeCountPlaceholder.text(e||"")}}));return a}),define("app/post/mixins/post.confirmationPrompt",["jquery","singleton/Renderer"],function(e,t){"use strict";var n={_confirmationPrompt:function(n,s){return window.confirm(e(t.renderTemplate(n,s||{})).text())}};return n}),define("app/post/mixins/post.userPermissionsHelper",["singleton/Feature","singleton/CurrentUser","singleton/CurrentBlog"],function(t,e,n){"use strict";return{canEditPost:function(n){var l=15,a=function(e){var t=new Date(e+60*l*1e3),n=new Date;return t>n},o=e.isLoggedIn(),i=e.id===n.get("authorId"),r=e.hasRole("OWNER",n.get("defaultBlogId")),c=e.hasRole("ADMIN",n.get("defaultBlogId")),s=n.has("parentId"),d=o&&(i||r||c)&&!s,u=o&&s&&i&&a(n.get("publishTimeMillis"));return e.isSuperuser()&&t.isOn("superuser")||d||u},canDeletePost:function(t){var n=e.isLoggedIn(),s=e.id===t.get("authorId"),o=e.hasRole("OWNER",t.get("defaultBlogId")),i=t.has("parentId");return n&&(s||o)&&!i},canInviteToPostManually:function(n){return t.isOn("invitetoken")&&n.get("authorId")===e.id},canPromote:function(){return e.hasPermission("SALES")||e.isSuperuser()&&t.isOn("superuser")},canDismissPost:function(s){var o=e.hasRole("ADMIN",n.id)||e.hasRole("ADMIN",s.get("defaultBlogId")),i=e.id===s.get("authorId"),a=e.id===s.get("parentAuthorId"),r=s.has("parentId");return r&&(e.isSuperuser()&&t.isOn("superuser")||!i&&(o||a))},canUnshareRepostedPost:function(){return e.hasRole("ADMIN",n.id)},canBlock:function(e){return this.userIsOwner(e)||this.userIsAdmin(e)||this.userIsSuper()},canSharePost:function(){return e.isLoggedIn()},userIsAuthor:function(t){return e.hasRole("AUTHOR",t.get("defaultBlogId"))&&e.id!==t.get("authorId")},userIsOwner:function(t){return e.hasRole("OWNER",t.get("defaultBlogId"))&&e.id!==t.get("authorId")},userIsAdmin:function(t){return e.hasRole("ADMIN",t.get("defaultBlogId"))&&e.id!==t.get("authorId")},userIsSuper:function(){return e.isSuperuser()&&t.isOn("superuser")}}}),define("app/post/mixins/post.userPermissions",["underscore","app/post/mixins/post.userPermissionsHelper"],function(e,t){"use strict";var n=["canEditPost","canDeletePost","canInviteToPostManually","canPromote","canDismissPost","canUnshareRepostedPost","canBlock","canSharePost","userIsAuthor","userIsOwner","userIsAdmin","userIsSuper"];return e.reduce(n,function(n,s){return n[s]=e.wrap(t[s],function(e){return e.call(this,this.model)}),n},{})}),define("app/post/common/post.menuitemview",["backbone.marionette"],function(e){"use strict";var t=e.ItemView.extend({_show:function(){this.$el.removeClass("hide")},_hide:function(){this.$el.addClass("hide")},_isDisabled:function(){return!1},_canShow:function(){throw new Error("method _canShow not implemented!")},onRender:function(){this._canShow()?(this._show(),this._isDisabled()?this.$el.addClass("disabled"):this.$el.removeClass("disabled")):this._hide()}});return t}),define("app/post/posttools/view/posttools.menuitemview",["underscore","app/post/mixins/post.userPermissions","app/post/mixins/post.confirmationPrompt","app/post/common/post.menuitemview"],function(e,t,n,s){"use strict";var o=s.extend(e.extend({},t,n,{_canShow:function(){var t=this,n=function(e){return t[e]};return e.chain(this.permissions).map(n).invoke("call",this).all().value()},render:function(){return this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this}}));return o}),define("app/post/posttools/view/posttools.editview",["app/post/posttools/view/posttools.menuitemview","singleton/Feature","singleton/Utils"],function(e,t,n){"use strict";var s=e.extend({permissions:["canEditPost"],onRender:function(){var s=t.isOn("editor_own_page_test")?window.location.search:"",o=this.$el.find("a");e.prototype.onRender.call(this,arguments),o.attr("href","//"+n.getKinjaHost()+"/write/"+this.model.id+s)}});return s}),define("app/post/posttools/view/posttools.editreplyview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["canEditPost"]});return t}),define("app/post/posttools/view/posttools.deleteview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["canDeletePost"],triggers:{click:"posttools:delete"}});return t}),define("apiclient/invite",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";return{addInvite:t.postJson(n.append(e.api.core.url+"/invite")),requestInviteToken:t.postJson(n.append(e.api.core.url+"/invite/create?postId={{postId}}")),approveInvitedCommenter:t.postJson(e.api.core.url+"/invite/approve")}}),define("templates/tiger/components/invites/modals",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.components.invites.modals.inviteToPostManually=function(e){return'<form class="invite-to-post-form js_invite-to-post-form"><div class="row"><div class="columns"><input type="url" class="mbn js_invite-manually-field" value="'+t.$$escapeHtmlAttribute(e.permalink)+"?invite="+t.$$escapeHtmlAttribute(e.inviteUid)+'" autofocus /></div></div></form>'},n.DEBUG&&(e.components.invites.modals.inviteToPostManually.soyTemplateName="tiger.components.invites.modals.inviteToPostManually")}),define("view/forms/invite/InviteToPostManuallyModalView",["backbone.marionette","singleton/EventDispatcher","templates/tiger/components/invites/modals"],function(e,t){"use strict";var n=e.ItemView.extend({id:"modal-invite-to-post-manually",template:tiger.components.invites.modals.inviteToPostManually,ui:{inviteToPostManuallyField:"#js_invite-to-post-manually-field"},initialize:function(){t.on("modal:login:close",this.close,this)}});return n}),define("app/invites/behaviors/invites.token.posttools",["backbone.marionette","apiclient/invite","app/modal/modal.controller","view/forms/invite/InviteToPostManuallyModalView"],function(t,n,e,s){"use strict";var o=t.Behavior.extend({events:{click:"onInviteModalToPostManuallyOpen"},onInviteModalToPostManuallyOpen:function(t){t.preventDefault(),n.requestInviteToken({postId:this.view.model.id}).done(function(t){var n=e.instantiate(s,{templateData:{permalink:this.view.model.get("permalink"),inviteUid:t.inviteUid}});e.create(n,{name:"invite",className:"reveal-modal kinja-modal small proxima"})}.bind(this))}});return o}),define("app/post/posttools/view/posttools.invitemanuallyview",["app/post/posttools/view/posttools.menuitemview","app/invites/behaviors/invites.token.posttools"],function(e,t){"use strict";var n=e.extend({permissions:["canInviteToPostManually"],behaviors:{InvitesTokenPostTools:{behaviorClass:t}}});return n}),define("app/post/posttools/view/posttools.dismissview",["app/post/posttools/view/posttools.menuitemview","singleton/CurrentUser","singleton/Utils"],function(t,n,e){"use strict";var s=t.extend({permissions:["canDismissPost"],ui:{dismissButton:"a.dismiss",undismissButton:"a.undismiss"},triggers:{"click @ui.dismissButton":"posttools:dismiss","click @ui.undismissButton":"posttools:undismiss"},modelEvents:{"change:actionState":"_finishRender"},_finishRender:function(){this._setDismissState(),t.prototype.onRender.call(this)},_setDismissState:function(){var e=this.model.get("actionState"),t=this.model.get("defaultBlogId"),e=e?e[t]:"";"dismiss"===e?(this.$el.removeClass(".js_dismiss").addClass("js_undismiss"),this.ui.dismissButton.addClass("hide"),this.ui.undismissButton.removeClass("hide")):(this.$el.removeClass(".js_undismiss").addClass("js_dismiss"),this.ui.undismissButton.addClass("hide"),this.ui.dismissButton.removeClass("hide"))},onRender:function(){var t,o,s=this;"permalink"===e.getKinjaMeta().pageType?(t=parseInt(e.getKinjaMeta().postId||0,10),o=parseInt(e.getKinjaMeta().starterId||0,10),t!==o&&t===this.model.id?n.onAuth.always(function(){n.isLoggedIn()?s.triggerMethod("posttools:getDismissState",{model:s.model}):s._finishRender()}):this._finishRender()):this._finishRender()}});return s}),define("app/post/posttools/view/posttools.promoteview",["app/post/posttools/view/posttools.menuitemview","singleton/Utils"],function(e,t){"use strict";var n=e.extend({permissions:["canPromote"],triggers:{click:"posttools:promote"},onPosttoolsOpened:function(){var e=this.model&&parseInt(t.getKinjaMeta().postId,10)===this.model.get("sharedPostId");e&&this.$el.addClass("hide")}});return n}),define("app/post/posttools/view/posttools.blockview",["app/post/posttools/view/posttools.menuitemview","singleton/CurrentUser"],function(e,t){"use strict";var n=e.extend({permissions:["canBlock"],events:{click:"_blockBlog"},modelEvents:{"posttools:blockStatusUpdated":"_finishRender"},collectionEvents:{"posttools:block posttools:unblock sync":"_checkBlockStatus"},_checkBlockStatus:function(){this.triggerMethod("posttools:checkBlockStatus",{model:this.model,collection:this.collection})},_blockBlog:function(e){e.preventDefault(),this.triggerMethod("posttools:block",{model:this.model,collection:this.collection,targetBlogName:this._getTargetBlogName(),targetAuthorName:this._getTargetAuthorName()}),this.$el.siblings(".js_unfollowforblog").addClass("hide"),this.$el.siblings(".js_followforblog").removeClass("hide"),this.$el.siblings(".js_unfollowforuser").addClass("hide"),this.$el.siblings(".js_followforuser").removeClass("hide")},_correctBlockText:function(n){var t=this.$el.find("span"),s=t.text(),e=n?"Unblock":"Block",e=s.replace(/Unblock|Block/,e);t.text(e)},_finishRender:function(t){this._correctBlockText(t),e.prototype.onRender.call(this)},_getTargetBlogName:function(){return this.$el.data("targetblogname")},_getTargetAuthorName:function(){return this.$el.data("targetauthorname")},onRender:function(){var e=this;t.onAuth.always(function(){e._canShow()?e._checkBlockStatus():e._hide()})}});return n}),define("app/post/posttools/view/posttools.hideview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["userIsSuper"],triggers:{click:"posttools:hide"}});return t}),define("app/post/posttools/view/posttools.kinjashareview",["app/post/posttools/view/posttools.menuitemview","singleton/Utils"],function(e,t){"use strict";var n=e.extend({permissions:[],events:{click:"onKinjaShareClick"},onKinjaShareClick:function(){var e=parseInt(t.getKinjaMeta().postId,10)===this.model.get("sharedPostId"),n=this.model.get("isStarter");this.trigger("posttools:kinjaShare",this.model,{showReframe:!e&&n})}});return n}),define("app/post/posttools/view/posttools.kinjaunshareview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["canSharePost","canUnshareRepostedPost"],triggers:{click:"posttools:undorepost"}});return t}),define("app/post/posttools/view/posttools.externalshareview",["jquery","app/post/posttools/view/posttools.menuitemview"],function(e,t){"use strict";var n=t.extend({permissions:[],ui:{sharePostButton:".js_share-post-item"},triggers:{"click @ui.sharePostButton":"posttools:externalShare"},onRender:function(){var t=function(t){return e("<div/>").html(t).text()},n=function(e){return e?e.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(e)}):""},s=this.model.get("headline")||this.model.get("first100Characters")||this.model.get("compact"),o=this.ui.sharePostButton.attr("href");this.ui.sharePostButton.attr("href",o.replace("POST_TITLE",encodeURIComponent(t(n(s)))))}});return n}),define("templates/tiger/components/groupchats/flagreason",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.groupchats.flagreason=function(n,s,t){return'<form><label class="reason-head">Why are you flagging this?<a class="icon" href="http://help.gawker.com/customer/portal/articles/1726140-what-is-flagging-?b_id=5895" target="_blank">'+e.icons.actions.information(null,null,t)+'</a></label><div class="row radio-cont"><div class="column small-12 js_error hide proxima"><small class="warningmessage">Please select a reason</small></div><div class="columns small-12"><label><input type="radio" name="reason" value="HARASSMENT">It\'s harassment</label></div></div><div class="row radio-cont"><div class="columns small-12"><label><input type="radio" name="reason" value="HATE_SPEECH">It\'s hate speech</label></div></div><div class="row radio-cont"><div class="columns small-12"><label><input type="radio" name="reason" value="SPAM">It\'s spam</label></div></div><div class="flag-reason-ctas"><a class="button secondary tiny cancel js_cancel">Cancel</a><a class="button primary tiny submit js_submit">Save</a></div></form>'},t.DEBUG&&(e.components.groupchats.flagreason.soyTemplateName="tiger.components.groupchats.flagreason")}),define("module/flagging/view/FlagReasonDropdown",["backbone.marionette","templates/tiger/components/groupchats/flagreason"],function(e){"use strict";var t=e.ItemView.extend({template:tiger.components.groupchats.flagreason,className:"flag-reason-dropdown js_flagreason",events:{submit:"submit",click:"preventPropagation","click .js_cancel":"cancel","click .js_submit":"submit"},initialize:function(){},preventPropagation:function(e){e.stopPropagation()},cancel:function(){this.trigger("flagreason:cancel")},submit:function(t){t.preventDefault();var e=this.$('input[name="reason"]:checked').val();return e?this.trigger("flagreason:submit",this,e):this.$(".js_error").removeClass("hide"),!1}});return t}),define("templates/tiger/components/forms/modals/flagreason",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.forms.modals.flagreason=function(){return'<div class="show-for-medium-down flag-reason-mobile"><ul class="sticky-modal-options"><li class="js_reason-harassment" data-reason="HARASSMENT">It\'s harassment</li><li class="js_reason-hate-speech" data-reason="HATE_SPEECH">It\'s hate speech</li><li class="js_reason-spam" data-reason="SPAM">It\'s spam</li></ul><footer class="row"><div class="column small-12"><input type="button" class="button tiny secondary js_cancel" tabindex="5" value="Cancel" /></div></footer></div>'},t.DEBUG&&(e.components.forms.modals.flagreason.soyTemplateName="tiger.components.forms.modals.flagreason")}),define("module/flagging/view/FlagReasonModal",["jquery","backbone.marionette","templates/tiger/components/forms/modals/flagreason"],function(e,t){"use strict";var n=t.ItemView.extend({template:tiger.components.forms.modals.flagreason,tagName:"form",events:{submit:"submit","click .js_cancel":"cancel","click .js_reason-harassment":"selectReason","click .js_reason-hate-speech":"selectReason","click .js_reason-spam":"selectReason"},cancel:function(){this.trigger("flagreason:cancel")},selectReason:function(n){var t=e(n.target).attr("data-reason");if(!t)throw new Error("Empty reason code for reason!");this.trigger("flagreason:submit",this,t)}});return n}),define("apiclient/flagging",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";var s={flagPost:function(t){return t.reason?e.api.core.url+"/post/{{postId}}/flag?reason={{reason}}":e.api.core.url+"/post/{{postId}}/flag"},unflagPost:function(t){return t.reason?e.api.core.url+"/post/{{postId}}/unflag?reason={{reason}}":e.api.core.url+"/post/{{postId}}/unflag"}},o={getPosts:t.getJson(n.append(e.api.core.url+"/post/{{starterId}}/flaggedposts")),getCount:t.getJson(n.append(e.api.core.url+"/post/{{starterId}}/flaggedcount")),flagPost:t.postJson(n.append(s.flagPost)),unflagPost:t.postJson(n.append(s.unflagPost)),getBlogCount:t.getJson(n.append(e.api.core.url+"/blog/{{blogId}}/flaggedcount")),resolveFlag:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/resolve")),unresolveFlag:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/unresolve"))};return window.__karma__&&(o.__testonly__={urls:s}),o}),define("templates/tiger/components/groupchats/flagging-admin-link",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.components.groupchats.flaggingAdminLink=function(e){return"<div class=\"flagging-admin-link proxima\"><a onClick=\"window.ga('send', 'event', 'On-Page Flagging', 'click', 'Click into moderation queue');\" href=\"https://kinja.com/manage/"+t.$$escapeHtmlAttribute(e.blogName)+'/flagged">Moderate Flagged Replies ('+t.$$escapeHtml(e.flagCount)+")</a></div>"},n.DEBUG&&(e.components.groupchats.flaggingAdminLink.soyTemplateName="tiger.components.groupchats.flaggingAdminLink")}),define("module/flagging/ReplyFlaggingModule",["jquery","underscore","singleton/Feature","singleton/CurrentUser","singleton/Utils","singleton/WindowController","module/flagging/view/FlagReasonDropdown","module/flagging/view/FlagReasonModal","app/modal/modal.controller","apiclient/flagging","templates/tiger/components/groupchats/flagging-admin-link"],function(s,n,a,t,d,r,c,l,i,o){"use strict";var e={flaggedReplies:null,flaggedRepliesLoaded:s.Deferred(),flagCount:null,flagCountLoaded:s.Deferred(),tokenRenewed:!1,reasonDropdown:void 0,reasonModal:void 0,_loadFlaggedReplies:function(s){var n=this,i=function(i,o){n.flaggedReplies=[],o&&o.success===!0?(n.flaggedReplies=i.map(function(e){return e.postId}),n.flaggedRepliesLoaded.resolve()):o&&"InvalidSessionToken"===o.type&&e.tokenRenewed===!1?(e.tokenRenewed=!0,t.token().done(function(){e._loadFlaggedReplies(s)})):n.flaggedRepliesLoaded.reject()};o.getPosts({starterId:s}).done(i)},_loadFlagCount:function(t){var e=this,n=function(n,t){t&&t.success===!0&&(e.flagCount=Number(n)),e.flagCountLoaded.resolve()};o.getCount({starterId:t}).done(n)},_mergePostModelWithFlagInfo:function(e){var t=e.get("id");n.contains(this.flaggedReplies,t)&&e.set({allowReplies:!1,flagged:!0})},_postStatus:function(e){return 0!==e.parents(".all-threads").length?e.parents(".js_reply").hasClass("reply--unapproved")?"Pending":"Approved":"Featured"},_flagPost:function(u,t,i){var l,d,s=t.get("flagged")===!0,r=t.get("id"),c=s?"Unflag":"Flag",h=e._postStatus(u);t.get("flaggingInProgress")===!0&&n.isUndefined(e.reasonDropdown)||(t.set({flaggingInProgress:!0}),d=a.isOn("extendedflag")&&!n.isUndefined(i)&&"Flag"===c?c+" - "+i.toLowerCase():c,window.ga("send","event","On-Page Flagging",d,"Reply status: "+h),l=s?o.unflagPost({postId:r,reason:i}):o.flagPost({postId:r,reason:i}),l.done(function(n,e){void 0!==e&&e.success===!0&&(t.set({flagged:!s,allowReplies:s,flaggingInProgress:!1}),this._syncFlaggedReplies(!s,r))}.bind(this)))},_syncFlaggedReplies:function(t,s){null!==e.flaggedReplies&&(t?e.flaggedReplies.push(s):e.flaggedReplies=n.reject(e.flaggedReplies,function(e){return e===s})),null!==e.flagCount&&(t?e.flagCount++:e.flagCount--)},_showDropdownReasonSelection:function(n,o){var t,i;e._hideReasonDropdown(),e.reasonDropdown=new c({$reply:n,model:o}),e.reasonDropdown.on("flagreason:submit",e._handlePostFlagFromDropdown),e.reasonDropdown.on("flagreason:cancel",e._hideReasonDropdown),e.reasonDropdown.render(),o.set({flaggingInProgress:!0}),e.reasonDropdown.$el.appendTo(n),t=e.reasonDropdown.$el,s(window).scrollTop()+window.innerHeight-t.height()<t.offset().top&&(i=t.offset().top-t.height(),s("body").scrollTo(i,{duration:"slow"}))},_showModalReasonSelection:function(t,n){e.reasonModal=new l({$reply:t,model:n}),e.reasonModal.on("flagreason:cancel",function(){i.close()}),e.reasonModal.on("flagreason:submit",e._handlePostFlagFromModal),i.create(e.reasonModal,{name:"flagreason",className:"reveal-modal kinja-modal sticky-modal bottom full-width"})},_handlePostFlagFromDropdown:function(t,s){var n=t.model;t.$("a,input").addClass("disabled"),n.once("change:flagged",e._hideReasonDropdown),e._flagPost(t.options.$reply,n,s)},_handlePostFlagFromModal:function(t,s){var n=t.model;t.$("a,input").addClass("disabled"),n.once("change:flagged",function(){i.close()}),e._flagPost(t.options.$reply,n,s)},_hideReasonDropdown:function(){n.isUndefined(e.reasonDropdown)||(e.reasonDropdown.options.model.set({flaggingInProgress:!1}),e.reasonDropdown.remove(),e.reasonDropdown=void 0)},API:{flaggedRepliesLoaded:function(){return e.flaggedRepliesLoaded},flagCountLoaded:function(){return e.flagCountLoaded},flaggedReplies:function(){return e.flaggedReplies},flagCount:function(){return e.flagCount},openFlagView:function(n,s){t.requireLogin("flagPost").done(function(){r.isSmall()?e._showModalReasonSelection(n,s):e._showDropdownReasonSelection(n,s)})},unflag:function(n,s){t.requireLogin("unflagPost").done(function(){e._flagPost(n.view.$el,s)})},loadFlaggedReplies:function(n){t.onAuth.done(function(){t.isLoggedIn()&&e._loadFlaggedReplies(n)})},loadFlagCount:function(n){t.onAuth.done(function(){var s=d.getKinjaMeta().blog.id;t.isLoggedIn()&&(t.isSuperuser()&&a.isOn("superuser")||t.hasRole("OWNER",s)||t.hasRole("ADMIN",s))?e._loadFlagCount(n):e.flagCountLoaded.reject()})},extendPostModel:function(t){e.flaggedRepliesLoaded.done(function(){e._mergePostModelWithFlagInfo(t)})}}};return window.__karma__&&(e.API.__testonly__=e),e.API}),define("app/post/posttools/view/posttools.flagview",["app/post/posttools/view/posttools.menuitemview","module/flagging/ReplyFlaggingModule"],function(e,t){"use strict";var n=e.extend({modelEvents:{"change:flagged":"_flaggedChanged","change:flaggingInProgress":"_flaggedChanged"},permissions:[],events:{click:"_onFlagClicked"},_flaggedChanged:function(){this.render()},_canShow:function(){return this.model.get("flagged")!==!0},_isDisabled:function(){return this.model.get("flaggingInProgress")===!0},_onFlagClicked:function(e){e.preventDefault();var n=this.$el.parents(".js_reply");t.openFlagView(n,this.model)}});return n}),define("app/post/posttools/view/posttools.unflagview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({modelEvents:{"change:flagged":"_flaggedChanged","change:flaggingInProgress":"_flaggedChanged"},permissions:[],triggers:{click:"posttools:unflag"},_flaggedChanged:function(){this.render()},_canShow:function(){return this.model.get("flagged")===!0},_isDisabled:function(){return this.model.get("flaggingInProgress")===!0}});return t}),define("app/post/posttools/view/reposttools.unscheduleview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";return e.extend({permissions:["canSharePost"],triggers:{click:"reposttools:unschedule"}})}),define("app/post/posttools/view/posttools.pupilview",["jquery","underscore","app/post/posttools/view/posttools.menuitemview"],function(n,s,e){"use strict";var t=e.extend({permissions:["canPromote"],triggers:{click:"posttools:pupil"}});return t}),define("templates/tiger/components/post/meta/post-dropdown",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,n,t){e.components.post.meta.postDropdown=function(n,c,s){var a="",r=n.post.defaultBlogId!=(null==n.blog?null:n.blog.id)&&"POSTACTION"==(null==n.post.meta?null:n.post.meta.typ),o=null!=(null==n.blog?null:n.blog.name)?null==n.blog?null:n.blog.name:n.post.defaultBlogName,i=null!=(null==n.blog?null:n.blog.displayName)?null==n.blog?null:n.blog.displayName:o;return a+='<ul id="dropdown-'+t.$$escapeHtmlAttribute(n.post.id)+'" class="f-dropdown proxima js_post-dropdown js_follow-controls js_user-follow-controls whitelisted-links" data-postid="'+t.$$escapeHtmlAttribute(n.post.id)+'" data-starterid="'+t.$$escapeHtmlAttribute(n.post.starterId)+'" data-authorid="'+t.$$escapeHtmlAttribute(n.post.author.id)+'" data-blogid="'+t.$$escapeHtmlAttribute(n.post.authorBlogId)+'" data-sourceblogid="'+t.$$escapeHtmlAttribute(null==n.blog?null:n.blog.id)+'" data-dropdown-content>'+("reply"==n.mode?'<li class="js_edit-reply hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.actions.write(null,null,s)+"Edit</a></li>":'<li class="js_edit-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.actions.write(null,null,s)+"Edit</a></li>")+(r?'<li class="js_kinja-unshare hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.essential.externalLink(null,null,s)+"Unshare</a></li>":'<li class="js_delete-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.essential.close(null,null,s)+"Delete</a></li>")+("DRAFT"!=n.post.status?e.components.invites.menuItems.invitePostDropdownItems(null,null,s):"")+("reply"==n.mode&&"profilepage"!=n.pageType?'<li data-analytics-target="groupChat" class="js_followforuser hover-icon readonly-hide" onclick="window.ga(\'send\', \'event\', \'Group Chats\', \'click\', \'Drop down - follow user click\');"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.essential.add(null,null,s)+"Follow "+t.$$escapeHtml(n.post.authorBlogName)+'</a></li><li class="js_unfollowforuser hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.essential.checkmark(null,null,s)+"Unfollow "+t.$$escapeHtml(n.post.authorBlogName)+"</a></li>"+("private"!=n.pageType&&"dashboard"!=n.pageType?'<li class="js_followforblog js_approveforblog hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+(s.features.approvemessage?e.icons.essential.add(null,null,s)+"Approve "+t.$$escapeHtml(n.post.authorBlogName)+" on "+t.$$escapeHtml(i):e.icons.essential.add(null,null,s)+"Follow "+t.$$escapeHtml(n.post.authorBlogName)+" for "+t.$$escapeHtml(o))+'</a></li><li class="js_unfollowforblog js_unapproveforblog hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+(s.features.approvemessage?e.icons.essential.checkmark(null,null,s)+"Remove "+t.$$escapeHtml(n.post.authorBlogName)+" from "+t.$$escapeHtml(i)+" approve list":e.icons.essential.checkmark(null,null,s)+"Unfollow "+t.$$escapeHtml(n.post.authorBlogName)+" for "+t.$$escapeHtml(o))+"</a></li>":""):"DRAFT"!=n.post.status?'<li class="js_promote hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.essential.starCircle(null,null,s)+"Promote</a></li>":"")+("DRAFT"!=n.post.status&&"dashboard"!=n.pageType?"<li class=\"js_dismiss hover-icon hide readonly-hide\"><a href=\"#\" class=\"dismiss icon--svg u-darkened--onhover u-prepended\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Dismiss click');\">"+e.icons.actions.userRemove(null,null,s)+"Dismiss</a><a href=\"#\" class=\"undismiss icon--svg u-darkened--onhover u-prepended\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Undismiss click');\">"+e.icons.actions.userRemove(null,null,s)+'Undismiss</a></li><li class="js_block hover-icon hide disabled readonly-hide" data-blogid="'+t.$$escapeHtmlAttribute(n.post.defaultBlogId)+'" data-targetblogid="'+t.$$escapeHtmlAttribute(n.post.authorBlogId)+'" data-targetblogname="'+t.$$escapeHtmlAttribute(o)+'" data-targetauthorname="'+t.$$escapeHtmlAttribute(n.post.author.displayName)+'"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.actions.disabled(null,null,s)+"<span>Block for "+t.$$escapeHtml(o)+'</span></a></li><li class="js_hide-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.actions.disabled(null,null,s)+"Hide</a></li>":"")+("permalink"==n.pageType&&"DRAFT"!=n.post.status?("reply"==n.mode?'<li class="js_flag-post hover-icon readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.actions.flag(null,null,s)+'Flag</a></li><li class="js_unflag-post unflag-post hover-icon readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+e.icons.actions.flag(null,null,s)+"Unflag</a></li>":s.features.pupil_rating?'<li class="js_pupil-rules-block"><a class="js_pupil-rules hover-icon icon--svg u-darkened--onhover u-prepended" href="#" rel="nofollow">'+e.icons.actions.writePaper(null,null,s)+"Open Pupil Rules</a></li>":"")+'<li class="js_kinja-share-block readonly-hide"><a class="js_kinja-share hover-icon icon--svg u-darkened--onhover u-prepended" href="#" rel="nofollow">'+e.icons.essential.externalLink(null,null,s)+'Share to Kinja</a></li><li class="js_go-to-permalink"><a class="hover-icon icon--svg u-darkened--onhover u-prepended" href="'+t.$$escapeHtmlAttribute(t.$$filterNormalizeUri(n.post.permalink))+"\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Drop down - Go to permalink click');\">"+e.icons.essential.link(null,null,s)+"Go to permalink</a></li>":"")+("dashboard"==n.pageType&&"reply"==n.mode&&"DRAFT"!=n.post.status?'<li class="js_block readonly-hide" data-blogid="'+t.$$escapeHtmlAttribute(n.post.defaultBlogId)+'" data-targetblogid="'+t.$$escapeHtmlAttribute(n.post.authorBlogId)+'" data-targetblogname="'+t.$$escapeHtmlAttribute(o)+'" data-targetauthorname="'+t.$$escapeHtmlAttribute(n.post.author.displayName)+"\"><a href=\"#\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Block User click');\" class=\"icon--svg u-darkened--onhover u-prepended\">"+e.icons.essential.close(null,null,s)+"Block user for blog</a></li>":"")+"</ul>"},n.DEBUG&&(e.components.post.meta.postDropdown.soyTemplateName="tiger.components.post.meta.postDropdown"),e.components.post.meta.postDropdownTrigger=function(s,o,n){return'<a href="#" target="_self" class="post-dropdown-trigger js_post-menu-toggler icon--svg u-highlighted--onhover" data-dropdown="dropdown-'+t.$$escapeHtmlAttribute(s.post.id)+"\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Drop down click');\">"+(n.features.newstream?e.icons.essential.toolsGiant(null,null,n):e.icons.essential.chevronBottom(null,null,n))+"</a>"},n.DEBUG&&(e.components.post.meta.postDropdownTrigger.soyTemplateName="tiger.components.post.meta.postDropdownTrigger")}),define("app/post/posttools/posttools.menuview",["jquery","underscore","backbone","backbone.marionette","singleton/CurrentUser","singleton/CurrentBlog","singleton/EventDispatcher","singleton/Utils","app/post/mixins/post.userPermissions","app/post/posttools/view/posttools.editview","app/post/posttools/view/posttools.editreplyview","app/post/posttools/view/posttools.deleteview","app/post/posttools/view/posttools.invitemanuallyview","app/post/posttools/view/posttools.dismissview","app/post/posttools/view/posttools.promoteview","app/post/posttools/view/posttools.blockview","app/post/posttools/view/posttools.hideview","app/post/posttools/view/posttools.kinjashareview","app/post/posttools/view/posttools.kinjaunshareview","app/post/posttools/view/posttools.externalshareview","app/post/posttools/view/posttools.flagview","app/post/posttools/view/posttools.unflagview","app/post/posttools/view/reposttools.unscheduleview","app/post/posttools/view/posttools.pupilview","templates/tiger/components/post/meta/post-dropdown"],function(s,e,m,o,l,r,a,t,c,n,d,u,h,i,f,p,g,v,b,j,y,_,w,O){"use strict";var x=["profilepage","dashboard","manageblog"],C=o.ItemView.extend(e.extend({},c,{menuItemViewClasses:{".js_pupil-rules":O,".js_-post":n,".js_edit-post":n,".js_edit-reply":-1===e.indexOf(x,t.getKinjaMeta().pageType)?d:n,".js_delete-post":u,".js_invite-to-post-manually":h,".js_dismiss":i,".js_promote":f,".js_block":p,".js_hide-post":g,".js_kinja-share":v,".js_kinja-unshare":b,".js_external-share":j,".js_flag-post":y,".js_unflag-post":_,".js_unschedule-repost":w},events:{"requested.fndtn.dropdown .js_post-menu-toggler":"onPosttoolsRequested"},triggers:{"opened.fndtn.dropdown .js_post-dropdown":"posttools:opened"},menuItemViews:[],permissions:["userIsSuper","canEditPost","canPromote","canDismissPost","canSharePost"],initialize:function(e){a.on("blog:block:success"+this.model.id,this.render,this),this.blockedBlogCollection=e.blockedBlogCollection},_instantiateMenuItemViewClasses:function(t){return t=t||this.$el,Object.keys(this.menuItemViewClasses).reduce(function(n,s){var o=t.find(s),i=e.partial(this._createMenuItemClass.bind(this),s);return o.length?n.concat(e.map(o,i)):n}.bind(this),[])},_createMenuItemClass:function(e,n){var o=this.menuItemViewClasses[e],t={el:s(n),model:this.model};return".js_block"===e&&(t.collection=this.blockedBlogCollection),new o(t)},_bindEvents:function(){l.onAuthStateChange(this._refreshMenu.bind(this))},_refreshMenu:function(){var n="permalink"===t.getKinjaMeta().pageType,e=this,s=function(){return e.$("li:not(.hide)").length};e._renderMenuItems(),e.trigger("posttools:menuview:togglehidden",!n&&!s())},_renderMenuItems:function(){this.menuItemViews.call("render")},_captureMenuItemEvents:function(){this.menuItemViews.call("on","all",this.trigger,this)},_adjustMenuHeight:function(){var t,e=this.$(".js_post-dropdown"),n=s(window.document).height(),o=this.$el.offset().top,i=n-o-e.height();0>i&&(t=n-o,e.height(t+"px"),e.addClass("scroll"))},onPosttoolsOpened:function(){e.isEmpty(this.menuItemViews)?this.listenToOnce(this,"posttools:content:render",this.onPosttoolsOpened):(this.menuItemViews.call("triggerMethod","posttools:opened"),this._adjustMenuHeight())},onPosttoolsRequested:function(s,e){var n=o.Renderer.render(tiger.components.post.meta.postDropdown,{post:this.model.toJSON(),mode:"reply",pageType:t.getKinjaMeta().pageType,blog:r});e.resolve(n),this.onContentRender()},render:function(){var e="permalink"===t.getKinjaMeta().pageType;return this.onContentRender(),e&&this.trigger("posttools:menuview:togglehidden",!1),this},onContentRender:function(){var e;this.menuItemViews.length||(e=this._instantiateMenuItemViewClasses(),this.menuItemViews=new m.ChildViewContainer(e),this._captureMenuItemEvents()),this._renderMenuItems(),this._bindEvents(),this.trigger("posttools:content:render")}}));return C}),define("app/post/posttools/controller/posttools.dismiss.controller",[],function(){"use strict";var e={API:{dismiss:function(e){e.setAction("dismiss",e.get("defaultBlogId"),{success:function(){e.trigger("posttools:post:dismissed"),e.trigger("annotation:remove")}.bind(this),error:function(e){throw new Error("PostTools.dismissPost(): "+e.reason)}})},undismiss:function(e){e.setAction("actionreset",e.get("defaultBlogId"),{success:function(){e.trigger("posttools:post:undismissed")}.bind(this),error:function(e){throw new Error("PostTools.undismissPost(): "+e.reason)}})}}};return e.API}),define("collection/blog.subscribersCollection",["config","underscore","backbone","singleton/CurrentUser"],function(e,t,n,s){"use strict";var o=n.Collection.extend({idCache:[],initialize:function(t,e){if(!e||e&&(!e.blogId||!e.type))throw new Error("Missing options for BlogSubscribersCollection");this.type=e.type,this.blogId=e.blogId,e.userId&&(this.userId=e.userId),void 0!==e.withNames&&(this.withNames=e.withNames),this.enableShortening=e.enableShortening||!1,this.on("add remove request sync",function(){this.idCache=[]})},parse:function(n){var o=this,s=n&&n.data?n.data:null,e=[];return s&&(e=this.withNames?s.map(function(e){return t.isUndefined(e.id)&&(e.id=e.authorId?e.defaultBlogId:e.blogId),e.sourceBlogId=o.blogId,e}):s.map(function(e){return{id:e}})),this.enableShortening===!0&&e.length>1e3&&(e=e.slice(e.length-1e3,e.length),this.shortened=!0),e},sync:function(r,o,c){var i,a;switch(this.idCache=[],r){case"read":switch(a="GET",o.type){case"followed":i=this.withNames?e.api.profile.url+"/blogfollow/views/followedByWithNames?blogId="+o.blogId:e.api.profile.url+"/blogfollow/views/followedBy?blogId="+o.blogId;break;case"followers":i=e.api.profile.url+"/blogfollow/views/followersOf?blogId="+o.blogId;break;case"followedUsers":i=e.api.profile.url+"/userfollow/views/followedUsers?userId="+o.userId+"&token="+s.get("token");break;case"followedBlogs":i=e.api.profile.url+"/userfollow/views/followedBlogs?userId="+o.userId+"&token="+s.get("token");break;case"blocked":i=this.withNames?e.api.profile.url+"/blogblock/views/byBlogWithNames?blogId="+o.blogId:e.api.profile.url+"/blogblock/views/byBlog?blogId="+o.blogId;break;default:throw new Error("blog.subscribersCollection.sync(): unsupported method in sync")}break;default:throw new Error("blog.subscribersCollection.sync(): unsupported method in sync")}return n.ajax(t.extend({type:a,dataType:"json",url:i},c))},getIds:function(){var e=this.idCache.length;return e&&e===this.length?this.idCache:this.pluck("id")}});return o}),define("templates/tiger/messages/postAction",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,t,n){e.messages.postAction.areYouSureToDelPost=function(){return"Are you sure you want to delete this post?"},t.DEBUG&&(e.messages.postAction.areYouSureToDelPost.soyTemplateName="tiger.messages.postAction.areYouSureToDelPost"),e.messages.postAction.confirmHidePost=function(){return"Are you sure you want to hide this?"},t.DEBUG&&(e.messages.postAction.confirmHidePost.soyTemplateName="tiger.messages.postAction.confirmHidePost"),e.messages.postAction.confirmDismissPost=function(){return"Are you sure you want to dismiss this reply?"},t.DEBUG&&(e.messages.postAction.confirmDismissPost.soyTemplateName="tiger.messages.postAction.confirmDismissPost"),e.messages.postAction.confirmBlockBlog=function(e){return""+("block"==e.action?"Are you sure you want to block "+n.$$escapeHtml(e.username)+" on "+n.$$escapeHtml(e.sitename)+"?":"Are you sure you want to unblock "+n.$$escapeHtml(e.username)+" on "+n.$$escapeHtml(e.sitename)+"?")},t.DEBUG&&(e.messages.postAction.confirmBlockBlog.soyTemplateName="tiger.messages.postAction.confirmBlockBlog"),e.messages.postAction.selfBlockError=function(){return"You should not block yourself."},t.DEBUG&&(e.messages.postAction.selfBlockError.soyTemplateName="tiger.messages.postAction.selfBlockError"),e.messages.postAction.blogBockMember=function(){return"Can't block a member of the blog."},t.DEBUG&&(e.messages.postAction.blogBockMember.soyTemplateName="tiger.messages.postAction.blogBockMember"),e.messages.postAction.postReposted=function(e){return"Shared to "+n.$$escapeHtml(e.blogName)+'. <a href="'+n.$$escapeHtmlAttribute(n.$$filterNormalizeUri(e.blogUrl))+'">View &raquo;</a>'},t.DEBUG&&(e.messages.postAction.postReposted.soyTemplateName="tiger.messages.postAction.postReposted"),e.messages.postAction.postScheduledRepost=function(){return"Your post has been scheduled to publish."},t.DEBUG&&(e.messages.postAction.postScheduledRepost.soyTemplateName="tiger.messages.postAction.postScheduledRepost"),e.messages.postAction.repostRemoved=function(){return"Post successfully un-shared from this blog (it may take 1-2 minutes for it to stop displaying)"},t.DEBUG&&(e.messages.postAction.repostRemoved.soyTemplateName="tiger.messages.postAction.repostRemoved"),e.messages.postAction.unsharePost=function(){return"Removed share"},t.DEBUG&&(e.messages.postAction.unsharePost.soyTemplateName="tiger.messages.postAction.unsharePost"),e.messages.postAction.areYouSureToUnschedRepost=function(){return"Are you sure you want to unschedule this repost?"},t.DEBUG&&(e.messages.postAction.areYouSureToUnschedRepost.soyTemplateName="tiger.messages.postAction.areYouSureToUnschedRepost"),e.messages.postAction.postDeleted=function(){return"The post has been deleted successfully."},t.DEBUG&&(e.messages.postAction.postDeleted.soyTemplateName="tiger.messages.postAction.postDeleted"),e.messages.postAction.repostUnscheduled=function(){return"The repost has been unscheduled successfully."},t.DEBUG&&(e.messages.postAction.repostUnscheduled.soyTemplateName="tiger.messages.postAction.repostUnscheduled"),e.messages.postAction.postRecommended=function(){return"You recommended a post."},t.DEBUG&&(e.messages.postAction.postRecommended.soyTemplateName="tiger.messages.postAction.postRecommended"),e.messages.postAction.undoDismissMsg=function(){return"You have successfully dismissed this reply."},t.DEBUG&&(e.messages.postAction.undoDismissMsg.soyTemplateName="tiger.messages.postAction.undoDismissMsg"),e.messages.postAction.undoBlockMsg=function(e){return"You have successfully dismissed this reply and blocked "+n.$$escapeHtml(e.userName)+" from "+n.$$escapeHtml(e.blogName)},t.DEBUG&&(e.messages.postAction.undoBlockMsg.soyTemplateName="tiger.messages.postAction.undoBlockMsg"),e.messages.postAction.undoResolveMsg=function(){return"You have successfully resolved the flag on this reply."},t.DEBUG&&(e.messages.postAction.undoResolveMsg.soyTemplateName="tiger.messages.postAction.undoResolveMsg")}),define("app/post/posttools/controller/posttools.block.controller",["jquery","singleton/CurrentUser","singleton/EventDispatcher","collection/blog.subscribersCollection","templates/tiger/messages/postAction"],function(t,n,s,o){"use strict";var e={_blogsBlockedHash:{},_postIsBlocked:function(e,t){return-1!==t.indexOf(e.get("authorBlogId"))},_blockBlog:function(o,t){var i,a=t.targetBlogId,r=t.confirmation,s=t.blockedBlogCollection,l=o.get("defaultBlogId"),d=t.targetBlogName,u=t.targetAuthorName,c=t.forceAction;"undefined"!=typeof c?(i=c,n.set("forceAction",c)):i=e._postIsBlocked(o,t.blockedBlogIds)?"unblock":"block",("boolean"==typeof r&&r||r({action:i,username:u,sitename:d}))&&n.setBlogAction(i,l,a,{success:function(r){var t,e=n.get("forceAction");r?"block"===i?(s.add({id:a}),s.trigger("posttools:block"),o.trigger("posttools:block")):(t=s.findWhere({id:a}),t&&s.remove(t),s.trigger("posttools:unblock"),o.trigger("posttools:unblock")):("block"===e||"unblock"===e)&&(s.trigger("posttools:"+e),o.trigger("posttools:"+e))},error:function(s,t){var n;switch(t.code){case"BLOG_BLOCK_MEMBER":n=tiger.messages.postAction.blogBockMember;break;default:n=t?t.message:s.reason}e._showErrorMessage(n)}})},_blockedBlogsInitialized:function(n){var s;return e._blogsBlockedHash.hasOwnProperty(n)||(e._blogsBlockedHash[n]=e.API.getBlockedBlogCollection(n)),e._blogsBlockedHash[n].fetched?(s=t.Deferred(),s.resolve(e._blogsBlockedHash[n]),s):(e._blogsBlockedHash[n].fetched=!0,e._blogsBlockedHash[n].fetch())},_showErrorMessage:function(e){s.trigger("successbox:display",{message:e,warningBox:!0,dismissable:!0})},API:{block:function(n,s,d,r,c,l){var i,a=n.get("defaultBlogId"),o=n.get("authorBlogId");return a===o?(e._showErrorMessage(tiger.messages.postAction.selfBlockError),!1):void t.when(e._blockedBlogsInitialized(a)).then(function(){i={targetBlogId:o,blockedBlogIds:s.getIds(),blockedBlogCollection:s,confirmation:d,targetBlogName:r,targetAuthorName:c,forceAction:l},e._blockBlog(n,i)})},getBlockedBlogCollection:function(t){return e._blogsBlockedHash.hasOwnProperty(t)||(e._blogsBlockedHash[t]=new o([],{blogId:t,type:"blocked",withNames:!1})),e._blogsBlockedHash[t]},checkBlockStatus:function(n,s){var o=n.get("defaultBlogId");t.when(e._blockedBlogsInitialized(o)).then(function(){n.trigger("posttools:blockStatusUpdated",e._postIsBlocked(n,s.getIds()))})}}};return window.__karma__&&(e.API.__testonly__=e),e.API}),define("app/post/mixins/post.successMessage",["singleton/Renderer","singleton/EventDispatcher"],function(e,t){"use strict";var n={_displaySuccessMessage:function(n,s){t.trigger("successbox:display",{message:e.renderTemplate(n,s||{})})},_displayChannelMessage:function(n,s){t.trigger("successbox:display",{message:e.renderTemplate(n,s||{}),timeout:5e3})}};return n}),define("app/post/posttools/controller/posttools.like.controller",["jquery","underscore","singleton/CurrentUser","module/KinjaAnalytics","singleton/Utils","app/post/mixins/post.successMessage","templates/tiger/messages/postAction"],function(s,n,o,i,t,a){"use strict";var e={};return e=n.extend(e,a,{_trackRecommendation:function(s,n){var e,r=s.get("isStarter")?"Post":"Comment",o="sharingBottom"===n.$el.attr("data-analytics-target"),a="groupChat"===n.$el.parent().attr("data-analytics-target"),c="permalink"===t.getKinjaMeta().pageType;window.ga("send","event","Recommendation",r+" Recommended",s.get("permalink")),(!c||o||a)&&(t.getKinjaMeta().pageType===t.pageTypes.frontpage?e="homepage":t.getKinjaMeta().pageType===t.pageTypes.dashboard?e="dashboard":o?e="sharingBottom":a&&(e="groupChat"),i.pushEvent("RECOMMENDATION","POST",n.model.get("id"),{uiElement:e}))},_likePost:function(t,o){var i=t.get("liked")?"unlike":"like",a=t.setLike(i,{success:function(s){if("like"===i&&(e._trackRecommendation(t,o),e._displaySuccessMessage(tiger.messages.postAction.postRecommended),!t.get("isStarter")&&!t.get("approved"))){var a=n.pluck(s.response.approvalResult.approvedReplies,"postId"),r=o.model.get("id");-1!==n.indexOf(a,r)&&o.model.set({approved:!0})}},error:function(e){throw new Error("PostTools.likePost(): "+e.reason)}}),r=function(){t.trigger("posttools:post:likeCount:updated")};s.when(a).then(r)},API:{like:function(t,n){return!!s("body").hasClass("read-only")||void o.requireLogin("likePost").done(function(){e._likePost(t,n)})}}}),e.API}),define("apiclient/post",["config","apiclient/apirequest","apiclient/gettoken","singleton/Feature"],function(o,t,e,n){"use strict";var i,s=n.isOn("postsecuretoken")?o.api.core.secureUrl+"/post":o.api.core.url+"/post";return i={create:t.postJson(e.append(s+"/add",n.isOn("postsecuretoken")?e.secure:e.fresh,!0)),read:t.getJson(e.append(s+"/preview/{{id}}",n.isOn("postsecuretoken")?e.secure:e.fresh)),update:t.postJson(e.append(s+"/{{id}}/update",n.isOn("postsecuretoken")?e.secure:e.fresh,!0)),delete:t.postJson(e.append(s+"/{{id}}/delete",n.isOn("postsecuretoken")?e.secure:e.fresh,!0)),generatePostJson:function(o){return t.postJson(e.append(s+o,n.isOn("postsecuretoken")?e.secure:e.fresh,!0))},socialStats:t.getJson(o.api.core.url+"/dfp/post/{{id}}/stats")}}),define("model/post/Post",["config","jquery","backbone","underscore","singleton/CurrentUser","singleton/Utils","apiclient/gettoken","apiclient/post"],function(a,e,o,t,i,u,c,d){"use strict";var n=e("<div />"),l=function(e){var s,t=e.getHours(),n=e.getMinutes(),o=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear();return 10>t&&(t="0"+t),10>n&&(n="0"+n),s=t+":"+n,{MdyHm:[o,s].join(" ")}},s={dateTimeFormat:/^\d{1,2}\/\d{1,2}\/\d{4} \d{1,2}:\d{2}$/,chompImgType:/img\.gawkerassets\.com\/img\/(\w+)\/[\w-]+\./g},r=o.Model.extend({constructor:function(e){window.__postModelStorage=window.__postModelStorage||{};var t,s,n=window.__postModelStorage,i=void 0!==e&&void 0!==e.id&&void 0!==n,a={};if(i&&void 0!==n[e.id]){for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&(a[t]=e[t]);return s=n[e.id],s.set(a),s}o.Model.prototype.constructor.apply(this,arguments),i&&(n[e.id]=this)},initialize:function(){s=e.extend(s,{mediaInPost:new RegExp("<("+this.mediaTags.join("|")+")","gim")})},storeInMemory:function(){var e=window.__postModelStorage||{},t=void 0!==this.id&&void 0!==e;return t&&void 0!==e[this.id]?e[this.id].set(this.attributes):e[this.id]=this,this},mediaTags:["img","embed","object","iframe","video","audio","canvas"],defaults:{promoteState:{},publishTime:l(new Date),blogs:new o.Collection,liked:!1},validationRules:{PUBLISHTIME_IS_REQUIRED:function(e){var t=!0;return"SCHEDULED"!==e.status||e.publishTimeMillis||(t=!1),t},POST_CONTENT_IS_REQUIRED:function(t){var o=!0,i=t.headline&&e.trim(n.html(t.headline)),a=t.original&&e.trim(n.html(t.original).text()),r=t.original&&(s.mediaInPost.test(t.original)||n.html(t.original).find("img").length),c=t.hasFile||t.files&&t.files.length;return i||a||r||c||(o=!1),o},POST_CONTENT_CANNOT_CONTAIN_BAD_CONTENT:function(t){var e=!0,s=["form"].join("");return n.html(t.original).find(s).length&&(e=!1),e}},savePipeline:e.Deferred().resolve(),publishTime:function(e){return l(e)},sync:function(r,n,s){var o,i,a,l,u,h;if("create"!==r&&(void 0===n.id||null===n.id))throw new Error("Post.sync(): Model undefined");switch(n.attributes.meta={},"undefined"!=typeof n.attributes.status&&(n.attributes.meta.status=n.attributes.status),"undefined"!=typeof n.attributes.allowReplies&&(n.attributes.meta.allowReplies=n.attributes.allowReplies),"undefined"!=typeof n.attributes.showByline&&(n.attributes.meta.showByline=n.attributes.showByline),"undefined"!=typeof n.attributes.byline&&(n.attributes.meta.byline=n.attributes.byline),"undefined"!=typeof n.attributes.properties&&(n.attributes.meta.properties=n.attributes.properties),r){case"create":i="POST",a=n.has("parentId")&&""!==n.get("parentId")?"/api/core/post/"+n.get("parentId")+"/jsonReplyWithApproval":"/api/core/post/add",u=JSON.stringify(n);break;case"read":i="GET",a=void 0!==s.preview&&s.preview===!0?"/api/core/post/preview/"+n.id:void 0!==s.showcase&&s.showcase===!0?"/api/core/post/showcase/"+n.id:"/api/core/post/"+n.id;break;case"update":i="POST",a="/api/core/post/"+n.id+"/update",u=JSON.stringify(n);break;case"delete":i="POST",a="/api/core/post/"+n.id+"/delete"}return l={type:i,dataType:"json",contentType:"application/json",url:a,data:u||null},o=e.Deferred(),h=o.promise(),c.secure().done(function(i){l.url=l.url+"?token="+i,"delete"===r?d[r]({id:n.id},s).done(o.resolve).fail(o.reject):e.ajax(t.extend(l,s)).done(o.resolve).fail(o.reject)}),h},parse:function(t){if(void 0===t)throw new Error("Post.parse(): no response to parse");var e={};return e=t.data?t.data:t,void 0!==e.id&&null!==e.id&&(e.id=parseInt(e.id,10)),e.tagDescriptions=e.tags.map(function(e){return e.description}),e.images&&e.images.length&&(e.images=[]),e},toFormData:function(){var n=["id","headline","original","tags","publishTimeMillis","publishTimeZone","status","blogId","defaultBlogId","annotation.annotationType","annotation.imageUrl","annotation.imageChompId","annotation.imageWidth","annotation.imageHeight","annotation.x","annotation.y","annotation.annotationText","annotation.annotationTextHash","allowReplies","sponsored","showByline","byline","salesAvatar","salesAvatarMap","share","properties","shareBlogId","sharedPostId","images","parentId","adZone"],e=["status","allowReplies","showByline","byline","properties"],s=function(s){var n=s[0],o=s[1];return-1!==t.indexOf(e,n)&&(n="meta."+n),[n,o]},o=t.pick(this.toJSON(),t.union(n,t.map(e,function(e){return"meta."+e}))),i=t.object(t.pairs(o).map(s));return i},getUrl:function(){return void 0!==this.get("permalink")?this.get("permalink"):"/"+this.id},getActionState:function(){var t=e.Deferred();return this.has("actionState")?t.resolve():this.getPostInfo().done(function(){t.resolve()}),t.promise()},getPostInfo:function(t){var n,s=this,o=parseInt(this.id,10);if(!i.isLoggedIn())throw new Error("Post.getPostInfo(): user not logged in");return t=t||{},t.success=t.success||function(){},n=[a.api.core.url,"/post/",o,"/actionstatus?token=",i.get("token")].join(""),e.ajax({type:"GET",dataType:"jsonp",jsonp:"jsonp",url:n,success:function(e){200===e.meta.status&&(s.setActionState(e.data),t.success.call(s))}})},isPublished:function(){return"PUBLISHED"===this.get("status")},setAction:function(e,t,n){var s,o={};if(!e||"repost"!==e&&"dismiss"!==e&&"actionreset"!==e)throw new Error("Post:setAction(): Invalid post action: "+e);if(!t)throw new Error("Post:setAction(): Invalid blogId: "+t);return s="repost"===e?a.api.core.url+"/post/"+this.id+"/"+e+"/"+t:"/ajax/post/"+this.id+"/"+e+"/"+t,"repost"===e&&n.publishTimeMillis&&(o.repostTime=n.publishTimeMillis),this.setLikeOrAction(n,e,s,o)},setLikeOrAction:function(t,a,r,s){var n,o,l,d;return t=t||{},s=s||{},t.success=t.success||function(){},t.error=t.error||function(){},i.isLoggedIn()||t.error.call(this,{reason:"user"}),o=e.Deferred(),d=o.promise(),n=this,c.fresh().done(function(i){s.token=i,l="repost"===a?{url:r+"?"+e.param(s),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:"{}"}:{url:r+"?"+e.param(s),type:"POST"},e.ajax(l).done(function(e){void 0!==e.meta?"repost"===a||"dismiss"===a||"actionreset"===a?(n.setActionState(e.data),t.success.call(n,{response:e.data})):(n.setLikeState(e.data),t.success.call(n,{response:e.data})):t.error.call(n,{reason:"action error"}),o.resolve()}).fail(function(e){t.error.call(this,e.responseJSON,e.status,e.statusText),o.reject(e.responseJSON,e.status,e.statusText)})}),d},setActionState:function(n){var e={};t.each(n,function(t){e[t.blogId]=t.relation.toLowerCase()},this),this.set({actionState:e})},setLike:function(e,s){var n,o=["like","unlike"];if(!e||!t.contains(o,e))throw new Error("Post:setLike(): Invalid post action: "+e);return"like"===e&&(e+="AndApprove"),n="likeAndApprove"!==e?["/api/core/post",this.id,e].join("/"):["/ajax/post",this.id,e].join("/"),this.setLikeOrAction(s,e,n)},setLikeState:function(n){var e=n||{},t=e.like||e;void 0!==t.objectId&&t.objectId===this.get("id")?this.set({liked:!0}):this.set({liked:!1})},prepareAnnotations:function(){if(this.has("annotation")){var t=this.get("annotation"),n=e().text(t.annotationText),s=170;void 0===t.annotationShortText&&n.length>s&&(t.annotationShortText=u.cut(n,s))}return this},parseFromDom:function(e){var t=JSON.parse(decodeURIComponent(e.data("model")));return new r(t)},replaceImagesWithOriginal:function(){var e=this.get("display");return this.set("display",e.replace(s.chompImgType,"img.gawkerassets.com/img/$1/original.")),this},validate:function(){var e=[],n=this.toJSON();return n.mode&&t.each(this.validationRules,function(t,s){t(n)||e.push({error:"CLIENT_VALIDATION_ERROR",reason:s})},this),!!e.length&&e},getShareOptionsForUser:function(o){var i=e.Deferred(),n=[],a=[],r=[],s=o.get("defaultBlogId"),c=!1;return this.getActionState().done(function(){t.each(this.get("actionState"),function(e,t){"repost"===e&&n.push(parseInt(t,10))}),c=-1!==t.indexOf(n,s),o.get("membership").each(function(e){e.get("blogId")===s||"ENABLED"!==e.get("blog").status&&"SPAM"!==e.get("blog").status||(-1!==t.indexOf(n,e.get("blog").id)?r.push({name:e.get("blog").displayName,id:e.get("blog").id}):a.push({name:e.get("blog").displayName,id:e.get("blog").id}))},this),i.resolve({repostedTo:n,repostedToPersonal:c,personalBlogId:s,blogsUndo:r,blogsRepost:a})}.bind(this)),i.promise()}});return r}),define("app/post/posttools/controller/posttools.hide.controller",["config","jquery","singleton/Feature","singleton/CurrentUser","model/post/Post"],function(t,n,s,e,o){"use strict";var i={API:{hide:function(a,c){var l=a.get("id"),d=t.api.core.url+"/post/"+l+"/hide?token="+e.get("token"),i=null,r="/";e.isSuperuser()&&s.isOn("superuser")&&c()&&(a.has("parentId")&&(i=new o({id:a.get("parentId")}),r=i.has("permalink")?i.get("permalink"):"/"+i.id),n.ajax({url:d,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){void 0!==e.meta&&e.meta.success===!0&&window.setTimeout(function(){window.location.href=r},1e3)}}))}}};return i.API}),define("templates/tiger/components/fullscreen-spinner",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.fullscreenSpinner=function(n,s,t){return'<div class="loading-full animate"><div class="loading-message-box">'+e.components.spinner.bounce(null,null,t)+"</div></div>"},t.DEBUG&&(e.components.fullscreenSpinner.soyTemplateName="tiger.components.fullscreenSpinner")}),define("view/Spinner",["jquery","view/BaseView","templates/tiger/components/spinner","templates/tiger/components/fullscreen-spinner"],function(e,t){"use strict";var n=t.extend({visible:!0,fullscreen:!1,tagName:"div",className:"spinner-wrapper",initialize:function(e){this.visible=void 0===e.initiallyVisible||e.initiallyVisible,this.fullscreen=void 0!==e.fullscreen&&e.fullscreen,this.render()},render:function(){var t;return this.visible&&(t=this.fullscreen?this.soyToHtml(tiger.components.fullscreenSpinner):this.soyToHtml(tiger.components.spinner.bounce,{})),this.$el.html(t),this.fullscreen?e(this.el).find(".animate").addClass("in"):e(this.el).addClass("with-margin"),this}});return n}),define("apiclient/repost",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";return{unschedule:t.postJson(n.append(e.api.core.url+"/blog/{{blogId}}/removeRepostJob/{{postId}}")),reschedule:t.postJson(n.append(e.api.core.url+"/blog/{{blogId}}/updateRepostJob/{{postId}}?repostTime={{repostTime}}"))}}),define("app/post/posttools/posttools.controller",["jquery","underscore","singleton/CurrentUser","singleton/EventDispatcher","singleton/Feature","singleton/Utils","singleton/util/loadEditor","module/KinjaAnalytics","view/BaseView","app/post/common/post.layout","app/post/mixins/post.confirmationPrompt","app/post/posttools/posttools.menuview","app/post/posttools/controller/posttools.dismiss.controller","app/post/posttools/controller/posttools.block.controller","app/post/posttools/controller/posttools.like.controller","app/post/posttools/controller/posttools.hide.controller","module/flagging/ReplyFlaggingModule","app/post/mixins/post.successMessage","app/MarionetteApp","view/Spinner","apiclient/repost","templates/tiger/messages/postAction"],function(c,n,t,i,m,o,h,u,s,l,d,_,r,a,f,p,g,v,b,j,y){"use strict";var e=n.extend({},d,v,{_openSpinnerUntil:function(s,t){t=n.defaults({},{fullscreen:!0});var e=new j(t);return e.$el.appendTo("body"),c.when(s).then(e.remove.bind(e))},_like:function(e){e.model.get("tags")&&e.model.get("tags").length&&m.isOn("channels")&&!e.model.get("liked")&&b.vent.trigger("add:channel",{channelName:e.model.get("tags")[0].name,url:e.model.get("tags")[0].urlName}),f.like(e.model,e.view)},_reply:function(){require(["module/DiscussionModule"],function(e){e.replyToStarterPost()})},_dismiss:function(t){e._confirmationPrompt(tiger.messages.postAction.confirmDismissPost)&&r.dismiss(t.model)},_undismiss:function(e){r.undismiss(e.model)},_getDismissState:function(e){e.model.getActionState()},_delete:function(a){var t,i=a.model,r=this,c="dashboard"===o.getKinjaMeta().pageType||"manageblog"===o.getKinjaMeta().pageType;e._confirmationPrompt(tiger.messages.postAction.areYouSureToDelPost)&&(i.on("destroy",function(){r._displaySuccessMessage(tiger.messages.postAction.postDeleted),t=function(){window.location=c?window.location.pathname:s.prototype.cachebuster.call(s.prototype,"/")},n.delay(t,2e3)}),i.destroy({wait:!0}))},_unscheduleRepost:function(t){var i=this,a=t.view.el.getAttribute("data-postid"),r=t.view.el.getAttribute("data-blogid"),c=function(){window.location="private"===o.getKinjaMeta().pageType?window.location.pathname:s.prototype.cachebuster.call(s.prototype,"/")},l=function(){i._displaySuccessMessage(tiger.messages.postAction.repostUnscheduled),n.delay(c,2e3)};e._confirmationPrompt(tiger.messages.postAction.areYouSureToUnschedRepost)&&y.unschedule({postId:a,blogId:r}).done(l)},_promote:function(e){var n=e.model.id,s=t.hasPermission("SALES")||t.isSuperUser(),o=window.location.port?"http://kinja.dev:9000":"http://kinja.com";s&&(window.location.href=o+"/dfp/promotions/"+n)},_checkBlockStatus:function(e){a.checkBlockStatus(e.model,e.collection)},_postIsBlocked:function(e,t){return-1!==t.indexOf(e.get("authorBlogId"))},_block:function(t){var n=function(t){return e._confirmationPrompt(tiger.messages.postAction.confirmBlockBlog,t)};a.block(t.model,t.collection,n,t.targetBlogName,t.targetAuthorName)},_hide:function(t){var n=function(){return e._confirmationPrompt(tiger.messages.postAction.confirmHidePost)};p.hide(t.model,n)},_unflag:function(e){g.unflag(e,e.model)},_kinjaShare:function(e){var n;t.requireLogin("kinjaSharePost").done(function(){n=function(){return h().then(function(t){t.sharePost(e)})},e.has("original")?this._openSpinnerUntil(n()):this._openSpinnerUntil(e.fetch({success:n,preview:"PUBLISHED"!==e.get("status")}).then(n)),u.pushEvent("SHARE","POST",e.get("id"),{uiElement:"dropdown"})}.bind(this))},_externalShare:function(s){var e=s.view.$(".js_share-post-item"),o=e.attr("href"),i={twitter:"toolbar=0,status=0,width=480,height=360",facebook:"toolbar=0,status=0,width=480,height=360",tumblr:"toolbar=0,status=0,width=450,height=430"},t=n.intersection(e.attr("class").split(/\s+/),["twitter","facebook","tumblr"])[0];window.open(o,"share"+t,i[t])},_repost:function(s,e){var o="repost",i=this,n=t.get("membership").find(function(t){return t.get("blogId")===parseInt(e,10)});s.setAction(o,e,{success:function(){i._displaySuccessMessage(tiger.messages.postAction.postReposted,{blogName:n.get("blog").displayName,blogUrl:"http://"+n.get("blog").canonicalHost})},error:function(e){throw new Error("PostTools.repostPost(): "+e.reason)}})},_undoRepost:function(e){var t="actionreset",n=e.targetBlogId,s=e.model,o=this;s.setAction(t,n,{success:function(){o._displaySuccessMessage(tiger.messages.postAction.repostRemoved)},error:function(e){throw new Error("PostTools.undoRepost(): "+e.reason)}})},_openPupilModal:function(){var e=c.Deferred();return require(["app/pupil/PupilController"],function(t){t.show().then(e.resolve.bind(e))}.bind(this)),this._openSpinnerUntil(e)},_bindEvents:function(n,e){n.on("posttools:like",this._like.bind(this)),n.on("posttools:reply",this._reply.bind(this)),e.on("posttools:dismiss",this._dismiss.bind(this)),e.on("posttools:undismiss",this._undismiss.bind(this)),e.on("posttools:getDismissState",this._getDismissState.bind(this)),e.on("posttools:delete",this._delete.bind(this)),e.on("posttools:promote",this._promote.bind(this)),e.on("posttools:block",this._block.bind(this)),e.on("posttools:checkBlockStatus",this._checkBlockStatus.bind(this)),e.on("posttools:hide",this._hide.bind(this)),e.on("posttools:unflag",this._unflag.bind(this)),e.on("posttools:kinjaShare",this._kinjaShare.bind(this)),e.on("posttools:externalShare",this._externalShare.bind(this)),e.on("posttools:repost",this._repost.bind(this)),e.on("posttools:undorepost",this._undoRepost.bind(this)),e.on("close",function(){t.off(null,null,e),i.off(null,null,e),e.model.off(null,null,e)}),e.on("posttools:menuview:togglehidden",function(e){n.togglePostToolsVisibility(e)}),e.on("reposttools:unschedule",this._unscheduleRepost.bind(this)),e.on("posttools:pupil",this._openPupilModal.bind(this))},API:{startPostTools:function(c,n){var d="undefined"!=typeof n.get("defaultBlogId")?n.get("defaultBlogId"):o.getKinjaMeta().blog.id,s=new _({el:c.find(".js_post-dropdown-ct"),model:n,blockedBlogCollection:a.getBlockedBlogCollection(d)}),r=new l({el:c,model:n});r.post.attachView(s),r.bindUIElements(),r.updateUserState(),e._bindEvents(r,s),i.on("posttools:close:"+n.get("id"),function(){s.close()}),t.onAuth.done(s.render.bind(s))},closePostTools:function(e){i.trigger("posttools:close:"+e)},bindEvents:function(t,n){e._bindEvents(t,n)}}});return e.API}),define("view/PostView",["jquery","underscore","view/BaseView","singleton/PostInsetTools","singleton/Utils","singleton/EventDispatcher","singleton/Feature","app/post/posttools/posttools.controller","view/SuccessBox"],function(e,n,i,a,t,r,s,o,c){"use strict";var l=i.extend({postTool:null,events:{"click .lazy-gif.thawable":"thawImage"},initialize:function(){this.$(".item-content").on("click",this.navigateToArticle.bind(this)),this.$(".js_read-more").on("click",this.gaTrackClick.bind(this)),this.$(".js_entry-title").on("click",this.gaTrackClick.bind(this)),this.$(".js_meta-byline a").on("click",this.gaTrackClick.bind(this)),this.$(".js_marquee-asset a").on("click",this.gaTrackClick.bind(this)),this.$(".js_publish_time").on("click",this.gaTrackClick.bind(this)),this.handleCustomIframes()},start:function(){return o.startPostTools(this.$el,this.model),"permalink"===t.getKinjaMeta().pageType&&(s.isOn("webpack")?require.ensure(["gawkerlib/lightboxer","lib/amd-wrapped/jquery.lightbox-0.5"],function(e){var t=e("gawkerlib/lightboxer");t(this.$el)}.bind(this)):require(["gawkerlib/lightboxer","lib/amd-wrapped/jquery.lightbox-0.5"],function(e){e(this.$el)}.bind(this))),this.fixMarkup(),e.cookie("editor_warnings")&&this.showEditorWarnings(),this},showEditorWarnings:function(){var t,i,o=JSON.parse(e.cookie("editor_warnings")),a=/(http(s)?:\/\/[a-zA-Z0-9-_]+\.[a-zA-Z]+(.)+)+/gi,r=o.length;o&&(e.removeCookie("editor_warnings"),n.each(o,function(e,n){t=e.message.match(a),i=e.message.replace(a,"");var o=new c({message:i+'<br/><a href="'+t+'" target="_blank">'+t+"</a>",permanent:!0,warningBox:!0,hidden:s.isOn("editor_warnings_collapsed")&&n>0});o.render(),s.isOn("editor_warnings_collapsed")&&0===n&&r>1&&o.attachMoreWarningsBox(r)}))},fixMarkup:function(){if("permalink"!==this.getPageType())return!1;var t=this;n.each(this.$el.find(".referenced ~ .content-ad"),function(n){var t=e(n);t.appendTo(t.prev())}),this.$el.find("blockquote .inset_placeholder").each(function(){e(this).closest("blockquote").before(this)}),a.render(this.$el),this.$el.find(".js_reel").each(function(){t.createReel(this)}),this.$el.find(".js_slider").each(function(){var n=e(this),s=n.attr("data-uri1"),o=n.attr("data-uri2"),i=n.attr("data-percent");t.renderSlider(n,s,o,i)})},renderSlider:function(a,p,f,m){function r(t,n){var e=n-t;return 6>e&&(e=6),e>630&&(e=630),e}function c(e,t,n,s){s&&(t.stop().animate({width:e},0),n.stop().animate({right:628-e},0))}var n,l=640*m*.01,g=t.imageUrl(p,"k-bigpic"),u=t.imageUrl(f,"k-bigpic"),h=e('<div id="sliderBottom" style="background-image: url('+u+');"></div>'),i=e('<div id="sliderTop" style="background-image: url('+g+');"></div>'),o=e('<div id="sliderArrows"></div>'),s=!1,d=a.offset().left;a.html('<div id="slider"></div>').append(h,i,o),n=a.find("#slider"),i.stop().animate({width:l},1e3),o.stop().animate({right:628-l},1e3),n.bind("mousedown touchstart",function(e){s=!0;var t=r(d,e.pageX);return c(t,i,o,s),n.bind("mousemove touchmove",function(e){var t=r(d,e.pageX);c(t,i,o,s)}),!1}).bind("mouseup touchend",function(){s=!1,n.stop()}).mouseleave(function(){s=!1,n.stop()})},remove:function(){o.closePostTools(this.model.get("id"))},render:function(){return this},createReel:function(u){var t,n,s=e(u),d=636,h=Math.round(d/(16/9)),a=[],i={},c=s.data("url"),l=s.data("cols"),o=s.data("rows"),r=e('<img class="greel" src="'+c+'A00.jpg" alt="" width="'+d+'" height="'+h+'" />');for(s.append(r),n=0;o>n;n++)for(t=0;l>t;t++)a.push(String.fromCharCode(n+65)+(10>t?"0":"")+t+".jpg");i={frames:l,path:c,images:a,cw:!0,revolution:{x:300,y:100},inversed:!0,suffix:"",wheelable:!1},1!==o&&(i.rows=o),require(["lib/amd-wrapped/jquery.reel"],function(){r.one("load",function(){e(this).reel(i)})})},truncatePostText:function(s,o){var a=o?"":"&hellip;",n=s||320,i=this.$el.find(".read-more").detach(),e=this.$el.find("p.first-text");e.text().length>n&&e.html(t.cutHtml(e.html(),n,a)),e.append(i)},truncateWidePostText:function(e,t){this.$el.parent().hasClass("wide")&&this.truncatePostText(e,t)},navigateToArticle:function(n){if(2!==n.button){var s,o=e(n.target);if(!o.parents(".thumb-inset").length&&!o.closest(".js_post-menu-toggler").length&&!o.closest("a").attr("href")){if(s=this.$(".js_read-more").attr("href"),this.gaTrackClick(),1===n.button||n.ctrlKey||n.metaKey||"dashboard"===t.getKinjaMeta().pageType)return window.open(s,"_blank"),!1;window.location=s}}},thawImage:function(t){t.preventDefault(),r.trigger("thawImage",{$el:e(t.target)})},gaTrackClick:function(){var t=n.indexOf(e(".post-list .js_post_item"),this.$el[0])+1;t>0&&23>t&&window.ga("send","event","Front page click","Front page post click","position - "+t)},handleCustomIframes:function(){var t=e("iframe.custom.aspect");t.each(function(){var t=e(this);t.data("aspectRatio",t.height()/t.width()).removeAttr("height").removeAttr("width")}),t.length&&e(window).resize(function(){t.each(function(){var t=e(this),n=t.parent().width();t.width(n).height(n*t.data("aspectRatio"))})}).resize()}});return l}),define("view/posttools/ApproveToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","model/post/Post","singleton/CurrentUser","singleton/CurrentBlog"],function(s,e,i,a,r,t,n){"use strict";var o,c;return o=function(n,s,t){return e.map(s,function(e){var s=t?'[data-sourceblogid="'+t+'"]':"";return"."+n+'[data-blogid="'+e+'"]'+s}).join(", ")},c=a.extend({events:{"click .js_followforblog":"followUserForBlog","click .js_unfollowforblog":"unfollowUserForBlog"},initialize:function(){var n=e.debounce(this.update,1e3);t.onAuthStateChange(n.bind(this)),this.on("update",n,this)},update:function(n){var o;return n=n||{},o=n.el||s("body"),t.onAuth.done(function(){if(t.isLoggedIn()){var i=function(e){return parseInt(s(e).data("blogid"),10)},n=o.find(".js_follow-controls"),a=e.without(e.unique(e.map(n,i)),void 0);this.updateBlogFollows(a,n)}}.bind(this)),this},updateBlogFollows:function(s,o){var i=function(o){(t.hasRole("AUTHOR",o)||t.isSuperuser())&&n.getFollowedBlogIds().done(function(){var t=e.intersection(n.followedBlogIds,s),i=e.difference(s,t);this.updateFollowState(t,"follow",o),this.updateFollowState(i,"unfollow",o)}.bind(this))};e.chain(o).union([n.id]).unique().compact().each(i,this)},followUserForBlog:function(e){var t=s(e.currentTarget).closest(".js_follow-controls");return i.pushEvent("FOLLOW","USER",t.data("blogid"),{uiElement:"groupChat"}),this.followReplyAction("blogfollow",e),!1},unfollowUserForBlog:function(e){return this.followReplyAction("unfollow",e),!1},followReplyAction:function(i,h){var a,l,c=s(h.currentTarget).closest(".js_follow-controls"),u=c.data("postid"),o=c.data("blogid"),d=function(){var s=n.id;return o!==t.get("defaultBlogId")&&void t.setBlogAction(i,s,o,{success:function(t){var s;a=new r({id:u}),"blogfollow"===i&&!a.get("isStarter")&&!a.get("approved")&&t.data&&t.data.approvedReplies&&(l=e.pluck(t.data.approvedReplies,"postId"),c.closest(".js_reply").trigger("approval",{approvedReplyIDs:l})),s="unfollow"===i?e.without(n.followedBlogIds,o):e.union(n.followedBlogIds,[o]),n.followedBlogIds=s,this.update()}.bind(this),error:function(e){throw new Error("PostTools.followBlog(): "+e.reason)}})}.bind(this);t.requireLogin("blogFollowTool").done(function(){d()})},updateFollowState:function(e,t,n){this.updateFollowControls(e,t,n)},updateFollowControls:function(n,e,i){var a=o("js_follow-controls",n,i);this.$(a).each(function(r,i){var o=s(i),a=parseInt(o.data("blogid"),10),n=t.get("defaultBlogId")===a;o.find(".js_followforblog").toggleClass("hide","follow"===e||n).end().find(".js_unfollowforblog").toggleClass("hide","unfollow"===e||n)})},removeControls:function(e){e=e||s("body"),e.find(".js_followforblog, .js_unfollowforblog").addClass("hide")}})}),define("view/posttools/UserFollowToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","singleton/CurrentUser"],function(e,n,o,i,t){"use strict";var s,a;return s=function(e,t){return n.map(t,function(t){return"."+e+'[data-authorid="'+t+'"]'}).join(", ")},a=i.extend({events:{"click .js_followforuser":"followUserForUser","click .js_unfollowforuser":"unfollowUserForUser"},initialize:function(){var e=n.debounce(this.update,1e3);t.onLoggedIn.done(e.bind(this)),this.on("update",e,this)},update:function(n){var s,o;return n=n||{},o=n.el||e("body"),s=t.get("followedAuthorIds"),this.toggleMarker(s,"follow"),this.updateUserFollows(s,"follow"),this},updateUserFollows:function(i,o){var a=s("js_user-follow-controls",n.without(i,t.id)),r=e('.js_user-follow-controls[data-authorid="'+t.id+'"]');r.find(".js_followforuser, .js_unfollowforuser").addClass("hide"),e(a).find(".js_followforuser").toggleClass("hide","follow"===o).end().find(".js_unfollowforuser").toggleClass("hide","unfollow"===o)},followUserForUser:function(e){return this.userfollowAction(e),!1},unfollowUserForUser:function(e){return this.userunfollowAction(e),!1},userfollowAction:function(s){var a=e(s.currentTarget).closest(".js_user-follow-controls"),n=a.attr("data-authorid"),i=e(s.currentTarget).attr("data-analytics-target");i&&o.pushEvent("FOLLOW","USER",n,{uiElement:i}),t.requireLogin("userfollow").done(function(){t.followUser(n).done(function(){this.toggleMarker([n],"follow"),this.updateUserFollows([n],"follow")}.bind(this))}.bind(this))},userunfollowAction:function(s){var o=e(s.currentTarget).closest(".js_user-follow-controls"),n=o.attr("data-authorid");t.requireLogin("authorunfollow").done(function(){t.unfollowUser(n).done(function(){this.toggleMarker([n],"unfollow"),this.updateUserFollows([n],"unfollow")}.bind(this))}.bind(this))},toggleMarker:function(e,t){var n=s("js_author",e);this.$(n).toggleClass("followed","follow"===t)},resetControls:function(t){t=t||e("body"),t.find(".js_followforuser").removeClass("hide"),t.find(".js_unfollowforuser").addClass("hide")},removeAvatarMarker:function(t){t=t||e("body"),t.find(".js_author").removeClass("followed")},removePlaceholderBtn:function(t){t=t||e("body"),t.find(".js_list-control__empty").addClass("hide")}})}),define("apiclient/likestate",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";var s;return s={getForPosts:t.getJson(n.append(e.api.core.url+"/like/status"),{}),getForStarter:t.getJson(n.append(e.api.core.url+"/like/{{starterId}}"),{})}}),define("singleton/PostHelper",["jquery","underscore","singleton/CurrentUser","model/post/Post","apiclient/likestate"],function(t,e,n,s,o){"use strict";var i={parsePostModelDataFromDom:function(e){return JSON.parse(decodeURIComponent(e.data("model")))},parseFromDom:function(n){var i,o=[];return i=e.isUndefined(n)?t("body").find(".js_post_item, .js_reply, .js_event_item"):n.is(".js_post_item, .js_reply, .js_event_item")?n:n.find(".js_post_item, .js_reply, .js_event_item"),e.each(i,function(i){var e=t(i),n={};void 0!==e.data("model")?(n=this.parsePostModelDataFromDom(e),o.push({model:new s(n),node:e})):void 0!==e.data("id")&&o.push({model:new s({id:e.data("id")}),node:e})},this),o},likeStatusFor:function(t){var s=e.map(t,function(e){return e.model.id});n.onAuth.done(function(){return!!(n.isLoggedIn()&&s)&&void o.getForPosts({id:s},{traditional:!0}).done(function(n){e.each(n,function(n){var o=n.objectId,s=e.find(t,function(e){return e.model.id===o});s&&s.model.setLikeState(n)})})}.bind(this))},getContentType:function(e){return e.get("contentType")}};return i}),define("app/mixins/PostViewLoader",["jquery","underscore","view/PostView","view/posttools/ApproveToolView","view/posttools/BlogFollowToolView","view/posttools/UserFollowToolView","singleton/PostHelper"],function(e,n,s,o,i,a,t){"use strict";var r={followtool:null,initPostTools:function(){var t=e("body");this.on("update.postlist.post",this.addPosts,this),this.userfollowtool=new a({el:t}),this.blogfollowtool=new i({el:t}),this.approvetool=new o({el:t}),this.on("update.follows",this.addFollowButtons,this),this.addPosts({el:e("body")})},addFollowButtons:function(e){this.userfollowtool.trigger("update",{el:e.el}),this.blogfollowtool.trigger("update",{el:e.el}),this.approvetool.trigger("update",{el:e.el})},addPosts:function(o){var i,a;o=o||{},a=o.el||e("body"),i=t.parseFromDom(a),n.each(i,function(e){var t=new s({model:e.model,el:e.node});t.start(),o.callback&&o.callback.call(this,t)},this),i.length>0&&t.likeStatusFor(i),this.addFollowButtons({el:a})}};return r}),define("apiclient/recommendation",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";return{recommendPost:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/recommendAsset")),unrecommendPost:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/unrecommendAsset"))}}),define("templates/tiger/components/post/button/recommend-button",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.post.button.recommendButton=function(n,a,s){var o="",i=n.assetId?n.assetId:"";return o+='<a href="#" class="recommend js_recommend '+e.$$escapeHtmlAttribute(n.type)+"-recommend js_"+e.$$escapeHtmlAttribute(n.type)+"-recommend "+(n.isActive?" active ":"")+' readonly-hide icon--svg" data-asset-source="'+e.$$escapeHtmlAttribute(n.assetSource)+'" data-asset-id="'+e.$$escapeHtmlAttribute(i)+'"'+(n.isRecommendable?'title="Recommend':"video"==n.type?'title="Recommend (WARNING: Minimum recommended front page video thumbnail size is 640×360. This video has a smaller thumbnail. Visual degradation may occur.)':'title="Recommend (WARNING: Minimum recommended front page image size is 640×360. This '+e.$$escapeHtmlAttribute(n.type)+" is smaller. Visual degradation may occur.)")+'">'+t.icons.essential.star(null,null,s)+"</a>"},n.DEBUG&&(t.components.post.button.recommendButton.soyTemplateName="tiger.components.post.button.recommendButton")}),define("app/mixins/RecommendAssetMixin",["jquery","underscore","singleton/EventDispatcher","singleton/Utils","view/BaseView","model/post/Post","apiclient/recommendation","templates/tiger/components/post/button/recommend-button","templates/tiger/messages"],function(t,e,n,o,i,a,s){"use strict";var r=i.extend({initialize:function(e){this.model=e.model,this.assets=this.filterAssets(this.model),this.renderUI()},filterAssets:function(t){var n=e.compact(e.map(t.get("images"),this.filterAndCreateImageObject,this)),s=e.compact(e.map(t.get("videos"),this.createVideoObject,this));return n.concat(s)},filterAndCreateImageObject:function(t){var n,s;return n=null!==t.id?t.id:"",s=n?this.$('[data-chomp-id="'+n+'"]'):this.$('[src="'+(null!==t.src?t.src:"")+'"]'),e.extend(t,{$el:s,type:"image"})},createVideoObject:function(t){var n=t.src.split("#")[0],s=this.$('[data-recommend-id="'+n+'"]');return e.extend(t,{$el:s,type:"video"})},recommendAsset:function(t,e){var n=e?"image://"+String(e):t;return s.recommendPost({postId:this.model.get("id"),assetUri:n}).then(this.updateAssetsData.bind(this)).then(this.renderUI.bind(this))},unrecommendAsset:function(t,e){var n=e?"image://"+String(e):t;return s.unrecommendPost({postId:this.model.get("id"),assetUri:n}).then(this.updateAssetsData.bind(this)).then(this.renderUI.bind(this))},updateAssetsData:function(e){var t=new a(e);this.assets=this.filterAssets(t)},renderUI:function(){this.$(".js_post_item").find(".js_recommend").remove(),this.renderRecommendButtons(),this.bindRecommendEvents()},renderRecommendButtons:function(){e.each(this.assets,function(e){this.renderRecommendButton(e)},this)},renderRecommendButton:function(e){var n,o=tiger.components.post.button.recommendButton,i={isActive:e.recommended,type:e.type,assetId:void 0!==e.id?String(e.id):"",assetSource:e.src||e.uri,isRecommendable:this.calcRecommendability(e)},s=this.soyToHtml(o,i);switch(e.type){case"image":n=e.$el.closest(".img-border"),0===n.length&&(n=e.$el.closest(".columns"),t(s).addClass("marquee-recommend-btn"));break;case"video":n=e.$el.closest(".flex-video")}n.append(s)},calcRecommendability:function(e){var n=!1,t=o.getKinjaMeta();return n=e.thumbnails&&e.thumbnails.length?e.thumbnails[0].width>=t.imageSizes.KinjaExtraLarge.width:e.width>=t.imageSizes.KinjaExtraLarge.width},displayRecommendMessage:function(){n.trigger("successbox:display",{message:tiger.messages.assetRecommended})},displayUnrecommendMessage:function(){n.trigger("successbox:display",{message:tiger.messages.assetUnrecommended})},bindRecommendEvents:function(){this.$(".js_post-wrapper").off("click",".js_recommend"),this.$(".js_post-wrapper").on("click",".js_recommend",this.recommendClickHandler.bind(this))},recommendClickHandler:function(n){var e=t(n.currentTarget);return this.handleRecommendation(e.data("asset-source"),e.data("asset-id")),!1},handleRecommendation:function(i,a){var s=e.find(this.assets,function(e){return e.recommended===!0}),o=null,r=null,n=null;s&&(o=s.src||s.uri,r=s.id),o?(n=t.when(this.unrecommendAsset(o,r)),o===i?n.then(this.displayUnrecommendMessage):e.delay(function(){n.then(this.recommendAsset(i,a)),n.then(this.displayRecommendMessage)}.bind(this),600)):(n=t.when(this.recommendAsset(i,a)),n.then(this.displayRecommendMessage))}});return{startRecommendAssetMixin:function(e){if(e){var t,n=e.has("images")&&e.get("images").length>0,s=e.has("videos")&&e.get("videos").length>0;(n||s)&&(t=new r({model:e,el:this.el}))}}}}),define("view/ImageLoader",["jquery","underscore","singleton/EventDispatcher","view/BaseView","singleton/Feature","lib/waypoints","lib/jquery.browser.mobile"],function(t,e,c,i,a){"use strict";var o=t(document),s=t(window),r={initialLookaheadFactor:.8,lookaheadFactor:2.6,containerClass:"lazy-image"},n="loaded",l=i.extend({$allWrappers:t(),$allImages:t(),_watchedImages:[],viewportHeight:0,scrollTop:0,initialize:function(t){this.options=e.defaults(t||{},r),e.bindAll(this,"loadIfVisible","handleScroll","handleScrollNew"),this.registerImages(this.$el),this.addScrollEvents(),c.on("rendered.postlist.reply",function(e){this.registerImages(e.el)}.bind(this))},registerImages:function(i){var n=this.options.containerClass,s=i.find("."+n),o=s.find("img, iframe");this.$allWrappers=this.$allWrappers.add(s),this.$allImages=this.$allImages.add(o),this._watchedImages=this._watchedImages.concat(e.map(o,function(n){var e=t(n);return[e,e.outerHeight(),e.offset().top]})),this.$allImages.each(function(o,s){var e=t(s);e.data("wrapper",e.closest("."+n))}),this.trigger("images:registered")},addScrollEvents:function(){var n=e.bind(function(){this.viewportHeight=t.waypoints("viewportHeight")},this);n(),s.resize(e.debounce(n,1e3)),a.isOn("imageloader")?(s.scroll(e.throttle(e.partial(this.handleScrollNew,this.options.lookaheadFactor),500)),this.handleScrollNew(this.options.initialLookaheadFactor)):(s.scroll(e.throttle(e.partial(this.handleScroll,this.options.lookaheadFactor),500)),this.handleScroll(this.options.initialLookaheadFactor))},loadImage:function(s){var e=t(s);e.data(n)||this.waitForPlaceholder(e)},reinitializeInterchange:e.once(function(){t(document).foundation("interchange")}),updateInterchange:e.throttle(function(){this.reinitializeInterchange(),t(document).foundation("interchange","reflow")},150),_loadImage:function(t){var s,o=t.data("src"),i=t.data("lazyInterchange");this.trigger("imageLoading",{$el:t}),s=e.bind(function(){t.off("load",s).addClass("lazy-loaded"),this.trigger("imageLoaded",{$el:t}),this._watchedImages=this._watchedImages.filter(function(e){return!t.is(e[0])})},this),t.load(s).data(n,!0),o?t.attr("src",o):i?(t.attr("data-interchange",i),this.updateInterchange()):t.load()},waitForPlaceholder:function(t){var n,s="await-placeholder",o=t.data("wrapper");o.hasClass("asset-loading")?t.data(s)||(t.data(s,!0),n=e.bind(function(){t.off("load",n),this._loadImage(t)},this),t.load(n)):this._loadImage(t)},loadIfVisible:function(e,t,s){!e.data(n)&&this.inViewPort(e,t,s)&&this.loadImage(e)},loadIfVisibleNew:function(e,t,s,o){!e.data(n)&&this.inViewPortNew(e,t,s,o)&&this.loadImage(e)},inViewPort:function(m,d,r,a){var e=this.scrollTop,i=a||this.options.lookaheadFactor,s=this.viewportHeight,n=s*i,c=e+s+n,l=e-n,t=Math.round(r),u=Math.round(t+d),h=u>l,o=c>t;return h&&o},inViewPortNew:function(m,d,r,a){var e=this.scrollTop,i=a||this.options.lookaheadFactor,s=this.viewportHeight,n=s*i,c=e+s+n,l=e-n,t=Math.round(r),u=Math.round(t+d),h=u>l,o=c>t;return h&&o},handleScrollNew:function(t){this._watchedImages.length&&(this.scrollTop=window.pageYOffset||o.scrollTop(),e.each(this._watchedImages,function(e){var n=e[0],s=e[1],o=e[2];this.loadIfVisibleNew(n,s,o,t)},this))},handleScroll:function(t){this._watchedImages.length&&(this.scrollTop=window.pageYOffset||o.scrollTop(),e.each(this._watchedImages,function(e){var n=e[0],s=e[1],o=e[2];this.loadIfVisible(n,s,o,t)},this))}});return l}),define("view/GifImageLoader",["jquery","underscore","singleton/EventDispatcher","singleton/Feature","view/ImageLoader","lib/jquery.browser.mobile","templates/tiger/components/spinner"],function(e,n,o,t,s){"use strict";var i,a={mobileGifs:!0,gifClass:"lazy-gif",thawableClass:"thawable",thawingClass:"thawing",thawedClass:"thawed"};return i=s.extend({initialize:function(e){n.extend(this.options,n.defaults(e||{},a)),this.addEvents(),this.on("images:registered",this.markImagesThawable),s.prototype.initialize.apply(this,arguments)},addEvents:function(){var s=this.options.gifClass,n=function(e){return e.data("wrapper").hasClass(s)};e.browser.mobile||(t.isOn("webm")||this.on("imageLoading",function(s){var t=s.$el,o=new Image,i=t.data("anim-src");n(t)&&e(o).attr("src",i)},this),this.on("imageLoaded",function(t){var e=t.$el;n(e)&&this.thawImage(e)},this)),o.on("thawImage",function(t){var e=t.$el;"IMG"!==e.prop("tagName")&&(e=e.find("img")),this.thawImage(e)},this)},markImagesThawable:function(){var t=this.options;e.browser.mobile&&t.mobileGifs&&this.$allWrappers.addClass(t.thawableClass)},thawImage:function(n){var s,o,i,a;t.isOn("webm")?(s=e("<video>"),a=s[0].canPlayType("video/webm")?n.data("webm-src"):n.data("mp4-src"),s.attr({autoplay:!0,controls:e.browser.mobile,loop:!0,muted:!0,src:a,poster:n.attr("src"),class:n.attr("class"),style:n.attr("style"),width:n.attr("width"),height:n.attr("height"),"data-chomp-id":n.data("chomp-id")}),s.data("wrapper",n.data("wrapper")),this.startLoadIndicator(s),n.replaceWith(s)):(o=n.data("animSrc")||n.data("assetUrl"),i=n.data("animInterchange"),this.startLoadIndicator(n),o&&n.attr("src",o),i&&(n.attr("data-interchange",i),this.updateInterchange()))},startLoadIndicator:function(a){var s=e(a),o=s.data("wrapper"),n=this.options,i=function(){o.removeClass(n.thawingClass).addClass(n.thawedClass),r.remove()},r=e(tiger.components.spinner.gifthaw()).appendTo(o);o.removeClass(n.thawableClass).addClass(n.thawingClass),s.load(i).error(i),t.isOn("webm")&&s.on("loadedmetadata",i)}})}),function(m){function s(m,f,p){var t=0,s=[0],o="",e=null,o=p||"UTF8";if("UTF8"!==o&&"UTF16"!==o)throw"encoding must be UTF8 or UTF16";if("HEX"===f){if(0!==m.length%2)throw"srcString of HEX type must be in byte increments";e=u(m),t=e.binLen,s=e.value}else if("TEXT"===f)e=h(m,o),t=e.binLen,s=e.value;else if("B64"===f)e=r(m),t=e.binLen,s=e.value;else{if("BYTES"!==f)throw"inputFormat must be HEX, TEXT, B64, or BYTES";e=d(m),t=e.binLen,s=e.value}this.getHash=function(m,f,e,h){var d,o=null,r=s.slice(),u=t;if(3===arguments.length?"number"!=typeof e&&(h=e,e=1):2===arguments.length&&(e=1),e!==parseInt(e,10)||1>e)throw"numRounds must a integer >= 1";switch(f){case"HEX":o=a;break;case"B64":o=i;break;case"BYTES":o=c;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-1"!==m)throw"Chosen SHA variant is not supported";for(d=0;e>d;d+=1)r=n(r,u),u=160;return o(r,l(h))},this.getHMAC=function(p,f,v,b,w){var e,m,g,y,_=[],j=[];switch(e=null,b){case"HEX":b=a;break;case"B64":b=i;break;case"BYTES":b=c;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-1"!==v)throw"Chosen SHA variant is not supported";if(m=64,y=160,"HEX"===f)e=u(p),g=e.binLen,e=e.value;else if("TEXT"===f)e=h(p,o),g=e.binLen,e=e.value;else if("B64"===f)e=r(p),g=e.binLen,e=e.value;else{if("BYTES"!==f)throw"inputFormat must be HEX, TEXT, B64, or BYTES";e=d(p),g=e.binLen,e=e.value}if(p=8*m,f=m/4-1,g/8>m){if("SHA-1"!==v)throw"Unexpected error in HMAC implementation";e=n(e,g),e[f]&=4294967040}else m>g/8&&(e[f]&=4294967040);for(m=0;f>=m;m+=1)_[m]=909522486^e[m],j[m]=1549556828^e[m];if("SHA-1"!==v)throw"Unexpected error in HMAC implementation";return v=n(j.concat(n(_.concat(s),p+t)),p+y),b(v,l(w))}}function h(i,a){var e,t,o=[],s=[],n=0;if("UTF8"===a)for(t=0;t<i.length;t+=1)for(e=i.charCodeAt(t),s=[],128>e?s.push(e):2048>e?(s.push(192|e>>>6),s.push(128|63&e)):55296>e||e>=57344?s.push(224|e>>>12,128|e>>>6&63,128|63&e):(t+=1,e=65536+((1023&e)<<10|1023&i.charCodeAt(t)),s.push(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|63&e)),e=0;e<s.length;e+=1)(n>>>2)+1>o.length&&o.push(0),o[n>>>2]|=s[e]<<24-n%4*8,n+=1;else if("UTF16"===a)for(t=0;t<i.length;t+=1)(n>>>2)+1>o.length&&o.push(0),o[n>>>2]|=i.charCodeAt(t)<<16-n%4*8,n+=2;return{value:o,binLen:8*n}}function u(s){var e,t,o=[],n=s.length;if(0!==n%2)throw"String of HEX type must be in byte increments";for(e=0;n>e;e+=2){if(t=parseInt(s.substr(e,2),16),isNaN(t))throw"String of HEX type contains invalid characters";o[e>>>3]|=t<<24-e%8*4}return{value:o,binLen:4*n}}function d(n){var e,s,t=[];for(e=0;e<n.length;e+=1)s=n.charCodeAt(e),(e>>>2)+1>t.length&&t.push(0),t[e>>>2]|=s<<24-e%4*8;return{value:t,binLen:8*n.length}}function r(t){var e,n,s,o,a,r=[],i=0;if(-1===t.search(/^[a-zA-Z0-9=+/]+$/))throw"Invalid character in base-64 string";if(n=t.indexOf("="),t=t.replace(/=/g,""),-1!==n&&n<t.length)throw"Invalid '=' found in base-64 string";for(s=0;s<t.length;s+=4){for(o=t.substr(s,4),e=a=0;e<o.length;e+=1)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(o[e]),a|=n<<18-6*e;for(e=0;e<o.length-1;e+=1)r[i>>2]|=(a>>>16-8*e&255)<<24-i%4*8,i+=1}return{value:r,binLen:8*i}}function a(s,o){var e,t,n="",i=4*s.length;for(e=0;i>e;e+=1)t=s[e>>>2]>>>8*(3-e%4),n+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return o.outputUpper?n.toUpperCase():n}function i(t,i){var e,n,o,s="",a=4*t.length;for(e=0;a>e;e+=3)for(o=(t[e>>>2]>>>8*(3-e%4)&255)<<16|(t[e+1>>>2]>>>8*(3-(e+1)%4)&255)<<8|t[e+2>>>2]>>>8*(3-(e+2)%4)&255,n=0;4>n;n+=1)s=8*e+6*n<=32*t.length?s+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-n)&63):s+i.b64Pad;return s}function c(t){var e,n,s="",o=4*t.length;for(e=0;o>e;e+=1)n=t[e>>>2]>>>8*(3-e%4)&255,s+=String.fromCharCode(n);return s}function l(t){var e={outputUpper:!1,b64Pad:"="};try{t.hasOwnProperty("outputUpper")&&(e.outputUpper=t.outputUpper),t.hasOwnProperty("b64Pad")&&(e.b64Pad=t.b64Pad)}catch(e){}if("boolean"!=typeof e.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof e.b64Pad)throw"Invalid b64Pad formatting option";return e}function e(e,t){return e<<t|e>>>32-t}function t(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function o(e,t,n,s,o){var i=(65535&e)+(65535&t)+(65535&n)+(65535&s)+(65535&o);return((e>>>16)+(t>>>16)+(n>>>16)+(s>>>16)+(o>>>16)+(i>>>16)&65535)<<16|65535&i}function n(m,h){var n,i,r,c,l,d,u,f,p,a=[],s=[1732584193,4023233417,2562383102,271733878,3285377520];for(m[h>>>5]|=128<<24-h%32,m[(h+65>>>9<<4)+15]=h,p=m.length,u=0;p>u;u+=16){for(l=s[0],i=s[1],r=s[2],c=s[3],d=s[4],n=0;80>n;n+=1)a[n]=16>n?m[n+u]:e(a[n-3]^a[n-8]^a[n-14]^a[n-16],1),f=20>n?o(e(l,5),i&r^~i&c,d,1518500249,a[n]):40>n?o(e(l,5),i^r^c,d,1859775393,a[n]):60>n?o(e(l,5),i&r^i&c^r&c,d,2400959708,a[n]):o(e(l,5),i^r^c,d,3395469782,a[n]),d=c,c=r,r=e(i,30),i=l,l=f;s[0]=t(l,s[0]),s[1]=t(i,s[1]),s[2]=t(r,s[2]),s[3]=t(c,s[3]),s[4]=t(d,s[4])}return s}"function"==typeof define&&define.amd?define("lib/sha1",[],function(){return s}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=s:exports=s:m.jsSHA=s}(this),define("gawkerlib/urlUtil",["underscore"],function(e){"use strict";var t={toQueryString:function(n){var t=e.reduce(n,function(e,t,n){return e.push(n+"="+encodeURIComponent(t)),e},[]).join("&");return t.length>0&&(t="?"+t),t},fromQueryString:function(t){return e.reduce(t.replace("?","").split("&"),function(t,n){return n.length>0&&e.extend(t,e.object([e.map(n.split("="),decodeURIComponent)])),t},{})}};return t}),define("module/discussion/discussion.channel",["backbone","underscore"],function(e,t){"use strict";return t.extend({},e.Events)}),define("view/sharingfooter.view",["jquery","underscore","backbone.marionette","singleton/WindowController","module/discussion/discussion.channel","app/post/posttools/controller/posttools.like.controller"],function(e,t,n,s,o,i){"use strict";var a=n.ItemView.extend({ui:{likeButton:".js_like",likeIcon:".js_like_icon",likeCountPlaceholder:".js_like_count",replyButton:".js_reply-to-post",replyCount:".js_reply-count",sharePostButton:".js_share-post-item"},modelEvents:{"change:liked":"_updateLikeIconClasses","posttools:post:likeCount:updated":"_updateLikeCount"},events:{"click a":function(e){e.preventDefault()},"click @ui.replyButton":"reply","click @ui.likeButton":"like","click @ui.sharePostButton":"externalShare","touchstart a":"onTouchStart","touchend a":"onTouchEnd"},onTouchStart:function(t){e(t.target).addClass("hovered")},onTouchEnd:function(t){window.setTimeout(function(){e(t.target).removeClass("hovered")},200)},reply:function(){var n=e(".replies-wrapper"),o=1e3;return s.isPartiallyVisible(n)||t.throttle(e.scrollTo(e(n),{duration:o,easing:"easeInOutQuad"}),o),!1},like:t.debounce(function(){return i.like(this.model,this),!1},300),externalShare:function(o){var n=e(o.currentTarget),i=n.attr("href"),a={twitter:"toolbar=0,status=0,width=480,height=360,top="+(window.screen.height/2-180)+",left="+(window.screen.width/2-240),facebook:"toolbar=0,status=0,width=480,height=360,top="+(window.screen.height/2-180)+",left="+(window.screen.width/2-240)},s=t.intersection(n.attr("class").split(/\s+/),["twitter","facebook"])[0];return window.open(i,"share"+s,a[s]),n.addClass("used"),!1},initialize:function(){e.easing.easeInOutQuad=function(o,e,t,n,s){return(e/=s/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t};var t=function(t){return e("<div/>").html(t).text()},n=function(e){return e?e.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(e)}):""},s=this.model.get("headline")||this.model.get("first100Characters")||this.model.get("compact");this.$(this.ui.sharePostButton).each(function(r,i){var o=e(i),a=o.attr("href");o.attr("href",a.replace("POST_TITLE",encodeURIComponent(t(n(s)))))}),this.listenTo(o,"newComment",this.updateCommentCount)},updateCommentCount:function(){var e=this.$(this.ui.replyCount);e.html(parseInt(e.html(),10)+1)},_updateLikeIconClasses:function(){this.$(this.ui.likeIcon).toggleClass("active",this.model.get("liked"))},_updateLikeCount:function(){var t=parseInt(e(".js_like.button-recommend-post").data("likecount"),10)||0;this.$(this.ui.likeCountPlaceholder).text(t||"0")}});return a}),define("lib/amd-wrapped/base64",[],function(){"use strict";function a(e){var n,o,s=[],t=0;for(e=encodeURI(e),o=e.length;o>t;)n=e[t],t+=1,"%"!==n?s.push(n.charCodeAt(0)):(n=e[t]+e[t+1],s.push(parseInt(n,16)),t+=2);return s}function s(n){for(var e,o,i,s=[],t=0,a=n.length;a>t;)e=n[t],o=n[t+1],i=n[t+2],128>e?(s.push(String.fromCharCode(e)),t+=1):e>191&&224>e?(s.push(String.fromCharCode((31&e)<<6|63&o)),t+=2):(s.push(String.fromCharCode((15&e)<<12|(63&o)<<6|63&i)),t+=3);return s.join("")}function o(r){var n,o="",s=a(r),i=s.length;for(n=0;i-2>n;n+=3)o+=e[s[n]>>2],o+=e[((3&s[n])<<4)+(s[n+1]>>4)],o+=e[((15&s[n+1])<<2)+(s[n+2]>>6)],o+=e[63&s[n+2]];return i%3&&(n=i-i%3,o+=e[s[n]>>2],i%3===2?(o+=e[((3&s[n])<<4)+(s[n+1]>>4)],o+=e[(15&s[n+1])<<2],o+=t):(o+=e[(3&s[n])<<4],o+=t+t)),o}function i(l){var a,c,e=0,d=[],o=0,i=0;for(e=0;e<l.length;e++)c=l.charCodeAt(e),a=r[127&c],-1===a?n("WARN: Illegal characters (code="+c+") in position "+e):(i=i<<6|a,o+=6,o>=8&&(o-=8,t!==l.charAt(e)&&d.push(i>>o&255),i&=(1<<o)-1));return o?(n("ERROR: Corrupted base64 string"),null):s(d)}var n=function(){},t="=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return window.console&&window.console.log&&(n=function(e){window.console.log(e)}),{encode:o,decode:i}}),define("module/promotions/promotions.model",["underscore","backbone","apiclient/post","lib/amd-wrapped/base64"],function(t,n,s,e){"use strict";var o=n.Model.extend({defaults:{starCount:0,replyCount:0,viewCount:0},initialize:function(){var e=this.get("id");"PROMOTION_SIDEBAR"===this.get("zoneType")&&s.socialStats({id:e}).done(function(e,t){200===t.status&&(this.set("starCount",e.likes),this.set("replyCount",e.replies),this.set("viewCount",e.views))}.bind(this))},parse:function(t){var n={postUrl:t.postUrl,dfpTracker:t.dfpTracker,version:t.version,headline:t.version>=12?e.decode(t.post_headline):t.post_headline,plaintext:t.post_plaintext,shortExcerpt:t.version>=12?e.decode(t.post_shortExcerpt):t.post_shortExcerpt,promotionByline:t.version>=12?e.decode(t.post_promotionByline):t.post_promotionByline,authorByline:t.version>=12?e.decode(t.post_authorByline):t.post_authorByline,permalinkPath:t.post_permalinkPath,trackingPixel:t.trackingPixel,publishTime:t.publishTime,hasReadMore:t.hasReadMore,sponsored:t.sponsored,author:t.author,headlineImage:t.headlineImage,id:t.postId,impressionTracker:t.impressionTracker,zoneType:t.zoneType};return n},toSoyData:function(){return{post:{id:this.get("id"),title:this.get("headline"),url:this.get("permalinkPath"),shortExcerpt:this.get("shortExcerpt"),authorByline:this.get("authorByline"),author:this.get("author"),sponsored:this.get("sponsored"),promotionByline:this.get("promotionByline"),headlineImage:this.get("headlineImage"),trackingPixel:this.get("trackingPixel"),publishTime:this.get("publishTime"),modelData:encodeURIComponent(JSON.stringify(t.clone(this.attributes)))}}}});return o}),define("templates/tiger/utils/crop-type",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,e,o,t,n){e.utils.cropType=function(e){return""+n.$$escapeHtml("centered"==e.name?"KinjaCentered":"uncropped"==e.name?"KinjaUncropped":"Kinja")},t.DEBUG&&(e.utils.cropType.soyTemplateName="tiger.utils.cropType"),e.utils.cropType__Ce4=function(e){return""+n.$$filterHtmlAttributes("centered"==e.name?"KinjaCentered":"uncropped"==e.name?"KinjaUncropped":"Kinja")},t.DEBUG&&(e.utils.cropType__Ce4.soyTemplateName="tiger.utils.cropType__Ce4")}),define("templates/tiger/components/promotions/post",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.promotions.post=function(n,c,s){var i,a='<article class="post hentry js_post_item status-published post-item-frontpage js_promoted" data-id="'+e.$$escapeHtmlAttribute(n.post.id)+'" id="post_'+e.$$escapeHtmlAttribute(n.post.id)+'" data-model="'+e.$$escapeHtmlAttribute(n.post.modelData)+'">'+t.components.promotions.head({headline:n.post.title,permalink:n.post.url,headerLevel:5},null,s)+'<div class="meta-container without-dropdown">'+t.components.promotions.meta(n,null,s)+t.components.promotions.postDropDownWrapper(n,null,s)+"</div>",o=0,r=""+(0==o?"large-12":1==o?"medium-9":2==o?"medium-6":"");return a+='<div class="row package standard-package"><div class="'+e.$$escapeHtmlAttribute(r)+' columns item-content hover-highlight entry-summary">'+t.components.promotions.mainMedia(n,null,s),i=""+t.components.promotions.readMore(n,null,s),a+=(n.post.shortExcerpt?e.$$filterNoAutoescape(n.post.shortExcerpt)+e.$$filterNoAutoescape(i):'<p class="first-text">'+e.$$filterNoAutoescape(n.post.plaintext)+e.$$filterNoAutoescape(i)+"</p>")+"</div></div>"+(n.post.trackingPixel?'<img style="position:absolute" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.trackingPixel))+'" width="1" height="1">':"")+"</article>"},n.DEBUG&&(t.components.promotions.post.soyTemplateName="tiger.components.promotions.post"),t.components.promotions.head=function(t){return""+(t.headline?'<header><h1 class="headline'+e.$$escapeHtmlAttribute(t.headerLevel&&t.headerLevel>1?" h"+t.headerLevel:"")+' hover-highlight entry-title"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(t.permalink))+'">'+e.$$filterNoAutoescape(t.headline)+"</a></h1></header>":"")},n.DEBUG&&(t.components.promotions.head.soyTemplateName="tiger.components.promotions.head"),t.components.promotions.meta=function(n,o,s){return'<div class="meta">'+t.components.promotions.postInfo(n,null,s)+'<div class="meta-byline js_meta-byline"><span class="display-name author vcard">'+(n.post.authorByline?e.$$filterNoAutoescape(window.kinja.stripHtmlTags(n.post.authorByline,"")):'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(n.post.author.screenName)+'" rel="nofollow">'+e.$$filterNoAutoescape(n.post.author.displayName)+"</a>")+"</span>"+t.components.promotions.promotedByline(n,null,s)+"</div></div>"},n.DEBUG&&(t.components.promotions.meta.soyTemplateName="tiger.components.promotions.meta"),t.components.promotions.promotedByline=function(n,a,s){var o='<span class="meta-promoted"><span class="promoted-dot">&middot;</span> '+(n.post.sponsored?'<span class="sponsored-label text-upper">Sponsored</span><span class="icon--svg u-prepended u-appended">'+t.icons.essential.starCircle(null,null,s)+"</span>":""),i=""+(n.post.promotionByline&&""!=n.post.promotionByline?e.$$escapeHtml(n.post.promotionByline):n.post.author&&n.post.author.displayName?e.$$escapeHtml(n.post.author.displayName):"");return o+='Promoted by <span class="js_promoted_displayName">'+e.$$filterNoAutoescape(i)+"</span></span>"},n.DEBUG&&(t.components.promotions.promotedByline.soyTemplateName="tiger.components.promotions.promotedByline"),t.components.promotions.mainMediaInterchange=function(n,c,a){var r="",s=""+t.utils.cropType({name:n.cropName},null,a),o=n.animated?n.image.format:n.image.frozenFormat,i="["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (default)], ["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (small)], ["+window.kinja.imageUrl(n.image.id,s+"Medium",o)+", (medium)], ["+(a.features.facethumbs?window.kinja.imageUrl(n.image.id,"KinjaThumb",o):window.kinja.imageUrl(n.image.id,s+"Small",o))+", (large)]";return r+=(n.animated?'data-anim-interchange="'+e.$$escapeHtml(i)+'"':n.lazyload?'data-lazy-interchange="'+e.$$escapeHtml(i)+'"':'data-interchange="'+e.$$escapeHtml(i)+'"')+'data-webm-src="'+e.$$escapeHtml(window.kinja.imageUrl(n.image.id,s+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtml(window.kinja.imageUrl(n.image.id,s+"-xlarge","mp4"))+'"'},n.DEBUG&&(t.components.promotions.mainMediaInterchange.soyTemplateName="tiger.components.promotions.mainMediaInterchange"),t.components.promotions.mainMediaImage=function(n,a,s){var o="",i=""+t.utils.cropType({name:n.cropName},null,s);return o+='<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(n.image.id,i+"-xlarge",n.image.format)))+'"'+t.components.promotions.mainMediaInterchange__Ce4(n,null,s)+(n.image.isAnimated?t.components.promotions.mainMediaInterchange__Ce4(e.$$augmentMap(n,{animated:!0}),null,s):"")+'width="132" height="74">'},n.DEBUG&&(t.components.promotions.mainMediaImage.soyTemplateName="tiger.components.promotions.mainMediaImage"),t.components.promotions.mainMedia=function(n,a,o){var s,i="";return n.post.headlineImage&&n.post.headlineImage.type&&(s="video"==n.post.headlineImage.type,i+='<div class="main-media fullwidth-for-small">'+("image"==n.post.headlineImage.type||s?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.url))+"\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Front page click', 'click', 'Front page click - post image', 'standard recommended');\"><span class=\""+(s?"video-thumb-play":"")+' img-border">'+t.components.promotions.mainMediaImage(e.$$augmentMap(n,{cropName:s?"centered":"default",image:n.post.headlineImage}),null,o)+(s?'<span class="play-icon">'+t.icons.actions.playIcon(null,null,o)+"</span>":"")+"</span></a>":"")+"</div>"),i},n.DEBUG&&(t.components.promotions.mainMedia.soyTemplateName="tiger.components.promotions.mainMedia"),t.components.promotions.readMore=function(t){return'<span class="read-more hide-for-billboard"> <a class="js_read-more" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(t.post.url))+'" rel="nofollow">&raquo;</a><span class="timestamp proxima text-tiny nowrap"><span class="publish-time js_publish_time"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(t.post.url))+'" rel="nofollow"><span class="published updated">'+e.$$escapeHtml(t.post.publishTime.Mddyyhmma)+"</span></a></span></span></span>"},n.DEBUG&&(t.components.promotions.readMore.soyTemplateName="tiger.components.promotions.readMore"),t.components.promotions.postInfo=function(n,o,s){return'<span class="meta-tools"><div class="view-count-container"></div><a data-likecount="'+e.$$escapeHtmlAttribute(null!=n.post.likes?n.post.likes:0)+'" href="#" class="js_like button-recommend-post hover-icon icon--svg u-darken--onhover js_like_icon" title="Recommend"><span class="js_like_count">'+(n.post.likes&&n.post.likes>0?e.$$escapeHtml(n.post.likes):"")+"</span>"+t.icons.essential.star(null,null,s)+"</a></span>"},n.DEBUG&&(t.components.promotions.postInfo.soyTemplateName="tiger.components.promotions.postInfo"),t.components.promotions.postDropDownWrapper=function(e,s,n){return'<div class="post-dropdown-ct js_post-dropdown-ct">'+t.components.promotions.postDropdown(e,null,n)+"</div>"},n.DEBUG&&(t.components.promotions.postDropDownWrapper.soyTemplateName="tiger.components.promotions.postDropDownWrapper"),t.components.promotions.postDropdown=function(n,o,s){return'<ul id="dropdown-'+e.$$escapeHtmlAttribute(n.post.id)+'" class="f-dropdown proxima js_post-dropdown js_follow-controls js_user-follow-controls whitelisted-links" data-postid="'+e.$$escapeHtmlAttribute(n.post.id)+'" data-starterid="'+e.$$escapeHtmlAttribute(n.post.id)+'" data-authorid="'+e.$$escapeHtmlAttribute(n.post.author.id)+'" data-blogid="'+e.$$escapeHtmlAttribute(n.post.defaultBlogId)+'" data-sourceblogid="'+e.$$escapeHtmlAttribute(null==n.blog?null:n.blog.id)+'" data-dropdown-content><li class="js_edit-post hover-icon hide readonly-hide"><a href="#" rel="nofollow"><span class="icon--svg u-prepended">'+t.icons.actions.write(null,null,s)+'</span></a></li><li class="js_delete-post hover-icon hide readonly-hide"><a href="#" rel="nofollow"><span class="icon--svg u-prepended">'+t.icons.essential.close(null,null,s)+'</span></a></li></ul><a href="#" target="_self" class="secondary transparent toggle-30 js_post-menu-toggler post-dropdown-trigger icon--svg u-highlighted--onhover" data-dropdown="dropdown-'+e.$$escapeHtmlAttribute(n.post.id)+'">'+t.icons.essential.chevronBottom(null,null,s)+"</a>"},n.DEBUG&&(t.components.promotions.postDropdown.soyTemplateName="tiger.components.promotions.postDropdown"),t.components.promotions.mainMediaInterchange__Ce4=function(n,c,a){var r="",s=""+t.utils.cropType__Ce4({name:n.cropName},null,a),o=n.animated?n.image.format:n.image.frozenFormat,i="["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (default)], ["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (small)], ["+window.kinja.imageUrl(n.image.id,s+"Medium",o)+", (medium)], ["+(a.features.facethumbs?window.kinja.imageUrl(n.image.id,"KinjaThumb",o):window.kinja.imageUrl(n.image.id,s+"Small",o))+", (large)]";return r+=(n.animated?'data-anim-interchange="'+e.$$escapeHtmlAttribute(i)+'"':n.lazyload?'data-lazy-interchange="'+e.$$escapeHtmlAttribute(i)+'"':'data-interchange="'+e.$$escapeHtmlAttribute(i)+'"')+'data-webm-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(n.image.id,s+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(n.image.id,s+"-xlarge","mp4"))+'"'},n.DEBUG&&(t.components.promotions.mainMediaInterchange__Ce4.soyTemplateName="tiger.components.promotions.mainMediaInterchange__Ce4")}),define("templates/tiger/components/promotions/sidebar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.promotions.sidebar=function(n,c,s){var i,a,o="",r=s.features.fullheadline?130:73;return o+='<div class="sidebar-item sidebar-module js_leftrailmodule leftrailmodule--promoted"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.url))+'" class="js_promoted-sidebar--link">'+(n.post.headlineImage&&n.post.headlineImage.src?'<span class="thumbnail-wrapper img--16x9"><span class="data-overlay hide"><ul><li class="js_promoted-sidebar--starcount hide"><span class="text"></span>'+t.icons.essential.star(null,null,s)+'</li><li class="js_promoted-sidebar--replycount hide"><span class="text"></span>'+t.icons.essential.bubble(null,null,s)+'</li><li class="js_promoted-sidebar--viewcount hide"><span class="text"></span>'+t.icons.essential.flame(null,null,s)+'</li></ul></span><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.headlineImage.src))+'" alt="'+e.$$escapeHtmlAttribute(n.post.headline)+'" /><span class="sponsored-overlay">Sponsored</span></span>':""),i=""+(n.post.promotionByline&&""!=n.post.promotionByline?e.$$escapeHtml(n.post.promotionByline):n.post.author&&n.post.author.displayName?e.$$escapeHtml(n.post.author.displayName):""),o+='<div class="meta meta--source"><div class="icon--svg">'+t.icons.actions.dollar(null,null,s)+'</div><div class="byline-text"><strong>Promoted by '+e.$$filterNoAutoescape(i)+"</strong> &middot; "+(n.post.authorByline?e.$$filterNoAutoescape(window.kinja.stripHtmlTags(n.post.authorByline,"")):'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(n.post.author.screenName)+'" rel="nofollow">'+e.$$filterNoAutoescape(n.post.author.displayName)+"</a>")+'</div></div><h4 class="headline">'+e.$$filterNoAutoescape(window.kinja.truncateHtml(n.post.title,r))+"</h4>",a=""+t.utils.relativeTime({time:n.post.publishTime},null,s),o+='<div class="meta"><time>'+e.$$filterNoAutoescape(a)+"</time></div>"+(n.post.trackingPixel?'<img style="position:absolute" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.trackingPixel))+'" width="1" height="1">':"")+"</a></div>"},n.DEBUG&&(t.components.promotions.sidebar.soyTemplateName="tiger.components.promotions.sidebar")}),define("templates/tiger/components/invites/menu-items",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(n,e,s,t){e.components.invites.menuItems.invitePostDropdownItems=function(n,s,t){return'<li class="js_invite-to-post-manually hover-icon hide"><a href="#" rel="nofollow" class="icon--svg">'+e.icons.places.mail(null,null,t)+"Invite manually</a></li>"},t.DEBUG&&(e.components.invites.menuItems.invitePostDropdownItems.soyTemplateName="tiger.components.invites.menuItems.invitePostDropdownItems")}),define("templates/tiger/components/post/pe-list-item",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(o,t,i,n,e,s){t.components.post.pe_item=function(n,a,s){var o="",i=(!n.post.isPromoted&&n.excerptOnly,""+e.$$escapeHtml(n.post.isBillboardPost&&n.post.showByline&&""!=n.post.byline?" billboard":"")+e.$$escapeHtml(n.sharingPost?" shared":"")+e.$$escapeHtml("true"==n.stream?" stream":""));return o+=(n.post.ads&&n.post.ads.ad16x9?t.components.ad.preroll(null,null,s):"")+'<div class="post-wrapper js_post-wrapper '+e.$$escapeHtmlAttribute(i)+'" '+(n.post.isPromoted?"data-postIdWrapper='"+e.$$escapeHtmlAttribute(n.post.id)+"' data-promotionData=\""+e.$$escapeHtmlAttribute(n.post.promotionJson)+'" data-adZone="'+e.$$escapeHtmlAttribute(n.post.adZone)+'" data-headline="'+e.$$escapeHtmlAttribute(n.post.headline)+'" data-tagUrlNames="'+e.$$escapeHtmlAttribute(n.post.tagUrlNames)+'"':"")+" >"+t.components.post.pe_article(n,null,s)+"</div>"+(n.post.ads&&n.post.ads.ad1x1&&n.post.sponsored?t.components.ad.tracker({postAdZone:n.post.adZone,postId:n.post.id},null,s):"")},n.DEBUG&&(t.components.post.pe_item.soyTemplateName="tiger.components.post.pe_item"),t.components.post.pe_article=function(n,l,s){var a="",r=""+("DRAFT"==n.post.status?"status-draft":"SCHEDULED"==n.post.status?"status-scheduled":"status-published"),c="postlist__item hentry js_post_item "+e.$$escapeHtml(r)+" post-item-"+e.$$escapeHtml(n.pageType)+(n.post.isPromoted?" js_promoted":"")+(1==n.post.isRecommended?" marquee-post":""),o=n.index&&n.index>2,i=!n.post.aboveHeadline&&n.post.leftOfHeadline;return a+='<article class="'+e.$$escapeHtmlAttribute(c)+'" data-id="'+e.$$escapeHtmlAttribute(n.post.id)+'" id="post_'+e.$$escapeHtmlAttribute(n.post.id)+'"'+(n.post.jsModelJson?' data-model="'+e.$$escapeUri(n.post.jsModelJson)+'"':"")+">"+t.components.post.secondaryByline(n,null,s)+'<header><h1 class="headline entry-title js_entry-title'+(n.post.isRecommended?" featured":"")+'"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'"'+(n.post.isPromoted?' rel="nofollow"':"")+">"+e.$$filterNoAutoescape(n.post.headline)+"</a></h1>"+t.components.post.peMeta(n,null,s)+'</header><div class="item__content'+(i?" item__content--thumb":"")+'">'+(n.post.aboveHeadline?t.components.post.media.large({lazyload:o,image:n.post.aboveHeadline,permalink:n.post.permalink,nofollow:n.post.isPromoted},null,s):n.post.leftOfHeadline?t.components.post.media.medium({lazyload:o,image:n.post.leftOfHeadline,permalink:n.post.permalink,nofollow:n.post.isPromoted},null,s):"")+'<div class="excerpt entry-summary">'+e.$$filterNoAutoescape(n.post.shortExcerpt)+"</div></div></article>"+(null==n.index||0!=n.index||n.post.sponsored||n.post.isPromoted?"":t.components.ad.mobile(null,null,s))},n.DEBUG&&(t.components.post.pe_article.soyTemplateName="tiger.components.post.pe_article"),t.components.post.secondaryByline=function(n,l,o){var i="",a=n.post&&n.post.postAction&&"REPOST"==n.post.postAction.relation,r=(n.post.sharedPost?n.post.sharedPost.replyCount:n.post.replyCount?n.post.replyCount:0,n.post.sponsored||n.post.isPromoted),c=""+(n.post.promotionByline&&""!=n.post.promotionByline?e.$$escapeHtml(n.post.promotionByline):n.post.author&&n.post.author.displayName?e.$$escapeHtml(n.post.author.displayName):""),s=n.post.sponsored;return i+="permalink"!=n.pageType?'<div class="meta--pe secondary-byline">'+(r?'<div class="meta__text">Promoted by '+e.$$escapeHtml(c)+"</div>":a?'<div class="meta__text">'+t.icons.places.sharedpostSmall(null,null,o)+" Shared from "+e.$$escapeHtml(n.post.defaultBlogName)+"</div>":"")+(s?'<div class="meta__label meta__label--sponsored">Sponsored</div>':"")+"</div>":""},n.DEBUG&&(t.components.post.secondaryByline.soyTemplateName="tiger.components.post.secondaryByline"),t.components.post.peMeta=function(n,g,o){var c,i="",p=n.post&&n.post.postAction&&"REPOST"==n.post.postAction.relation,l=n.post.sharedPost?n.post.sharedPost.replyCount:n.post.replyCount?n.post.replyCount:0,m=(n.post.sponsored||n.post.isPromoted,""+(n.post.promotionByline&&""!=n.post.promotionByline?e.$$escapeHtml(n.post.promotionByline):n.post.author&&n.post.author.displayName?e.$$escapeHtml(n.post.author.displayName):""),n.post.sponsored),r=""+(n.post.showByline&&""==n.post.byline&&(null==n.post.author?null:n.post.author.avatar)?"//kinja.com/"+e.$$escapeHtml(n.post.author.screenName):""),r=s.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(r),d=n.post.byline&&""!=n.post.byline?n.post.byline:n.post.author.displayName,u=n.scheduledRepost;if(i+='<div class="meta--pe">'+("permalink"==n.pageType?'<div class="meta__avatar'+(m?" sponsored":"")+'">'+(p?t.components.post.streamMetaSharedAvatars({post:n.post,sharerAuthor:n.post.postAction.author},null,o):u?t.components.post.streamMetaSharedAvatars({post:n.post,sharerAuthor:n.scheduledRepost.author},null,o):t.components.post.streamMetaAvatar(n,null,o))+'<span class="avatar__badge avatar__badge--sponsored">'+t.icons.actions.dollarCircle(null,null,o)+"</span></div>":"")+'<div class="meta__text"><div class="meta__byline author">'+(r?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(r))+'">'+e.$$escapeHtml(d)+"</a>":e.$$escapeHtml(d))+'</div><time class="meta__time updated" datetime="'+e.$$escapeHtmlAttribute(n.post.publishTime.yMdHmsZ)+'"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'" target="_self" title="'+e.$$escapeHtmlAttribute(n.post.publishTime.Mddyyhmma)+'" '+(n.post.isPromoted?'rel="nofollow"':"")+">"+(u?"<b>Scheduled share:</b> "+e.$$escapeHtml(window.kinja.formatTime(n.scheduledRepost.repostTime,"M/dd/yy h:mma",n.post.timezone,"en-US")):"DRAFT"==n.post.status?"<b>Draft:</b> "+e.$$escapeHtml(window.kinja.formatTime(n.post.publishTime.timestamp,"M/dd/yy h:mma",n.post.timezone,"en-US")):"SCHEDULED"==n.post.status?"<b>Scheduled:</b> "+e.$$escapeHtml(window.kinja.formatTime(n.post.publishTime.timestamp,"M/dd/yy h:mma",n.post.timezone,"en-US")):t.messages.time.relativeTime({type:n.post.publishTime.relative.type,amount:n.post.publishTime.relative.amount,hmma:n.post.publishTime.hmma,day:n.post.publishTime.day,Mddyyhmma:n.post.publishTime.Mddyyhmma,timestamp:n.post.publishTime.timestamp},null,o))+"</a></time>",n.tags&&n.tags[0]){if(i+='<div class="tags-container"><a class="first-tag" href="/tag/'+e.$$escapeHtmlAttribute(n.tags[0].urlName)+'" data-urlname="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.tags[0].urlName))+"\" data-dropdown=\"taglist\" data-options=\"is_hover:true;autoalign:true;\" onclick=\"window.ga('send', 'event', 'Permalink meta', 'Tag click', 'First tag click');\">Filed to: <span>"+e.$$escapeHtml(n.tags[0].desc)+"</span>"+t.icons.essential.chevronBottom(null,null,o)+"</a>",n.tags.length>1){i+='<div id="taglist" class="tiny f-dropdown text-upper" data-dropdown-content><div><ul>';for(var h=n.tags,f=h.length,a=0;f>a;a++)c=h[a],i+=a>=1?'<li><a href="/tag/'+e.$$escapeHtmlAttribute(c.urlName)+'" data-urlname="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(c.urlName))+"\" onclick=\"window.ga('send', 'event', 'Permalink meta', 'Tag click', 'Dropdown tag click');\">"+e.$$escapeHtml(c.desc)+"</a></li>":"";i+="</ul></div></div>"}i+="</div>"}return i+='</div><div class="meta__right"><div class="'+(o.features.newstream?"meta__data":"")+' view-count-container"></div>'+(l&&l>0?'<a class="meta__data meta__data--comment" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'#replies">'+t.icons.essential.bubbleGiant(null,null,o)+"<span>"+e.$$escapeHtml(l)+"</span></a>":"")+'<a href="#" class="meta__data meta__data--recommend js_like icon--svg u-darkened--onhover js_like_icon" title="Recommend" data-likecount="'+e.$$escapeHtmlAttribute(null!=n.post.likes?n.post.likes:0)+'" data-analytics-target="starterTop">'+t.icons.essential.starGiant(null,null,o)+'<span class="js_like_count">'+(n.post.likes&&n.post.likes>0?e.$$escapeHtml(n.post.likes):"")+'</span></a><div class="meta__tools js_meta-tools post-dropdown-ct js_post-dropdown-ct hide">'+t.components.post.meta.postDropdown({post:n.post,mode:"post",pageType:n.pageType,blog:n.blog},null,o)+'<a href="#" target="_self" class="post-dropdown-trigger js_post-menu-toggler icon--svg u-darkened--onhover" data-dropdown="dropdown-'+e.$$escapeHtmlAttribute(n.post.id)+'">'+t.icons.essential.toolsGiant(null,null,o)+"</a></div></div></div>"},n.DEBUG&&(t.components.post.peMeta.soyTemplateName="tiger.components.post.peMeta"),t.components.post.streamMetaAvatar=function(n,l,r){var c="",a="gif"==(null==n.post.author.avatar?null:n.post.author.avatar.format)?"jpg":null==n.post.author.avatar?null:n.post.author.avatar.format,i=""+(n.post.showByline&&""==n.post.byline&&(null==n.post.author?null:n.post.author.avatar)?""+window.kinja.imageUrl(n.post.author.avatar.id,"avt-small",a):n.post.salesAvatarMap&&n.post.salesAvatarMap.id?""+window.kinja.imageUrl(n.post.salesAvatarMap.id,"avt-small",a):""),i=s.$$markUnsanitizedTextForInternalBlocks(i),o=""+(n.post.showByline&&""==n.post.byline&&(null==n.post.author?null:n.post.author.avatar)?"//kinja.com/"+e.$$escapeHtml(n.post.author.screenName):""),o=s.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(o);return n.post.byline&&""!=n.post.byline?n.post.byline:n.post.author.displayName,c+=(o?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(o))+'" class="avatar__link"'+(n.post.isPromoted?' rel="nofollow"':"")+">":"")+(i?'<img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" />':t.icons.places.avatarBig(null,null,r))+(o?"</a>":"")},n.DEBUG&&(t.components.post.streamMetaAvatar.soyTemplateName="tiger.components.post.streamMetaAvatar"),t.components.post.streamMetaSharedAvatars=function(t){var l="",a="gif"==(null==t.post.author.avatar?null:t.post.author.avatar.format)?"jpg":null==t.post.author.avatar?null:t.post.author.avatar.format,c="gif"==(null==t.sharerAuthor.avatar?null:t.sharerAuthor.avatar.format)?"jpg":null==t.sharerAuthor.avatar?null:t.sharerAuthor.avatar.format,n=""+(t.post.showByline&&""==t.post.byline&&(null==t.post.author?null:t.post.author.avatar)?""+window.kinja.imageUrl(t.post.author.avatar.id,"avt-small",a):t.post.salesAvatarMap&&t.post.salesAvatarMap.id?""+window.kinja.imageUrl(t.post.salesAvatarMap.id,"avt-small",a):""),n=s.$$markUnsanitizedTextForInternalBlocks(n),r=window.kinja.imageUrl(t.sharerAuthor.avatar.id,"avt-small",c),o=""+(t.post.showByline&&""==t.post.byline&&(null==t.post.author?null:t.post.author.avatar)?"//kinja.com/"+e.$$escapeHtml(t.post.author.screenName):""),o=s.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(o),i="//kinja.com/"+t.sharerAuthor.screenName,i=s.$$markUnsanitizedTextForInternalBlocks(i);return t.post.byline&&""!=t.post.byline?t.post.byline:t.post.author.displayName,t.sharerAuthor.displayName,l+='<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" class="avatar__link"'+(t.post.isPromoted?' rel="nofollow"':"")+">"+(t.sharerAuthor.id==t.post.author.id?'<img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n))+'" />':'<span class="avatar-wrapper sharedauthor"><img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n))+'" /></span><span class="avatar-wrapper sharingauthor"><img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(r))+'" /></span>')+'</a><div class="avatar__popover hide">'+(o?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(o))+'" class="avatar__link"'+(t.post.isPromoted?' rel="nofollow"':"")+'><img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n))+'" /></a>':n?'<img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n))+'" />':"")+"</div>"},n.DEBUG&&(t.components.post.streamMetaSharedAvatars.soyTemplateName="tiger.components.post.streamMetaSharedAvatars")}),define("templates/tiger/components/post/media/medium",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.post.media.medium=function(n,a,o){var i="",s=n.image.isVideo;return i+='<figure class="asset main-media fullwidth-for-small"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.permalink))+'"'+(n.nofollow?' rel="nofollow"':"")+'><span class="'+(s?"video-thumb-play":"")+" img-border"+(n.image.isAnimated?" lazy-gif lazy-image ":n.lazyload?" lazy-image":"")+'">'+t.components.post.media.mainMediaImage({cropName:s?"centered":"default",image:n.image,lazyload:n.lazyload,animated:n.image.isAnimated},null,o)+(s?'<span class="play-icon">'+t.icons.actions.playIcon(null,null,o)+"</span>":"")+"</span></a></figure>"},n.DEBUG&&(t.components.post.media.medium.soyTemplateName="tiger.components.post.media.medium"),t.components.post.media.mainMediaImage=function(n,h,s){var d="",r=""+t.utils.cropType({name:n.cropName},null,s),o=n.image.isAnimated,c=n.image.height?n.image.height:74,a=n.image.width?n.image.width:132,l=o?n.image.frozenFormat:n.image.format,i=""+e.$$escapeHtml(window.kinja.imageUrl(n.image.id,r+"Medium",l)),u=o&&n.lazyload;return d+='<img src="'+(n.lazyload?"data:image/svg+xml;charset=utf-8,%3Csvg xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg' viewBox%3D'0 0 "+e.$$escapeHtmlAttribute(a)+" "+e.$$escapeHtmlAttribute(c)+"'%2F%3E":e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i)))+'"'+(u?'data-src="'+e.$$escapeHtmlAttribute(i)+'"':"")+t.components.post.media.mainMediaInterchange__Ce4(n,null,s)+(o?t.components.post.media.mainMediaInterchange__Ce4(e.$$augmentMap(n,{animated:!0}),null,s):"")+"/>"},n.DEBUG&&(t.components.post.media.mainMediaImage.soyTemplateName="tiger.components.post.media.mainMediaImage"),t.components.post.media.mainMediaInterchange=function(n,c,i){var r="",s=""+t.utils.cropType({name:n.cropName},null,i),o=""+(n.animated?e.$$escapeHtml(n.image.format):e.$$escapeHtml(n.image.frozenFormat)),a="["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (default)], ["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (small)], ["+window.kinja.imageUrl(n.image.id,s+"Medium",o)+", (medium)], ["+(i.features.facethumbs?window.kinja.imageUrl(n.image.id,"KinjaThumb",o):window.kinja.imageUrl(n.image.id,s+"Small",o))+", (large)]";return r+=(n.animated?'data-anim-interchange="'+e.$$escapeHtml(a)+'"':n.lazyload?'data-lazy-interchange="'+e.$$escapeHtml(a)+'"':'data-interchange="'+e.$$escapeHtml(a)+'"')+(i.features.webm?'data-webm-src="'+e.$$escapeHtml(window.kinja.imageUrl(n.image.id,s+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtml(window.kinja.imageUrl(n.image.id,s+"-xlarge","mp4"))+'"':"")},n.DEBUG&&(t.components.post.media.mainMediaInterchange.soyTemplateName="tiger.components.post.media.mainMediaInterchange"),t.components.post.media.mainMediaInterchange__Ce4=function(n,c,i){var r="",s=""+t.utils.cropType__Ce4({name:n.cropName},null,i),o=""+(n.animated?e.$$filterHtmlAttributes(n.image.format):e.$$filterHtmlAttributes(n.image.frozenFormat)),a="["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (default)], ["+window.kinja.imageUrl(n.image.id,s+"ExtraLarge",o)+", (small)], ["+window.kinja.imageUrl(n.image.id,s+"Medium",o)+", (medium)], ["+(i.features.facethumbs?window.kinja.imageUrl(n.image.id,"KinjaThumb",o):window.kinja.imageUrl(n.image.id,s+"Small",o))+", (large)]";return r+=(n.animated?'data-anim-interchange="'+e.$$escapeHtmlAttribute(a)+'"':n.lazyload?'data-lazy-interchange="'+e.$$escapeHtmlAttribute(a)+'"':'data-interchange="'+e.$$escapeHtmlAttribute(a)+'"')+(i.features.webm?'data-webm-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(n.image.id,s+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(n.image.id,s+"-xlarge","mp4"))+'"':"")},n.DEBUG&&(t.components.post.media.mainMediaInterchange__Ce4.soyTemplateName="tiger.components.post.media.mainMediaInterchange__Ce4")}),define("module/promotions/promotions.itemview",["jquery","underscore","backbone.marionette","singleton/EventDispatcher","singleton/Feature","singleton/Renderer","module/promotions/promotions.model","templates/tiger/utils/crop-type","templates/tiger/components/promotions/post","templates/tiger/components/promotions/sidebar","templates/tiger/components/invites/menu-items","templates/tiger/components/post/pe-list-item","templates/tiger/components/post/media/medium","templates/tiger/utils/relative-time","templates/tiger/section/sidebar","templates/tiger/messages"],function(t,n,s,o,e,i,a){"use strict";var r=s.ItemView.extend({model:a,template:e.isOn("newstream")?tiger.components.post.pe_item:tiger.components.promotions.post,readMorePlaceholder:'<span class="read-more-placeholder"></span></p>',$container:null,className:"post-wrapper js_post-wrapper",ui:{headline:".headline",excerpt:".package",promotedSidebarLink:".js_promoted-sidebar--link",dataOverlay:".data-overlay",starCount:".js_promoted-sidebar--starcount",replyCount:".js_promoted-sidebar--replycount",viewCount:".js_promoted-sidebar--viewcount"},modelEvents:{"change:starCount":"updateDataOverlay","change:replyCount":"updateDataOverlay","change:viewCount":"updateDataOverlay"},events:{"click @ui.headline":"onPostClicked","click @ui.promotedSidebarLink":"onPostClicked","click @ui.excerpt":"onPostClicked"},initialize:function(n){var e="",s=n.innerEl,t=this.model.get("zoneType");this.$container=s.closest(".ad-promotions-container"),t&&"PROMOTION_SIDEBAR"===t&&(this.template=tiger.components.promotions.sidebar),e=this.$container.data("mobile")?"show-for-medium-down":"hide-for-medium-down animate-slidedown animate-closed",this.$el.addClass(e)},serializeData:function(){var t;return e.isOn("newstream")?(t=this.model.toSoyData(),t.post.headline=t.post.title,t.post.byline=t.post.authorByline,t.post.leftOfHeadline=t.post.headlineImage,t.post.permalink=t.post.url):(this.injectReadMorePlaceholder(),t=this.model.toSoyData()),t},injectReadMorePlaceholder:function(){var e=this.model.get("shortExcerpt");e&&(e=e.replace(/<\/p>$/,this.readMorePlaceholder),this.model.set({shortExcerpt:e}))},onPostClicked:function(e){var n,s=t(e.target);(!s.attr("href")||s.hasClass("js_read-more"))&&(e.preventDefault(),n=this.constructPermalink(),window.location.href=n)},updateDataOverlay:function(a,t){var s,o=n.keys(this.model.changedAttributes())[0],e=this.ui[o];e&&t>0&&(s=i.renderTemplate(tiger.section.sidebar.numberFormat,{number:t}),e.find(".text").html(s),e.removeClass("hide"),this.ui.dataOverlay.removeClass("hide"))},constructPermalink:function(){var e,t=window.location.protocol+"//"+window.location.host,n=this.model.get("dfpTracker"),s=this.model.get("permalinkPath");return e=n+t+s},onRender:function(){this.$container.before(this.el),this.$el.removeClass("animate-closed"),o.trigger("update.postlist.post",{el:this.$el})}});return r}),define("module/promotions/promotions.controller",["jquery","module/ads/ads.events","module/promotions/promotions.model","module/promotions/promotions.itemview"],function(n,t,s,o){"use strict";var e={views:[],_startPromotions:function(){window.location.search.match(/startTime/)||this._registerEvents()},_registerEvents:function(){t.on("ads.zonedisplayed",this.onPromotionAdded,this),t.on("ads.forcedisplay",this._renderPromotedPost)},onPromotionAdded:function(n){var t=n.model.get("zoneType");("PROMOTION"===t||"PROMOTION_MOBILE"===t||"PROMOTION_SIDEBAR"===t)&&e.renderPromotedPost(n)},renderPromotedPost:function(t){var e,n=this.getPromotedPost(t);n&&(e=new o({innerEl:t.$el.closest(".js_ad-promotion"),model:n}),e.render(),this.views.push(e))},_renderPromotedPost:function(){var t,s=n(".js_ad-promotion-desktop iframe").first(),i=e._getPromotedPost(s);i&&(t=new o({innerEl:s.closest(".js_ad-promotion"),model:i}),t.render(),e.views.push(t))},getPromotedPost:function(t){var e,n,i=this,o=t.$el.find("div > iframe");return o.length>0&&(e=i.extractPromotionData(o),e&&(e.zoneType=t.model.get("zoneType"),n=new s(e,{parse:!0}))),n},_getPromotedPost:function(i){var t,n,o=i;return o.length>0&&(t=e.extractPromotionData(o),t&&(n=new s(t,{parse:!0}))),n},parseJsonFuture:function(e){var t;try{return e=e.replace(/"\\&quot;/gm,'\\"'),e=e.replace(/\\&quot;/gm,"\\"),t=JSON.parse(e)}catch(t){return window.console.warn("parseJsonFuture failed for promoted post, trying parseJsonV4 next"),this.parseJsonV4(e)}},parseJsonV4:function(e){var t;try{return t=JSON.parse(e)}catch(t){return window.console.warn("parseJsonV4 failed for promoted post, trying native parseJson next"),this.parseJson(e)}},parseJson:function(e){var t;e=e.replace(/"\\&quot;/gm,'\\"'),e=e.replace(/\\&quot;/gm,"\\");try{t=JSON.parse(e)}catch(t){window.console.error("Unable to parse JSON string of promoted post"),window.console.error(e),window.console.error(t)}return t},getJsonVersion:function(t){var e,n;return e=t.match(/"version":\s*"([0-9]+)"/),n=null!==e&&2===e.length?parseInt(e[1],10):0},cleanJsonString:function(s){var e,t,o,n=s;if(t=s.match(/<a href="tel:[0-9]+">[0-9]+<\/a>/gi),o=t?t.length:0)try{for(e=0;o>e;e++)n=n.replace(t[e],t[e].match(/([0-9]+)/)[0])}catch(e){window.console.warn("Error while cleaning json string for promoted post"),window.console.warn(e)}return n},extractPromotionData:function(i){var e,t,s,o,a;return t=n(i).contents().find("body").html(),o=t.search(/<script/),e=t.slice(0,o),s=this.getJsonVersion(e),e=this.cleanJsonString(e),""!==e&&(a=s>=6?this.parseJsonFuture(e):s>=4?this.parseJsonV4(e):this.parseJson(e))},API:{startPromotions:function(){e._startPromotions()},forcedisplay:function(){t.trigger("ads.forcedisplay")}}};return window.kinjaads=window.kinjaads||{},window.kinjaads.queue=window.kinjaads.queue||[],window.kinjaads.forcedisplay=e.API.forcedisplay,e.API}),define("templates/tiger/components/post/meta/meta-components",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(s,t,o,n,e){t.components.post.meta.byline=function(t){var n,s=""+("repost"==t.mode&&t.reposter?e.$$escapeHtml(t.reposter.displayName)+' <span class="text-italic">shared a post by</span> '+(""==t.post.byline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(t.post.author.screenName)+'" class="text-light fn url"'+(t.post.isPromoted?' rel="nofollow"':"")+">"+e.$$escapeHtml(t.post.author.displayName)+"</a>":e.$$escapeHtml(window.kinja.stripHtmlTags(t.post.byline,""))):"");return t.post.showByline&&(!t.post.postAction||!t.post.postAction.author)&&"repost"!=t.mode&&((s+='<span class="display-name author vcard">'+(""==t.post.byline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(t.post.author.screenName)+"\" onclick=\"window.ga('send', 'event', 'byline', 'click', "+(t.pageType?" '"+e.$$escapeHtmlAttribute(e.$$escapeJsString(t.pageType))+"' ":" 'private'")+');" '+(t.post.isPromoted?' rel="nofollow"':"")+' class="fn url">'+e.$$escapeHtml(t.post.author.displayName)+"</a>":e.$$escapeHtml(window.kinja.stripHtmlTags(t.post.byline,"")))+"</span>",t.post.allowReplies&&"reply"!=t.mode)&&(n=t.post.sharedPost?t.post.sharedPost.replyCount:t.post.replyCount?t.post.replyCount:0,s+=n&&n>0?' <a href="'+("permalink"!=t.pageType?e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(t.post.permalink)):"")+'#replies" class="text-light" rel="nofollow">'+(1==n?"and "+e.$$escapeHtml(n)+" other":"and "+e.$$escapeHtml(n)+" others")+"</a>":""),s+="reply"==t.mode&&t.post.replyMeta.parentAuthor?'&nbsp;replied to a post by&nbsp;<span class="strong">'+(""==t.post.replyMeta.parentByline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(t.post.replyMeta.parentAuthor.screenName)+'" class="text-light fn url"'+(t.post.isPromoted?' rel="nofollow"':"")+">"+e.$$escapeHtml(t.post.replyMeta.parentAuthor.displayName)+"</a>":e.$$escapeHtml(t.post.replyMeta.parentByline))+"</span>":""),s+=(t.post.postAction&&t.post.postAction.author&&"repost"!=t.mode?e.$$escapeHtml(t.post.postAction.author.displayName)+' <span class="text-italic">'+("shared-reply"==t.mode?"shared a reply by":"shared a post by")+'</span> <span class="author vcard">'+(""==t.post.byline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(t.post.author.screenName)+'" class="text-light fn url"'+(t.post.isPromoted?' rel="nofollow"':"")+">"+e.$$escapeHtml(t.post.author.displayName)+"</a>":e.$$escapeHtml(window.kinja.stripHtmlTags(t.post.byline,"")))+"</span>":"")+("profileposts"==t.pageType?'<p class="posted-on-blog">posted on<a href="//'+e.$$escapeHtmlAttribute(t.post.defaultBlogHost)+'"> '+e.$$escapeHtml(t.post.defaultBlogName)+"</a></p>":"")},n.DEBUG&&(t.components.post.meta.byline.soyTemplateName="tiger.components.post.meta.byline"),t.components.post.meta.topByline=function(n,d,a){if(s="",n.post.showByline)if(""==n.post.byline){if(s+='<span class="display-name author vcard"><a href="//kinja.com/'+e.$$escapeHtmlAttribute(n.post.author.screenName)+'" target="_self" '+(n.post.isPromoted?'rel="nofollow"':"")+" class=\"fn url\" onclick=\"window.ga('send', 'event', 'byline', 'click', 'permalink');\" >"+e.$$escapeHtml(n.post.author.displayName)+"</a>",r=(null==a.replyData?null:a.replyData.atUser)==n.post.authorBlogName,s+=(r?'<span class="moderator-name">, Host</span>':"")+("reply"==n.mode&&(null==n.post.replyMeta?null:null==n.post.replyMeta.parentAuthor?null:n.post.replyMeta.parentAuthor.displayName)?'<span class="reply-author replyto-author"><span class="icon--svg u-downsized">'+t.icons.essential.chevronRight(null,null,a)+"</span>"+((null==n.post.replyMeta?null:n.post.replyMeta.showParentByline)&&""!=(null==n.post.replyMeta?null:n.post.replyMeta.parentByline)?e.$$escapeHtml(window.kinja.stripHtmlTags(n.post.replyMeta.parentByline,"")):e.$$escapeHtml(n.post.replyMeta.parentAuthor.displayName))+"</span>":"")+(n.contributors?' <span class="text-normal text-tiny">'+(1==n.contributors?"and 1 other":n.contributors>1?"and "+e.$$escapeHtml(n.contributors)+" others":"")+"</span>":"")+"</span>",n.blog&&n.post.isStarter&&n.post.defaultBlogId!=n.post.author.defaultBlogId&&n.post.defaultBlogId!=n.blog.id||n.forSharedPost){s+='<span class="published-on">';for(var s,o,r,c=n.post.blogs,l=c.length,i=0;l>i;i++)o=c[i],s+=o.id==n.post.defaultBlogId?' on <a class="blog-name" href="http://'+e.$$escapeHtmlAttribute(o.canonicalHost)+'" target="_self" '+(n.post.isPromoted?'rel="nofollow"':"")+">"+e.$$escapeHtml(o.displayName)+"</a>":"";s+="</span>"}}else s+='<span class="display-name">'+e.$$escapeHtml(window.kinja.stripHtmlTags(n.post.byline,""))+"</span>";return s+=n.post.postAction&&n.post.postAction.author&&n.post.postAction.author.displayName?'<span class="reposted-by">shared by <span class="text-upper">'+e.$$escapeHtml(n.post.postAction.author.displayName)+"</span></span>":""},n.DEBUG&&(t.components.post.meta.topByline.soyTemplateName="tiger.components.post.meta.topByline"),t.components.post.meta.promotedByline=function(n,a,i){var o,s='<span class="meta-promoted"><span class="promoted-dot">&middot;</span> '+(n.post.sponsored||n.post.isBillboardPost?'<span class="sponsored-label text-upper">Sponsored</span><span class="icon--svg">'+t.icons.essential.starCircle(null,null,i)+"</span>":"");return n.post.isPromoted&&(o=""+(n.post.promotion&&n.post.promotion.byline&&""!=n.post.promotion.byline?e.$$escapeHtml(n.post.promotion.byline):n.post.promotion&&n.post.promotion.authorDisplayName?e.$$escapeHtml(n.post.promotion.authorDisplayName):""),s+='Promoted by <span class="js_promoted_displayName">'+e.$$filterNoAutoescape(o)+"</span>"),s+="</span>"},n.DEBUG&&(t.components.post.meta.promotedByline.soyTemplateName="tiger.components.post.meta.promotedByline"),t.components.post.meta.publishTime=function(n,o,s){return'<span class="publish-time js_publish_time" data-publishtime="'+e.$$escapeHtmlAttribute(n.post.publishTimeMillis)+'">'+(n.post.postAction&&n.post.postAction.createTime?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'" target="_self" '+(n.post.isPromoted?'rel="nofollow"':"")+(n.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(n.post.postAction.createTime.Mddyyhmma)+'"':"")+">"+(n.showRelativeTime?t.components.post.meta.relativeTime({time:n.post.postAction.createTime},null,s):"")+'<span class="'+(n.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(n.post.postAction.createTime.Mddyyhmma)+"</span></a>":n.post.publishTime?"SCHEDULED"==n.post.status?'Scheduled:<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'" target="_self" '+(n.post.isPromoted?'rel="nofollow"':"")+(n.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(n.post.publishTime.Mddyyhmma)+'"':"")+">"+(n.showRelativeTime?t.components.post.meta.relativeTime({time:n.post.publishTime},null,s):"")+'<span class="'+(n.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(n.post.publishTime.Mddyyhmma)+'</span></a><span class="icon--svg u-prepended">'+t.icons.actions.clock(null,null,s)+"</span>":"DRAFT"==n.post.status?'Draft<span class="icon--svg u-prepended">'+t.icons.actions.write(null,null,s)+'</span><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'" target="_self" '+(n.post.isPromoted?'rel="nofollow"':"")+(n.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(n.post.publishTime.Mddyyhmma)+'"':"")+">"+(n.showRelativeTime?t.components.post.meta.relativeTime({time:n.post.publishTime},null,s):"")+'<span class="'+(n.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(n.post.publishTime.Mddyyhmma)+"</span></a>":'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(n.post.permalink))+'" target="_self" '+(n.post.isPromoted?'rel="nofollow"':"")+(n.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(n.post.publishTime.Mddyyhmma)+'"':"")+">"+(n.showRelativeTime?t.components.post.meta.relativeTime({time:n.post.publishTime},null,s):"")+'<span class="'+(n.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(n.post.publishTime.Mddyyhmma)+"</span></a>":"")+"</span>"},n.DEBUG&&(t.components.post.meta.publishTime.soyTemplateName="tiger.components.post.meta.publishTime"),t.components.post.meta.avatarContainer=function(e,a,n){var i,s="",o="avt-small";return e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?(i="gif"==e.post.author.avatar.format?"jpg":e.post.author.avatar.format,s+=t.components.post.meta.avatarDisplay({url:"//kinja.com/"+e.post.author.screenName,avatar:window.kinja.imageUrl(e.post.author.avatar.id,o,i),nofollow:e.post.isPromoted},null,n)):s+=e.post.salesAvatarMap&&e.post.salesAvatarMap.id?t.components.post.meta.avatarDisplay({avatar:window.kinja.imageUrl(e.post.salesAvatarMap.id,o)},null,n):t.components.post.meta.avatarDisplay(null,null,n),s},n.DEBUG&&(t.components.post.meta.avatarContainer.soyTemplateName="tiger.components.post.meta.avatarContainer"),t.components.post.meta.postInfo=function(n,o,s){return'<span class="meta-tools"><div class="view-count-container"></div><a data-likecount="'+e.$$escapeHtmlAttribute(null!=n.post.likes?n.post.likes:0)+'" href="#" data-analytics-target="starterTop" class="js_like button-recommend-post hover-icon icon--svg u-darkened--onhover js_like_icon" title="Recommend"><span class="js_like_count">'+(n.post.likes&&n.post.likes>0?e.$$escapeHtml(n.post.likes):"")+"</span>"+t.icons.essential.star(null,null,s)+"</a></span>"},n.DEBUG&&(t.components.post.meta.postInfo.soyTemplateName="tiger.components.post.meta.postInfo"),t.components.post.meta.postViewCount=function(n,o,s){return""+(n.isBlip&&!n.isBillboardPost||n.forSharedPost?"":n.viewstats&&n.viewstats.nonUniqueFormatted&&"0"!=n.viewstats.nonUniqueFormatted&&("permalink"==n.pageType||"dashboard"==n.pageType||"manageblog"==n.pageType)?(s.features.newstream?t.icons.essential.flameGiant(null,null,s):"")+'<span class="view-count '+(s.features.newstream?"":"icon--svg")+'" '+(n.viewstats.uniqueFormatted?' title="'+e.$$escapeHtmlAttribute(n.viewstats.uniqueFormatted)+' New Visitors"':"")+">"+e.$$escapeHtml(n.viewstats.nonUniqueFormatted)+(s.features.newstream?"":t.icons.essential.flame(null,null,s))+"</span>":"")},n.DEBUG&&(t.components.post.meta.postViewCount.soyTemplateName="tiger.components.post.meta.postViewCount")}),define("module/PostApp",["jquery","underscore","singleton/Utils","singleton/CurrentUser","singleton/CurrentBlog","singleton/Feature","singleton/IframeResizer","module/BaseApp","module/KinjaAnalytics","app/MarionetteApp","app/AnnotationApplet","app/mixins/PostViewLoader","app/mixins/RecommendAssetMixin","model/post/Post","view/GifImageLoader","lib/sha1","gawkerlib/urlUtil","view/sharingfooter.view","singleton/WindowController","module/promotions/promotions.controller","app/leftrail/leftrailContainedList.view","module/ads/ads.events","lib/jquery.cookie","templates/tiger/components/post/meta/meta-components","templates/tiger/section/sidebar"],function(e,s,n,o,c,t,w,m,h,u,y,b,f,i,g,p,a,v,l,j,d,_){"use strict";var r,O=m.extend(s.extend({},b,f,{starterPost:null,initApp:function(){m.prototype.initApp.call(this),this.starterPost=new i(n.getKinjaMeta().post),this.initPostTools(this.starterPost.id),this.imageLoader=new g({el:document}),e(".js_ad-mobile-second").length&&e(".js_ad-mobile-waypoint").length&&l.isSmall()&&e(".js_ad-mobile-waypoint").waypoint({handler:function(t){"down"===t&&_.trigger("ads.dynamicad.load",e(".js_ad-mobile-second .js_ad-container"),"MOBILE_SECOND")},offset:"50%",triggerOnce:!0})},start:function(){var i,a=c.blogGroup||"default";t.isOn("delaydiscussion")&&!n.isCommentPermalinkPage()?l.registerWaypointWithTimeout(e(u.discussionRegion.el),"150%",this.startDiscussionApplet.bind(this),1e4):this.startDiscussionApplet(),this.startAnnotations(),t.isOn("nosocialscripts")||l.registerWaypointWithTimeout(e(".fb-like"),"150%",this.loadFacebook.bind(this),3e3),this.startAmazonStats(),this.startAmazonTextLinksWithSha(),this.insertViewstats(),t.isOn("no3rdparty")||((t.isOn("moatads_promoted")||t.isOn("moatads_headertag"))&&this.insertMoatAdScript(),(t.isOn("taboola")||t.isOn("only_taboola"))&&this.addTaboola()),o.onLoggedIn.done(s.bind(this.initAssetRecommendation,this)),t.isOn("analyticstracking")&&this.initPermalinkViewTracking(),w.start(),t.isOn("post_completion")&&this.trackPostCompletion(),j.startPromotions(),i=e("#sharingfooter"),i.length>0&&(this.sharingfooter=new v({el:i,model:this.starterPost})),window.markUserTime("JS - After PostApp start - "+(t.isOn("webpack")?"Webpack":"Require")+" - "+a)},initLeftrailContained:function(){var n;t.isOn("personalized_trending_module")||t.isOn("trending_test_c")?e.ajax("//kinja.com/api/analytics/kala/recommendedPostsForUser",{xhrFields:{withCredentials:!0},crossDomain:!0}).done(function(t){var o=t.data||[],i="?"+o.map(function(e){return"id="+e}).join("&");e.ajax("/api/core/corepost/getList"+i).done(function(o){var i=o.data||[],t=i.map(function(t){return e.extend(t,{authorNameOrByline:t.author.displayName||t.byline,image:t.sharingMainImage||(t.images||[])[0],defaultBlogName:(s.find(t.blogs,function(e){return e.id===t.defaultBlogId})||{}).displayName})}).slice(0,3);n=new d({el:".js_sidebar",trendingPosts:t.length>2?t:void 0}),n.render()})}).fail(function(){n=new d({el:".js_sidebar"}),n.render()}):(n=new d({el:".js_sidebar"}),n.render())},startDiscussionApplet:function(){return require(["module/DiscussionIconModule"],function(){}),this.shouldLoadReplies()&&require(["module/DiscussionModule"],function(e){u.discussionRegion.show(e)}),!1},shouldLoadReplies:function(){return this.starterPost.get("allowReplies")!==!1||0!==this.starterPost.get("replyCount")},startAnnotations:function(){new y({model:this.starterPost,el:e("body")}).startApp()},startAmazonStats:function(){var t=this;o.onLoggedIn.done(function(){o.hasPermission("SALES")&&"on"===n.getParameterByName("amazonstats")&&require(["module/AmazonStats"],function(n){var s=e(".post-wrapper article.post"),o=new n({postId:t.starterPost.id});s.prepend(o.$el)})}.bind(this))},startAmazonTextLinks:function(){if(""===document.referrer)return!1;var n=s.filter(e(".post-content a"),function(t){return!!e(t).data("amazontag")}),t=document.referrer.match(/:\/\/([^/]+)\//);null!==t&&(t=t[1],s.each(n,function(n){var s=e(n).attr("href").replace("&ascsubtag=","&ascsubtag=[r|"+t);e(n).attr("href",s)}))},startAmazonTextLinksWithSha:function(){var n=function(e){var t=new p(e,"TEXT");return t.getHash("SHA-1","HEX")},d=function(e){var t=document.referrer;return""===t?e:"[r|"+t+e},i=function(e){return e.split("?")[0]},t=function(e){return a.fromQueryString(e.split("?")[1])},l=function(n){var e=t(n),s=e.ascsubtag;return e.rawdata=s,i(n)+a.toQueryString(e)},c=function(){return s.filter(e(".post-content a"),function(t){return!!e(t).data("amazontag")})},r=function(e){var n=t(e),s=n.rawdata;return s},o=function(s,n){var o=i(n),e=t(n),r=e.ascsubtag,c=s(r);return e.ascsubtag=c,o+a.toQueryString(e)},u=function(e){return o(d,e)},h=function(e){return o(n,e)},m=function(t){e(t).click(function(){var s=r(e(t).attr("href")),o=encodeURIComponent(s);e.ajax("/api/ecommerce/amazon/putSubtag?data="+o,{type:"GET",error:function(e){require(["module/Raven"],function(t){t.captureMessage("Analytics: Could not send subtag",{extra:{subtag:s,subtagSha:n(s),analyticsResponse:e.status,analyticsResponseStatusText:e.statusText,analyticsResponseText:e.responseText}})})}})})},f=function(s,t){var o=String(e(t).attr("href")),n=s(o);return e(t).attr("href",n),n},g=function(e){f(s.compose(h,l,u),e)};s.forEach(c(),function(e){g(e),m(e)})},initUserTools:function(){var t,e=this.options.id;n.getKinjaMeta().post&&n.getKinjaMeta().post.id!==this.options.id&&(e=n.getKinjaMeta().post.id),t=new i({id:e})},trackPostCompletion:function(){var t=e(window),n=e(".post-bottom").offset().top,o=function(){var e=t.height(),s=e+t.scrollTop();s>n&&(window.ga("send","event","post completion","post completion",{nonInteraction:1}),t.off("scroll.postCompletion"))};t.on("scroll.postCompletion",s.throttle(o,1e3))},insertMoatAdScript:function(){if(!n.getKinjaMeta().post.sponsored)return!1;var t=['<script type="text/javascript">',"(function(){",'var a=document,b=a.createElement("script"),a=a.getElementsByTagName("script")[0];','b.type="text/javascript";b.async=!0;','b.src="http://js.moatads.com/gawkersppage4859385728/moatcontent.js";',"a.parentNode.insertBefore(b,a)","})();","<\/script>"];e("body").append(t.join(""))},initAssetRecommendation:function(){var e=new i(n.getKinjaMeta().post),s=o.hasRole("ADMIN",e.get("defaultBlogId")),a=o.isSuperuser()&&t.isOn("superuser");(s||a)&&this.startRecommendAssetMixin(e)},insertViewstats:function(){var r=this,t=this.starterPost.get("id"),s=this.options.id,o=new i({id:t}),c=function(e,t){var n=r.soyToHtml(tiger.components.post.meta.postViewCount,{isBlip:o.get("isBlip"),isBillboardPost:o.get("isBillboardPost"),viewstats:e});r.$el.find(".view-count-container").eq(t).html(n)},a=function(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},n=function(t,n){e.ajax("/api/analytics/kala/viewsForPost?id="+t).done(function(t){var e=t.data[0]||{},s=a(e.views||0),o=a(e.uniqueViews||0);e.nonUniqueFormatted=s,e.uniqueFormatted=o,c(e,n)})};t!==s?(n(t,0),n(s,1)):n(t,0)},initPermalinkViewTracking:function(){var t=this.starterPost.get("id"),s=e(".js_stats").data("unique")||!1,n=e("#analytics-permalink-view").data(),i=n.authorId,a=(n.tagIds||"").toString().split(",");h.setContext(c.id,"PERMALINK",t),h.pushEvent("PERMALINK_VIEW","POST",t,{blogName:c.canonicalHost,unique:s,authorId:i.toString(),isLoggedIn:o.isLoggedIn()?1:0},{tagIds:a})},loadFacebook:function(){e.getScript("https://connect.facebook.net/en_US/sdk.js",function(){window.fbAsyncInit=function(){window.FB.init({appId:n.getKinjaMeta().blog&&n.getKinjaMeta().blog.fbAppId?n.getKinjaMeta().blog.fbAppId:"36368793975",version:"v2.0",status:!0,cookie:!0,xfbml:!0})}})},addTaboola:function(){var s=this.starterPost.get("sponsored"),e="Below Article Thumbnails Organic",n=window.parseInt(t.value("discussion_truncation")||0,10);n&&(e+=" - "+n+" Threads"),window._taboola=window._taboola||[],window._taboola.push({article:"auto"}),window._taboola.push({mode:s?"organic-thumbnails-a":"thumbnails-a",container:"taboola-below-article-thumbnails",placement:e,tracking:"utm_source=taboola",target_type:"mix"})}}));return r=parseInt(n.getKinjaMeta().postId,10),"permalink"===n.getKinjaMeta().pageType&&!isNaN(r)&&new O({id:r}).start()})