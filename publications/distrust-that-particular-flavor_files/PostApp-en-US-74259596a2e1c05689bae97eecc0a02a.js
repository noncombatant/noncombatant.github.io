if("undefined"==typeof tiger)var tiger={};"undefined"==typeof tiger.components&&(tiger.components={}),"undefined"==typeof tiger.components.ad&&(tiger.components.ad={}),"undefined"==typeof tiger.components.annotation&&(tiger.components.annotation={}),"undefined"==typeof tiger.components.blogdropdown&&(tiger.components.blogdropdown={}),"undefined"==typeof tiger.components.duiModal&&(tiger.components.duiModal={}),"undefined"==typeof tiger.components.forms&&(tiger.components.forms={}),"undefined"==typeof tiger.components.forms.modals&&(tiger.components.forms.modals={}),"undefined"==typeof tiger.components.forms.search&&(tiger.components.forms.search={}),"undefined"==typeof tiger.components.groupchats&&(tiger.components.groupchats={}),"undefined"==typeof tiger.components.header&&(tiger.components.header={}),"undefined"==typeof tiger.components.header.notifications&&(tiger.components.header.notifications={}),"undefined"==typeof tiger.components.invites&&(tiger.components.invites={}),"undefined"==typeof tiger.components.invites.menuItems&&(tiger.components.invites.menuItems={}),"undefined"==typeof tiger.components.invites.modals&&(tiger.components.invites.modals={}),"undefined"==typeof tiger.components.navpanels&&(tiger.components.navpanels={}),"undefined"==typeof tiger.components.notifications&&(tiger.components.notifications={}),"undefined"==typeof tiger.components.post&&(tiger.components.post={}),"undefined"==typeof tiger.components.post.button&&(tiger.components.post.button={}),"undefined"==typeof tiger.components.post.media&&(tiger.components.post.media={}),"undefined"==typeof tiger.components.post.meta&&(tiger.components.post.meta={}),"undefined"==typeof tiger.components.promotions&&(tiger.components.promotions={}),"undefined"==typeof tiger.components.spinner&&(tiger.components.spinner={}),"undefined"==typeof tiger.components.user&&(tiger.components.user={}),"undefined"==typeof tiger.icons&&(tiger.icons={}),"undefined"==typeof tiger.icons.actions&&(tiger.icons.actions={}),"undefined"==typeof tiger.icons.essential&&(tiger.icons.essential={}),"undefined"==typeof tiger.icons.places&&(tiger.icons.places={}),"undefined"==typeof tiger.messages&&(tiger.messages={}),"undefined"==typeof tiger.messages.postAction&&(tiger.messages.postAction={}),"undefined"==typeof tiger.messages.time&&(tiger.messages.time={}),"undefined"==typeof tiger.section&&(tiger.section={}),"undefined"==typeof tiger.section.header&&(tiger.section.header={}),"undefined"==typeof tiger.section.sidebar&&(tiger.section.sidebar={}),"undefined"==typeof tiger.utils&&(tiger.utils={}),define("app/editor/config/paths",[],function(){"use strict";return{proxiedPath:"/proxy/iframe?url="}}),define("singleton/IframeResizer",["underscore","app/editor/config/paths"],function(e,t){"use strict";function s(n,s){function o(e,t,n){n.setAttribute(e,t)}if(n&&s){var i=e.filter(document.getElementsByTagName("iframe"),function(n){var i=decodeURI(n.src),o=decodeURI(s),a=t.proxiedPath+encodeURIComponent(o);return e.contains([o,a],i)});e.each(["width","height"],function(t){"number"==typeof n[t]&&e.each(i,o.bind(0[0],t,n[t]))})}}function o(t){var o,s=t.data,i=window.location.protocol+"//"+window.location.host;if((t.origin===i||t.origin.match(n))&&s){if(e.isObject(s)&&s.kinja)return s.kinja;try{o=JSON.parse(s).kinja}catch{}return o||!1}}var n,i;return n=/^https?:\/\/(\w+\.)?(kinja.com|gawker-labs.com|localhost:7000|kinja\.dev:9000)$/,i={start:function(){function t(e){var t=o(e);t&&t.resizeFrame&&t.sourceUrl&&s(t.resizeFrame,t.sourceUrl),t&&t.getUrl&&e.source.postMessage({kinja:{url:window.location.href}},e.origin)}window.addEventListener("message",t),window._K_MSGS&&e.each(window._K_MSGS,t),window.removeEventListener("message",window._K_MSG_L),delete window._K_MSG_L}}}),function(){"use strict";define("module/Main",["jquery","singleton/Feature","singleton/RavenConfig","singleton/Trackers","singleton/DeviceController","singleton/PerfTracker","module/ads/ads.controller","app/MarionetteApp","singleton/CurrentUser","singleton/CurrentBlog","lib/kriteo","module/foundation/Foundation5","lib/polyfills/json-null-old-android"],function(e,t,n,s,o,i,a,r){function c(){n.init(),t.isOn("no3rdparty")?s.loadDummy():(s.load(),o.setDevice(),a.startAds()),r.start(),t.isOn("frontendtiming")&&window.setTimeout(function(){i.start()},0)}return e.ajaxSetup({cache:!0}),{start:c}})}(),define("templates/tiger/messages",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.messages.areYouSureToDisconnect=function(){return"Are you sure you want to disconnect this account?"},s.DEBUG&&(t.messages.areYouSureToDisconnect.soyTemplateName="tiger.messages.areYouSureToDisconnect"),t.messages.settingsSaved=function(){return"Settings saved successfully."},s.DEBUG&&(t.messages.settingsSaved.soyTemplateName="tiger.messages.settingsSaved"),t.messages.confirmationEmail=function(){return"Confirmation email has been sent."},s.DEBUG&&(t.messages.confirmationEmail.soyTemplateName="tiger.messages.confirmationEmail"),t.messages.blogPropertySaved=function(){return"Blog property saved successfully."},s.DEBUG&&(t.messages.blogPropertySaved.soyTemplateName="tiger.messages.blogPropertySaved"),t.messages.blogPropertyCreated=function(){return"Blog property created successfully."},s.DEBUG&&(t.messages.blogPropertyCreated.soyTemplateName="tiger.messages.blogPropertyCreated"),t.messages.blogPropertyDeleted=function(){return"Blog property deleted successfully."},s.DEBUG&&(t.messages.blogPropertyDeleted.soyTemplateName="tiger.messages.blogPropertyDeleted"),t.messages.ownerSet=function(){return"New owner has been set."},s.DEBUG&&(t.messages.ownerSet.soyTemplateName="tiger.messages.ownerSet"),t.messages.cannotDisconnectLoginAccount=function(){return"You cannot disconnect your login account from Kinja. Please switch your login account, save, and try again."},s.DEBUG&&(t.messages.cannotDisconnectLoginAccount.soyTemplateName="tiger.messages.cannotDisconnectLoginAccount"),t.messages.repliesDisabled=function(e,n,s){return'<div class="twelve columns end mbx"><div class="reply-create media"><div class="img mrm icon--svg">'+t.icons.discussion.bubbleClose(null,null,s)+'</div><div class="bd proxima"><span class="msg text-small text-light">This discussion is closed</span></div></div></div>'},s.DEBUG&&(t.messages.repliesDisabled.soyTemplateName="tiger.messages.repliesDisabled"),t.messages.imageUploadError=function(){return"Image upload error."},s.DEBUG&&(t.messages.imageUploadError.soyTemplateName="tiger.messages.imageUploadError"),t.messages.assetRecommended=function(){return"Media recommended."},s.DEBUG&&(t.messages.assetRecommended.soyTemplateName="tiger.messages.assetRecommended"),t.messages.assetUnrecommended=function(){return"Removed media recommendation."},s.DEBUG&&(t.messages.assetUnrecommended.soyTemplateName="tiger.messages.assetUnrecommended"),t.messages.amazonBestSellerReport=function(){return"<p><small>If the blog list is omitted, all blogs will be taken into account. If the limit is set to 0, no limit is set.</small></p>"},s.DEBUG&&(t.messages.amazonBestSellerReport.soyTemplateName="tiger.messages.amazonBestSellerReport"),t.messages.amazonTagReport=function(){return"<p><small>Beware: If the checkbox above is unchecked, Amazon statistics and posts will both be filtered by the date picker. This means that earnings and orders for posts which were published earlier will <strong>not</strong> be shown here.</small></p>"},s.DEBUG&&(t.messages.amazonTagReport.soyTemplateName="tiger.messages.amazonTagReport")}),define("templates/tiger/components/notifications/button",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.notifications.button=function(e,n,s){var i='<a href="#" class="js_notification-trigger hide-for-medium-down toolbar-icon notifications-menu is-loaded '+(e.notificationCount>0?"has-notification":"")+'" title="'+(e.notificationCount>999?t.messages.notifications({count:e.notificationCount},null,s):"Notifications")+'" data-dropdown="notifications-menu"><span class="icon-circle icon-notifications"></span>',a=""+(e.notificationCount>999?"infinite":e.notificationCount>99?"hundred":1==e.notificationCount?"only-one":"");return i+='<span class="notification-count js_notification-count '+o.$$escapeHtmlAttribute(a)+'">'+t.components.notifications.count(e,null,s)+"</span></a>"},s.DEBUG&&(t.components.notifications.button.soyTemplateName="tiger.components.notifications.button"),t.components.notifications.count=function(e){var i="",s=""+(e.notificationCount>999?"∞":e.notificationCount?o.$$escapeHtml(e.notificationCount):"");return i+=s?o.$$escapeHtml(s):""},s.DEBUG&&(t.components.notifications.count.soyTemplateName="tiger.components.notifications.count")}),define("templates/tiger/components/header/notifications",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.header.notifications.notificationsEmpty=function(){return'<li class="text-center pvm js_notification-item">You have no unread notifications.</li>'},s.DEBUG&&(t.components.header.notifications.notificationsEmpty.soyTemplateName="tiger.components.header.notifications.notificationsEmpty"),t.components.header.notifications.notificationsSpinner=function(e,n,s){return'<li class="js_spinner notifications-spinner">'+t.components.spinner.bounce(null,null,s)+"</li>"},s.DEBUG&&(t.components.header.notifications.notificationsSpinner.soyTemplateName="tiger.components.header.notifications.notificationsSpinner"),t.components.header.notifications.globalNotificationsDropdown=function(e,n,s){return'<section class="notif-list"><div class="notif-list-scroll-wrapper"><ul class="js_notification-list menu-list"></ul></div><ul class="menu-list see-all-link"><li class="more"><div class="show-for-large-up"><a class="js_event-link js_see-all-notifications" data-ga="[Notifications Menu, See All Notifications Click]" href="//kinja.com/dashboard/notifications">See all notifications</a></div><div class="show-for-medium-down"><a class="button secondary hide icon--svg u-highlighted js_event-link js_see-all-notifications" data-ga="[Notifications Menu, See All Notifications Click]" href="//kinja.com/dashboard/notifications">See all notifications'+t.icons.essential.chevronRight(null,null,s)+"</a></div></li></ul></section>"},s.DEBUG&&(t.components.header.notifications.globalNotificationsDropdown.soyTemplateName="tiger.components.header.notifications.globalNotificationsDropdown"),t.components.header.notifications.globalNotificationEvent=function(e,n,s){var o="";switch(e.item.variant){case"PresentableApproval":o+=t.components.header.notifications.approval(e,null,s);break;case"PresentableUserFollow":o+=t.components.header.notifications.userfollow(e,null,s);break;case"PresentableBlogFollow":o+=t.components.header.notifications.blogfollow(e,null,s);break;case"PresentableMessage":o+=t.components.header.notifications.message(e,null,s);break;case"PresentablePostFollow":o+=t.components.header.notifications.postfollow(e,null,s);break;case"PresentablePostLikeGroup":o+=e.item.sourceAuthorData&&e.item.sourceAuthorData.id?t.components.header.notifications.postlikegroup(e,null,s):"";break;case"PresentableReply":o+=t.components.header.notifications.reply(e,null,s);break;case"PresentableRepost":o+=t.components.header.notifications.repostpost(e,null,s);break;case"PresentableShare":o+=t.components.header.notifications.sharepost(e,null,s);break;case"PresentablePendingMembership":o+=t.components.header.notifications.pendingmembership(e,null,s);break;case"PresentableMembershipResponse":o+=t.components.header.notifications.membershipresponse(e,null,s)}return o+='<span class="unread-marker"></span>'},s.DEBUG&&(t.components.header.notifications.globalNotificationEvent.soyTemplateName="tiger.components.header.notifications.globalNotificationEvent"),t.components.header.notifications.blogfollow=function(e,n,s){return'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.screenName)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.add(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.avatar.id,"avt-small",e.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.defaultBlog.displayName)+'</span><span class="event-msg">started following you.</span></span></div></div></a>'},s.DEBUG&&(t.components.header.notifications.blogfollow.soyTemplateName="tiger.components.header.notifications.blogfollow"),t.components.header.notifications.approval=function(e,n,s){return'<a href="http://'+o.$$escapeHtmlAttribute(null==e.item.sourceBlogData?null:e.item.sourceBlogData.canonicalHost)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.add(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar">'+((null==e.item.sourceBlogData?null:e.item.sourceBlogData.avatar)?'<img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.sourceBlogData.avatar.id,"avt-small",e.item.sourceBlogData.avatar.format)))+'" />':'<img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.imgPath))+'icons/icon-kinja-nav.png" />')+'</span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(null==e.item.sourceBlogData?null:e.item.sourceBlogData.displayName)+'</span><span class="event-msg">'+(s.features.approvemessage?"approved you":"started following you")+"</span></span></div></div></a>"},s.DEBUG&&(t.components.header.notifications.approval.soyTemplateName="tiger.components.header.notifications.approval"),t.components.header.notifications.reply=function(e,n,s){var a,i="",r=(e.item.reply,null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName);return i+=(s.features.hide_pending_replies&&!(null==e.item.postData?null:e.item.postData.approved)?'<span class="pending-label">Pending approval</span>':"")+'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(null==e.item.postData?null:e.item.postData.permalink))+'" data-ga="[Notifications Menu, Reply Notification Click]" class="js_event-link event-reply icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.bubble(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center">',a="avt-small",i+='<span class="avatar">'+((null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.avatar)?'<img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.sourceAuthorData.avatar.id,a,e.item.sourceAuthorData.avatar.format)))+'" />':'<span class="avatar-default"></span>')+'</span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(r)+'</span><div class="text-normal text-small">replied to you:</div><div class="msg-excerpt">'+o.$$truncate(o.$$filterNoAutoescape(null==e.item.postData?null:e.item.postData.plaintext),80,!0)+"</div></span></div></div></a>"},s.DEBUG&&(t.components.header.notifications.reply.soyTemplateName="tiger.components.header.notifications.reply"),t.components.header.notifications.postlikegroup=function(e,n,s){var a="",i=e.item.sourceAuthorsData.length;return a+='<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(null==e.item.postData?null:e.item.postData.permalink))+'" data-ga="[Notifications Menu, Recommend Group Notification Click]" class="js_event-link event-like icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.star(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.sourceAuthorData.avatar.id,"avt-small",e.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt">'+((null==e.item.postData?null:e.item.postData.headline)?1==i?'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and one other recommended <strong>'+o.$$filterNoAutoescape(null==e.item.postData?null:e.item.postData.headline)+"</strong>.</span>":i>1?'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and '+o.$$escapeHtml(e.item.sourceAuthorsData.length)+" others recommended <strong>"+o.$$filterNoAutoescape(null==e.item.postData?null:e.item.postData.headline)+"</strong>.</span>":'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+' </span><span class="event-msg">recommended <strong>'+o.$$filterNoAutoescape(null==e.item.postData?null:e.item.postData.headline)+"</strong>.</span></span>":1==i?'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and one other recommended your post.</span></span>':i>1?'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and '+o.$$escapeHtml(e.item.sourceAuthorsData.length)+" others recommended your post</strong>.</span></span>":'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+' </span><span class="event-msg">recommended your post.</span></span>')+"</span></div></div></a>"},s.DEBUG&&(t.components.header.notifications.postlikegroup.soyTemplateName="tiger.components.header.notifications.postlikegroup"),t.components.header.notifications.message=function(e,n,s){return'<div><div class="row collapse" data-ga="[Notifications Menu, Message Notification Click]"><div class="col small-2 center">'+t.icons.actions.lightning(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.avatar.id,"avt-small",null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+'</span> messaged you:<br><span class="msg-excerpt">'+o.$$escapeHtml(e.item.message)+"</span></span></div></div></div>"},s.DEBUG&&(t.components.header.notifications.message.soyTemplateName="tiger.components.header.notifications.message"),t.components.header.notifications.postfollow=function(){return""},s.DEBUG&&(t.components.header.notifications.postfollow.soyTemplateName="tiger.components.header.notifications.postfollow"),t.components.header.notifications.sharepost=function(e,n,s){return'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(null==e.item.sharedData?null:e.item.sharedData.permalink))+'" data-ga="[Notification Menu, Menu - Share Notification]" class="js_event-link event-share icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.externalLink(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.sourceAuthorData.avatar.id,"avt-small",e.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared your post as <strong>'+o.$$filterNoAutoescape(null==e.item.sharedData?null:e.item.sharedData.headline)+"</strong></span></span></div></div></a>"},s.DEBUG&&(t.components.header.notifications.sharepost.soyTemplateName="tiger.components.header.notifications.sharepost"),t.components.header.notifications.repostpost=function(e,n,s){return""+(e.item.postActionData?'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.item.postActionData.post.permalink))+'" data-ga="[Notification Menu, Menu - Repost Notification]" class="js_event-link event-share icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.externalLink(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.sourceAuthorData.avatar.id,"avt-small",e.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt">'+(e.item.postActionData.post.headline?'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared <strong>'+o.$$filterNoAutoescape(e.item.postActionData.post.headline)+"</strong> to "+o.$$escapeHtml(null==e.item.postActionData?null:e.item.postActionData.blog.displayName)+"</span>":'<span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared your reply to '+o.$$escapeHtml(null==e.item.postActionData?null:e.item.postActionData.blog.displayName)+"</span>")+"</span></div></div></a>":"")},s.DEBUG&&(t.components.header.notifications.repostpost.soyTemplateName="tiger.components.header.notifications.repostpost"),t.components.header.notifications.globalNotificationsButton=function(e,n,s){var a="",i=""+(e.notificationCount>999?"infinite":e.notificationCount>99?"hundred":1==e.notificationCount?"only-one":"");return a+='<a class="js_notif show-for-large-up js_menu-button '+(e.notificationCount?"has-notification":"")+'" data-dropdown="js_notifications--dropdown" data-ga="[Notifications Menu, Notifications Menu Click, '+(e.notificationCount?"New":"Neutral")+']">'+(e.notificationCount?'<span class="js_notifications-count notif-circle '+o.$$escapeHtmlAttribute(i)+'">'+t.components.header.notifications.count(e,null,s)+"</span>":'<span class="notif-circle">'+t.icons.actions.lightning(null,null,s)+"</span>")+'</a><a class="js_notif show-for-medium-down js_offcanvas-notif js_menu-button '+(e.notificationCount?"has-notification":"")+'" data-ga="[Notifications Menu, Notifications Menu Click, '+(e.notificationCount?"New":"Neutral")+']">'+(e.notificationCount?'<span class="js_notifications-count notif-circle '+o.$$escapeHtmlAttribute(i)+'">'+t.components.header.notifications.count(e,null,s)+"</span>":'<span class="notif-circle">'+t.icons.actions.lightning(null,null,s)+"</span>")+"</a>"},s.DEBUG&&(t.components.header.notifications.globalNotificationsButton.soyTemplateName="tiger.components.header.notifications.globalNotificationsButton"),t.components.header.notifications.count=function(e){return""+(e.notificationCount>999?"∞":o.$$escapeHtml(e.notificationCount))},s.DEBUG&&(t.components.header.notifications.count.soyTemplateName="tiger.components.header.notifications.count"),t.components.header.notifications.userfollow=function(e,n,s){return'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.screenName)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.essential.add(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.sourceAuthorData.avatar.id,"avt-small",e.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(null==e.item.sourceAuthorData?null:e.item.sourceAuthorData.displayName)+'</span><span class="event-msg">started following you.</span></span></div></div></a>'},s.DEBUG&&(t.components.header.notifications.userfollow.soyTemplateName="tiger.components.header.notifications.userfollow"),t.components.header.notifications.pendingmembership=function(e,n,s){return'<div data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg u-full"><div class="row collapse"><div class="col small-2 center">'+t.icons.places.user(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.invitedByData.avatar.id,"avt-small",e.item.invitedByData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name"></span><span class="event-msg"><strong>'+o.$$escapeHtml(e.item.invitedByData.displayName)+'</strong> invited you to be an author on their blog <a href="http://'+o.$$escapeHtmlAttribute(e.item.blogData.canonicalHost)+'">'+o.$$escapeHtml(e.item.blogData.displayName)+'</a></span></span></div></div><div class="dui row collapse notification__btn-cont"><div class="col small-offset-2 small-5"><a class="button small js_invite-btn" data-accepting="true">Accept</a></div><div class="col small-5"><a class="button small secondary js_invite-btn" data-accepting="false">Decline</a></div></div></div>'},s.DEBUG&&(t.components.header.notifications.pendingmembership.soyTemplateName="tiger.components.header.notifications.pendingmembership"),t.components.header.notifications.membershipresponse=function(e,n,s){return'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.item.blogData.displayName)+'/manage" data-ga="[Notifications Menu, Membership Response Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+t.icons.places.user(null,null,s)+'</div><div class="col small-10"><time>'+o.$$escapeHtml(e.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.item.inviteeData.avatar.id,"avt-small",e.item.inviteeData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+o.$$escapeHtml(e.item.inviteeData.displayName)+'</span><span class="event-msg">'+(e.item.accepted?"accepted your invitation.":"declined your invitation.")+"</span></span></div></div></a>"},s.DEBUG&&(t.components.header.notifications.membershipresponse.soyTemplateName="tiger.components.header.notifications.membershipresponse")}),define("app/notifdropdown/NotificationButton",["backbone.marionette","app/account/account.channel","templates/tiger/messages","templates/tiger/components/notifications/button","templates/tiger/components/header/notifications"],function(e,t){"use strict";var n=e.ItemView.extend({template:tiger.components.header.notifications.globalNotificationsButton,tagName:"span",attributes:function(){return{"data-ga":"["+["Notifications Menu","Notifications Button Click",this.model.get("notificationCount")?"New":"Neutral"].join(", ")+"]"}},activeClass:"active",modelEvents:{"change:notificationCount":"render"},render:function(){e.ItemView.prototype.render.apply(this)},doClick:function(e){this.model.isLoggedIn()?this.toggleClass():(e.stopPropagation(),this.requireLogin())},requireLogin:function(){t.trigger("loginRequired",{source:"notificationButton"})},toggleClass:function(){this.$el.toggleClass(this.activeClass)}});return n}),define("apiclient/notification",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";var o,i=e.api.mantle.url,s=e.api.notification.url;return o={getNotificationCount:t.getJson(n.append(s+"/notification/views/unseenCount")),deleteNotification:t.deleteJson(n.append(s+"/notification/{{notificationId}}")),getNotifications:t.getJson(n.append(i+"/notifications/paginated/{{userId}}",n.fresh))}}),define("app/notifdropdown/notificationCount.model",["backbone","singleton/CurrentUser","apiclient/notification"],function(e,t,n){"use strict";var s=e.Model.extend({defaults:{notificationCount:0,inSync:!1},sync:function(e,s,o){var i=t.get("token"),a=t.isLoggedIn();return a&&i&&-1===i.indexOf("dummy-")?n.getNotificationCount({userId:t.id},o):0[0]},isNew:function(){return!this.get("inSync")},parse:function(e){return{notificationCount:parseInt(e.data,10)||0,inSync:!0}},markAsRead:function(){this.empty(),this.save()},empty:function(){this.set({notificationCount:0})},remove:function(){this.empty(),this.stopListening()}});return s}),define("model/Notification",["backbone","apiclient/profile"],function(e,t){"use strict";var n=e.Model.extend({sync:function(e,n,s){switch(e){case"delete":return t.deleteNotification({notificationId:n.get("id")});case"update":case"create":return s.acceptingInvite?t.acceptMembershipInvitation({invitationId:n.get("invitationId")},s):t.rejectMembershipInvitation({invitationId:n.get("invitationId")},s)}}});return n}),define("templates/tiger/messages/time",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.messages.time.oneSecondAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"seconds"},null,s)},s.DEBUG&&(t.messages.time.oneSecondAgo.soyTemplateName="tiger.messages.time.oneSecondAgo"),t.messages.time.someSecondsAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"seconds",amount:e.seconds},null,s)},s.DEBUG&&(t.messages.time.someSecondsAgo.soyTemplateName="tiger.messages.time.someSecondsAgo"),t.messages.time.oneMinuteAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"minute"},null,s)},s.DEBUG&&(t.messages.time.oneMinuteAgo.soyTemplateName="tiger.messages.time.oneMinuteAgo"),t.messages.time.someMinutesAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"minutes",amount:e.minutes},null,s)},s.DEBUG&&(t.messages.time.someMinutesAgo.soyTemplateName="tiger.messages.time.someMinutesAgo"),t.messages.time.oneHourAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"hours"},null,s)},s.DEBUG&&(t.messages.time.oneHourAgo.soyTemplateName="tiger.messages.time.oneHourAgo"),t.messages.time.someHoursAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"hours",amount:e.hours},null,s)},s.DEBUG&&(t.messages.time.someHoursAgo.soyTemplateName="tiger.messages.time.someHoursAgo"),t.messages.time.oneDayAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"days"},null,s)},s.DEBUG&&(t.messages.time.oneDayAgo.soyTemplateName="tiger.messages.time.oneDayAgo"),t.messages.time.someDaysAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"days",amount:e.days},null,s)},s.DEBUG&&(t.messages.time.someDaysAgo.soyTemplateName="tiger.messages.time.someDaysAgo"),t.messages.time.oneMonthAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"months"},null,s)},s.DEBUG&&(t.messages.time.oneMonthAgo.soyTemplateName="tiger.messages.time.oneMonthAgo"),t.messages.time.someMonthsAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"months",amount:e.months},null,s)},s.DEBUG&&(t.messages.time.someMonthsAgo.soyTemplateName="tiger.messages.time.someMonthsAgo"),t.messages.time.oneYearAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"years"},null,s)},s.DEBUG&&(t.messages.time.oneYearAgo.soyTemplateName="tiger.messages.time.oneYearAgo"),t.messages.time.someYearsAgo=function(e,n,s){return""+t.messages.time.relativeTime({type:"years",amount:e.years},null,s)},s.DEBUG&&(t.messages.time.someYearsAgo.soyTemplateName="tiger.messages.time.someYearsAgo"),t.messages.time.relativeTime=function(e){e=e||{};var s="";switch(e.type){case"seconds":s+=e.amount&&"1"!=e.amount?o.$$escapeHtml(e.amount)+" seconds ago":"1 second ago";break;case"hours":s+=e.amount&&"1"!=e.amount?o.$$escapeHtml(e.amount)+" hours ago":"an hour ago";break;case"days":s+=e.amount&&"1"!=e.amount?o.$$escapeHtml(e.amount)+" days ago":"yesterday";break;case"weeks":s+=e.amount&&"1"!=e.amount?o.$$escapeHtml(e.amount)+" weeks ago":"a week ago";break;case"months":s+=e.amount&&"1"!=e.amount?o.$$escapeHtml(e.amount)+" months ago":"a month ago";break;case"years":s+=e.amount&&"1"!=e.amount?o.$$escapeHtml(e.amount)+" years ago":"1 year ago";break;case"future":s+=o.$$escapeHtml(e.Mddyyhmma);break;case"minutes":s+=e.amount&&"1"!=e.amount?'<span class="'+(e.timestamp?"minutedisplay-"+o.$$escapeHtmlAttribute(e.timestamp):"")+'">'+o.$$escapeHtml(e.amount)+"</span> minutes ago":'<span class="'+(e.timestamp?"minutedisplay-"+o.$$escapeHtmlAttribute(e.timestamp):"")+'">A</span> minute ago';break;case"today":s+="Today "+o.$$escapeHtml(e.hmma);break;case"yesterday":s+="Yesterday "+o.$$escapeHtml(e.hmma);break;case"pastweek":s+=o.$$escapeHtml(e.day)+" "+o.$$escapeHtml(e.hmma);break;case"greaterthanweek":s+=o.$$escapeHtml(e.Mddyyhmma);break;default:s+="Just now"}return s},s.DEBUG&&(t.messages.time.relativeTime.soyTemplateName="tiger.messages.time.relativeTime")}),define("singleton/DateUtils",["singleton/Renderer","moment","templates/tiger/messages/time"],function(e,t){"use strict";var n={getRelativeTime:function(t){var s=Math.round(((new Date).getTime()-parseInt(t,10))/1e3),o=Math.round(s/60),i=Math.round(s/3600),a=Math.round(s/86400),r=Math.round(s/2592e3),c=Math.round(s/31536e3),n=e.renderTemplate,l="";return l=60>s?1===s?n(tiger.messages.time.oneSecondAgo):n(tiger.messages.time.someSecondsAgo,{seconds:s}):60>o?1===o?n(tiger.messages.time.oneMinuteAgo):n(tiger.messages.time.someMinutesAgo,{minutes:o}):24>i?1===i?n(tiger.messages.time.oneHourAgo):n(tiger.messages.time.someHoursAgo,{hours:i}):30>a?1===a?n(tiger.messages.time.oneDayAgo):n(tiger.messages.time.someDaysAgo,{days:a}):12>r?1===r?n(tiger.messages.time.oneMonthAgo):n(tiger.messages.time.someMonthsAgo,{months:r}):1===c?n(tiger.messages.time.oneYearAgo):n(tiger.messages.time.someYearsAgo,{years:c}),l.textContent.replace(/^\s+|\s+$/g,"")},getMDYYYYHHMM:function(e){return t(e).format("M/D/YYYY H:mm")},getMDYYYY:function(e){return t(e).format("M/D/YYYY")},getDateTimeLocalString:function(e){return t(e).format("YYYY-MM-DDTHH:mm:ss")},getTimeInMilliseconds:function(e){return new Date(e).getTime()}};return n}),define("collection/Notifications",["underscore","backbone","model/Notification","singleton/CurrentUser","singleton/DateUtils","singleton/Feature","apiclient/notification"],function(e,t,n,s,o,i,a){"use strict";var r=t.Collection.extend({model:n,initialize:function(n,s){t.Collection.prototype.initialize.call(this,n,s),this.options=e.extend(this.options,s||{})},sync:function(e,t,n){var o=i.isOn("pendingmember");return a.getNotifications({markAsRead:!0,userId:s.id,maxReturned:5,pinPending:o},n)},parse:function(t){return!t||!t.data||!t.meta||t.meta.error||t.meta.success&&t.meta.success!==!0?[]:e.map(t.data.items,function(e){return e.relativeTime=o.getRelativeTime(e.createdAt),e.variant=e.$variant,e})}});return r}),define("app/notifdropdown/notifdropdown.app",["jquery","app/notifdropdown/NotificationButton","app/notifdropdown/notificationCount.model","collection/Notifications","singleton/CurrentUser","singleton/EventDispatcher","app/MarionetteApp","app/account/account.channel"],function(e,t,n,s,o,i,a,r){"use strict";var c,l;return c={notifications:null,notificationCountModel:null,notificationDropdown:null,notificationOffcanvas:null,initialize:function(){var e=new s;this.notifications=e,this.initNotificationButton()},initNotificationButton:function(){this.notificationCountModel=new n,o.onLoggedIn.done(function(){this.notificationCountModel.fetch()}.bind(this)),o.on("clearNotifications",function(){this.notificationCountModel.markAsRead()},this);var s=new t({el:a.notificationRegion.el,model:this.notificationCountModel});e(a.notificationDropdownRegion.el).one("opened.fndtn.dropdown",function(){var e;this.notificationDropdown||(e=this.initNotificationDropdown(),e.done(function(){this.notificationDropdown.trigger("opened:notifications")}.bind(this)))}.bind(this)),s.render(),a.notificationRegion.attachView(s)},initNotificationDropdown:function(){var t=e.Deferred();return require(["module/NotificationListModule"],function(e){this.notificationDropdown=new e({el:a.notificationDropdownRegion.el,collection:this.notifications,model:o}),this.notificationDropdown.on("opened:notifications",function(){o.isLoggedIn()&&(c.notificationDropdown.render(),this.notifications.fetch({reset:!0})),this.notificationCountModel.empty()},this),a.notificationDropdownRegion.attachView(this.notificationDropdown),t.resolve()}.bind(this)),t},remove:function(){i.off(null,null,this),o.off(null,null,this),r.off(null,null,this),this.notificationDropdown&&(this.notificationDropdown.off(null,null,this),this.notificationDropdown=null),this.notificationCountModel&&(this.notificationCountModel.remove(),this.notificationCountModel=null)}},l={initialize:function(){return c.initialize()},fetch:function(){c.notifications.fetch()},remove:function(){c.remove()}}}),define("gawkerlib/analytics/analytics_config_prod",[],function(){"use strict";var e={rootUrl:"http://kinja.com/api/analytics/",rootUrlWoProtocol:"//kinja.com/api/analytics/"};return e}),!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var o,i,a=String(t),s=0,r=n,c="";a.charAt(0|s)||(r="=",s%1);c+=r.charAt(63&o>>8-s%1*8)){if(i=a.charCodeAt(s+=.75),i>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");o=o<<8|i}return c}),t.atob||(t.atob=function(t){if(o=String(t).replace(/=+$/,""),o.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,o,i,a=0,c=0,r="";s=o.charAt(c++);~s&&(i=a%4?64*i+s:s,a++%4)?r+=String.fromCharCode(255&i>>(-2*a&6)):0)s=n.indexOf(s);return r})}(),define("lib/base64.min",function(){}),define("module/KinjaAnalytics",["jquery","gawkerlib/analytics/analytics_config_prod","lib/base64.min"],function(e,t){"use strict";var n={session:{},context:{},setContext:function(e,t,n){this.context.blogId=e,this.context.contextType=t,this.context.id=n},createPayload:function(e,t,n,s,o,i,a,r){var c={blogId:e,eventType:t,targetType:n,targetId:s,contextType:o,contextId:i,eventAttributes:a,eventAttributesExtended:r};return c},pushEvent:function(e,t,n,s,o){var i=this.createPayload(this.context.blogId?String(this.context.blogId):null,e,t,n?String(n):null,this.context.contextType,this.context.id?String(this.context.id):null,s,o);this.writeEvent(i)},setSession:function(e){return!!("string"==typeof e.agid&&"string"==typeof e.asid&&e.ping)&&(this.session.globalId=e.agid,this.session.sessionId=e.asid,this.session.ping=e.ping,!0)},getEventMeta:function(){var e={context:this.context,session:this.session};return e},writeEvent:function(n){var s=btoa(JSON.stringify(n)),o=t.rootUrlWoProtocol,i=Math.floor(1e3*Math.random()+1),a=o+"t/event.js?e="+s+"&cb="+i,r=this;e.ajax(a,{type:"GET",success:function(e){r.setSession(e.data)},xhrFields:{withCredentials:!0},crossDomain:!0})}};return n}),define("view/posttools/BlogFollowToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","singleton/CurrentUser"],function(e,t,n,s,o){"use strict";var i,a;return i=function(e,n){return t.map(n,function(t){return"."+e+'[data-blogid="'+t+'"]'}).join(", ")},a=s.extend({events:{"click .js_followblogforuser":"followBlogForUser","click .js_unfollowblogforuser":"unfollowBlogForUser"},initialize:function(){var e=t.debounce(this.update,1e3);o.onAuthStateChange(e.bind(this)),this.on("update",e,this)},update:function(t){var n;return t=t||{},n=t.el||e("body"),o.onAuth.done(function(){this.resetControls(n),this.removePlaceholderBtn(n),o.isLoggedIn()?(this.updateBlogFollows(o.get("followedBlogIds"),"follow"),this.hideOwnBlogs()):this.resetControls(n)}.bind(this)),this},updateBlogFollows:function(t,n){var s=i("js_follow-blog-controls",t);e(s).find(".js_followblogforuser").toggleClass("hide","follow"===n).end().find(".js_unfollowblogforuser").toggleClass("hide","unfollow"===n)},hideOwnBlogs:function(){var n=i("js_follow-blog-controls",t.pluck(o.getBlogs(),"id"));e(n).addClass("hide")},resetControls:function(e){e.find(".js_unfollowblogforuser").addClass("hide"),e.find(".js_followblogforuser").removeClass("hide")},followBlogForUser:function(e){return this.blogFollowAction(e),!1},unfollowBlogForUser:function(e){return this.blogUnfollowAction(e),!1},blogFollowAction:function(t){var a=e(t.currentTarget).closest(".js_follow-blog-controls"),s=parseInt(a.attr("data-blogid"),10),i="profileFollowList"===e(t.currentTarget).attr("data-analytics-target")?"profileFollowList":"header";n.pushEvent("FOLLOW","BLOG",s,{uiElement:i}),o.requireLogin("blogfollow").done(function(){return-1===o.get("followedBlogIds").indexOf(s)&&void o.followBlog(s).done(function(){this.updateBlogFollows([s],"follow")}.bind(this))}.bind(this))},blogUnfollowAction:function(t){var s=e(t.currentTarget).closest(".js_follow-blog-controls"),n=parseInt(s.attr("data-blogid"),10);o.requireLogin("blogunfollow").done(function(){o.unfollowBlog(n).done(function(){this.updateBlogFollows([n],"unfollow")}.bind(this))}.bind(this))},removePlaceholderBtn:function(t){t=t||e("body"),t.find(".js_list-control__empty").addClass("hide")}})}),define("view/modal/duimodal.defaultBehavior",["jquery","backbone.marionette"],function(e,t){"use strict";var n=t.Behavior.extend({events:{"click .js_close":"onCloseModal"},onShow:function(){e("body").addClass("disable-scroll");var t=e(this.view.bodyRegion.el);window.setTimeout(function(){t.addClass("dui-modal-body-animate")},100),this.contentBlurAdd(),this.$("img[data-src]").each(function(){var t=e(this);t.attr("src",t.data("src")).removeData("src")})},onCloseModal:function(){this.view.close(),this.contentBlurRemove(),e("body").removeClass("disable-scroll")},onCloseModalTimeout:function(e){var t=this;window.setTimeout(function(){t.onCloseModal()},e)},contentBlurAdd:function(){e(".js_page-content, .js_global-nav-wrap").addClass("blur-content")},contentBlurRemove:function(){e(".js_page-content, .js_global-nav-wrap").removeClass("blur-content")}});return n}),define("view/behaviors/googleAnalytics.behavior",["jquery","underscore","backbone.marionette","singleton/Utils"],function(e,t,n,s){"use strict";var o=n.Behavior.extend({events:{"click [data-ga]:not(form)":"onGAClick","submit form[data-ga]":"onGASubmit"},onGAClick:function(t){var n,o=e(t.currentTarget),s=o.closest("a[href]").eq(0);return this.logGAEvent(t),s.length&&(n=s.attr("href"),!/^((http|https):)?\/\//.test(n)||"_blank"===s.attr("target")||t.shiftKey||t.ctrlKey||t.metaKey||(t.preventDefault(),window.setTimeout(function(){window.location.href=n},500))),!0},onGASubmit:function(t){var n=e(t.currentTarget),s=n.attr("action"),o=n.serialize();this.logGAEvent(t),t.preventDefault(),window.setTimeout(function(){window.location.href=s+"?"+o},500)},logGAEvent:function(n){var a=e(n.currentTarget),s=a.attr("data-ga").replace(/[[\]]/g,"").split(/\s*,\s*/g),s=s.map(function(e){return t.contains(o.validKeys,e)?o.replacePlaceholder(e):e}),i=["send","event"].concat(s);window.ga.apply(this,i)}},{validKeys:["js_pageType","js_pageUrl"],replacePlaceholder:function(e){var t=s.getKinjaMeta();switch(e=e.replace(/js_/g,"")){case"pageType":return t.pageType;case"pageUrl":return window.location.url;default:return""}}});return o}),define("templates/tiger/components/blogdropdown",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.blogdropdown.globalBlogDropdown=function(e,n,s){if(a='<div class="top-tools">'+("search"!=e.pageType?'<div class="search-box search show-for-medium-down">'+t.components.forms.search.simpleSearch(e,null,s)+'<div class="divider show-for-medium-down"></div></div>':"")+'<div class="js_login-links show-for-medium-down login-links">'+(e.isLoggedIn?"":'<a href="#" class="login-button button inverse js_login-link" data-ga="[User Menu, Login/Signup Click, js_pageType]">Log in / Sign up</a>')+"</div>"+(e.blog&&""!=e.blog?t.components.blogdropdown.blogfollowbutton(e,null,s):"")+"</div>",e.blogGroup&&e.blogGroup.length){a+='<ul class="blog-list related-blog-list"><li class="title">Related blogs</li>';for(var i,a,c=e.blogGroup,l=c.length,r=0;l>r;r++)i=c[r],a+='<li><a href="http://'+o.$$escapeHtmlAttribute(i.canonicalHost)+'" data-ga="[Kinja Menu, Related Blog Click, '+o.$$escapeHtmlAttribute(i.name)+']" class="icon--svg u-prepended">'+(i.avatar?'<img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(i.avatar.id,"avt-small",i.avatar.format))+'" width="16" height="16" class="icon icon-prepend" />':'<img data-src="//x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png" width="16" height="16" class="icon icon-prepend" />')+o.$$escapeHtml(i.displayName)+"</a></li>";a+="</ul>"}return a+='<ul class="blog-list gmg-blog-list"><li class="title">Blogs you may like</li>'+t.components.globalBlogLinks(null,null,s)+"</ul>"},s.DEBUG&&(t.components.blogdropdown.globalBlogDropdown.soyTemplateName="tiger.components.blogdropdown.globalBlogDropdown"),t.components.blogdropdown.blogfollowbutton=function(e,n,s){var i="";return s.features.follow_plus,i+='<ul class="show-for-medium-down"><li class="js_follow-controls js_follow-blog-controls follow-controls--blog-menu" data-blogid="'+o.$$escapeHtmlAttribute(e.blog.id)+'"><a href="#" class="js_followblogforuser button list-entity__button--follow follow-state following list-control--active svg-icon--white hide"><span>Follow '+o.$$escapeHtml((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"")+"</span>"+t.icons.essential.adDMSall(null,null,s)+'</a><a href="#" class="js_unfollowblogforuser button list-entity__button--following follow-state following list-control--active svg-icon--white hide"><span>Following '+o.$$escapeHtml((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"")+"</span>"+t.icons.essential.checkmarkSmall(null,null,s)+"</a></li></ul>"},s.DEBUG&&(t.components.blogdropdown.blogfollowbutton.soyTemplateName="tiger.components.blogdropdown.blogfollowbutton")}),define("templates/tiger/components/forms/search",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.forms.search.simpleSearch=function(e,n,s){return'<form method="GET" class="search search-simple" '+(e.formId?'id="'+o.$$escapeHtmlAttribute(e.formId)+'" name="'+o.$$escapeHtmlAttribute(e.formId)+'" ':"")+`action="/search" onsubmit="window.ga('send', 'event', 'Search', 'Submit', '`+o.$$escapeHtmlAttribute(o.$$escapeJsString(e.pageType))+`');"><div class="input-with-icon"><span class="icon--svg">`+t.icons.essential.search(null,null,s)+'</span><input type="text" placeholder="Search '+o.$$escapeHtmlAttribute((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"Kinja")+'" name="q"'+(e.query?' value="'+o.$$escapeHtmlAttribute(e.query)+'"':"")+' class="mbn" autocomplete="off" data-focus-on-display/></div></form>'},s.DEBUG&&(t.components.forms.search.simpleSearch.soyTemplateName="tiger.components.forms.search.simpleSearch"),t.components.forms.search.advancedSearch=function(e,n,s){return'<form method="GET"'+(e.formClasses?'class="'+o.$$escapeHtmlAttribute(e.formClasses)+' search" ':' class="search"')+(e.formId?' id="'+o.$$escapeHtmlAttribute(e.formId)+'" name="'+o.$$escapeHtmlAttribute(e.formId)+'" ':"")+(e.action?' action="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.action))+'"':"")+`onsubmit="window.ga('send', 'event', 'Search', 'Submit', '`+o.$$escapeHtmlAttribute(o.$$escapeJsString(e.pageType))+`');"><div class="input-with-icon mbx mtm"><span class="icon--svg">`+t.icons.essential.search(null,null,s)+'</span><input type="text" placeholder="Search '+o.$$escapeHtmlAttribute((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"Kinja")+'" name="q"'+(e.query?' value="'+o.$$escapeHtmlAttribute(e.query)+'"':"")+' class="man" autocomplete="off" data-focus-on-display/></div></form>'},s.DEBUG&&(t.components.forms.search.advancedSearch.soyTemplateName="tiger.components.forms.search.advancedSearch")}),define("templates/tiger/components/bloglinks",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.globalBlogLinks=function(){var s="",i="my2vnuuejg3jt9yqbx3z",a="rnxqtvv6advgidzfs6am",r="pch44wvo0v6acpdlt0f6",c="fdj3buryz5nuzyf2k620",l="eh1hvjxamru5z6aobgwc",d="aqhdzcldymb9mkltfhxh",u="ghxlwgdztvqerb4zptdx",h="u0939doeuioaqhspkjyc",m="fdmagj52rhclnn6dfoig";return s+='<li><a href="http://deadspin.com" data-ga="[Kinja Menu, Blogs You May Like Click, Deadspin]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(a,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Deadspin</a></li><li><a href="http://gawker.com" data-ga="[Kinja Menu, Blogs You May Like Click, Gawker]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(i,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Gawker</a></li><li><a href="http://gizmodo.com" data-ga="[Kinja Menu, Blogs You May Like Click, Gizmodo]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(c,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Gizmodo</a></li><li><a href="http://io9.com" data-ga="[Kinja Menu, Blogs You May Like Click, io9]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(l,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />io9</a></li><li><a href="http://jalopnik.com" data-ga="[Kinja Menu, Blogs You May Like Click, Jalopnik]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(d,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Jalopnik</a></li><li><a href="http://jezebel.com" data-ga="[Kinja Menu, Blogs You May Like Click, Jezebel]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(r,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Jezebel</a></li><li><a href="http://kotaku.com" data-ga="[Kinja Menu, Blogs You May Like Click, Kotaku]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(u,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Kotaku</a></li><li><a href="http://lifehacker.com" data-ga="[Kinja Menu, Blogs You May Like Click, Lifehacker]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(h,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Lifehacker</a></li><li><a href="http://sploid.gizmodo.com/" data-ga="[Kinja Menu, Blogs You May Like Click, Sploid]"><img data-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(m,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Sploid</a></li>'},s.DEBUG&&(t.components.globalBlogLinks.soyTemplateName="tiger.components.globalBlogLinks")}),define("templates/tiger/components/duiModal",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.duiModal.layout=function(e,n,s){return'<a class="js_close modal-close-x">'+t.icons.essential.close(null,null,s)+'</a><div class="dui dui-modal-body"></div>'},s.DEBUG&&(t.components.duiModal.layout.soyTemplateName="tiger.components.duiModal.layout")}),define("templates/tiger/components/navpanels",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.navpanels.duiGlobalMenuPanel=function(e,n,s){return'<div class="dui-menu dui-modal fullscreen-modal left"><a class="js_close modal-close-x">'+t.icons.essential.close(null,null,s)+'</a><div class="dui dui-modal-body nav-dropdown"><div id="js_blogmenu--offcanvas">'+t.components.blogdropdown.globalBlogDropdown(e,null,s)+"</div></div></div>"},s.DEBUG&&(t.components.navpanels.duiGlobalMenuPanel.soyTemplateName="tiger.components.navpanels.duiGlobalMenuPanel")}),define("app/modalmenu/globalmenu",["jquery","backbone.marionette","singleton/CurrentUser","view/posttools/BlogFollowToolView","view/modal/duimodal.defaultBehavior","view/behaviors/googleAnalytics.behavior","app/account/account.channel","templates/tiger/components/blogdropdown","templates/tiger/components/forms/search","templates/tiger/components/bloglinks","templates/tiger/components/duiModal","templates/tiger/components/navpanels"],function(e,t,n,s,o,i,a){"use strict";function r(){e("body").removeClass("disable-scroll")}function c(){e("body").addClass("disable-scroll")}var l;return l=t.Layout.extend({template:tiger.components.navpanels.duiGlobalMenuPanel,regions:{loginRegion:".js_login-links",bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:o},GoogleAnalyticsBehavior:{behaviorClass:i}},initialize:function(){n.onLoggedIn.done(function(){this.triggerMethod("CloseModal")}.bind(this)),e(document).on("open.fndtn.reveal","[data-reveal]",r),e(document).on("close.fndtn.reveal","[data-reveal]",c)},onClose:function(){e(document).off("open.fndtn.reveal","[data-reveal]",r),e(document).off("close.fndtn.reveal","[data-reveal]",c)},events:{"click .js_login-link":"onLoginClick"},onLoginClick:function(e){e.preventDefault(),a.trigger("loginRequired",{source:"loginButton"})},serializeData:function(){return{blog:this.model.get("blog"),pageType:this.model.get("pageType"),blogGroup:this.model.get("blogGroup"),isLoggedIn:this.model.isLoggedIn()}},onRender:function(){this.$(".gmg-blog-list").before(e(".related-blog-list").clone()),this.blogfollowtool=new s({el:this.$el})},onShow:function(){this.blogfollowtool.update({el:this.$el})}})}),define("templates/tiger/section/navbar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.section.navbar=function(e,n,s){var i,r,l,a="",d=((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"","BlogLogo"),c=(null==e.blog?null:e.blog.logo)?window.kinja.imageUrl(e.blog.logo.id,d,e.blog.logo.format):"";return""+("gawker"==(null==e.blog?null:e.blog.name)||"lifehacker"==(null==e.blog?null:e.blog.name)||"deadspin"==(null==e.blog?null:e.blog.name)||"kotaku"==(null==e.blog?null:e.blog.name)||"jezebel"==(null==e.blog?null:e.blog.name)||"io9"==(null==e.blog?null:e.blog.name)||"jalopnik"==(null==e.blog?null:e.blog.name)||"gizmodo"==(null==e.blog?null:e.blog.name)?" gmglogos":""),a+="<!-- "+(e.md5?" md5! ":"")+' --><div class="navwrap--outer js-navwrap--outer"><nav class="js_global-nav-wrap js_top-nav global-nav notransition shown"><div class="global-nav__left global-nav__triggers">',r=!!(e.blogList&&e.blogList.length>1),i="dashboard"==e.pageType||"manageblog"==e.pageType,a+=(i&&r?'<a class="js_show-dashboard-blogs show-dashboard-blogs show-for-medium-down icon--svg u-prepended">'+t.icons.essential.chevronLeft(null,null,s)+"</a>":"")+'<a class="js_mobile-menu-button hamburger-trigger hamburger-trigger--mobile'+(i&&r?" js_hamburger-trigger hide":"")+'" data-ga="[Kinja Menu, Menu Click, js_pageType]"><span class="icon-dustinburger"><span></span><span></span><span></span></span></a><div class="f-dropdown-ct"><a data-dropdown="global-blog" class="js_menu-button hamburger-trigger hamburger-trigger--desktop" data-ga="[Kinja Menu, Menu Click, js_pageType]"><span class="icon-dustinburger"><span></span><span></span><span></span></span></a>',l=""+(e.blogGroup&&e.blogGroup.length?"dropdown-wide":""),a+='<div class="proxima f-dropdown content nav-dropdown main-menu hide-for-medium-down '+o.$$escapeHtmlAttribute(l)+'" id="global-blog" data-dropdown-content><div id="js_blogmenu--dropdown">'+t.components.blogdropdown.globalBlogDropdown(e,null,s)+'</div></div><a href="#" id="global-search-trigger" class="search-trigger icon--svg u-prepended u-highlighted--onhover u-undecorated" data-dropdown="global-search" data-ga="[Kinja Menu, Search Click, js_pageType]">'+t.icons.essential.search(null,null,s)+t.icons.essential.close(null,null,s)+'</a><div class="f-dropdown content nav-dropdown search-dropdown hide-for-medium-down" id="global-search" data-dropdown-content><form method="GET" action="/search" data-ga="[Search, Submit, js_pageType]"><div class="input-with-icon icon--svg">'+t.icons.essential.search(null,null,s)+'<input id="global-search-input" type="search" name="q" placeholder="Search '+o.$$escapeHtmlAttribute((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"Kinja")+'" autocomplete="off" /></div></form></div></div></div><div class="global-nav__right global-nav__triggers js_right-user-bar">'+(s.features.fasttoken2?'<div class="js_loggedout" style="display:none">'+t.section.navbarRightLogin(null,null,s)+'</div><div class="js_loggedin" style="display:none">'+t.section.navbarRightUserBar(null,null,s)+"</div>":"")+'</div><div class="global-nav__center row"><div class="logo-wrapper large-6 columns large-offset-4">'+(e.title?e.mobileTitle?'<h1 class="js_mobile-title global-nav--title show-for-medium-down">'+o.$$escapeHtml(e.mobileTitle)+'</h1><h1 class="global-nav--title hide-for-medium-down">'+o.$$escapeHtml(e.title)+"</h1>"+(i?'<h1 class="js_dashboard-mobile-title-blogs global-nav--title hide">'+o.$$escapeHtml(e.title)+"</h1>":""):'<h1 class="global-nav--title">'+o.$$escapeHtml(e.title)+"</h1>":'<a href="//'+o.$$escapeHtmlAttribute((null==e.blog?null:e.blog.canonicalHost)?e.blog.canonicalHost:"")+'" class="logo" title="'+o.$$escapeHtmlAttribute((null==e.blog?null:e.blog.displayName)?e.blog.displayName:"")+'" data-ga="[Kinja Menu, Logo/Blog Title Click, js_pageType]">'+(""!=c?'<img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(c))+'" alt="" />':o.$$escapeHtml((null==e.blog?null:e.blog.displayName)?e.blog.displayName:""))+"</a>"+(e.blog.id?'<div class="follow-controls follow-controls--header js_follow-controls js_follow-blog-controls" data-blogid="'+o.$$escapeHtmlAttribute(e.blog.id)+'"><a href="#" class="js_followblogforuser follow-controls__link icon--svg u-prepended u-highlighted" title="Follow'+(e.blog&&e.blog.displayName?" "+o.$$escapeHtmlAttribute(e.blog.displayName):"")+'" data-ga="[Kinja Menu, Follow Link Click, js_pageType]">'+t.icons.essential.add(null,null,s)+'Follow</a><a href="#" class="js_unfollowblogforuser follow-controls__link hide icon--svg u-prepended u-highlighted" title="Unfollow'+(e.blog&&e.blog.displayName?" "+o.$$escapeHtmlAttribute(e.blog.displayName):"")+'" data-ga="[Kinja Menu, Unfollow Link Click, js_pageType]">'+t.icons.essential.checkmark(null,null,s)+"Following</a></div>":""))+'</div></div><div class="proxima f-dropdown nav-dropdown content notif-menu" id="js_notifications--dropdown" data-dropdown-content>'+t.components.header.notifications.notificationsSpinner(null,null,s)+'</div><div class="proxima f-dropdown nav-dropdown content channels-menu" id="js_channels--dropdown" data-dropdown-content></div><div class="js_global-user scrollable-container noskimlinks noskimwords"><div class="proxima f-dropdown nav-dropdown content user-menu user-menu--mobile" id="js_usermenu--dropdown" data-dropdown-content></div></div></nav></div>'},s.DEBUG&&(t.section.navbar.soyTemplateName="tiger.section.navbar"),t.section.navbarBlogTitle=function(e,n,s){return(s.features.superuser&&s.features.superuser_notif?'<div class="momjeans-overlay js_momjeans-overlay">'+t.icons.places.momjeans(null,null,s)+"</div>":"")+'<a href="/" class="blog-title__logo site-logo js_blog-title__logo'+(e.isGmgBlog?" gmgLogos":"")+(e.showLogo?" no-fade-transition fade-in":"")+'" title="'+o.$$escapeHtmlAttribute(e.blogDisplayName)+'">'+(e.isGmgBlog?'<img class="blog-title__img logo-'+o.$$escapeHtmlAttribute(e.blogName)+'" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.imageAssetPath))+"logos/navbar/logo-"+o.$$escapeHtmlAttribute(e.blogName)+'.png" alt="" />':""!=e.logoSrc?'<img class="blog-title__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.logoSrc))+'" alt="" />':'<div class="blog-title__txt header-title proxima">'+o.$$escapeHtml(e.blogDisplayName)+"</div>")+'</a><div class="search-button"><span class="icon icon-search js_search-button__open-icon search-button__open-icon"></span></div>'},s.DEBUG&&(t.section.navbarBlogTitle.soyTemplateName="tiger.section.navbarBlogTitle"),t.section.navbarSearchBar=function(e,t,n){return(n.features.superuser&&n.features.superuser_notif?'<div class="momjeans-overlay js_momjeans-overlay"><span class="icon icon-momjeans"></span></div>':"")+'<a href="/" class="blog-title__logo site-logo js_blog-title__logo'+(e.isGmgBlog?" gmgLogos":"")+" no-fade-transition"+(e.showLogo?" fade-in":"")+'" title="'+o.$$escapeHtmlAttribute(e.blogDisplayName)+'">'+(e.isGmgBlog?'<img class="blog-title__img logo-'+o.$$escapeHtmlAttribute(e.blogName)+'" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.imageAssetPath))+"logos/navbar/logo-"+o.$$escapeHtmlAttribute(e.blogName)+'.png" alt="" />':""!=e.logoSrc?'<img class="blog-title__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.logoSrc))+'" alt="" />':'<div class="blog-title__txt header-title proxima">'+o.$$escapeHtml(e.blogDisplayName)+"</div>")+'</a><form method="GET" action="/search" class="search-bar__form js_search-bar__form" data-ga="[Search, Submit, js_pageType]"><span class="icon icon-search search-bar__icon"></span><input type="text" class="search-bar__field js_search-bar__field" name="q" placeholder="Search '+o.$$escapeHtmlAttribute(e.blogDisplayName)+'" autocomplete="off" /><div class="search-button"><span class="icon icon-x-small js_search-button__close-icon search-button__close-icon"></span></div></form><div class="search-button--placeholder"><span class="icon icon-search search-button__open-icon"></span></div>'},s.DEBUG&&(t.section.navbarSearchBar.soyTemplateName="tiger.section.navbarSearchBar"),t.section.navbarRightUserBar=function(e,n,s){return e=e||{},(s.features.channels?'<span class="notification-trigger"><a class="show-for-medium-up js_channels js_menu-button" data-dropdown="js_channels--dropdown"><span class="notif-circle"><span class="icon"><svg class="channels-icon" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>icon-hashmark</title><path d="M8.785 12h-2.97l-.552 3.16c-.097.553-.612.923-1.16.825-.543-.096-.907-.62-.81-1.174L3.785 12H.938C.42 12 0 11.556 0 11c0-.552.417-1 .938-1h3.197l.7-4H1.938C1.42 6 1 5.556 1 5c0-.552.417-1 .938-1h3.246L5.737.84c.097-.552.612-.922 1.16-.824.543.096.907.618.81 1.174L7.215 4h2.97l.552-3.16c.097-.552.612-.922 1.16-.824.543.096.907.618.81 1.174L12.215 4h2.847c.518 0 .938.444.938 1 0 .552-.417 1-.938 1h-3.197l-.7 4h2.897c.518 0 .938.444.938 1 0 .552-.417 1-.938 1h-3.246l-.553 3.16c-.097.553-.612.923-1.16.825-.543-.096-.907-.62-.81-1.174L8.785 12zm.35-2h-2.97l.7-4h2.97l-.7 4z" fill="#000" fill-rule="evenodd"/></svg></span></span></a></span>':"")+'<span class="js_notif-wrapper notification-trigger">'+(s.features.fasttoken2?t.components.header.notifications.globalNotificationsButton({notificationCount:0},null,s):"")+'</span><div class="user-trigger" data-ga="[User Menu, Menu Click, js_pageType]"><a class="js_menu-button js_usermenu-button show-for-large-up" data-dropdown="js_usermenu--dropdown" title="User dropdown"><span class="js_avatar avatar" style="'+(e.avatar?"background-image: url("+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.avatar.url))+")":"")+'"></span></a><a class="js_offcanvas-user show-for-medium-down"><span class="js_avatar avatar" style="'+(e.avatar?"background-image: url("+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.avatar.url))+")":"")+'"></span></a></div>'},s.DEBUG&&(t.section.navbarRightUserBar.soyTemplateName="tiger.section.navbarRightUserBar"),t.section.navbarRightLogin=function(){return'<a href="#" class="login-button button tiny inverse js_login-link" data-ga="[User Menu, Login/Signup Click, js_pageType]">Log in / Sign up</a>'},s.DEBUG&&(t.section.navbarRightLogin.soyTemplateName="tiger.section.navbarRightLogin")}),define("templates/tiger/icons/actions/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.icons.actions.arrowBottomLeft=function(){return'<svg class="svg-icon svg-arrow-bottom-left"><use xlink:href="#iconset-arrow-bottom-left" /></svg>'},s.DEBUG&&(t.icons.actions.arrowBottomLeft.soyTemplateName="tiger.icons.actions.arrowBottomLeft"),t.icons.actions.arrowBottomRight=function(){return'<svg class="svg-icon svg-arrow-bottom-right"><use xlink:href="#iconset-arrow-bottom-right" /></svg>'},s.DEBUG&&(t.icons.actions.arrowBottomRight.soyTemplateName="tiger.icons.actions.arrowBottomRight"),t.icons.actions.arrowBottom=function(){return'<svg class="svg-icon svg-arrow-bottom"><use xlink:href="#iconset-arrow-bottom" /></svg>'},s.DEBUG&&(t.icons.actions.arrowBottom.soyTemplateName="tiger.icons.actions.arrowBottom"),t.icons.actions.arrowLeft=function(){return'<svg class="svg-icon svg-arrow-left"><use xlink:href="#iconset-arrow-left" /></svg>'},s.DEBUG&&(t.icons.actions.arrowLeft.soyTemplateName="tiger.icons.actions.arrowLeft"),t.icons.actions.arrowRight=function(){return'<svg class="svg-icon svg-arrow-right"><use xlink:href="#iconset-arrow-right" /></svg>'},s.DEBUG&&(t.icons.actions.arrowRight.soyTemplateName="tiger.icons.actions.arrowRight"),t.icons.actions.arrowTop=function(){return'<svg class="svg-icon svg-arrow-top"><use xlink:href="#iconset-arrow-top" /></svg>'},s.DEBUG&&(t.icons.actions.arrowTop.soyTemplateName="tiger.icons.actions.arrowTop"),t.icons.actions.arrowTopLeft=function(){return'<svg class="svg-icon svg-arrow-top-left"><use xlink:href="#iconset-arrow-top-left" /></svg>'},s.DEBUG&&(t.icons.actions.arrowTopLeft.soyTemplateName="tiger.icons.actions.arrowTopLeft"),t.icons.actions.arrowTopRight=function(){return'<svg class="svg-icon svg-arrow-top-right"><use xlink:href="#iconset-arrow-top-right" /></svg>'},s.DEBUG&&(t.icons.actions.arrowTopRight.soyTemplateName="tiger.icons.actions.arrowTopRight"),t.icons.actions.blogAdd=function(){return'<svg class="svg-icon svg-blog-add"><use xlink:href="#iconset-blog-add" /></svg>'},s.DEBUG&&(t.icons.actions.blogAdd.soyTemplateName="tiger.icons.actions.blogAdd"),t.icons.actions.closeSmall=function(){return'<svg class="svg-icon svg-close-sm"><use xlink:href="#iconset-close-sm" /></svg>'},s.DEBUG&&(t.icons.actions.closeSmall.soyTemplateName="tiger.icons.actions.closeSmall"),t.icons.actions.disabled=function(){return'<svg class="svg-icon svg-disabled"><use xlink:href="#iconset-disabled" /></svg>'},s.DEBUG&&(t.icons.actions.disabled.soyTemplateName="tiger.icons.actions.disabled"),t.icons.actions.dollar=function(){return'<svg class="svg-icon svg-dollar"><use xlink:href="#iconset-dollar" /></svg>'},s.DEBUG&&(t.icons.actions.dollar.soyTemplateName="tiger.icons.actions.dollar"),t.icons.actions.dollarCircle=function(){return'<svg class="svg-icon svg-dollar-circle"><use xlink:href="#iconset-dollar-circle" /></svg>'},s.DEBUG&&(t.icons.actions.dollarCircle.soyTemplateName="tiger.icons.actions.dollarCircle"),t.icons.actions.flag=function(){return'<svg class="svg-icon svg-flag"><use xlink:href="#iconset-flag" /></svg>'},s.DEBUG&&(t.icons.actions.flag.soyTemplateName="tiger.icons.actions.flag"),t.icons.actions.fullscreen=function(){return'<svg class="svg-icon svg-fullscreen"><use xlink:href="#iconset-fullscreen" /></svg>'},s.DEBUG&&(t.icons.actions.fullscreen.soyTemplateName="tiger.icons.actions.fullscreen"),t.icons.actions.gear=function(){return'<svg class="svg-icon svg-gear"><use xlink:href="#iconset-gear" /></svg>'},s.DEBUG&&(t.icons.actions.gear.soyTemplateName="tiger.icons.actions.gear"),t.icons.actions.heart=function(){return'<svg class="svg-icon svg-heart"><use xlink:href="#iconset-heart" /></svg>'},s.DEBUG&&(t.icons.actions.heart.soyTemplateName="tiger.icons.actions.heart"),t.icons.actions.information=function(){return'<svg class="svg-icon svg-information"><use xlink:href="#iconset-information" /></svg>'},s.DEBUG&&(t.icons.actions.information.soyTemplateName="tiger.icons.actions.information"),t.icons.actions.login=function(){return'<svg class="svg-icon svg-login"><use xlink:href="#iconset-login" /></svg>'},s.DEBUG&&(t.icons.actions.login.soyTemplateName="tiger.icons.actions.login"),t.icons.actions.logout=function(){return'<svg class="svg-icon svg-logout"><use xlink:href="#iconset-logout" /></svg>'},s.DEBUG&&(t.icons.actions.logout.soyTemplateName="tiger.icons.actions.logout"),t.icons.actions.lightning=function(){return'<svg class="svg-icon svg-lightning"><use xlink:href="#iconset-lightning" /></svg>'},s.DEBUG&&(t.icons.actions.lightning.soyTemplateName="tiger.icons.actions.lightning"),t.icons.actions.moveLeft=function(){return'<svg class="svg-icon svg-move-left"><use xlink:href="#iconset-move-left" /></svg>'},s.DEBUG&&(t.icons.actions.moveLeft.soyTemplateName="tiger.icons.actions.moveLeft"),t.icons.actions.moveRight=function(){return'<svg class="svg-icon svg-move-right"><use xlink:href="#iconset-move-right" /></svg>'},s.DEBUG&&(t.icons.actions.moveRight.soyTemplateName="tiger.icons.actions.moveRight"),t.icons.actions.moveTop=function(){return'<svg class="svg-icon svg-move-top"><use xlink:href="#iconset-move-top" /></svg>'},s.DEBUG&&(t.icons.actions.moveTop.soyTemplateName="tiger.icons.actions.moveTop"),t.icons.actions.moveBottom=function(){return'<svg class="svg-icon svg-move-bottom"><use xlink:href="#iconset-move-bottom" /></svg>'},s.DEBUG&&(t.icons.actions.moveBottom.soyTemplateName="tiger.icons.actions.moveBottom"),t.icons.actions.reload=function(){return'<svg class="svg-icon svg-reload"><use xlink:href="#iconset-reload" /></svg>'},s.DEBUG&&(t.icons.actions.reload.soyTemplateName="tiger.icons.actions.reload"),t.icons.actions.userAdd=function(){return'<svg class="svg-icon svg-user-add"><use xlink:href="#iconset-user-add" /></svg>'},s.DEBUG&&(t.icons.actions.userAdd.soyTemplateName="tiger.icons.actions.userAdd"),t.icons.actions.userRemove=function(){return'<svg class="svg-icon svg-user-remove"><use xlink:href="#iconset-user-remove" /></svg>'},s.DEBUG&&(t.icons.actions.userRemove.soyTemplateName="tiger.icons.actions.userRemove"),t.icons.actions.writePaper=function(){return'<svg class="svg-icon svg-write-paper"><use xlink:href="#iconset-write-paper" /></svg>'},s.DEBUG&&(t.icons.actions.writePaper.soyTemplateName="tiger.icons.actions.writePaper"),t.icons.actions.zoomOut=function(){return'<svg class="svg-icon svg-zoom-out"><use xlink:href="#iconset-zoom-out" /></svg>'},s.DEBUG&&(t.icons.actions.zoomOut.soyTemplateName="tiger.icons.actions.zoomOut"),t.icons.actions.clock=function(){return'<svg class="svg-icon svg-clock"><use xlink:href="#iconset-clock" /></svg>'},s.DEBUG&&(t.icons.actions.clock.soyTemplateName="tiger.icons.actions.clock"),t.icons.actions.clockSmall=function(){return'<svg class="svg-icon small svg-clock--small"><use xlink:href="#iconset-clock--small" /></svg>'},s.DEBUG&&(t.icons.actions.clockSmall.soyTemplateName="tiger.icons.actions.clockSmall"),t.icons.actions.write=function(){return'<svg class="svg-icon svg-write"><use xlink:href="#iconset-write" /></svg>'},s.DEBUG&&(t.icons.actions.write.soyTemplateName="tiger.icons.actions.write"),t.icons.actions.writeSmall=function(){return'<svg class="svg-icon small svg-write--small"><use xlink:href="#iconset-write--small" /></svg>'},s.DEBUG&&(t.icons.actions.writeSmall.soyTemplateName="tiger.icons.actions.writeSmall"),t.icons.actions.share=function(){return'<svg class="svg-icon svg-share"><use xlink:href="#iconset-share" /></svg>'},s.DEBUG&&(t.icons.actions.share.soyTemplateName="tiger.icons.actions.share"),t.icons.actions.quote=function(){return'<svg class="svg-icon svg-quote"><use xlink:href="#iconset-quote" /></svg>'},s.DEBUG&&(t.icons.actions.quote.soyTemplateName="tiger.icons.actions.quote"),t.icons.actions.playIcon=function(){return'<svg class="svg-icon svg-quote"><use xlink:href="#icon-play" /></svg>'},s.DEBUG&&(t.icons.actions.playIcon.soyTemplateName="tiger.icons.actions.playIcon")}),define("app/navigation/userButton.view",["backbone.marionette","singleton/Utils","templates/tiger/components/header/notifications","templates/tiger/section/navbar","templates/tiger/icons/actions/usage"],function(e,t){"use strict";var n=e.ItemView.extend({ui:{avatar:".js_avatar"},template:tiger.section.navbarRightUserBar,modelEvents:{"change:avatar":"updateAvatar"},updateAvatar:function(){var e=this.model.get("avatar");this.ui.avatar.css("background-image","url("+t.imageUrl(e.id,"avt-small",e.format)+")")}});return n}),define("app/navigation/loginButton.view",["backbone.marionette","app/account/account.channel","templates/tiger/section/navbar"],function(e,t){"use strict";var n=e.ItemView.extend({template:tiger.section.navbarRightLogin,events:{"click .js_login-link":"onLoginClick"},onLoginClick:function(e){e.preventDefault(),t.trigger("loginRequired",{source:"loginButton"})}});return n}),define("singleton/BlogInfo",["underscore","singleton/CurrentBlog"],function(e,t){"use strict";var n={adEnabledSites:[{name:"Gizmodo",id:4},{name:"Gawker",id:7},{name:"io9",id:8},{name:"Kotaku",id:9},{name:"Deadspin",id:11},{name:"Jalopnik",id:12},{name:"Lifehacker",id:17},{name:"Jezebel",id:39},{name:"GizmodoES",id:19292},{name:"Guanabee",id:86551},{name:"studioatgawker",id:4541888},{name:"The fusion project",id:10698056},{name:"XperiaZ",id:471472023},{name:"BetterState",id:473241793},{name:"IBM",id:474911957},{name:"BusinessTravelersToolkit",id:476089313},{name:"SonyEntertainmentNetwork",id:476783795},{name:"WonderFilled",id:499874619},{name:"OreoWonderFilled",id:499964452},{name:"RandomHouseAudio",id:506884481},{name:"Gizmodo Live",id:509173099},{name:"RayDonovan",id:509473310},{name:"Kotaku Live Blog",id:510669784},{name:"Defamer",id:512288369},{name:"collaboratory",id:709976306},{name:"Doomsday Castle",id:813471273},{name:"fiestahero",id:1256311089},{name:"Metlife",id:1300181229},{name:"Porsche",id:1434801322},{name:"crashplan",id:1444734969},{name:"Quirky G.E",id:1460862244},{name:"Netflix",id:1463118792},{name:"3dprintingtoolkit",id:1467567363},{name:"goodtobebad",id:1467571985},{name:"Oliver Kovacs",id:1484116755},{name:"Over Rated",id:1521570730},{name:"biz product",id:1525133490},{name:"Playboy",id:1173588042,gptNetworkId:6487541,gptSiteName:"playboy.kinja"},{name:"Sploid",id:487662860}],gmgBlogs:["gawker","lifehacker","deadspin","kotaku","jezebel","io9","jalopnik","gizmodo"],currentBlogIsGmgBlog:function(){return e.find(this.gmgBlogs,function(e){return t.name===e})}};return n}),define("app/navigation/blogTitle.view",["backbone.marionette","singleton/CurrentBlog","singleton/EventDispatcher","singleton/BlogInfo","singleton/Feature","templates/tiger/section/navbar"],function(e,t,n,s,o){"use strict";var i=e.ItemView.extend({template:tiger.section.navbarBlogTitle,tagName:"div",className:"blog-title",ui:{blogLogo:".js_blog-title__logo",searchIcon:".js_search-button__open-icon"},triggers:{"click @ui.searchIcon":"open.searchbar"},attributes:{href:"/",title:t.displayName||""},fadeIn:function(){this.ui.blogLogo.addClass("fade-in")},fadeOut:function(){this.ui.blogLogo.removeClass("fade-in")},serializeData:function(){return{blogName:(t||{}).name,blogDisplayName:t.displayName||"",isGmgBlog:s.currentBlogIsGmgBlog(),logoSrc:this.options.logoSrc||"",imageAssetPath:this.options.imageAssetPath,showLogo:this.options.showLogo}},onRender:function(){o.isOn("gns")&&this.ui.blogLogo.removeClass("no-fade-transition"),this.listenTo(n,"logoHidden.topbar",this.fadeIn),this.listenTo(n,"logoShown.topbar",this.fadeOut)}});return i}),define("app/navigation/searchBar.view",["backbone.marionette","singleton/CurrentBlog","singleton/BlogInfo","singleton/EventDispatcher","singleton/Feature","templates/tiger/section/navbar"],function(e,t,n,s,o){"use strict";var i=e.ItemView.extend({template:tiger.section.navbarSearchBar,tagName:"div",className:"search-bar",ui:{searchForm:".js_search-bar__form",searchField:".js_search-bar__field",closeSearchIcon:".js_search-button__close-icon",blogLogo:".js_blog-title__logo"},events:{keyup:"onKeyup","click @ui.closeSearchIcon":"onCloseSearchButtonClick"},onCloseSearchButtonClick:function(){this.ui.closeSearchIcon.removeClass("fade-in"),this.ui.searchForm.removeClass("open")},onKeyup:function(e){27===e.keyCode&&this.onCloseSearchButtonClick()},fadeIn:function(){this.ui.blogLogo.addClass("fade-in")},fadeOut:function(){this.ui.blogLogo.removeClass("fade-in")},serializeData:function(){return{blogName:(t||{}).name,blogDisplayName:t.displayName||"",isGmgBlog:n.currentBlogIsGmgBlog(),logoSrc:this.options.logoSrc||"",imageAssetPath:this.options.imageAssetPath,showLogo:this.options.showLogo}},onRender:function(){this.ui.searchForm.on("transitionend webkitTransitionEnd oTransitionEnd",function(e){"width"===e.originalEvent.propertyName&&this.ui.searchForm.hasClass("open")?this.ui.closeSearchIcon.addClass("fade-in"):"width"===e.originalEvent.propertyName&&this.trigger("closed.searchbar")}.bind(this)),o.isOn("gns")&&(this.listenTo(s,"logoHidden.topbar",this.fadeIn),this.listenTo(s,"logoShown.topbar",this.fadeOut))},onDomRefresh:function(){this.ui.searchField.focus(),this.ui.searchForm.addClass("open")}});return i}),define("app/navigation/topbar.layout",["jquery","underscore","backbone.marionette","lib/foundation/foundation","app/MarionetteApp","app/notifdropdown/notifdropdown.app","app/modalmenu/globalmenu","app/navigation/userButton.view","app/navigation/loginButton.view","app/navigation/blogTitle.view","app/navigation/searchBar.view","module/ads/model/ads.slotModel","view/behaviors/googleAnalytics.behavior","singleton/EventDispatcher","singleton/CurrentUser","singleton/Feature","singleton/Utils","singleton/WindowController","module/ads/ads.events"],function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b){"use strict";var j="splash"===g.getKinjaMeta().pageType,y=n.Layout.extend({ui:{menuDropdown:"#global-blog",mobileMenuDropdown:".js_mobile-menu-button",notifDropdown:"#global-notifications",notifDropdownButton:".js_notif",navIcon:".js_nav-icon",kinjaIcon:".js_kinja-icon",userDropdown:"#global-user",rightUserBar:".js_right-user-bar",globalSearchDropdown:"#global-search",globalSearchInput:"#global-search-input",globalSearchTrigger:"#global-search-trigger",dashboardBlogSelectorBtn:".js_show-dashboard-blogs",hamburgerBtn:".js_hamburger-trigger",mobileTitle:".js_mobile-title",dashboardMobileTitleBlogs:".js_dashboard-mobile-title-blogs"},regions:{userButtonRegion:".js_right-user-bar",blogTitleRegion:".js_blog-title-region"},behaviors:{GoogleAnalyticsBehavior:{behaviorClass:h}},events:{"opened.fndtn.dropdown @ui.menuDropdown":"onDropdownOpened","closed.fndtn.dropdown @ui.menuDropdown":"onDropdownClosed","opened.fndtn.dropdown @ui.userDropdown":"onDropdownOpened","closed.fndtn.dropdown @ui.userDropdown":"onDropdownClosed","click .right-off-canvas-toggle":"fetchNotifications","click @ui.mobileMenuDropdown":"openModalGlobalmenu","opened.fndtn.dropdown @ui.globalSearchDropdown":"onGlobalSearchOpened","closed.fndtn.dropdown @ui.globalSearchDropdown":"onGlobalSearchClosed","click @ui.dashboardBlogSelectorBtn":"openBlogSelector"},initialize:function(){this.model.onAuthStateChange(this.onModelAuthenticated.bind(this))},onRender:function(){},initializeAutohide:function(){var t,i=!!window.kinja.meta.blogSales&&window.kinja.meta.blogSales.adsEnabled,n=function(){this.$el.addClass("fixed"),v.scrollAutohide(this.$el,{waypoint:e(".js_page")}),this.$el.removeClass("notransition")}.bind(this),o=function(){this.$el.removeClass("fixed"),v.unbindScrollAutohide()}.bind(this),s=function(){(e(".js_site-header").length||j)&&(this.showBlogLogo(),j||(this.setupScroll(),this.refreshBlogLogo())),p.isOn("splashy_ad")?(t=function(){0!==this.$el.offset().top?v.registerWaypoint(this.$el.parent(),0,function(e){"down"===e?n():o()}.bind(this)):n()}.bind(this),p.isOn("ad_module")?i?window.kinjaads.queue.push({zoneType:u.zoneTypes.SPLASHYTOP,onRenderEnded:t}):t():this.listenToOnce(b,"kinjaads.disabled kinjaads.SPLASHYTOP.displayed kinjaads.SPLASHYTOP.hide",t)):n()}.bind(this);p.isOn("gns")?this.model.onAuth.done(s):s()},mainLogoHidden:function(){var t=e(window),n=20,s=e(".js_site-header").offset().top-n,o=t.width()>799,i=t.scrollTop();return i>s&&o},setupScroll:function(){var n=e(window),a=20,s=e(".js_site-header").offset().top-a,r=function(){var e=n.scrollTop();e>s&&o?m.trigger("logoHidden.topbar"):m.trigger("logoShown.topbar"),this.ui.navIcon.toggleClass("hide",e>s),this.ui.kinjaIcon.toggleClass("hide",s>e)}.bind(this),o=n.width()>799,i=t.throttle(r,100);n.on("scroll.topbar",i),this.listenTo(m,"orientation:change",function(){o=n.width()>799})},showUserButton:function(){var e=new r({model:f});this.userButtonRegion.show(e)},showLoginButton:function(){var e=new c;this.userButtonRegion.show(e)},showBlogLogo:function(){var t=this.blogTitleRegion.$el||e(this.blogTitleRegion.el),n=new l({logoSrc:t.data("logoSrc"),imageAssetPath:t.data("imageAssetPath"),showLogo:!j&&this.mainLogoHidden()});n.on("open.searchbar",this.showSearchBar.bind(this)),this.blogTitleRegion.show(n),p.isOn("gns")||j||this.refreshBlogLogo()},refreshBlogLogo:function(){e(window).trigger("scroll")},showSearchBar:function(){var t=this.blogTitleRegion.$el||e(this.blogTitleRegion.el),n=new d({logoSrc:t.data("logoSrc"),imageAssetPath:t.data("imageAssetPath"),showLogo:!j&&this.mainLogoHidden()});this.listenTo(n,"closed.searchbar",this.showBlogLogo),this.blogTitleRegion.show(n)},onModelAuthenticated:function(){p.isOn("fasttoken2")?this.model.isLoggedIn()?i.initialize():i.remove():this.model.isLoggedIn()?(this.showUserButton(),i.initialize()):(this.showLoginButton(),i.remove()),e(window.document).foundation()},onDropdownOpened:function(t){var n=t.target.id;e("[data-dropdown="+n+"]").addClass("active"),e("body").addClass(n+"-open")},onDropdownClosed:function(t){var n=t.target.id;e("[data-dropdown="+n+"]").removeClass("active"),e("body").removeClass(n+"-open")},manualCloseDropdown:function(){s.libs.dropdown.close(this.ui.menuDropdown)},fetchNotifications:function(){i.fetch()},onGlobalSearchOpened:function(){this.ui.globalSearchInput.focus(),this.ui.globalSearchTrigger.addClass("active")},onGlobalSearchClosed:function(){this.ui.globalSearchInput.blur(),this.ui.globalSearchTrigger.removeClass("active")},openBlogSelector:function(t){var n=this;t.stopPropagation(),e(".dashboard-blog-selector").height(e(document).height()),e(".dashboard-blog-selector").removeClass("hide"),this.ui.dashboardBlogSelectorBtn.addClass("hide"),this.ui.hamburgerBtn.removeClass("hide"),this.ui.mobileTitle.addClass("hide"),this.ui.dashboardMobileTitleBlogs.removeClass("hide"),e("body").on("click.hidemenu",function(){n.closeBlogSelector()})},closeBlogSelector:function(){this.ui.dashboardBlogSelectorBtn.removeClass("hide"),this.ui.hamburgerBtn.addClass("hide"),this.ui.mobileTitle.removeClass("hide"),this.ui.dashboardMobileTitleBlogs.addClass("hide"),e(".dashboard-blog-selector").addClass("hide"),e("body").off("click.hidemenu")},openModalGlobalmenu:function(){var e=new a({model:f});o.duimodalregion.show(e)}});return y}),define("templates/tiger/components/user/your-blogs",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.user.yourBlogsItem=function(e,n,s){var i="",a=s.features.no_offcanvas_manageblog;return i+='<a href="http://'+o.$$escapeHtmlAttribute(e.blogData.canonicalHost)+'" class="hover-icon" data-ga="[User Menu, My Blogs Click - '+o.$$escapeHtmlAttribute(e.blogData.displayName)+']">'+(e.blogData.avatar&&e.blogData.avatar.id?'<img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.blogData.avatar.id,"avt-small",e.blogData.avatar.format)))+'" class="icon icon-prepend" alt="" />':'<img src="//x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png" class="icon icon-prepend" alt="" />')+o.$$escapeHtml(e.blogData.displayName)+"</a>"+(a?'<a class="icon--svg u-ultralight u-highlighted--onhover show-for-medium-down" href="https://kinja.com/manage/'+o.$$escapeHtmlAttribute(e.blogData.name)+'">'+t.icons.places.settings(null,null,s)+"</a>":"")},s.DEBUG&&(t.components.user.yourBlogsItem.soyTemplateName="tiger.components.user.yourBlogsItem")}),define("app/navigation/blogItem.view",["backbone.marionette","templates/tiger/components/user/your-blogs"],function(e){"use strict";var t=e.ItemView.extend({template:tiger.components.user.yourBlogsItem,tagName:"li",className:"ownblog js_ownblog",serializeData:function(){return{blogData:this.model.attributes}}});return t}),define("templates/tiger/components/user/profile-menu",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.user.globalProfileMenuContent=function(e,n,s){return'<ul class="user-links"><li class="display-name"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.currentUser.avatar.id,"avt-small",e.currentUser.avatar.format)))+'" class="avatar"><span data-username="'+o.$$escapeHtmlAttribute(e.currentUser.screenName)+'" class="js_display-name">'+o.$$escapeHtml(e.currentUser.displayName)+'</span></li><li class="hover-icon"><a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.currentUser.screenName)+'" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Your profile click, js_pageType]">'+t.icons.places.user(null,null,s)+'Your profile</a></li><li class="hover-icon"><a href="#" class="js_compose-post-button readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Compose Post Click, js_pageType]">'+t.icons.actions.write(null,null,s)+'Compose post</a></li><li class="hover-icon"><a href="//kinja.com/settings" class="js_settings-link readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Account Settings Click, js_pageType]">'+t.icons.actions.gear(null,null,s)+'Account Settings</a></li><li class="hover-icon">'+(s.features.activenow?'<a href="//kinja.com/dashboard/activenow" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Active Now View Click, js_pageType]">':'<a href="//kinja.com/dashboard" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Private View Click, js_pageType]">')+t.icons.places.home(null,null,s)+'Dashboard</a></li><li class="hover-icon"><a href="//kinja.com/manage'+(e.currentBlogName&&e.isMemberCurrentBlog?"/"+o.$$escapeHtmlAttribute(e.currentBlogName):"")+'" data-ga="[User Menu, New Manage Blog Click, js_pageType]" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.places.settings(null,null,s)+(e.currentBlogName&&e.isMemberCurrentBlog?"Manage "+o.$$escapeHtml(e.blogName):"Manage blogs")+"</a></li>"+(s.features.superuser&&("frontpage"==e.pageType||"permalink"==e.pageType)?'<li class="js_manageblog hover-icon hide"><a href="#" class="js_manageblog-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Manage Blog Click, js_pageType]">'+t.icons.places.lock(null,null,s)+"Superuser Settings</a></li>":"")+'<li class="js_salestools hover-icon hide"><a href="#" class="js_salestools-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Business Tool Click, js_pageType]">'+t.icons.essential.bubble(null,null,s)+"Biz Tools"+(e.blogName?" for "+o.$$escapeHtml(e.blogName):"")+'</a></li><li class="js_promotions hover-icon hide"><a href="#" class="js_promotions-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Promotions Click, js_pageType]">'+t.icons.essential.starCircle(null,null,s)+'Active Promotions</a></li><li class="js_superuser-tools hover-icon hide"><a href="#" class="js_createblog-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Create Blog Click, js_pageType]">'+t.icons.actions.blogAdd(null,null,s)+"Create blog</a></li>"+(s.features.superuser?'<li class="js_superuser-tools hide"><a href="?superuser=off" class="hover-icon icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Hide Mom Jeans Click, js_pageType]">'+t.icons.essential.star(null,null,s)+"Hide Mom Jeans</a></li>":'<li class="js_superuser-tools hide"><a href="?superuser" class="hover-icon icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Show Mom Jeans Click, js_pageType]">'+t.icons.essential.star(null,null,s)+"Show Mom Jeans</a></li>")+'<li class="hover-icon"><a href="#" class="js_logout-link icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Logout Click, js_pageType]">'+t.icons.actions.logout(null,null,s)+'Logout</a></li></ul><div class="divider"></div><ul class="title-ownblogs"><li class="title">My blogs</li></ul><ul class="js_myblogs myblogs"></ul>'},s.DEBUG&&(t.components.user.globalProfileMenuContent.soyTemplateName="tiger.components.user.globalProfileMenuContent")}),define("templates/tiger/icons/places/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.icons.places.avatar=function(){return'<svg class="svg-icon svg-avatar"><use xlink:href="#iconset-avatar" /></svg>'},s.DEBUG&&(t.icons.places.avatar.soyTemplateName="tiger.icons.places.avatar"),t.icons.places.avatarBig=function(){return'<svg class="svg-icon svg-avatar-big"><use xlink:href="#iconset-avatar-big" /></svg>'},s.DEBUG&&(t.icons.places.avatarBig.soyTemplateName="tiger.icons.places.avatarBig"),t.icons.places.blog=function(){return'<svg class="svg-icon svg-blog"><use xlink:href="#iconset-blog" /></svg>'},s.DEBUG&&(t.icons.places.blog.soyTemplateName="tiger.icons.places.blog"),t.icons.places.hashmark=function(){return'<svg class="svg-icon svg-hashmark"><use xlink:href="#iconset-hashmark" /></svg>'},s.DEBUG&&(t.icons.places.hashmark.soyTemplateName="tiger.icons.places.hashmark"),t.icons.places.home=function(){return'<svg class="svg-icon svg-home"><use xlink:href="#iconset-home" /></svg>'},s.DEBUG&&(t.icons.places.home.soyTemplateName="tiger.icons.places.home"),t.icons.places.key=function(){return'<svg class="svg-icon svg-key"><use xlink:href="#iconset-key" /></svg>'},s.DEBUG&&(t.icons.places.key.soyTemplateName="tiger.icons.places.key"),t.icons.places.lock=function(){return'<svg class="svg-icon svg-lock"><use xlink:href="#iconset-lock" /></svg>'},s.DEBUG&&(t.icons.places.lock.soyTemplateName="tiger.icons.places.lock"),t.icons.places.mail=function(){return'<svg class="svg-icon svg-mail"><use xlink:href="#iconset-mail" /></svg>'},s.DEBUG&&(t.icons.places.mail.soyTemplateName="tiger.icons.places.mail"),t.icons.places.mailSmall=function(){return'<svg class="svg-icon small svg-mail--small"><use xlink:href="#iconset-mail--small" /></svg>'},s.DEBUG&&(t.icons.places.mailSmall.soyTemplateName="tiger.icons.places.mailSmall"),t.icons.places.momjeans=function(){return'<svg class="svg-icon svg-momjeans"><use xlink:href="#iconset-momjeans" /></svg>'},s.DEBUG&&(t.icons.places.momjeans.soyTemplateName="tiger.icons.places.momjeans"),t.icons.places.settings=function(){return'<svg class="svg-icon svg-settings"><use xlink:href="#iconset-settings" /></svg>'},s.DEBUG&&(t.icons.places.settings.soyTemplateName="tiger.icons.places.settings"),t.icons.places.sharedpostSmall=function(){return'<svg class="svg-icon small svg-sharedpost--small"><use xlink:href="#iconset-sharedpost--small" /></svg>'},s.DEBUG&&(t.icons.places.sharedpostSmall.soyTemplateName="tiger.icons.places.sharedpostSmall"),t.icons.places.user=function(){return'<svg class="svg-icon svg-user"><use xlink:href="#iconset-user" /></svg>'},s.DEBUG&&(t.icons.places.user.soyTemplateName="tiger.icons.places.user"),t.icons.places.users=function(){return'<svg class="svg-icon svg-users"><use xlink:href="#iconset-users" /></svg>'},s.DEBUG&&(t.icons.places.users.soyTemplateName="tiger.icons.places.users")}),define("app/navigation/userMenu.view",["jquery","underscore","backbone","backbone.marionette","app/navigation/blogItem.view","singleton/Feature","singleton/CurrentBlog","singleton/Utils","module/KinjaAnalytics","view/behaviors/googleAnalytics.behavior","templates/tiger/components/user/profile-menu","templates/tiger/icons/actions/usage","templates/tiger/icons/places/usage"],function(e,t,n,s,o,i,a,r,c,l){"use strict";require(["module/PlacesIconModule"],function(){}),require(["module/ActionsIconModule"],function(){});var d=s.CompositeView.extend({events:{"click .js_logout-link":"onLogoutClick","click .js_createblog-link":"onCreateBlogClick","click .js_manageblog-link":"onManageBlogClick","click .js_salestools-link":"onSalesClick","click .js_promotions-link":"onPromotionsClick","click .js_channels-link":"onChannelsClick"},ui:{composeButton:".js_compose-post-button",superuserButtons:".js_superuser-tools",salesButtons:".js_salestools",blogButtons:".js_manageblog",promotionsButton:".js_promotions"},collection:new n.Collection,itemView:o,itemViewContainer:".js_myblogs",template:tiger.components.user.globalProfileMenuContent,behaviors:function(){return this.options.offcanvas?{GoogleAnalyticsBehavior:{behaviorClass:l}}:{}},initialize:function(){this.listenTo(this.model.get("membership"),"add",this.render),this.listenTo(this.model,"change:screenName change:displayName",this.render)},onRender:function(){if(this.model.isLoggedIn()){var o,n=this.model.get("screenName"),c=this.model.get("defaultBlogId"),s=i.isOn("editor_own_page_test")?window.location.search:"",l=t.any(["OWNER","AUTHOR","ADMIN"],function(e){return this.model.hasRole(e,a.id)}.bind(this));s+=l?("?"===s[0]?"&":"?")+"blogid="+a.id:"",this.ui.composeButton.attr("href","//"+r.getKinjaHost()+"/write"+s),this.model.isSuperuser()?this.ui.superuserButtons.removeClass("hide"):this.ui.superuserButtons.remove(),this.model.isSalesperson()||this.model.isSuperuser()&&i.isOn("superuser")?this.ui.salesButtons.removeClass("hide"):this.ui.salesButtons.remove(),(this.model.isSalesperson()||this.model.isSuperuser()&&i.isOn("superuser")||a.isGmgBlog&&this.model.hasRole("ADMIN",a.id))&&this.ui.promotionsButton.removeClass("hide"),this.model.hasRole("ADMIN",a.id)||this.model.isSuperuser()&&a.id?this.ui.blogButtons.removeClass("hide"):this.model.isSuperuser()?this.ui.blogButtons.remove():e(".js_manageblog-link ").hide(),o=t.sortBy(this.model.getBlogs(),function(e){return e.id===c&&e.name!==n&&(e.name=n,e.canonicalHost=n+".kinja.com"),(e.id===c?"0":"1")+e.name}),this.collection.reset(o)}},serializeData:function(){var e=t.map(this.model.get("membership").models,function(e){return e.get("blogId")}),n=t.indexOf(e,a.id)>-1;return{blogName:a.displayName,currentUser:this.model.toJSON(),currentBlogName:a.name,isMemberCurrentBlog:n,pageType:r.kinjaMeta.pageType}},onLogoutClick:function(e){var t=r.getKinjaMeta().pageType;e.preventDefault(),this.model.logout(),("dashboard"===t||"manageblog"===t)&&(window.location.pathname.indexOf("notifications")>-1?c.setContext(null,"NOTIFICATIONS"):c.setContext(null,"DASHBOARD"),c.pushEvent("LOGOUT"))},onCreateBlogClick:function(e){e.preventDefault(),require(["module/BlogSettingsModule"],function(e){e.controller.showCreateBlog()})},onManageBlogClick:function(e){e.preventDefault(),require(["module/BlogSettingsModule"],function(e){e.controller.showManageBlog()})},onSalesClick:function(e){e.preventDefault(),require(["module/BusinessModule"],function(e){e.controller.showBusinessTools()})},onPromotionsClick:function(e){e.preventDefault(),window.location.href="http://"+r.getKinjaHost()+"/dfp/promotions"},onChannelsClick:function(t){t.preventDefault(),e(".js_channels-off-canvas-toggle").click()}});return d}),define("app/modalmenu/usermenu",["backbone.marionette","view/modal/duimodal.defaultBehavior","app/navigation/userMenu.view","templates/tiger/components/duiModal","templates/tiger/components/navpanels"],function(e,t,n){"use strict";var s;return s=e.Layout.extend({template:tiger.components.duiModal.layout,regions:{bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:t}},onRender:function(){var e=new n({model:this.model,offcanvas:!0});this.bodyRegion.show(e),this.$(".dui-modal-body").addClass("nav-dropdown")}})}),define("templates/tiger/components/spinner",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.spinner.bounce=function(){return'<span class="spinner bounce"><span class="one"></span><span class="two"></span><span class="three"></span></span>'},s.DEBUG&&(t.components.spinner.bounce.soyTemplateName="tiger.components.spinner.bounce"),t.components.spinner.gifthaw=function(){return'<div class="animationContainer"><svg width="26" height="12" viewBox="0 0 26 12" version="1.1" xmlns="http://www.w3.org/2000/svg" class="loading-animation loading-animation--small grey"><circle cx="4" cy="6" r="3" class="circle-1" /><circle cx="4" cy="6" r="3" class="circle-2" /><circle cx="13" cy="6" r="3" class="circle-3" /><circle cx="22" cy="6" r="3" class="circle-4" /></svg></div>'},s.DEBUG&&(t.components.spinner.gifthaw.soyTemplateName="tiger.components.spinner.gifthaw")}),define("app/modalmenu/notifmenu",["jquery","backbone.marionette","collection/Notifications","view/modal/duimodal.defaultBehavior","templates/tiger/components/duiModal","templates/tiger/components/navpanels","templates/tiger/components/spinner"],function(e,t,n,s){"use strict";var o,i=t.ItemView.extend({template:tiger.components.spinner.bounce});return o=t.Layout.extend({notificationListLoaded:null,template:tiger.components.duiModal.layout,regions:{bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:s}},initNotificationList:function(){var t=e.Deferred();return require(["module/NotificationListModule"],function(e){t.resolve(e)}),t},onRender:function(){this.notificationListLoaded||(this.bodyRegion.show(new i),this.notificationListLoaded=this.initNotificationList()),this.notificationListLoaded.done(function(e){var t=new n,s=new e({collection:t,model:this.model});this.bodyRegion.show(s),t.fetch({reset:!0}),this.$(".dui-modal-body").addClass("nav-dropdown")}.bind(this))}})}),define("app/navigation/secondaryNav.view",["jquery","backbone","backbone.marionette"],function(e,t,n){"use strict";var s=t.Model.extend({defaults:{open:!1}}),o=n.Layout.extend({model:new s,modelEvents:{"change:open":"listEventHandler"},initialize:function(){var e,t;this.animation=this.options.animation,this.animation&&this.$el.addClass("animated-secondary-nav"),e=new i({el:".js_toggle-secondary-nav",model:this.model}),t=new a({el:".js_secondary-nav-wrapper",model:this.model})},listEventHandler:function(){var t=this;this.model.get("open")?e("body").on("click.hidemenu",function(){t.model.set("open",!1)}):e("body").off("click.hidemenu")}}),i=n.ItemView.extend({events:{click:"openSecondaryNav"},initialize:function(){var t=this.$el.parents(".js_secondary-nav-btn-wrapper");e(".js_global-nav-wrap").on("autohide.pushdown.show",function(){t.addClass("shown")}).on("autohide.pushdown.hide",function(){t.removeClass("shown")})},openSecondaryNav:function(e){e.stopPropagation(),this.model.set("open",!0)}}),a=n.ItemView.extend({modelEvents:{"change:open":"toggleOpen"},toggleOpen:function(){this.model.get("open")&&(this.$el.height(e(document).height()),e(window).scrollTop(0)),this.$el.toggleClass("hide",!this.model.get("open"))}});return o}),define("templates/tiger/section/header/success-box",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.section.header.successBox=function(e,n,s){return'<div class="proxima success-box js_success_box" style="display: none">'+(e.dismissable?'<a href="#" class="js_close close icon--svg u-darkened--onhover">'+t.icons.actions.closeSmall(null,null,s)+"</a>":"")+'<span class="msg">'+o.$$filterNoAutoescape(e.message)+"</span></div>"},s.DEBUG&&(t.section.header.successBox.soyTemplateName="tiger.section.header.successBox"),t.section.header.moreWarnings=function(e){return'<div class="proxima success-box js_additional-warnings"><a href="#">'+o.$$escapeHtml(e.count)+" more warnings</a></div>"},s.DEBUG&&(t.section.header.moreWarnings.soyTemplateName="tiger.section.header.moreWarnings")}),define("view/SuccessBox",["jquery","view/BaseView","templates/tiger/section/header/success-box"],function(e,t){"use strict";var n=t.extend({events:{"click .js_close":"close","click .js_open-channels":"openChannels"},initialize:function(t){this.options=e.extend({message:"",dismissable:!0,url:null,permanent:!1,hidden:!1,timeout:2500},t)},render:function(){var t=this.options,n=this.soyToHtml(tiger.section.header.successBox,{message:this.getHtml(t.message),dismissable:t.dismissable});e("#js_success-box-container").append(n),this.setElement(e(".js_success_box:last")),this.options.hidden||this.$el.fadeIn(300),t.warningBox&&this.$el.addClass("warning-box"),window.setTimeout(function(){this.options.permanent||this.close()}.bind(this),t.timeout),null!==this.options.url&&this.$el.on("click",function(){return window.location=this.options.url,!1}.bind(this)).addClass("linked")},close:function(e){e&&e.preventDefault&&e.preventDefault(),this.$el.slideUp("fast",this.remove.bind(this))},attachMoreWarningsBox:function(t){var n=this.soyToHtml(tiger.section.header.moreWarnings,{count:t});e("#js_success-box-container").append(n),e("#js_success-box-container .js_additional-warnings a").click(function(t){t.preventDefault(),e(this).parent().hide(),e(".js_success_box").show()})},openChannels:function(t){e(".js_channels-off-canvas-toggle").click(),t.preventDefault()}});return n}),define("templates/tiger/section/sidebar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.section.sidebar.sidebarModule=function(e,n,s){var i="",o=e.trendingStories.length&&e.adsEnabled&&!s.features.leftrail_notrending,a=e.popularStories.length;return i+='<div class="sidebar-content js_sidebar-container js_sidebar">'+(s.features.newsletter_fs?'<div class="js_newsletter-btn--subscribe"></div>':"")+(o?'<div class="sidebar-module trending-module js_leftrailmodule">'+t.section.sidebar.leftrailTrending({posts:e.trendingStories,postsJson:e.trendingStoriesJson,permalinkPost:e.permalinkPost},null,s)+"</div>"+t.section.sidebar.containedAdContainer({preload:!0},null,s):"")+(a?'<div class="sidebar-module js_leftrailmodule leftrailmodule--popular'+(o?" invisible":"")+'">'+t.section.sidebar.leftrailPopular({popularPosts:e.popularStories,permalinkPost:e.permalinkPost,blogDisplayName:e.blogDisplayName,recommendedByScreenName:e.recommendedByScreenName,recommendedByDisplayName:e.recommendedByDisplayName},null,s)+'<div class="leftrailmodule--promotion js_leftrailmodule--promotion js_ad-promotion ad-promotions-container row"><div class="column">'+t.components.ad.leftrailPromotion({pp_position:"sidebar"},null,s)+"</div></div></div>"+(o?"":t.section.sidebar.containedAdContainer({preload:!0},null,s)):"")+"</div>"},s.DEBUG&&(t.section.sidebar.sidebarModule.soyTemplateName="tiger.section.sidebar.sidebarModule"),t.section.sidebar.leftrailTrendingImage=function(e,t,n){var i="",s=e.post.image,a=""+(s?"":(null==e.post.defaultBlogLogo?null:e.post.defaultBlogLogo.id)?"placeholder--logo":"placeholder--avatar"),r=""+(s?o.$$escapeHtml(window.kinja.imageUrl(s.id,"KinjaMedium",s.frozenFormat)):(null==e.post.defaultBlogLogo?null:e.post.defaultBlogLogo.id)?o.$$escapeHtml(window.kinja.imageUrl(e.post.defaultBlogLogo.id,"original",e.post.defaultBlogLogo.frozenFormat)):(null==e.post.defaultBlogAvatar?null:e.post.defaultBlogAvatar.id)?o.$$escapeHtml(window.kinja.imageUrl(e.post.defaultBlogAvatar.id,"original",e.post.defaultBlogAvatar.frozenFormat)):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png");return i+='<span class="trending-image-wrapper"><span class="img--16x9 '+o.$$escapeHtmlAttribute(a)+'"'+(n.features.lazy_trending_module||n.features.personalized_trending_module?"":` style="background-image: url('`+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(r))+`')"`)+'role="img" aria-label="'+o.$$escapeHtmlAttribute(e.post.headline)+'" alt="'+o.$$escapeHtmlAttribute(e.post.headline)+'"></span></span>'},s.DEBUG&&(t.section.sidebar.leftrailTrendingImage.soyTemplateName="tiger.section.sidebar.leftrailTrendingImage"),t.section.sidebar.leftrailTrending=function(e,n,s){var a="",v=3,_=s.features.fullheadline?130:73,i=(e.posts[0],s.features.lazy_trending_module||s.features.personalized_trending_module);a+="<header><h2>"+(i?"<strong>You</strong> may also like":"<strong>Popular</strong> from all blogs")+'</h2></header><div class="trending-reel js_trending-reel clearfix'+(i?" lazy-trending":"")+'" '+(e.postsJson?'data-posts="'+o.$$escapeHtmlAttribute(e.postsJson)+'"':"")+'><div class="index-wrapper">';for(var h=e.posts,b=h.length,c=0;b>c;c++)d=h[c],f=(d.image,"Trending module click, position "+o.$$escapeHtml(c+1)+", js_pageType"),a+=v>c?'<div class="index-img-wrap reel__item js_reel__item"><div class="reel__thumb"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(d.permalink))+'" data-ga="['+o.$$escapeHtmlAttribute(f)+']">'+t.section.sidebar.leftrailTrendingImage({post:d},null,s)+'<span class="index-img-num"></span></a></div></div>':"";a+='</div><div class="trending-progress js_trending-progress clearfix">';for(p=v,u=0;p>u;u++)a+='<div class="trending-progress__segment js_trending-progress__segment"><div class="segment__fill"></div></div>';a+='</div><div class="reel-wrap"><div class="reel js_reel">';for(var g=e.posts,j=g.length,l=0;j>l;l++){var d,u,f,p,r=g[l],y=""+t.utils.relativeTime({time:r.publishTime},null,s),m=""+(i?"[Author Name]":o.$$escapeHtml(window.kinja.stripHtmlTags(r.authorName,""))),w=i?"[Blog Name]":r.defaultBlogName,O=i?"[Headline]":r.headline,x=i?"[Publish Time]":y,C=i?"[Post Link]":r.permalink;a+='<a class="reel__feature sidebar-item js_reel__feature'+(0==l?" active":"")+'" href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(C))+'" data-ga="[Trending module click, position main, js_pageType]">'+t.section.sidebar.leftrailTrendingImage({post:r},null,s)+'<div class="trending-description-wrapper"><div class="reel__feature-description" style="background-color:#ffffff;min-height:93px"><div class="meta meta--source js_trending-source"><strong>'+o.$$escapeHtml(w)+"</strong>"+(m?" &middot; "+o.$$filterNoAutoescape(m):"")+'</div><h4 class="headline js_headline">'+o.$$filterNoAutoescape(window.kinja.truncateHtml(O,_))+'</h4><div class="meta js_meta"><time>'+o.$$filterNoAutoescape(x)+"</time></div></div></div></a>"}return a+="</div></div></div>"},s.DEBUG&&(t.section.sidebar.leftrailTrending.soyTemplateName="tiger.section.sidebar.leftrailTrending"),t.section.sidebar.leftrailPopular=function(e,n,s){var i,r,c="",h=3,l=""+(e.recommendedByDisplayName&&e.recommendedByScreenName?o.$$escapeHtml(e.recommendedByScreenName):e.recommendedByDisplayName&&e.popularPosts.length?o.$$escapeHtml(e.popularPosts[0].authorScreenName):""),d=l&&e.recommendedByDisplayName;c+="<header><h2>"+(d?'<strong>Recent</strong> from <a href="//kinja.com/'+o.$$escapeHtmlAttribute(l)+'">'+o.$$escapeHtml(e.recommendedByDisplayName)+"</a>":e.blogDisplayName?"<strong>Popular</strong> from "+o.$$escapeHtml(e.blogDisplayName):"<strong>Popular</strong> in your network")+"</h2></header>";for(var u=e.popularPosts,m=u.length,a=0;m>a;a++)i=u[a],r=i.image,c+=h>a?t.section.sidebar.leftrailPopularItem({index:a+1,headline:i.headline,imageUrl:r?window.kinja.imageUrl(r.id,"KinjaCenteredMedium",r.frozenFormat):"",permalink:i.permalink,authorName:i.authorName,isCurrentPost:!!e.permalinkPost&&e.permalinkPost.permalink==i.permalink,isRecommended:d,blogName:i.defaultBlogName,replyCount:i.replyCount,likeCount:i.likeCount,viewCount:i.viewCount,publishTime:i.publishTime},null,s):"";return c},s.DEBUG&&(t.section.sidebar.leftrailPopular.soyTemplateName="tiger.section.sidebar.leftrailPopular"),t.section.sidebar.leftrailPopularItem=function(e,n,s){var a,r,i="",c=s.features.fullheadline?130:73,l="Popular stories click, position "+o.$$escapeHtml(e.index)+", js_pageType";return i+='<div class="sidebar-item'+(e.isCurrentPost?" highlighted":"")+(e.isRecommended?" recommended":"")+'"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.permalink))+'" data-ga="['+o.$$escapeHtmlAttribute(l)+']">'+(e.imageUrl?'<span class="img--16x9"><span class="data-overlay"><ul>'+(e.likeCount?"<li>"+t.section.sidebar.numberFormat({number:e.likeCount},null,s)+t.icons.essential.star(null,null,s)+"</li>":"")+(e.replyCount?"<li>"+t.section.sidebar.numberFormat({number:e.replyCount},null,s)+t.icons.essential.bubble(null,null,s)+"</li>":"")+(e.viewCount?"<li>"+t.section.sidebar.numberFormat({number:e.viewCount},null,s)+t.icons.essential.flame(null,null,s)+"</li>":"")+"</ul></span>"+(e.imageUrl?'<span class="img--16x9" style="background-image: url('+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.imageUrl))+')" role="img" aria-label="'+o.$$escapeHtmlAttribute(e.headline)+'" alt="'+o.$$escapeHtmlAttribute(e.headline)+'"></span>':"")+"</span>":""),a=""+o.$$escapeHtml(window.kinja.stripHtmlTags(e.authorName,"")),i+='<div class="meta meta--source"><strong>'+o.$$escapeHtml(e.blogName)+"</strong>"+(a?" &middot; "+o.$$filterNoAutoescape(a):"")+'</div><h4 class="headline">'+o.$$filterNoAutoescape(window.kinja.truncateHtml(e.headline,c))+"</h4>",r=""+t.utils.relativeTime({time:e.publishTime},null,s),i+='<div class="meta"><time>'+o.$$filterNoAutoescape(r)+"</time></div></a></div>"},s.DEBUG&&(t.section.sidebar.leftrailPopularItem.soyTemplateName="tiger.section.sidebar.leftrailPopularItem"),t.section.sidebar.containedAdContainer=function(e,n,s){return e=e||{},"<div"+(e.preload?' id="js_leftrailmodule--preloadedad"':"")+' class="sidebar-module js_contained-ad-container contained-ad-container js_leftrailmodule invisible"><div class="contained-ad-shaft js_contained-ad-shaft"><div class="contained-ad-wrapper js_contained-ad-wrapper notransform"><div class="ad-pad"></div>'+t.components.ad.leftRail(null,null,s)+'<div class="ad-pad"></div></div></div></div>'},s.DEBUG&&(t.section.sidebar.containedAdContainer.soyTemplateName="tiger.section.sidebar.containedAdContainer"),t.section.sidebar.containedAdContents=function(e,n,s){return e=e||{},'<div class="contained-ad-shaft js_contained-ad-shaft"><div class="contained-ad-wrapper js_contained-ad-wrapper">'+(e.isEmpty?"":'<div class="ad-pad"></div>'+t.components.ad.leftRail(null,null,s)+'<div class="ad-pad"></div>')+"</div></div>"},s.DEBUG&&(t.section.sidebar.containedAdContents.soyTemplateName="tiger.section.sidebar.containedAdContents"),t.section.sidebar.numberFormat=function(e){return""+(e.number<1e3?o.$$escapeHtml(e.number):e.number>1e3&&e.number<1e6?o.$$escapeHtml(Math.round(e.number/1e3*10)/10)+"K":o.$$escapeHtml(Math.round(e.number/1e6*10)/10)+"M")},s.DEBUG&&(t.section.sidebar.numberFormat.soyTemplateName="tiger.section.sidebar.numberFormat")}),define("templates/tiger/components/ad/ads",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.ad.zoneSimple=function(e){var r="",s="MOBILE"==e.type,i=Math.floor(89999999*Math.random())+1e7,a=e.media&&"INSTREAM_VIDEO"==e.media;return r+='<div class="ad-unit js_ad-unit'+(s?" hide-contents":"")+" ad-"+o.$$escapeHtmlAttribute(e.cssClass)+" js_ad-"+o.$$escapeHtmlAttribute(e.cssClass)+'">'+(s?'<div class="ad-mobile-inner"><p class="ad-label proxima"><small class=" proxima">Advertisement</small></p>':"")+'<div id="ad-container-'+o.$$escapeHtmlAttribute(i)+'" class="ad-container js_ad-container"'+(a?'data-media-type="'+o.$$escapeHtmlAttribute(e.media)+'"':"")+'data-zone-type="'+o.$$escapeHtmlAttribute(e.type)+'"'+(e.forcedAdZone?' data-forced-ad-zone="'+o.$$escapeHtmlAttribute(e.forcedAdZone)+'"':"")+(e.postId?' data-post-id="'+o.$$escapeHtmlAttribute(e.postId)+'"':"")+(e.pp_position?'data-pp-position="'+o.$$escapeHtmlAttribute(e.pp_position)+'"':"")+">"+(a?'<span id="js_instream_video-placeholder-'+o.$$escapeHtmlAttribute(i)+'" class="js_instream-video-placeholder"></span>':"")+"</div>"+(s?'<p class="ad-label-bottom"></p></div>':"")+"</div>"},s.DEBUG&&(t.components.ad.zoneSimple.soyTemplateName="tiger.components.ad.zoneSimple"),t.components.ad.tracker=function(e,n,s){return e=e||{},""+t.components.ad.zoneSimple({type:"TRACKER",cssClass:"tracker",forcedAdZone:null!=e.postAdZone?e.postAdZone:null,postId:null!=e.postId?e.postId:null},null,s)},s.DEBUG&&(t.components.ad.tracker.soyTemplateName="tiger.components.ad.tracker"),t.components.ad.topBanner=function(e,n,s){return""+t.components.ad.zoneSimple({type:"TOP_BANNER",cssClass:"top-banner"},null,s)},s.DEBUG&&(t.components.ad.topBanner.soyTemplateName="tiger.components.ad.topBanner"),t.components.ad.billboard=function(e,n,s){return""+t.components.ad.zoneSimple({type:"BILLBOARD",cssClass:"billboard"},null,s)},s.DEBUG&&(t.components.ad.billboard.soyTemplateName="tiger.components.ad.billboard"),t.components.ad.billboardDynamic=function(e,n,s){return""+t.components.ad.zoneSimple({type:"BILLBOARD_DYNAMIC",cssClass:"billboard--dynamic"},null,s)},s.DEBUG&&(t.components.ad.billboardDynamic.soyTemplateName="tiger.components.ad.billboardDynamic"),t.components.ad.leftRail=function(e,n,s){return""+t.components.ad.zoneSimple({type:"LEFT_RAIL",cssClass:"left-rail"},null,s)},s.DEBUG&&(t.components.ad.leftRail.soyTemplateName="tiger.components.ad.leftRail"),t.components.ad.mobile=function(e,n,s){return""+t.components.ad.zoneSimple({type:"MOBILE",cssClass:"mobile"},null,s)},s.DEBUG&&(t.components.ad.mobile.soyTemplateName="tiger.components.ad.mobile"),t.components.ad.mobileSecond=function(e,n,s){return"<h1>INSERT TABOOLA HERE</h1>"+t.components.ad.zoneSimple({type:"MOBILE_SECOND",cssClass:"mobile_second--dynamic"},null,s)},s.DEBUG&&(t.components.ad.mobileSecond.soyTemplateName="tiger.components.ad.mobileSecond"),t.components.ad.adhesion=function(e,n,s){return""+t.components.ad.zoneSimple({type:"ADHESION",cssClass:"adhesion"},null,s)},s.DEBUG&&(t.components.ad.adhesion.soyTemplateName="tiger.components.ad.adhesion"),t.components.ad.preroll=function(){return'<div id="foreplay" class="reveal-modal js_foreplay foreplay proxima noskimlinks noskimwords" data-reveal><div id="jwPlayerVideo"></div><a href="#" class="close js_foreplay-close">You can skip this ad in 5 seconds.</a></div>'},s.DEBUG&&(t.components.ad.preroll.soyTemplateName="tiger.components.ad.preroll"),t.components.ad.promotion=function(e,n,s){var o="",i=""+(e.mobile?"PROMOTION_MOBILE":"PROMOTION");return o+=t.components.ad.zoneSimple({type:i,media:e.media,cssClass:"promotion",pp_position:e.pp_position},null,s)},s.DEBUG&&(t.components.ad.promotion.soyTemplateName="tiger.components.ad.promotion"),t.components.ad.leftrailPromotion=function(e,n,s){return""+t.components.ad.zoneSimple({type:"PROMOTION_SIDEBAR",cssClass:"promotion-sidebar",pp_position:e.pp_position},null,s)},s.DEBUG&&(t.components.ad.leftrailPromotion.soyTemplateName="tiger.components.ad.leftrailPromotion"),t.components.ad.splashyTop=function(e,n,s){return""+t.components.ad.zoneSimple({type:"SPLASHYTOP",cssClass:"splashy-top"},null,s)},s.DEBUG&&(t.components.ad.splashyTop.soyTemplateName="tiger.components.ad.splashyTop"),t.components.ad.splashyBottom=function(e,n,s){return""+t.components.ad.zoneSimple({type:"SPLASHYBOTTOM",cssClass:"splashy-bottom"},null,s)},s.DEBUG&&(t.components.ad.splashyBottom.soyTemplateName="tiger.components.ad.splashyBottom"),t.components.ad.instreamVideo=function(e,n,s){return'<div class="ad-instream ad-instream--elastic"><div class="elastic__wrapper">'+t.components.ad.zoneSimple({type:"INSTREAM_VIDEO",media:e.media,cssClass:"video",pp_position:e.pp_position},null,s)+"</div></div>"},s.DEBUG&&(t.components.ad.instreamVideo.soyTemplateName="tiger.components.ad.instreamVideo")}),define("lib/jquery.stickem",["jquery"],function(e){"use strict";var t,s=e(window),i=e(".js_global-nav-wrap"),a=i.find(".f-dropdown"),n="down",o=s.scrollTop();s.on("scroll.stickem.global",function(){var e=s.scrollTop();n="down",o>e&&(n="up"),o=e}),t=function(t,n){this.elem=t,this.$elem=e(t),this.options=n,this.metadata=this.$elem.data("stickem-options"),this.$win=e(window)},t.prototype={defaults:{item:".stickem",container:".stickem-container",stickClass:"stickit",stickPushdownClass:"pushdown",endStickClass:"stickit-end",offset:0,start:0,onStick:null,onUnstick:null},init:function(){var t=this;return t.config=e.extend({},t.defaults,t.options,t.metadata),t.setWindowHeight(),t.getItems(),t.bindEvents(),t},bindEvents:function(){var t=this;t.$win.on("scroll.stickem",e.proxy(t.handleScroll,t)),t.$win.on("resize.stickem",e.proxy(t.handleResize,t))},destroy:function(){var e=this;e.$win.off("scroll.stickem"),e.$win.off("resize.stickem")},getItem:function(t,n){var o=this,i=e(n),s={_stickemSelf:o,$elem:i,elemHeight:i.height(),$container:i.parents(o.config.container),isStuck:!1};o.windowHeight>s.elemHeight?(s.containerHeight=s.$container.outerHeight(),s.containerInner={border:{bottom:parseInt(s.$container.css("border-bottom"),10)||0,top:parseInt(s.$container.css("border-top"),10)||0},padding:{bottom:parseInt(s.$container.css("padding-bottom"),10)||0,top:parseInt(s.$container.css("padding-top"),10)||0}},s.containerStart=s.$container.offset().top-o.config.offset+o.config.start+s.containerInner.padding.top+s.containerInner.border.top,s.containerInnerHeight=s.$container.height(),s.scrollFinish=s.containerStart-o.config.start+(s.containerInnerHeight-s.elemHeight),s.containerInnerHeight>s.elemHeight&&o.items.push(s)):s.$elem.removeClass(o.config.stickClass+" "+o.config.endStickClass)},getItems:function(){var t=this;t.items=[],t.$elem.find(t.config.item).each(e.proxy(t.getItem,t))},handleResize:function(){var e=this;e.getItems(),e.setWindowHeight()},handleScroll:function(){if(t=this,t.items.length>0)for(var e,t,i,s=t.$win.scrollTop(),o=0,r=t.items.length;r>o;o++)e=t.items[o],e.isStuck&&(s<e.containerStart||s>e.scrollFinish)||s>e.scrollFinish?(e.$elem.removeClass(t.config.stickClass).removeClass(t.config.stickPushdownClass),s>e.scrollFinish&&e.$elem.addClass(t.config.endStickClass),i=e.isStuck,e.isStuck=!1,i&&t.config.onUnstick&&t.config.onUnstick(e,n)):e.isStuck===!1&&s>e.containerStart&&s<e.scrollFinish&&(a.hasClass("open")&&e.$elem.addClass(t.config.stickPushdownClass),e.$elem.removeClass(t.config.endStickClass).addClass(t.config.stickClass),e.isStuck=!0,t.config.onStick&&t.config.onStick(e,n))},setWindowHeight:function(){var e=this;e.windowHeight=e.$win.height()-e.config.offset}},t.defaults=t.prototype.defaults,e.fn.stickem=function(e){return this.destroy=function(){this.each(function(){new t(this,e).destroy()})},this.each(function(){new t(this,e).init()})}}),define("app/leftrail/leftrailContainedItem.view",["jquery","backbone.marionette","lib/amd-wrapped/modernizr","singleton/WindowController","module/ads/ads.events","templates/tiger/section/sidebar","templates/tiger/components/ad/ads","templates/tiger/section/sidebar","lib/jquery.stickem"],function(e,t,n,s,o){"use strict";var i,a=e(window);return i=t.ItemView.extend({_isStatic:!1,template:tiger.section.sidebar.containedAdContents,ui:{containedAd:".js_contained-ad-wrapper",adContainer:".js_ad-container",adShaft:".js_contained-ad-shaft",adUnit:".js_ad-unit"},tagName:"section",className:"js_contained-ad-container contained-ad-container leftrailmodule js_leftrailmodule invisible notransform",serializeData:function(){return{isEmpty:this.options.isEmpty||!1}},onRender:function(e){e&&e.hasOwnProperty("isStatic")&&(this._isStatic=e.isStatic);var t,n=this.$el.outerHeight(!0);this.listenTo(this,"dom:appended",function(){t=this.$el.offset().top-a.scrollTop(),s.isPartiallyVisible(this.$el)?this.onVisible():this.$el.offset().top+n/2>=a.scrollTop()?this.$el.waypoint({handler:function(e){"down"===e&&(this.onVisible(),this.$el.waypoint("destroy"))}.bind(this),offset:"100%"}):this.$el.waypoint({handler:function(e){"up"===e&&(this.onVisible(),this.$el.waypoint("destroy"))}.bind(this),offset:-this.$el.outerHeight()})})},onVisible:function(){var e=this.ui.adContainer,t=e.attr("id");!t||e.hasClass("initialized")?this.reveal():(this.listenTo(o,"kinjaads."+t+".displayed",function(e){this.reveal(e.zone)}),o.trigger("ads.dynamicad.load",e,"LEFT_RAIL_DYNAMIC"))},resize:function(){this.$el.addClass("short")},resizeAd:function(){this.ui.containedAd.length&&this.ui.containedAd.addClass("short")},reveal:function(e){this.ui.adContainer.length&&(this.ui.adContainer.height()<i.adHeights.LARGE&&this.resizeAd(e),n.touch||this._isStatic||this.preparePushdownSticky()),this.$el.removeClass("invisible")},preparePushdownSticky:function(){this.$el.stickem({container:this.ui.adShaft,item:".js_contained-ad-wrapper",stickClass:"waypoint--fixed js_ah-pushdown",onStick:function(e,t){e.$elem.removeClass("notransform"),"down"===t&&e.$elem.removeClass("frombottom")},endStickClass:"waypoint--unfixed",onUnstick:function(e,t){e.$elem.addClass("notransform"),s.translateElement(e.$elem),"up"===t&&e.$elem.addClass("frombottom")}.bind(this),offset:i.stickemOffset})}},{adHeights:{SMALL:250,LARGE:600},stickemOffset:20})}),define("templates/tiger/utils/relative-time",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.utils.relativeTime=function(e,n,s){return e=e||{},""+(e.time?t.messages.time.relativeTime({type:e.time.relative.type,amount:e.time.relative.amount,hmma:e.time.hmma,day:e.time.day,Mddyyhmma:e.time.Mddyyhmma},null,s):"")},s.DEBUG&&(t.utils.relativeTime.soyTemplateName="tiger.utils.relativeTime")}),define("app/leftrail/trendingReel.view",["jquery","underscore","backbone.marionette","singleton/WindowController","singleton/Utils","singleton/Renderer","singleton/Feature","templates/tiger/utils/relative-time"],function(e,t,n,s,o,i,a){"use strict";var r,c,d,l="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationEnd animationend";return c=function(){return s.isLargeUp()},r=c(),d=n.ItemView.extend({_reelIndex:0,_mouseInReel:!1,_mouseInItem:!1,ui:{progressBar:".js_trending-progress",progressSegments:".js_trending-progress__segment",reel:".js_reel",reelItem:".js_reel__item",reelFeature:".js_reel__feature"},events:{"mouseenter @ui.reelItem":"onMouseenterReelItem","mouseleave @ui.reelItem":"onMouseleaveReelItem",mouseenter:"onMouseinteract",mouseleave:"onMouseinteract"},render:function(){var s=n.getOption(this,"posts")||JSON.parse(e.attr(this.el,"data-posts")||"[]"),d=e(this.el).find(".js_reel__item"),l=e(this.el).find(".js_reel__feature"),u=a.isOn("personalized_trending_module")||a.isOn("lazy_trending_module");this.bindUIElements(),this.delegateEvents(),u&&(d.find(".img--16x9").each(function(e,t){var n=s[e].image||s[e].defaultBlogLogo||s[e].defaultBlogAvatar,i=n?o.imageUrl(n.id,"KinjaMedium",n.format):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png";t.style["background-image"]="url('"+i+"')"}),l.find(".img--16x9").each(function(e,t){var n=s[e].image||s[e].defaultBlogLogo||s[e].defaultBlogAvatar,i=n?o.imageUrl(n.id,"KinjaMedium",n.format):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png";t.style["background-image"]="url('"+i+"')"}),l.each(function(t,n){var o=s[t],a=i.renderTemplate(tiger.utils.relativeTime,{time:o.publishTime});e.attr(n,"href",o.permalink),e(n).find(".js_headline").html(o.headline),e(n).find(".js_trending-source").html("<strong>"+o.defaultBlogName+"</strong> &middot "+o.authorNameOrByline),e(n).find(".js_meta").html(e("<time>").html(a))}),e(this.el).addClass("loaded")),r&&this._startTicking(),e(window).on("resize.trendingModule",t.throttle(function(){var e=c();r&&!e?this._resetTicking():!r&&e&&this._startTicking(),r=e}.bind(this),500))},onMouseenterReelItem:function(t){this._showItem(e(t.currentTarget).index(),!0),this._mouseInItem=!0},onMouseleaveReelItem:function(){this._mouseInReel||this._showItem(this._reelIndex,!0),this._mouseInItem=!1},onMouseinteract:function(e){return this._mouseInReel="mouseenter"===e.type,this._mouseInItem||this._showItem(this._reelIndex,!0),!0},_startTicking:function(){this.ui.progressBar.addClass("ticking"),this._reelIndex=0,this._showItem(this._reelIndex)},_resetTicking:function(){this.ui.progressBar.removeClass("ticking"),this.ui.progressSegments.removeClass("ticking").off(l)},_showItem:function(e,t){var s=this.ui.reelItem.length,n=this.ui.reelItem.eq(e);n.hasClass("active")||(this.ui.reelItem.removeClass("active"),n.width(),n.addClass("active")),this.ui.reelFeature.filter(".active").removeClass("active").addClass("inactive").end().eq(e).removeClass("inactive").addClass("active"),t||this.ui.progressSegments.eq(e).addClass("ticking").one(l,function(){this._reelIndex=(this._reelIndex+1)%s,0===this._reelIndex&&this._resetTicking(),this._showItem(this._reelIndex)}.bind(this))}})}),define("app/leftrail/leftrailContainedList.view",["jquery","backbone.marionette","view/behaviors/googleAnalytics.behavior","app/leftrail/leftrailContainedItem.view","module/ads/model/ads.slotModel","app/leftrail/trendingReel.view","module/ads/ads.events","singleton/WindowController","singleton/Feature","singleton/Utils","lib/waypoints"],function(e,t,n,s,o,i,a,r,c,l){"use strict";var d,u=e(".js_main__content"),h=e(".js_page"),m=e(".js_sidebar-actual-container"),f=e(window).height(),p=e("#js_leftrailmodule--preloadedad").outerHeight(!0);return d=t.CollectionView.extend({_isNextEmpty:!1,behaviors:{GoogleAnalyticsBehavior:{behaviorClass:n}},ui:{leftrailmodules:".js_leftrailmodule",preloadedAd:"#js_leftrailmodule--preloadedad"},itemView:s,render:function(){var h,m,f,p,g,n=e('.js_ad-container[data-zone-type="LEFT_RAIL"]'),v=n.attr("id"),s=o.zoneTypes,d=e.Deferred(),u=e.Deferred(),b=l.getKinjaMeta(),j=!!b.blogSales&&b.blogSales.adsEnabled;this.isClosed=!1,this.bindUIElements(),r.isMediumDown()||n.length&&(n.hasClass("js_slot-hidden")||n.hasClass("js_slot-inactive"))?this.bindChildren(!1):n.length&&n.hasClass("js_slot-displayed")?this.bindChildren(!0):c.isOn("splashy_ad")?e.when(d,u).done(function(e){this.bindChildren(e)}.bind(this)):e.when(d).done(function(e){this.bindChildren(e)}.bind(this)),h=["kinjaads.disabled","kinjaads."+v+".hide","ads."+s.LEFT_RAIL+".inactive"].join(" "),m="kinjaads."+v+".displayed",this.listenToOnce(a,h,function(){d.resolve(!1)}).listenToOnce(a,m,function(){d.resolve(!0)}),c.isOn("ad_module")&&(j?(f=["kinjaads.disabled","kinjaads."+s.SPLASHYTOP+".hide","ads."+s.SPLASHYTOP+".inactive","kinjaads."+s.SPLASHYTOP+".displayed"].join(" "),this.listenToOnce(a,f,function(){u.resolve()}),window.kinjaads.queue.push({zoneType:s.SPLASHYTOP,onRenderEnded:u.resolve})):u.resolve()),g=this.$(".js_trending-reel"),g.length>0&&(p=new i({el:this.$(".js_trending-reel"),posts:t.getOption(this,"trendingPosts")}),p.render())},bindChildren:function(e){var t,n=this,o=this._isLongPage();n.ui.leftrailmodules.each(function(){return t=new s({el:this}),t.bindUIElements(),t.$el.hasClass("contained-ad-container")&&(o||t.resize(),!e)?void t.remove():(t.delegateEvents(),n.addChildViewEventForwarding(t),n.children.add(t),t.onRender({isStatic:!o}),void t.trigger("dom:appended"))}),o&&!r.isMediumDown()&&e&&this.bindNewAdWaypoint()},addNewModule:function(){var t=this.getItemView(),e=this._isNextEmpty?new t({isEmpty:!0}):new t;this._isNextEmpty=!this._isNextEmpty,e.render(),this.$el.append(e.$el),e.trigger("dom:appended")},bindNewAdWaypoint:function(){this.$el.waypoint({handler:function(e){"down"===e&&(this.$el.waypoint("destroy"),this.getRemainingHeight()>2*p&&(this.addNewModule(),this.bindNewAdWaypoint()))}.bind(this),offset:f-this.$el.outerHeight()+250})},getRemainingHeight:function(){return h.outerHeight(!0)-this.$el.outerHeight(!0)},_isLongPage:function(){return u.outerHeight(!0)>m.outerHeight(!0)}})}),define("view/footer.view",["jquery","underscore","backbone.marionette","view/behaviors/googleAnalytics.behavior"],function(e,t,n,s){"use strict";var o=n.ItemView.extend({behaviors:{GoogleAnalyticsBehavior:{behaviorClass:s}},onRender:function(){var n=e(window),o=n.height(),s=t.throttle(function(){n.scrollTop()+o>this.$el.offset().top&&(window.ga("send","event","Footer","scroll","complete",{nonInteraction:1}),n.off("scroll.footer"))}.bind(this),1e3);n.on("scroll.footer",s)}});return o}),define("templates/tiger/icons/essential/definitions",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.icons.essential.definitions=function(){return'<svg id="svggroup--essential" class="hide"><symbol id="iconset-search" viewBox="0 0 15 15"><path d="M9.5 8C11.433 8 13 6.433 13 4.5S11.433 1 9.5 1 6 2.567 6 4.5 7.567 8 9.5 8zm-3.233-.975c.196-.195.518-.19.708 0 .195.195.19.517 0 .708l-4.95 4.95c-.195.194-.517.19-.707 0-.195-.196-.19-.518 0-.708l4.95-4.95zM9.5 9C7.015 9 5 6.985 5 4.5S7.015 0 9.5 0 14 2.015 14 4.5 11.985 9 9.5 9z" /></symbol><symbol id="iconset-add" viewBox="0 0 18 18"><path d="M9 2.494C9 2.226 8.776 2 8.5 2c-.268 0-.5.22-.5.494V8H2.494C2.226 8 2 8.224 2 8.5c0 .268.22.5.494.5H8v5.506c0 .268.224.494.5.494.268 0 .5-.22.5-.494V9h5.506c.268 0 .494-.224.494-.5 0-.268-.22-.5-.494-.5H9V2.494z" /></symbol><symbol id="iconset-add--small" viewBox="0 0 10 10"><path d="M6 1.007C6 .45 5.552 0 5 0c-.556 0-1 .45-1 1.007V4H1.007C.45 4 0 4.448 0 5c0 .556.45 1 1.007 1H4v2.993C4 9.55 4.448 10 5 10c.556 0 1-.45 1-1.007V6h2.993C9.55 6 10 5.552 10 5c0-.556-.45-1-1.007-1H6V1.007z"></path></symbol><symbol id="iconset-site-default" viewBox="0 0 18 18"><path d="M9 16.158c3.953 0 7.158-3.205 7.158-7.158 0-3.953-3.205-7.158-7.158-7.158-3.953 0-7.158 3.205-7.158 7.158 0 3.953 3.205 7.158 7.158 7.158zM9 17c-4.418 0-8-3.582-8-8s3.582-8 8-8 8 3.582 8 8-3.582 8-8 8z"/><path d="M9 16.158c1.97 0 3.79-3.143 3.79-7.158 0-4.015-1.82-7.158-3.79-7.158S5.21 4.985 5.21 9c0 4.015 1.82 7.158 3.79 7.158zM9 17c-2.558 0-4.632-3.582-4.632-8S6.442 1 9 1s4.632 3.582 4.632 8S11.558 17 9 17z"/><path d="M2.742 4.674c1.69.883 3.947 1.383 6.345 1.383 2.396 0 4.65-.5 6.34-1.38l-.39-.746c-1.564.82-3.684 1.29-5.95 1.29-2.27 0-4.39-.47-5.955-1.28l-.39.746zm.39 9.403c1.564-.817 3.686-1.288 5.955-1.288 2.266 0 4.386.47 5.95 1.28l.39-.75c-1.69-.88-3.944-1.38-6.34-1.38-2.398 0-4.654.5-6.345 1.38l.39.744z"/><path d="M8.58 8.58H1.083v.84H8.58v7.496h.84V9.42h7.496v-.84H9.42V1.083h-.84V8.58z" /></symbol><symbol id="iconset-zoom-in" viewBox="0 0 18 18"><path d="M9 4.494C9 4.226 9.224 4 9.5 4c.268 0 .5.22.5.494V7h2.506c.268 0 .494.224.494.5 0 .268-.22.5-.494.5H10v2.506c0 .268-.224.494-.5.494-.268 0-.5-.22-.5-.494V8H6.494C6.226 8 6 7.776 6 7.5c0-.268.22-.5.494-.5H9V4.494zM9.5 13C6.462 13 4 10.538 4 7.5S6.462 2 9.5 2 15 4.462 15 7.5 12.538 13 9.5 13zm-4.877-1.36l-3.48 3.51c-.194.194-.188.514 0 .703.196.195.51.196.704.002l3.48-3.51c-.304-.275-.416-.34-.704-.706zM9.5 14c3.59 0 6.5-2.91 6.5-6.5S13.09 1 9.5 1 3 3.91 3 7.5 5.91 14 9.5 14z" /></symbol><symbol id="iconset-star" viewBox="0 0 18 18"><path d="M9.005 13.115L4.083 16.88l1.895-6.07-4.943-3.563 6.094.014L9 1.01l1.866 6.25 6.093-.01-4.93 3.563 1.89 6.07z" /></symbol><symbol id="iconset-star--giant" viewBox="0 0 24 24"><path d="M12 17.8l-7.053 4.908 2.488-8.225-6.848-5.19 8.592-.176L12 1l2.82 8.117 8.593.175-6.848 5.19 2.488 8.226z" /></symbol><symbol id="iconset-star-circle" viewBox="0 0 18 18"><path d="M9 17c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zM9 3.7c.093 0 .185.06.208.158l1.146 3.39 3.413.085c.104 0 .185.073.22.17.034.097 0 .207-.08.267l-2.72 2.175.972 3.44c.03.096 0 .206-.09.266-.05.04-.097.05-.14.05-.05 0-.09-.02-.13-.05L9 11.61l-2.81 2.04c-.036.038-.082.05-.13.05-.045 0-.09-.012-.138-.05-.07-.06-.104-.17-.08-.266l.97-3.44L4.095 7.77c-.08-.06-.115-.17-.08-.267.034-.097.127-.17.22-.17l3.412-.085 1.134-3.39c.04-.098.13-.158.22-.158z" /></symbol><symbol id="iconset-chevron-right" viewBox="0 0 18 18"><path d="M6.165 3.874c-.217-.204-.22-.53-.008-.73.206-.192.56-.195.776.008l5.902 5.48c.11.102.165.236.165.37-.002.126-.055.262-.165.365l-5.902 5.478c-.217.204-.564.207-.776.007-.206-.193-.21-.525.008-.728L11.69 9 6.165 3.873z" /></symbol><symbol id="iconset-chevron-right--small" viewBox="0 0 10 10"><path d="M7.782 4.497L3.272.207c-.287-.274-.763-.278-1.054 0-.292.277-.29.724.002 1L6.205 5 2.22 8.79c-.288.273-.292.726-.002 1.002.293.28.763.276 1.054 0l4.51-4.29C7.926 5.363 8 5.18 8 5c.002-.183-.072-.364-.218-.503z" /></symbol><symbol id="iconset-flame" viewBox="0 0 18 18"><path d="M3.923 10.89c0 2.678 2.447 5.17 5.077 5.17s5.077-2.492 5.077-5.17c0-1.752-.618-3.036-1.977-4.664-1.196-1.433-1.154-3.453-1.093-3.453-.356-.04-2.164 2.918-2.49 5.764-.507 1.5-2.29 1.018-2.543-.126-.245-.62-.296-1.97-.296-2.47 0-.5-1.755 2.72-1.755 4.95zm2.962-2.617c.25.344.63.345.72.077.185-2.933 2.015-5.63 2.643-6.247.78-.766 1.7-1.444 1.984-.915.072.135-.047.438-.167.826-.267.863-.412 2.224.738 3.602C13.883 6.912 15 8.516 15 10.89c0 3.2-2.86 6.11-6 6.11s-6-2.912-6-6.11c0-2.018 1.45-5.456 2.972-6.798l.198-.17c.233-.197.806-.146.715.164-.837 2.85 0 4.187 0 4.187z" /></symbol><symbol id="iconset-flame--giant" viewBox="0 0 24 24"><path d="M9.004 10.954c.353.496.89.497 1.02.112.262-4.217 2.854-8.093 3.743-8.98C14.872.984 16.177.01 16.577.77c.103.194-.065.63-.235 1.187-.378 1.242-.583 3.198 1.046 5.18 1.532 1.86 3.112 4.166 3.112 7.58 0 4.597-4.052 8.783-8.5 8.783s-8.5-4.186-8.5-8.782c0-3.652 2.056-7.844 4.21-9.773l.28-.243c.33-.285 1.143-.212 1.014.234-1.186 4.096 0 6.018 0 6.018z" /></symbol><symbol id="iconset-logo-kinja" viewBox="0 0 18 18"><path d="M2.898 8.293c.746.24 1.423.978 1.734 1.495.31.517 2.246 3.78 2.905 4.916.726 1.253 1.743 1.294 2.308 1.294h4.125s-3.023-5.378-3.943-6.846c-.622-.994-1.452-1.11-2.374-1.11H2.1C2.093 8.042 3 7.065 5 7c2-.065 5.284.006 6.64 0 1.354-.006 2.046-.727 2.33-1.195.284-.468 2.03-3.8 2.03-3.8S8.793 1.995 6.992 2c-1.21.006-1.734.647-2.197 1.41l-2.792 4.6c-.01.017.007.07.017.098 0 0 .35.018.878.186z" /><</symbol><symbol id="iconset-bubble" viewBox="0 0 18 18"><path d="M6.292 13.952l.34-.503.577.1c.43.07.86.11 1.29.11 3.65 0 6.56-2.65 6.56-5.84 0-3.186-2.91-5.836-6.57-5.836-3.657 0-6.566 2.65-6.566 5.836 0 1.918 1.054 3.7 2.83 4.84l.437.256c0 .18-.375 2.06-.57 2.54-.054.132 1.12-.71 1.66-1.51zm-2.01-.426C2.3 12.254 1 10.182 1 7.832 1 4.06 4.358 1 8.5 1 12.642 1 16 4.06 16 7.832c0 3.774-3.36 6.833-7.5 6.833-.495 0-.978-.047-1.447-.13-.32.473-2.45 2.172-3.165 2.4-.714.226-.823-.164-.51-.713.313-.548.903-1.95.903-2.696z" /></symbol><symbol id="iconset-bubble--giant" viewBox="0 0 24 24"><path d="M6.094 18.506C3.324 16.678 1.5 13.7 1.5 10.32 1.5 4.9 6.2.5 12 .5s10.5 4.398 10.5 9.82c0 5.425-4.702 9.823-10.5 9.823-.694 0-1.37-.067-2.025-.187-.45.68-3.432 3.123-4.432 3.45-1 .326-1.15-.235-.713-1.024.438-.788 1.264-2.802 1.264-3.876z" /></symbol><symbol id="iconset-checkmark" viewBox="0 0 18 18"><path d="M14.855 5.87c.192-.195.195-.523 0-.722-.19-.194-.51-.2-.706 0l-7.418 7.62-2.88-2.978c-.19-.195-.515-.2-.71-.002-.19.194-.194.525.003.726L6.38 13.85c.095.1.224.15.353.15.128 0 .257-.047.355-.147l7.767-7.982z" /></symbol><symbol id="iconset-checkmark--small" viewBox="0 0 10 10"><path d="M.292 5.078c-.39.4-.388 1.044-.002 1.442l2.038 2.15c.313.344 1.125.526 1.703 0L9.71 2.746c.39-.402.388-1.046 0-1.445-.39-.402-1.014-.4-1.4 0l-5.11 5.39L1.69 5.075C1.31 4.683.68 4.68.293 5.078z"></path></symbol><symbol id="iconset-close" viewBox="0 0 18 18"><path d="M1.737 1.12c-.16-.158-.44-.164-.61.006-.165.165-.172.443-.005.61L7.885 8.5l-6.763 6.764c-.167.167-.16.445.005.61.17.17.45.164.61.005L8.5 9.11l6.763 6.764c.16.158.44.164.61-.006.165-.164.172-.442.005-.61L9.115 8.5l6.763-6.764c.167-.167.16-.445-.005-.61-.17-.17-.45-.164-.61-.005L8.5 7.89 1.737 1.12z" /></symbol><symbol id="iconset-close--small" viewBox="0 0 10 10"><path d="M2.884 1.47c-.394-.394-1.03-.395-1.42-.005-.392.393-.387 1.026.006 1.42L3.586 5 1.47 7.116c-.394.394-.395 1.03-.005 1.42.393.392 1.026.387 1.42-.006L5 6.414 7.116 8.53c.394.394 1.03.395 1.42.005.392-.393.387-1.026-.006-1.42L6.414 5 8.53 2.884c.394-.394.395-1.03.005-1.42-.393-.392-1.026-.387-1.42.006L5 3.586 2.884 1.47z" /></symbol><symbol id="iconset-facebook" viewBox="0 0 18 18"><path d="M7.003 17l-.006-7H4l.006-3h2.997V4.995C7.003 2.408 8.457 1 10.808 1c1.126 0 1.91.082 2.192.12v2.877h-1.447c-1.278 0-1.526.597-1.526 1.472V7h2.866l-.403 3h-2.47l.007 7H7.003z" /></symbol><symbol id="iconset-twitter" viewBox="0 0 18 18"><path d="M12.077 2c-1.812 0-3.282 1.582-3.282 3.534 0 .277.03.547.085.806-2.728-.148-5.147-1.555-6.766-3.693-.283.522-.445 1.13-.445 1.777 0 1.226.58 2.308 1.46 2.942-.54-.02-1.05-.178-1.49-.443v.045c0 1.712 1.13 3.14 2.63 3.465-.28.08-.57.124-.87.124-.21 0-.418-.022-.62-.063.418 1.404 1.63 2.426 3.067 2.455-1.125.94-2.54 1.51-4.078 1.51-.267 0-.528-.02-.785-.05 1.46 1 3.185 1.59 5.04 1.59 6.037 0 9.34-5.39 9.34-10.06 0-.153-.005-.306-.01-.457.64-.5 1.197-1.12 1.637-1.83-.59.28-1.22.47-1.885.557.677-.437 1.198-1.13 1.443-1.955-.633.405-1.336.7-2.084.858C13.88 2.43 13.028 2 12.08 2" /></symbol><symbol id="iconset-googleplus" viewBox="0 0 18 18"><path d="M13.657 13.42c0 .914-.4 1.74-1.202 2.475-.4.354-.916.62-1.545.796-.573.208-1.245.31-2.017.31-1.402 0-2.575-.264-3.52-.795C4.457 15.645 4 14.938 4 14.085c0-.62.2-1.18.6-1.68.43-.59 1.002-1.033 1.718-1.327.658-.324 1.46-.487 2.403-.487.03 0 .798-.15.827-.15-.458-.382-.653-.57-.653-1.04 0-.355.043-.665.214-.93h-.472c-1.058 0-1.903-.574-2.618-1.28-.686-.708-1.03-1.56-1.03-2.565 0-.972.43-1.812 1.288-2.52C7.106 1.37 8.09 1 9.236 1H14l-1.073.796h-1.502c.486.236.872.604 1.16 1.105.284.59.428 1.166.428 1.725 0 1.032-.472 1.9-1.416 2.608-.373.295-.63.546-.773.752-.115.147-.172.383-.172.707 0 .325.444.84 1.33 1.548.573.413 1.002.87 1.288 1.37.258.472.387 1.076.387 1.812zM11.31 4.483c-.145-.705-.46-1.29-.95-1.75-.487-.488-1.06-.73-1.72-.73-.604-.025-1.077.18-1.422.62-.373.46-.517 1.057-.43 1.787.143.73.473 1.337.99 1.824.517.51 1.076.766 1.68.766.66 0 1.162-.243 1.506-.73.373-.486.488-1.082.345-1.787zm.153 10.713c.55-.38.826-.862.826-1.445 0-1.7-2.757-2.05-3.06-2.05-.88 0-1.667.19-2.356.573-.69.403-1.033.873-1.033 1.41 0 .54.304 1.01.91 1.413.58.403 1.295.605 2.15.605 1.13 0 1.983-.167 2.56-.503z" fill-rule="evenodd"/></symbol><symbol id="iconset-external-link" viewBox="0 0 18 18"><path d="M3.006 17C1.898 17 1 16.103 1 14.994V5.006C1 3.898 1.897 3 3.006 3H5.5c.276 0 .5.224.5.5s-.224.5-.5.5H3.006C2.45 4 2 4.45 2 5.006v9.988C2 15.55 2.45 16 3.006 16h9.988C13.55 16 14 15.55 14 14.994V11.5c0-.276.224-.5.5-.5s.5.224.5.5v3.494C15 16.102 14.103 17 12.994 17H3.006zM10 1.5c0-.276.228-.5.51-.5h5.98c.51 0 .51.5.51.51v5.98c0 .282-.232.51-.5.51-.276 0-.5-.228-.5-.51V2.75l-8.095 8.1c-.206.204-.548.197-.75-.004-.207-.207-.205-.545-.002-.748L15.247 2H10.51c-.282 0-.51-.232-.51-.5z" /></symbol><symbol id="iconset-link" viewBox="0 0 18 18"><path d="M8.72 13.36l-2.044 2.017c-.954.952-2.418.797-3.05.083L2.53 14.18c-.942-.93-.59-2.446 0-3.072.96-1.017 3.698-3.656 3.698-3.656.952-.975 2.245-1.038 3.27 0 1.023 1.038.97.997.97.997.262.26.64.21.835 0 .195-.22.16-.58-.102-.85l-.94-.93c-1.31-1.35-3.322-1.3-4.61 0l-3.68 3.75c-1.28 1.26-1.28 3.38 0 4.68l.92.93c.627.63 1.45.96 2.337.96.887 0 1.71-.335 2.334-.966L9.4 14.17c.263-.266.263-.555 0-.82-.263-.266-.673 0-.673 0zm.56-8.72l2.044-2.017c.954-.952 2.418-.797 3.05-.083l1.095 1.28c.94.93.59 2.446 0 3.072-.96 1.017-3.7 3.656-3.7 3.656-.95.975-2.25 1.038-3.27 0s-.97-.997-.97-.997c-.26-.26-.64-.21-.84 0-.2.22-.16.58.1.85l.944.93c1.31 1.35 3.327 1.3 4.61 0l3.68-3.75c1.284-1.26 1.284-3.38 0-4.68l-.92-.93c-.62-.63-1.443-.96-2.33-.96-.888 0-1.71.334-2.335.965L8.6 3.825c-.262.266-.262.555 0 .82.264.266.674 0 .674 0z" /></symbol><symbol id="iconset-image" viewBox="0 0 18 18"><path d="M1 2.994v12.012c0 .548.446.994.995.994h14.01c.55 0 .995-.445.995-.994V2.994c0-.548-.446-.994-.995-.994H1.995C1.445 2 1 2.445 1 2.994zm-1 0C0 1.894.893 1 1.995 1h14.01C17.107 1 18 1.895 18 2.994v12.012c0 1.1-.893 1.994-1.995 1.994H1.995C.893 17 0 16.105 0 15.006V2.994z"/><path d="M1.38 15.804L5.807 8.24l-.86.007 3.682 6.068c.17.288.573.324.8.073l2.5-2.82-.74.01 4.514 4.832c.188.202.504.213.706.024.203-.19.213-.505.025-.707l-4.515-4.83c-.2-.216-.543-.212-.74.008l-2.5 2.82.8.07L5.8 7.728c-.197-.324-.67-.32-.86.007L.51 15.298c-.137.24-.057.545.18.684.24.14.546.06.685-.178zM12 9c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm0 1c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/></symbol><symbol id="iconset-burner" viewBox="0 0 18 18"><path d="M14.24 10.837c-.39.175-.853.28-1.387.28-.27 0-.593-.044-.955-.126-.344-.07-.713-.19-1.093-.32-.284-.1-1.218-.51-1.31-.54-.158-.06-.32-.093-.488-.093-.175 0-.336.038-.493.096-.092.035-1.035.444-1.32.545-.38.136-.748.247-1.093.326-.36.083-.68.127-.95.127-.53 0-.99-.103-1.39-.28-.22-.1-.55-.353-.65-.46-.17-.18-.34-.39-.502-.634-.38-.57-.635-1.22-.712-1.934l-.006.14c.268-1.33 1.078-2.07 2.03-2.07 1.53 0 2.884.31 4.662 1.284 0 0 .266.147.41.147.146 0 .43-.143.43-.143 1.78-.974 3.137-1.282 4.666-1.282.95 0 1.762.74 2.038 2.057l-.002-.14c-.076.72-.33 1.364-.71 1.94-.162.24-.335.453-.507.633-.1.105-.43.36-.657.46zm1.907-.61c.453-.684.76-1.463.853-2.33l-.007-.137C16.635 6.053 15.48 5 14.083 5c-1.672 0-3.175.34-5.093 1.393C7.092 5.34 5.59 5 3.916 5c-1.397 0-2.55 1.053-2.91 2.76L1 7.897c.093.867.4 1.646.853 2.33.33.498.664.846.9 1.036.114.1.332.24.64.38.503.223 1.09.357 1.754.357.346 0 .732-.052 1.154-.15.39-.086.79-.207 1.2-.354.31-.108.6-.223.87-.34.16-.068.6-.248.647-.248.045 0 .474.18.636.25.27.115.56.23.865.338.41.147.813.268 1.195.355.42.1.805.15 1.15.15.666 0 1.25-.13 1.755-.35.31-.14.528-.28.65-.39.228-.18.56-.53.89-1.03zm-9.99-2.604c-.155-.077-.316-.133-.483-.17-.53-.118-1.078-.037-1.605.164-.22.08-.38.164-.48.223l-.24.146.03.28c.07.623.45 1.266 1.22 1.502.34.11.77.117 1.27.05.3-.044.63-.115.95-.206.19-.053.373-.11.54-.167.1-.034.174-.062.22-.078l.735-.285-.628-.477c-.07-.052-.2-.145-.394-.273-.315-.21-.69-.444-1.13-.696l-.02-.013zm.243 1.19s-.447.1-.654.13c-.374.05-.68.046-.878-.017-.367-.114-.48-.485-.48-.485s.76-.2 1.093-.12c.1.02.92.5.92.5zm5.42-1.177c-.437.252-.813.485-1.128.696-.192.128-.322.22-.39.273l-.63.477.74.285c.042.016.117.044.218.078.167.057.35.114.542.167.33.09.652.162.96.205.493.068.92.06 1.27-.05.762-.235 1.146-.88 1.214-1.502l.03-.28-.24-.145c-.1-.06-.263-.142-.475-.223-.52-.2-1.07-.282-1.6-.164-.16.037-.32.093-.48.17l-.02.013zm.7.68c.333-.075 1.09.125 1.09.125s-.11.38-.475.49c-.202.07-.507.07-.88.02-.265-.032-.64-.15-.64-.15s.808-.45.904-.472z" /></symbol><symbol id="spinner" viewBox="0 0 37 12" stroke="#aaa" fill="none"><circle cx="6" cy="6" r="4"><animate attributeName="r" begin="0s" dur="0.65s" values="0;4" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/><animate attributeName="stroke-opacity" begin="0s" dur="0.65s" values="0;1" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="6" cy="6" r="4"><animate attributeName="cx" begin="0s" dur="0.65s" values="6;19" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="19" cy="6" r="4"><animate attributeName="cx" begin="0s" dur="0.65s" values="19;32" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="32" cy="6" r="4"><animate attributeName="r" begin="0s" dur="0.65s" values="4;0" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/><animate attributeName="stroke-opacity" begin="0s" dur="0.65s" values="1;0" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle></symbol><symbol id="iconset-tools--giant" viewBox="0 0 24 24"><path d="M12 5.5c1.38 0 2.5-1.12 2.5-2.5S13.38.5 12 .5 9.5 1.62 9.5 3s1.12 2.5 2.5 2.5zm0 18c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5-2.5 1.12-2.5 2.5 1.12 2.5 2.5 2.5zm0-9c1.38 0 2.5-1.12 2.5-2.5S13.38 9.5 12 9.5 9.5 10.62 9.5 12s1.12 2.5 2.5 2.5z" /></symbol></svg>'},s.DEBUG&&(t.icons.essential.definitions.soyTemplateName="tiger.icons.essential.definitions")}),define("templates/tiger/icons/essential/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.icons.essential.search=function(){return'<svg class="svg-icon svg-search"><use xlink:href="#iconset-search" /></svg>'},s.DEBUG&&(t.icons.essential.search.soyTemplateName="tiger.icons.essential.search"),t.icons.essential.add=function(){return'<svg class="svg-icon svg-add"><use xlink:href="#iconset-add" /></svg>'},s.DEBUG&&(t.icons.essential.add.soyTemplateName="tiger.icons.essential.add"),t.icons.essential.adDMSall=function(){return'<svg class="svg-icon small svg-add--small"><use xlink:href="#iconset-add--small" /></svg>'},s.DEBUG&&(t.icons.essential.adDMSall.soyTemplateName="tiger.icons.essential.adDMSall"),t.icons.essential.siteDefault=function(){return'<svg class="svg-icon svg-site-default"><use xlink:href="#iconset-site-default" /></svg>'},s.DEBUG&&(t.icons.essential.siteDefault.soyTemplateName="tiger.icons.essential.siteDefault"),t.icons.essential.zoomIn=function(){return'<svg class="svg-icon svg-zoom-in"><use xlink:href="#iconset-zoom-in" /></svg>'},s.DEBUG&&(t.icons.essential.zoomIn.soyTemplateName="tiger.icons.essential.zoomIn"),t.icons.essential.star=function(){return'<svg class="svg-icon svg-star"><use xlink:href="#iconset-star" /></svg>'},s.DEBUG&&(t.icons.essential.star.soyTemplateName="tiger.icons.essential.star"),t.icons.essential.starGiant=function(){return'<svg class="svg-icon giant stroked svg-star--giant"><use xlink:href="#iconset-star--giant" /></svg>'},s.DEBUG&&(t.icons.essential.starGiant.soyTemplateName="tiger.icons.essential.starGiant"),t.icons.essential.starCircle=function(){return'<svg class="svg-icon svg-star-circle"><use xlink:href="#iconset-star-circle" /></svg>'},s.DEBUG&&(t.icons.essential.starCircle.soyTemplateName="tiger.icons.essential.starCircle"),t.icons.essential.chevronRight=function(){return'<svg class="svg-icon svg-chevron chevron--right"><use xlink:href="#iconset-chevron-right" /></svg>'},s.DEBUG&&(t.icons.essential.chevronRight.soyTemplateName="tiger.icons.essential.chevronRight"),t.icons.essential.chevronRightSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--right"><use xlink:href="#iconset-chevron-right--small" /></svg>'},s.DEBUG&&(t.icons.essential.chevronRightSmall.soyTemplateName="tiger.icons.essential.chevronRightSmall"),t.icons.essential.chevronBottom=function(){return'<svg class="svg-icon svg-chevron chevron--bottom"><use xlink:href="#iconset-chevron-right" /></svg>'},s.DEBUG&&(t.icons.essential.chevronBottom.soyTemplateName="tiger.icons.essential.chevronBottom"),t.icons.essential.chevronBottomSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--bottom"><use xlink:href="#iconset-chevron-right--small" /></svg>'},s.DEBUG&&(t.icons.essential.chevronBottomSmall.soyTemplateName="tiger.icons.essential.chevronBottomSmall"),t.icons.essential.chevronLeft=function(){return'<svg class="svg-icon svg-chevron chevron--left"><use xlink:href="#iconset-chevron-right" /></svg>'},s.DEBUG&&(t.icons.essential.chevronLeft.soyTemplateName="tiger.icons.essential.chevronLeft"),t.icons.essential.chevronLeftSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--left"><use xlink:href="#iconset-chevron-right--small" /></svg>'},s.DEBUG&&(t.icons.essential.chevronLeftSmall.soyTemplateName="tiger.icons.essential.chevronLeftSmall"),t.icons.essential.chevronTop=function(){return'<svg class="svg-icon svg-chevron chevron--top"><use xlink:href="#iconset-chevron-right" /></svg>'},s.DEBUG&&(t.icons.essential.chevronTop.soyTemplateName="tiger.icons.essential.chevronTop"),t.icons.essential.chevronTopSmall=function(){return'<svg class="svg-icon small svg-chevron--small chevron--top"><use xlink:href="#iconset-chevron-right--small" /></svg>'},s.DEBUG&&(t.icons.essential.chevronTopSmall.soyTemplateName="tiger.icons.essential.chevronTopSmall"),t.icons.essential.flame=function(){return'<svg class="svg-icon svg-flame"><use xlink:href="#iconset-flame" /></svg>'},s.DEBUG&&(t.icons.essential.flame.soyTemplateName="tiger.icons.essential.flame"),t.icons.essential.flameGiant=function(){return'<svg class="svg-icon giant stroked svg-flame--giant"><use xlink:href="#iconset-flame--giant" /></svg>'},s.DEBUG&&(t.icons.essential.flameGiant.soyTemplateName="tiger.icons.essential.flameGiant"),t.icons.essential.kinja=function(){return'<svg class="svg-icon svg-logo-kinja"><use xlink:href="#iconset-logo-kinja" /></svg>'},s.DEBUG&&(t.icons.essential.kinja.soyTemplateName="tiger.icons.essential.kinja"),t.icons.essential.bubble=function(){return'<svg class="svg-icon svg-bubble"><use xlink:href="#iconset-bubble" /></svg>'},s.DEBUG&&(t.icons.essential.bubble.soyTemplateName="tiger.icons.essential.bubble"),t.icons.essential.bubbleGiant=function(){return'<svg class="svg-icon giant stroked svg-bubble--giant"><use xlink:href="#iconset-bubble--giant" /></svg>'},s.DEBUG&&(t.icons.essential.bubbleGiant.soyTemplateName="tiger.icons.essential.bubbleGiant"),t.icons.essential.checkmark=function(){return'<svg class="svg-icon svg-checkmark"><use xlink:href="#iconset-checkmark" /></svg>'},s.DEBUG&&(t.icons.essential.checkmark.soyTemplateName="tiger.icons.essential.checkmark"),t.icons.essential.checkmarkSmall=function(){return'<svg class="svg-icon small svg-checkmark--small"><use xlink:href="#iconset-checkmark--small" /></svg>'},s.DEBUG&&(t.icons.essential.checkmarkSmall.soyTemplateName="tiger.icons.essential.checkmarkSmall"),t.icons.essential.close=function(){return'<svg class="svg-icon svg-close"><use xlink:href="#iconset-close" /></svg>'},s.DEBUG&&(t.icons.essential.close.soyTemplateName="tiger.icons.essential.close"),t.icons.essential.closeSmall=function(){return'<svg class="svg-icon small svg-close--small"><use xlink:href="#iconset-close--small" /></svg>'},s.DEBUG&&(t.icons.essential.closeSmall.soyTemplateName="tiger.icons.essential.closeSmall"),t.icons.essential.facebook=function(){return'<svg class="svg-icon svg-facebook"><use xlink:href="#iconset-facebook" /></svg>'},s.DEBUG&&(t.icons.essential.facebook.soyTemplateName="tiger.icons.essential.facebook"),t.icons.essential.twitter=function(){return'<svg class="svg-icon svg-twitter"><use xlink:href="#iconset-twitter" /></svg>'},s.DEBUG&&(t.icons.essential.twitter.soyTemplateName="tiger.icons.essential.twitter"),t.icons.essential.googleplus=function(){return'<svg class="svg-icon svg-googleplus"><use xlink:href="#iconset-googleplus" /></svg>'},s.DEBUG&&(t.icons.essential.googleplus.soyTemplateName="tiger.icons.essential.googleplus"),t.icons.essential.externalLink=function(){return'<svg class="svg-icon svg-external-link"><use xlink:href="#iconset-external-link" /></svg>'},s.DEBUG&&(t.icons.essential.externalLink.soyTemplateName="tiger.icons.essential.externalLink"),t.icons.essential.burner=function(){return'<svg class="svg-icon svg-burner"><use xlink:href="#iconset-burner" /></svg>'},s.DEBUG&&(t.icons.essential.burner.soyTemplateName="tiger.icons.essential.burner"),t.icons.essential.link=function(){return'<svg class="svg-icon svg-link"><use xlink:href="#iconset-link" /></svg>'},s.DEBUG&&(t.icons.essential.link.soyTemplateName="tiger.icons.essential.link"),t.icons.essential.image=function(){return'<svg class="svg-icon svg-image"><use xlink:href="#iconset-image" /></svg>'},s.DEBUG&&(t.icons.essential.image.soyTemplateName="tiger.icons.essential.image"),t.icons.essential.spinner=function(){return'<svg class="svg-icon svg-image"><use xlink:href="#spinner" /></svg>'},s.DEBUG&&(t.icons.essential.spinner.soyTemplateName="tiger.icons.essential.spinner"),t.icons.essential.toolsGiant=function(){return'<svg class="svg-icon giant stroked svg-tools--giant"><use xlink:href="#iconset-tools--giant" /></svg>'},s.DEBUG&&(t.icons.essential.toolsGiant.soyTemplateName="tiger.icons.essential.toolsGiant"),t.icons.essential.facebook__C17=function(){return'<svg class="svg-icon svg-facebook"><use xlink:href="#iconset-facebook" /></svg>'},s.DEBUG&&(t.icons.essential.facebook__C17.soyTemplateName="tiger.icons.essential.facebook__C17"),t.icons.essential.twitter__C17=function(){return'<svg class="svg-icon svg-twitter"><use xlink:href="#iconset-twitter" /></svg>'},s.DEBUG&&(t.icons.essential.twitter__C17.soyTemplateName="tiger.icons.essential.twitter__C17"),t.icons.essential.googleplus__C17=function(){return'<svg class="svg-icon svg-googleplus"><use xlink:href="#iconset-googleplus" /></svg>'},s.DEBUG&&(t.icons.essential.googleplus__C17.soyTemplateName="tiger.icons.essential.googleplus__C17"),t.icons.essential.chevronBottomSmall__C17=function(){return'<svg class="svg-icon small svg-chevron--small chevron--bottom"><use xlink:href="#iconset-chevron-right--small" /></svg>'},s.DEBUG&&(t.icons.essential.chevronBottomSmall__C17.soyTemplateName="tiger.icons.essential.chevronBottomSmall__C17"),t.icons.essential.closeSmall__C17=function(){return'<svg class="svg-icon small svg-close--small"><use xlink:href="#iconset-close--small" /></svg>'},s.DEBUG&&(t.icons.essential.closeSmall__C17.soyTemplateName="tiger.icons.essential.closeSmall__C17")}),define("module/EssentialIconModule",["jquery","templates/tiger/icons/essential/definitions","templates/tiger/icons/essential/usage"],function(e){"use strict";var t=e("#svggroup--essential");t&&t.length||e("#js_svg-definitions").append(e.trim(tiger.icons.essential.definitions()))}),define("model/Feature",["underscore","backbone","apiclient/feature"],function(e,t,n){"use strict";var s=t.Model.extend({defaults:{sticky:!0,regions:[]},sync:function(e,t,s){var o={};switch(e){case"create":return o=t.set({enabled:!0}).toJSON(),n.createFeature(o,s);case"update":if(t.changedAttributes())return o=t.changedAttributes(),o.modelId=t.id,n.updateFeature(o,s);window.alert("No feature settings were changed.");break;case"read":case"delete":case"enable":case"disable":return n[e+"Feature"]({modelId:t.id},s);case"segment":return n.getSegmentFeature()}},parse:function(e){var t;return t=e.meta&&e.meta.success===!0?e.data:e},validate:function(t){var n=e.extend(e.clone(this.attributes),t||{}),s=n.defaultValue||"",o=n.values||"";if(!n.name)return"Name not specified";if(!n.id||this.attributes.name!==n.name){if(!n.name.match(/^[a-z]/))return"Name must start with a lowecase letter";if(!n.name.match(/^[a-z0-9_]+$/))return"Name can only use the following: a-z 0-9 _"}return!o||o.length<2?"No values":n.abTesting!==!1||"%"===s.substr(s.length-1)||s&&-1!==o.indexOf(s)?0[0]:"Invalid default value"},toggle:function(){var e=this,t=e.get("enabled")?"disable":"enable";e.sync(t,e,{success:function(t){return!!e.set({enabled:!e.get("enabled")})&&void e.trigger("sync",e,t)}})}});return s}),define("collection/Feature",["backbone","model/Feature","singleton/CurrentBlog","apiclient/feature"],function(e,t,n,s){"use strict";var o=e.Collection.extend({model:t,sync:function(e,t,o){var i={};return n.canonicalHost&&(i.blog=n.canonicalHost),o.withAuthor&&(i.withAuthor=!0),o.compact&&(i.compact=!0),"read"===e?this.blogId?s.getBlogFeatures({blogId:this.blogId},o):s.getAjaxFeatures(i,o):0[0]},blacklist:{476822046:"off"},getBetaFeatures:function(){return new o(this.filter(function(e){return"BETA"===e.get("type")}))},parse:function(e){return e.data},getDirtyModels:function(){var t=this.models.filter(function(e){return e.get("isDirty")}),e=this.blacklist;return t.map(function(t){var n=parseInt(t.get("id"),10);return e.hasOwnProperty(n)&&t.set("value",e[n]),t.get("id")+"="+t.get("value")}).join("&")}});return o}),define("singleton/FeatureThrottling",["jquery","backbone","underscore","lib/amd-wrapped/modernizr","singleton/Feature","singleton/CurrentUser","singleton/Utils","model/Feature","collection/Feature","apiclient/feature","gawkerlib/jquery.parseParams"],function(e,t,n,s,o,i,a,r,c,l){"use strict";var u="_",h="kinja_feature_segment",d="kinja_feature_measurement_2507",m=t.Model.extend({initialize:function(){o.isOn("throttle")&&(i.onLoggedIn.done(function(){e.removeCookie(h,{path:"/"}),this.checkFeatures()}.bind(this)),this.checkFeatures(),"off"!==o.value("throttle_measuring")&&this.measureThrottledFeature(o.value("throttle_measuring")))},checkFeatures:function(){var t=n.map(n.filter(e("body")[0].className.split(" "),function(e){return 0===e.indexOf("mf_")}),function(e){return e.substr(3)});e.when(this.getFeatureSegment(),this.getFeatures()).done(function(s,i){var a=this.lookupFeaturesToChange(s,i,t),r=n.map(n.extend({},a.reloading,a.silent),function(e,t){return t+"="+e});r.length>0&&(e.removeCookie(d,{path:"/"}),o.isOn("throttle_instant")?(o.syncCookies(r.join("&")),n.keys(a.reloading).length>0&&document.location.reload()):e(window).on("beforeunload",function(){o.syncCookies(r.join("&"),!0)}))}.bind(this))},measureThrottledFeature:function(t){var n=o.value(t),s=t+"="+n;e.cookie(d)||0[0]===n||(l.sendPerHourFeatureTick({featureName:t,featureValue:n}),e.cookie(d,s,{path:"/",expires:1/24}))},getFeatureSegment:function(){var n=e.cookie(h),t=e.Deferred();return n?t.resolve(parseInt(n,10)):i.onAuth.done(function(){var e=new r;e.sync("segment",e,{success:function(e){e.meta&&e.meta.success&&e.meta.success===!0&&t.resolve(e.data)}})}),t},getFeatures:function(){var t,o=e.Deferred(),n=new c,r="kinja_feature_collection",i=!0,l=parseInt(a.getKinjaMeta().featuresLastUpdate,10),d=s.localstorage;return n.on("sync",function(){o.resolve(n),d&&(t={featuresLastUpdate:l,features:n.invoke("pick",["name","abTesting","possibleValues","source","defaultValue","blogValue"])},window.localStorage.setItem(r,JSON.stringify(t)))}),d&&(t=JSON.parse(window.localStorage.getItem(r)),t&&parseInt(t.featuresLastUpdate,10)===l&&(o.resolve(new c(t.features)),i=!1)),i=!0,i===!0&&n.fetch({compact:!0,disableToken:!0}),o},lookupFeaturesToChange:function(e,t,s){var a=e/100,i={reloading:{},silent:{}};return s=s||[],t.each(function(e){var t,r=0;n.contains(s,e.get("name"))||(e.get("abTesting")===!0?(t=n.last(n.filter(e.get("possibleValues"),function(e){var t=a>r;return r+=e.percentage,t})),o.value(e.get("name"))!==t.name&&(i.reloading[e.get("name")]=t.name)):"user"===e.get("source")&&(o.value(e.get("name"))!==e.get("defaultValue")&&o.value(e.get("name"))!==e.get("blogValue")?i.reloading[e.get("name")]=u:i.silent[e.get("name")]=u))}),i}});return new m}),define("lib/amd-wrapped/jquery.scrollTo",["jquery"],function(e){function n(e){return"object"==typeof e?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,s){e(window).scrollTo(t,n,s)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var n,t=this,s=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);return s?(n=(t.contentWindow||t).document||t.ownerDocument||t,/webkit/i.test(navigator.userAgent)||"BackCompat"==n.compatMode?n.body:n.documentElement):t})},e.fn.scrollTo=function(s,o,i){return"object"==typeof o&&(i=o,o=0),"function"==typeof i&&(i={onAfter:i}),"max"==s&&(s=9e9),i=e.extend({},t.defaults,i),o=o||i.duration,i.queue=i.queue&&i.axis.length>1,i.queue&&(o/=2),i.offset=n(i.offset),i.over=n(i.over),this._scrollable().each(function(){function u(e){d.animate(r,o,i.easing,e&&function(){e.call(this,s,i)})}if(s!=null){var c,l=this,d=e(l),a=s,r={},h=d.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}if(a=e(a,this),!a.length)return;case"object":(a.is||a.style)&&(c=(a=e(a)).offset())}e.each(i.axis.split(""),function(e,n){var m,f="x"==n?"Left":"Top",o=f.toLowerCase(),s="scroll"+f,p=l[s],g=t.max(l,n);c?(r[s]=c[o]+(h?0:p-d.offset()[o]),i.margin&&(r[s]-=parseInt(a.css("margin"+f))||0,r[s]-=parseInt(a.css("border"+f+"Width"))||0),r[s]+=i.offset[o]||0,i.over[o]&&(r[s]+=a["x"==n?"width":"height"]()*i.over[o])):(m=a[o],r[s]=m.slice&&"%"==m.slice(-1)?parseFloat(m)/100*g:m),i.limit&&/^\d+$/.test(r[s])&&(r[s]=r[s]<=0?0:Math.min(r[s],g)),!e&&i.queue&&(p!=r[s]&&u(i.onAfterFirst),delete r[s])}),u(i.onAfter)}}).end()},t.max=function(t,n){if(s="x"==n?"Width":"Height",o="scroll"+s,!e(t).is("html,body"))return t[o]-e(t)[s.toLowerCase()]();var s,o,i="client"+s,a=t.ownerDocument.documentElement,r=t.ownerDocument.body;return Math.max(a[o],r[o])-Math.min(a[i],r[i])}}),define("lib/ios-orientationchange-fix",["jquery"],function(e){return function(t){function h(){var t,n="";e(document).find("input[placeholder]").each(function(){t=e(this),n=t.attr("placeholder"),t.removeAttr("placeholder").attr("placeholder",n)})}function u(){n.setAttribute("content",g),o=!0}function f(){n.setAttribute("content",p),o=!1}function m(e){s=e.accelerationIncludingGravity,i=Math.abs(s.x),c=Math.abs(s.y),l=Math.abs(s.z),t.orientation&&180!==t.orientation||!(i>7||(l>6&&8>c||8>l&&c>6)&&i>5)?o||u():o&&f()}if(t.addEventListener&&t.addEventListener("orientationchange",h,!1),a=navigator.userAgent,/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(a)&&a.indexOf("AppleWebKit")>-1&&(r=t.document,r.querySelector)){var s,i,a,r,c,l,n=r.querySelector("meta[name=viewport]"),d=n&&n.getAttribute("content"),p=d+",maximum-scale=1",g=d+",maximum-scale=10",o=!0;n&&(t.addEventListener("orientationchange",u,!1),t.addEventListener("devicemotion",m,!1))}}(window),{}}),define("module/BaseApp",["jquery","underscore","lib/amd-wrapped/modernizr","module/Main","view/BaseView","singleton/CurrentUser","singleton/CurrentBlog","singleton/EventDispatcher","singleton/Feature","singleton/Utils","app/navigation/topbar.layout","app/navigation/userMenu.view","app/modalmenu/usermenu","app/modalmenu/notifmenu","app/navigation/secondaryNav.view","view/SuccessBox","app/MarionetteApp","app/leftrail/leftrailContainedList.view","view/footer.view","app/account/account.channel","module/KinjaAnalytics","module/ads/ads.events","module/EssentialIconModule","singleton/FeatureThrottling","lib/jquery.cookie","lib/amd-wrapped/jquery.scrollTo","lib/ios-orientationchange-fix","lib/waypoints","templates/tiger/icons/essential/usage","templates/tiger/components/ad/ads"],function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_){"use strict";var w,O;return w=function(e){require(["module/LoginModule"],function(t){e(t.controller)})},O=o.extend({successBox:null,el:e("body"),$secondaryNavBtn:e(".js_secondary-nav-btn-wrapper"),events:{"click .js_offcanvas-user":"onOffcanvasUser","click .js_offcanvas-notif":"onOffcanvasNotif","click .js_usermenu-button":"onUsermenuButtonClick"},initialize:function(){s.start(),c.isOn("tap")&&require(["lib/fastclick"],function(e){e.attach(document.body)}),"resettoken"===this.getPageType()||"gettoken"===this.getPageType()?this.resetToken():(this.initApp(),"admin"!==l.getKinjaMeta().pageType&&this.initSubViews())},start:function(){},initApp:function(){var t=function(t){var n=e.cookie("kinja_features");!t.isSuperUser()||n&&-1!==n.indexOf("all_on=")||(e.cookie.raw=!0,n&&""!==n?e.cookie("kinja_features",n+"|all_on=on"):e.cookie("kinja_features","all_on=on"),e.cookie.raw=0[0])};c.isOn("frontendtiming")&&window.markUserTime("currentuser_load"),i.load(window._user).done(function(){if(t(i),c.isOn("frontendtiming")){var e=i.isLoggedIn()?"currentuser_loaded_loggedin":"currentuser_loaded_loggedout";e+="-"+(c.isOn("webpack")?"webpack":"require"),e+="-"+(a.blogGroup||"default"),window.markUserTime(e)}}).fail(function(){e("body").addClass("read-only")}),i.onLoggedIn.done(this.handleLogin.bind(this)),r.on("modal:incompleteRegistration:success",function(){window.ga("send","event","Sign up",i.get("authName"),a.displayName)},this),r.on("all",this.trigger,this),c.isOn("userstats")&&this.statsTracker(),c.isOn("analyticstracking")&&this.initAnalyticsTracking(),e("body").addClass("js_initialized "+(n.touch?"touch":"no-touch")),e("#ad-970x250-container").length&&c.isOn("dynamic_billboard")&&e("div.basement").first().waypoint({handler:function(t){"down"===t&&(e("#ad-970x250-container").append(tiger.components.ad.billboardDynamic()),_.trigger("ads.dynamicad.load",e(".js_ad-billboard--dynamic .js_ad-container"),"BILLBOARD_DYNAMIC"))},offset:function(){return window.innerHeight+100},triggerOnce:!0}),this.listenTo(j,"loginRequired",this.onLoginRequired).listenTo(j,"loginCancelled",this.onLoginCancelled).listenTo(i,"incompleteRegistration",this.onIncompleteRegistration)},initSubViews:function(){var t,s=e(g.notificationDropdownRegion.el).length>0,n=e(".js_site-footer");this.initLeftrailContained(),c.isOn("channels")&&this.initChannels(),c.isOn("trendingfeed_mobile")&&"permalink"===l.getKinjaMeta().pageType&&this.initMobileTrendingModule(),c.isOn("newsletter_fs")&&this.initSubscriptionModule(),s&&this.initTopbar(),c.isOn("maintenance_mode")&&this.showMaintenanceMessage(),this.setupSuccessBox(),n.length&&(t=new b({el:n}),t.bindUIElements(),t.delegateEvents(),t.onRender()),c.isOn("featurepanel")&&require(["module/FeaturePanelModule"],function(e){e.start()})},isGoogleBot:function(){return window.navigator.userAgent.toLowerCase().indexOf("googlebot")>0},displayWarningMessage:function(t,n){if(0===t.length||"1"===e.cookie(n))return!1;var s=function(){return t.addClass("hide"),e.cookie(n,"1",{expires:30,path:"/"}),!1};t.removeClass("hide").find("a.close").on("click",s)},showMaintenanceMessage:function(){var t=e(".js_maintenance");t.length>0&&t.removeClass("hide")},setupSuccessBox:function(){r.on("successbox:display",function(e){null!==this.successBox&&this.successBox.close(),this.successBox=new p(e),this.successBox.render()},this),r.on("successbox:close",function(){null!==this.successBox&&this.successBox.close()},this)},initLeftrailContained:function(){var e=new v({el:".js_sidebar"});e.render()},initMobileTrendingModule:function(){var t=e(".post-content > p"),n=t.length>3?2:t.length;e(t[n]).after('<div class="trendingfeed-inset-container js_trendingfeed-inset-container hide-for-large-up"></div>'),require(["module/MobileTrendingModule"],function(e){e.start()})},initTopbar:function(){var s,e=l.pageTypes,o=[e.editor,e.usersettings,e.splash,e.dashboard,e.manageblog,e.leaderboard,e.performancestats],n=-1!==o.indexOf(l.getKinjaMeta().pageType),t=new d({el:".js_global-nav-wrap",model:i});t.bindUIElements(),t.onRender(),n||/iemobile/.test(window.navigator.userAgent.toLowerCase())||t.initializeAutohide(),this.$secondaryNavBtn.length>0&&(n||this.$secondaryNavBtn.addClass("transition shown"),s=new f({el:"body",animation:!n}))},onOffcanvasUser:function(){var e=new h({className:"dui-modal fullscreen-modal right dui-menu",model:i,tab:"user"});return g.duimodalregion.show(e),!1},onOffcanvasNotif:function(){var e=new m({className:"dui-modal fullscreen-modal right dui-menu",model:i,tab:"notif"});return g.duimodalregion.show(e),!1},onUsermenuButtonClick:t.once(function(){var e=new u({model:i});g.userDropdownRegion.show(e)}),initChannels:function(){require(["module/ChannelsApp"],function(e){e.start()})},initSubscriptionModule:function(){require(["module/SubscriptionModule"],function(e){e.start()})},handleLogin:function(){i.isSuperUser()&&c.isOn("superuser")&&c.isOn("superuser_notif")&&e(".js_top-nav-wrap").addClass("momjeans-notifier"),e("body").addClass("loggedin")},resetToken:function(){var e=i.get("token");return e&&0===e.indexOf("dummy-")?window.location.href=window.location.protocol+"//"+window.location.host:i.token().done(function(){window.setTimeout(function(){window.location.reload()},1e3)}).fail(function(){window.location.href="/"}),!1},statsTracker:function(){var t="__k_iut",n=e(".js_stats"),s=n.data("trackurl"),o=!1;(!e.cookie(t)||e.cookie(t)<(new Date).getTime()-2592e6)&&(o=!0,e.cookie(t,(new Date).getTime(),{path:"/",expires:365})),n.data("unique",o),s&&(o&&(s+="&unique=true"),n.append('<img src="'+s+'" style="display: none;">'))},initAnalyticsTracking:function(){i.on("logoutReset",function(){y.pushEvent("LOGOUT",null,null,null)}),r.on("modal:login:closed",function(e){y.pushEvent("LOGIN","AUTHENTICATION",i.get("authName"),{uiElement:e.source||"default"})}),r.on("modal:incompleteRegistration:success",function(e){y.pushEvent("REGISTER","AUTHENTICATION",i.get("authName"),{uiElement:e.source||"default"})}),r.on("analytics:postSaved",function(e){"PUBLISHED"===e.data.status&&e.data.id===e.data.starterId&&y.pushEvent("PUBLISH_STARTER","POST",e.data.id,null)}),r.on("analytics:replySaved",function(e){"PUBLISHED"===e.data.status&&e.data.id!==e.data.starterId&&y.pushEvent("PUBLISH_REPLY","POST",e.data.id,null)})},onLoginRequired:function(e){w(function(t){var n=e?e.source:"default";t.showOptions(n),window.ga("send","event","Authentication flow","Prompt login","source: "+n)})},onLoginCancelled:function(e){y.pushEvent("LOGIN","CANCELLED","closeModal",{uiElement:e.source||"default"})},onIncompleteRegistration:function(){w(function(e){e.showIncompleteRegistration()})}})}),define("singleton/util/loadEditor",["underscore","jquery","singleton/Feature","singleton/StringUtils"],function(e,t,n,s){"use strict";function o(n,o,i){var a,r,c,l=t("head>meta[id="+o+"-css-url]");1===l.length?(a=l.attr("content"),r=0,c=function(){var t=e.find(document.styleSheets,function(e){return s.endsWith(e.href,a)});return"undefined"!=typeof t},document.createStyleSheet?document.createStyleSheet(a):t("head").append('<link rel="stylesheet" type="text/css" href="'+a+'" />'),l.remove(),require([n],function(){if(c())i.apply();else var e=window.setInterval(function(){(c()||r>99)&&(window.clearInterval(e),i.apply()),r+=1},250)})):require([n],i)}function i(){var e=t.Deferred();return n.isOn("webpack")?require(["module/MarionetteEditor","stylesheets/editor.css"],function(){require(["app/editor/editor.app"],e.resolve)}):o("module/MarionetteEditor","editor",function(){require(["app/editor/editor.app"],e.resolve)}),e.promise()}return i}),define("app/mixins/HighlightBox",["jquery","singleton/EventDispatcher"],function(e,t){"use strict";var n={insertHighlightBox:function(n,s,o,i){var a=n===!1?s:e(n.target),r=n===!1?Math.round(a.width()*o/100):Math.round(n.pageX-a.offset().left),c=n===!1?Math.round(a.height()*i/100):Math.round(n.pageY-a.offset().top),l=a.width()-50,m=50,d=a.height()-50,f=50,u=Math.round((r>l?l-50:m>r?0:r-50)+a.offset().left),h=Math.round((c>d?d-50:f>c?0:c-50)+a.offset().top),p=n!==!1?" create-annotation":"",g='<div class="annotationHighlightBox'+p+'" style="top:'+h+"px; left:"+u+'px;"></div>';return n===!1?t.on("imageAnnotationsClose",function(){e(".annotationHighlightBox").remove()},this):t.on("removeReplyForm",function(){e(".annotationHighlightBox").remove()},this),e(".annotationHighlightBox").remove(),e("body").prepend(g),{top:h,left:u}}};return n}),define("apiclient/annotation",["config","singleton/Feature","apiclient/apirequest","singleton/Utils"],function(e,t,n,s){"use strict";var o;return o={getAnnotations:n.getJson(e.api.core.url+"/annotation/starter/{{starterId}}",{filterDismissed:!0,cache:!!t.isOn("cachecomments")&&s.shouldGetCached})}}),define("templates/tiger/components/annotation",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.annotation.newSingleAnnotation=function(e,n,s){return'<span class="js_annotation-footnote annotation-footnote" data-annotation-id="'+o.$$escapeHtmlAttribute(e.reply.id)+'"'+(null!=e.x&&null!=e.y?' data-annotation-x="'+o.$$escapeHtmlAttribute(e.x)+'" data-annotation-y="'+o.$$escapeHtmlAttribute(e.y)+'" data-image-chompid="'+o.$$escapeHtmlAttribute(e.imageChompId)+'" data-annotation-type="image"':' data-annotation-type="text" ')+' ><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.reply.permalink))+'" class="js_annotation-footnote-link annotation-footnote-link proxima">P</a>'+t.components.annotation.annotationInset(e,null,s)+"</span>"},s.DEBUG&&(t.components.annotation.newSingleAnnotation.soyTemplateName="tiger.components.annotation.newSingleAnnotation"),t.components.annotation.annotationInset=function(e,n,s){i="",l=s.features.hide_pending_replies&&e.reply&&!(null==e.reply?null:e.reply.approved),i+='<div class="annotation-inset-under js_annotation-inset-'+o.$$escapeHtmlAttribute(e.id)+' hide" data-annotation-id="'+o.$$escapeHtmlAttribute(e.id)+'"><div class="hide-annotation right cursor-pointer" id="annotation_'+o.$$escapeHtmlAttribute(e.id)+'">'+t.icons.essential.closeSmall(null,null,s)+'</div><div class="annotation-content">'+(l&&!(null==e.reply?null:e.reply.newpost)?t.components.groupchats.unapprovedAnnotationWarning(null,null,s)+'<div class="js_annotation-content hide">':'<div class="js_annotation-content">')+o.$$filterNoAutoescape(e.reply.excerptWithAssets)+'<footer class="row proxima"><div class="medium-8 columns"><span class="floated-container img-30"><span class="avatar"><span class="img-border mbn mrm"><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.reply.author.avatar.id,"avt-large",e.reply.author.avatar.format)))+'" class="avatar" alt="" /></span></span><span class="txt blogname proxima text-upper text-strong text-light txt-30">';for(var i,c,l,a="",d=e.reply.blogs,u=d.length,r=0;u>r;r++)c=d[r],a+=c.id==e.reply.author.defaultBlogId?'<a class="text-light" href="http://'+o.$$escapeHtmlAttribute(c.canonicalHost)+'" target="_self">'+o.$$escapeHtml(e.reply.author.displayName)+"</a>":"";return i+=(a?o.$$filterNoAutoescape(a):o.$$escapeHtml(e.reply.author.displayName))+'</span></span></div><div class="medium-4 columns medium-text-right text-center txt-30"><a class="text-light text-small view-discussion" href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.reply.permalink))+'">View discussion&nbsp;&gt;&gt;</a></div></footer></div></div></div>'},s.DEBUG&&(t.components.annotation.annotationInset.soyTemplateName="tiger.components.annotation.annotationInset")}),define("app/AnnotationApplet",["jquery","underscore","backbone.marionette","view/BaseView","singleton/EventDispatcher","singleton/Feature","singleton/util/loadEditor","singleton/DeviceController","app/mixins/HighlightBox","apiclient/annotation","templates/tiger/components/annotation"],function(e,t,n,s,o,i,a,r,c,l){"use strict";var d=e(window),u=s.extend(t.extend({},c,{annotationsFootnotesMax:5,_annotationTypeImage:"image",annotationApiResult:null,events:{"click .js_annotation-footnote-link":"toggleAnnotation","click .hide-annotation":"hideAllAnnotations","click .ellipsis":"expandFootnotes","click .js_annotatable-image":"annotateHandler","click .js_pending-reply-switch":"showPending"},initialize:e.noop,startApp:function(){this.isMobile=r.isTabletLike()||r.isMobileLike(),this.allowReplies=this.model.get("allowReplies")&&!e("body").hasClass("read-only"),(!this.isMobile||i.isOn("mobileannotation"))&&(e(".post-content").addClass("new-annotation"),!this.allowReplies||this.isMobile?this.enableImageAnnotations(!0):this.enableImageAnnotations(),this.model&&this.model.get("isStarter")===!0&&(this.model.on("AnnotationCreated",function(e){this.addNewAnnotation(e)},this),this.annotationApiResult=l.getAnnotations({starterId:this.model.get("starterId")}).then(function(e){return e.items}),this.getAnnotationReplies({type:"starter",discussions:!0})),this.model.on("annotation:remove",this.removeAnnotation.bind(this)),o.on("annotation:fromReplies",this.getAnnotationReplies.bind(this)))},getAnnotationReplies:function(e){this.annotationApiResult.done(function(n){var s="permalink"===e.type?t.filter(n,function(t){return t.replyId===e.replyId}):e.discussions?t.filter(n,function(e){return e.reply.approved}):n;this.renderAnnotations(s)}.bind(this))},renderAnnotations:function(n){var s,i=this,a=n,o=t.where(a,{annotationType:this._annotationTypeImage.toUpperCase()});this.$(".annotation-footnote-wrapper").empty(),o.length&&(s=t(o).filter(function(e){return e.reply}),t(s).each(function(t){var s=t.imageChompId,n=e('[data-chomp-id="'+s+'"]').parents(".has-image");0===n.children(".annotation-footnote-wrapper").length&&n.append('<span class="annotation-footnote-wrapper clearfix"></span>'),n.children(".annotation-footnote-wrapper").append(i.renderAnnotationTemplate(t))})),this.updateFotenoteNumbers(),this.addEllipsis()},renderAnnotationTemplate:function(e){var t=this.soyToHtml(tiger.components.annotation.newSingleAnnotation,e);return t},addEllipsis:function(){var n=this,s=e(".annotation-footnote-wrapper");t.each(s,function(s){var i=e(s),o=i.find(".annotation-footnote"),a=o.length;t.each(o,function(t,s){s>n.annotationsFootnotesMax-1&&s!==a-1&&e(t).addClass("ellipsable hide")}),a>n.annotationsFootnotesMax+1&&0===i.find(".ellipsis").length&&o.last().before('<span class="ellipsis">...</span>')})},updateFotenoteNumbers:function(){var n=e(".js_annotation-footnote-link");e(n).length&&t.each(n,function(t,n){e(t).html(n+1)})},expandFootnotes:function(t){var n=e(t.target);n.siblings(".ellipsable").removeClass("hide"),n.remove()},toggleAnnotation:function(t){var s=e(t.target),n=s.parents(".annotation-footnote");t.preventDefault(),n.hasClass("selected")?this.hideAllAnnotations():this.openAnnotation(t,n)},openAnnotation:function(t,n){var s,o,i=this;this.hideAllAnnotations(),n.addClass("selected").find(".annotation-inset-under").removeClass("hide"),n.data("annotation-type")===this._annotationTypeImage&&(s=n.data("image-chompid"),o=e('[data-chomp-id="'+s+'"]'),this.insertHighlightBox(!1,o,n.data("annotation-x"),n.data("annotation-y"))),d.on("keyup.hideAnnotations",function(e){(0[0]!==e.keyCode&&27===e.keyCode||0[0]!==e.which&&27===e.which)&&i.hideAllAnnotations()}),d.on("click.hideAnnotations",function(t){0===e(t.target).parents(".annotation-footnote-wrapper").length&&i.hideAllAnnotations()})},hideAllAnnotations:function(t){t&&t.stopPropagation(),e(".annotation-footnote").removeClass("selected"),e(".annotation-inset-under").addClass("hide"),e(".annotationHighlightBox").length&&e(".annotationHighlightBox:not(.create-annotation)").remove(),d.off("keyup.hideAnnotations"),d.off("click.hideAnnotations")},enableImageAnnotations:function(n){var s,o=e('article:not(reframe-post) img[data-chomp-id][src!=""]'),i=[];if(o.length){for(s=0,o;s<o.length;s+=1)i.push(e(o[s]).data("chomp-id"));t.each(t.unique(i),function(t){var s=e("[data-chomp-id="+t+"]").first();n||s.closest("a").length||s.addClass("js_annotatable-image cursor-crosshair")})}},annotateHandler:function(t){var o,i,r,c,l,u,h,m,f,p,g,v,b,s=this,j="image",n=e(t.currentTarget);return this.hideAllAnnotations(),o=n.offset(),i=n.width(),r=n.height(),c=n.attr("width"),l=n.attr("height"),g=n.data("asset-url"),u=n.data("chomp-id"),h=t.pageX-o.left,m=t.pageY-o.top,f=Math.round(h/i*100),p=Math.round(m/r*100),b=function(e){e.$el.find(".reply-annotation").remove(),e.$el.find("input.js_annotationType").val("IMAGE"),e.$el.find("input.js_imageUrl").val(g),e.$el.find("input.js_imageChompId").val(u),e.$el.find("input.js_imageWidth").val(c||i),e.$el.find("input.js_imageHeight").val(l||r),e.$el.find("input.js_x").val(f),e.$el.find("input.js_y").val(p)},v=function(n){a().then(function(){require(["app/editor/editor.app","app/MarionetteApp"],function(o,i){var a=s.addCommentRegion(i,e('<div class="js_replyform "/>').css({position:"absolute",top:0}).prependTo("body"));a.once("editor:post:save",function(e){s.addNewAnnotation({model:e})}),o.annotatePost(n,t,j)})})},v(this.model),d.on("keyup.hideAnnotations",function(e){(0[0]!==e.keyCode&&27===e.keyCode||0[0]!==e.which&&27===e.which)&&s.hideAllAnnotations()}),d.on("click.hideAnnotations",function(t){0===e(t.target).parents(".replyform").length&&s.hideAllAnnotations()}),!1},addCommentRegion:function(e,t){var s=e.commentRegion,o=!!s&&s.currentView;return(!o||o.confirmRemove())&&(s&&(s.reset(),s.off()),s=new n.Region({el:t}),e.addRegions({commentRegion:s})),s},addNewAnnotation:function(n){t.defaults(n.model,{get:function(e){return this[e]}});var s=n.model,r=s.get("imageChompId"),c={id:s.id,x:s.get("x")?s.get("x"):null,y:s.get("y")?s.get("y"):null,imageChompId:r,reply:{permalink:s.get("permalink"),excerptWithAssets:s.get("excerptWithAssets")?s.get("excerptWithAssets"):s.get("display"),author:s.get("author"),blogs:s.get("blogs"),id:s.id,newpost:!0}},i=e('[data-chomp-id="'+r+'"]'),o=i.parents(".has-image"),a=o.find(".annotation-footnote-wrapper");a.length?a.append(this.renderAnnotationTemplate(c)):(o.append('<span class="annotation-footnote-wrapper clearfix"></span>'),o.find(".annotation-footnote-wrapper").append(this.renderAnnotationTemplate(c))),this.insertHighlightBox(!1,i,s.get("x"),s.get("y")),e('[data-annotation-id="'+s.get("id")+'"]').removeClass("hide").parents(".js_annotation-footnote").addClass("selected"),this.updateFotenoteNumbers(),this.addEllipsis()},removeAnnotation:function(t){e('[data-annotation-id="'+t+'"]').remove(),this.updateFotenoteNumbers(),this.addEllipsis()},showPending:function(t){t.preventDefault();var n=e(t.target).parents(".annotation-content");n.find(".js_toggle-pending").addClass("hide"),n.find(".js_annotation-content").removeClass("hide")}}));return u}),define("singleton/util/hostname",[],function(){"use strict";function e(e){return e.replace(/^www\./,"")}function t(e){var t=e.lastIndexOf(".");return-1===t?e:e.substring(0,t)}function s(s){return e(t(s))===t(n)}var n;return n=e(window.location.host),{removeWWW:e,sameHost:s}}),define("singleton/util/externalLinks",["singleton/util/hostname"],function(e){"use strict";return{openInNewTabs:function(t){t.find("a").each(function(t,n){e.sameHost(n.hostname)||n.setAttribute("target","_blank")})}}}),define("singleton/PostInsetTools",["underscore","jquery","singleton/Renderer","singleton/Utils","singleton/Feature","singleton/util/hostname","singleton/util/externalLinks"],function(e,t,n,s,o,i,a){"use strict";function r(){}var c;return r.prototype={render:function(e){var t=e.find(".js_inset");a.openInNewTabs(t),this.markExternalInsets(t),o.isOn("empty_thumbnail_test")||this.hideEmptyThumbnails(e)},hideEmptyThumbnails:function(e){var n=e.find(".referenced-item img");n.each(function(e,n){function s(){n.naturalHeight&&n.naturalWidth||i.addClass("hide")}var o=t(n),i=o.parents(".referenced-item-image");n.complete?s():o.load(s)})},markExternalInset:function(e,t){var n,s,o;i.sameHost(t)||(n=e.querySelector(".js_readmore .js_external-text"),n&&(o=i.removeWWW(t),s='<span class="hostname">'+o.split(".").join(".&#x200b;")+"</span>",e.querySelector(".js_readmore").innerHTML=n.innerText+" "+s))},markExternalInsets:function(t){t.find(".referenced-item").each(function(t,n){this.markExternalInset(n,e.last(n.querySelectorAll("a")).hostname)}.bind(this))},soyToHtml:function(e,t,o){var i=s.getRenderableData(t,o);return n.renderTemplate(e,i.data,i.injected)}},c||(c=new r)}),define("app/post/common/post.layout",["underscore","backbone.marionette","singleton/CurrentUser","singleton/Utils","singleton/Feature","module/KinjaAnalytics"],function(e,t,n,s,o,i){"use strict";var a=t.Layout.extend(e.extend({regions:{post:".post"},ui:{likeButton:".js_like",likeIcon:".js_like_icon",likeCountPlaceholder:".js_like_count",replyButton:".js_reply-to-post",metaContainer:".meta-container",metaTools:".js_meta-tools"},triggers:{"click @ui.likeButton":"posttools:like","click @ui.replyButton":"posttools:reply"},events:{approval:"_removePendingStyling","click @ui.likeIcon":"onRecommendTracking"},modelEvents:{"change:liked":"_updateLikeIconClasses","posttools:post:likeCount:updated":"_updateLikeCount"},updateUserState:function(){n.onAuth.done(function(){n.isLoggedIn()?this._updateLikeIconClasses():this._removeLikeIconClass()}.bind(this)),n.onLoggedIn.done(this._updateLikeIconClasses.bind(this))},togglePostToolsVisibility:function(e){o.isOn("newstream")?this.ui.metaTools.toggleClass("hide",e):this.ui.metaContainer.toggleClass("without-dropdown",e)},onRecommendTracking:function(e){var t="groupChat"===e.currentTarget.parentElement.getAttribute("data-analytics-target");s.getKinjaMeta().pageType!==s.pageTypes.permalink||t||i.pushEvent("RECOMMENDATION","POST",this.model.id,{uiElement:e.currentTarget.getAttribute("data-analytics-target")})},_removePendingStyling:function(t,n){var s=this.$el.closest(".js_branch-list");e.each(n.approvedReplyIDs,function(e){s.find("#reply_"+e).removeClass("reply--unapproved")})},_updateLikeIconClasses:function(){this.ui.likeIcon.toggleClass("active",this.model.get("liked"))},_removeLikeIconClass:function(){this.ui.likeIcon.removeClass("active")},_updateLikeCount:function(){var e=parseInt(this.ui.likeButton.data("likecount"),10)||0,t=e>0,e=this.model.get("liked")?e+1:t?e-1:0;this.ui.likeButton.data("likecount",e),this.ui.likeCountPlaceholder.text(e||"")}}));return a}),define("app/post/mixins/post.confirmationPrompt",["jquery","singleton/Renderer"],function(e,t){"use strict";var n={_confirmationPrompt:function(n,s){return window.confirm(e(t.renderTemplate(n,s||{})).text())}};return n}),define("app/post/mixins/post.userPermissionsHelper",["singleton/Feature","singleton/CurrentUser","singleton/CurrentBlog"],function(e,t,n){"use strict";return{canEditPost:function(n){var a=15,r=function(e){var t=new Date(e+60*a*1e3),n=new Date;return t>n},s=t.isLoggedIn(),o=t.id===n.get("authorId"),c=t.hasRole("OWNER",n.get("defaultBlogId")),l=t.hasRole("ADMIN",n.get("defaultBlogId")),i=n.has("parentId"),d=s&&(o||c||l)&&!i,u=s&&i&&o&&r(n.get("publishTimeMillis"));return t.isSuperuser()&&e.isOn("superuser")||d||u},canDeletePost:function(e){var n=t.isLoggedIn(),s=t.id===e.get("authorId"),o=t.hasRole("OWNER",e.get("defaultBlogId")),i=e.has("parentId");return n&&(s||o)&&!i},canInviteToPostManually:function(n){return e.isOn("invitetoken")&&n.get("authorId")===t.id},canPromote:function(){return t.hasPermission("SALES")||t.isSuperuser()&&e.isOn("superuser")},canDismissPost:function(s){var o=t.hasRole("ADMIN",n.id)||t.hasRole("ADMIN",s.get("defaultBlogId")),i=t.id===s.get("authorId"),a=t.id===s.get("parentAuthorId"),r=s.has("parentId");return r&&(t.isSuperuser()&&e.isOn("superuser")||!i&&(o||a))},canUnshareRepostedPost:function(){return t.hasRole("ADMIN",n.id)},canBlock:function(e){return this.userIsOwner(e)||this.userIsAdmin(e)||this.userIsSuper()},canSharePost:function(){return t.isLoggedIn()},userIsAuthor:function(e){return t.hasRole("AUTHOR",e.get("defaultBlogId"))&&t.id!==e.get("authorId")},userIsOwner:function(e){return t.hasRole("OWNER",e.get("defaultBlogId"))&&t.id!==e.get("authorId")},userIsAdmin:function(e){return t.hasRole("ADMIN",e.get("defaultBlogId"))&&t.id!==e.get("authorId")},userIsSuper:function(){return t.isSuperuser()&&e.isOn("superuser")}}}),define("app/post/mixins/post.userPermissions",["underscore","app/post/mixins/post.userPermissionsHelper"],function(e,t){"use strict";var n=["canEditPost","canDeletePost","canInviteToPostManually","canPromote","canDismissPost","canUnshareRepostedPost","canBlock","canSharePost","userIsAuthor","userIsOwner","userIsAdmin","userIsSuper"];return e.reduce(n,function(n,s){return n[s]=e.wrap(t[s],function(e){return e.call(this,this.model)}),n},{})}),define("app/post/common/post.menuitemview",["backbone.marionette"],function(e){"use strict";var t=e.ItemView.extend({_show:function(){this.$el.removeClass("hide")},_hide:function(){this.$el.addClass("hide")},_isDisabled:function(){return!1},_canShow:function(){throw new Error("method _canShow not implemented!")},onRender:function(){this._canShow()?(this._show(),this._isDisabled()?this.$el.addClass("disabled"):this.$el.removeClass("disabled")):this._hide()}});return t}),define("app/post/posttools/view/posttools.menuitemview",["underscore","app/post/mixins/post.userPermissions","app/post/mixins/post.confirmationPrompt","app/post/common/post.menuitemview"],function(e,t,n,s){"use strict";var o=s.extend(e.extend({},t,n,{_canShow:function(){var t=this,n=function(e){return t[e]};return e.chain(this.permissions).map(n).invoke("call",this).all().value()},render:function(){return this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this}}));return o}),define("app/post/posttools/view/posttools.editview",["app/post/posttools/view/posttools.menuitemview","singleton/Feature","singleton/Utils"],function(e,t,n){"use strict";var s=e.extend({permissions:["canEditPost"],onRender:function(){var s=t.isOn("editor_own_page_test")?window.location.search:"",o=this.$el.find("a");e.prototype.onRender.call(this,arguments),o.attr("href","//"+n.getKinjaHost()+"/write/"+this.model.id+s)}});return s}),define("app/post/posttools/view/posttools.editreplyview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["canEditPost"]});return t}),define("app/post/posttools/view/posttools.deleteview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["canDeletePost"],triggers:{click:"posttools:delete"}});return t}),define("apiclient/invite",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";return{addInvite:t.postJson(n.append(e.api.core.url+"/invite")),requestInviteToken:t.postJson(n.append(e.api.core.url+"/invite/create?postId={{postId}}")),approveInvitedCommenter:t.postJson(e.api.core.url+"/invite/approve")}}),define("templates/tiger/components/invites/modals",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.invites.modals.inviteToPostManually=function(e){return'<form class="invite-to-post-form js_invite-to-post-form"><div class="row"><div class="columns"><input type="url" class="mbn js_invite-manually-field" value="'+o.$$escapeHtmlAttribute(e.permalink)+"?invite="+o.$$escapeHtmlAttribute(e.inviteUid)+'" autofocus /></div></div></form>'},s.DEBUG&&(t.components.invites.modals.inviteToPostManually.soyTemplateName="tiger.components.invites.modals.inviteToPostManually")}),define("view/forms/invite/InviteToPostManuallyModalView",["backbone.marionette","singleton/EventDispatcher","templates/tiger/components/invites/modals"],function(e,t){"use strict";var n=e.ItemView.extend({id:"modal-invite-to-post-manually",template:tiger.components.invites.modals.inviteToPostManually,ui:{inviteToPostManuallyField:"#js_invite-to-post-manually-field"},initialize:function(){t.on("modal:login:close",this.close,this)}});return n}),define("app/invites/behaviors/invites.token.posttools",["backbone.marionette","apiclient/invite","app/modal/modal.controller","view/forms/invite/InviteToPostManuallyModalView"],function(e,t,n,s){"use strict";var o=e.Behavior.extend({events:{click:"onInviteModalToPostManuallyOpen"},onInviteModalToPostManuallyOpen:function(e){e.preventDefault(),t.requestInviteToken({postId:this.view.model.id}).done(function(e){var t=n.instantiate(s,{templateData:{permalink:this.view.model.get("permalink"),inviteUid:e.inviteUid}});n.create(t,{name:"invite",className:"reveal-modal kinja-modal small proxima"})}.bind(this))}});return o}),define("app/post/posttools/view/posttools.invitemanuallyview",["app/post/posttools/view/posttools.menuitemview","app/invites/behaviors/invites.token.posttools"],function(e,t){"use strict";var n=e.extend({permissions:["canInviteToPostManually"],behaviors:{InvitesTokenPostTools:{behaviorClass:t}}});return n}),define("app/post/posttools/view/posttools.dismissview",["app/post/posttools/view/posttools.menuitemview","singleton/CurrentUser","singleton/Utils"],function(e,t,n){"use strict";var s=e.extend({permissions:["canDismissPost"],ui:{dismissButton:"a.dismiss",undismissButton:"a.undismiss"},triggers:{"click @ui.dismissButton":"posttools:dismiss","click @ui.undismissButton":"posttools:undismiss"},modelEvents:{"change:actionState":"_finishRender"},_finishRender:function(){this._setDismissState(),e.prototype.onRender.call(this)},_setDismissState:function(){var e=this.model.get("actionState"),t=this.model.get("defaultBlogId"),e=e?e[t]:"";"dismiss"===e?(this.$el.removeClass(".js_dismiss").addClass("js_undismiss"),this.ui.dismissButton.addClass("hide"),this.ui.undismissButton.removeClass("hide")):(this.$el.removeClass(".js_undismiss").addClass("js_dismiss"),this.ui.undismissButton.addClass("hide"),this.ui.dismissButton.removeClass("hide"))},onRender:function(){var e,o,s=this;"permalink"===n.getKinjaMeta().pageType?(e=parseInt(n.getKinjaMeta().postId||0,10),o=parseInt(n.getKinjaMeta().starterId||0,10),e!==o&&e===this.model.id?t.onAuth.always(function(){t.isLoggedIn()?s.triggerMethod("posttools:getDismissState",{model:s.model}):s._finishRender()}):this._finishRender()):this._finishRender()}});return s}),define("app/post/posttools/view/posttools.promoteview",["app/post/posttools/view/posttools.menuitemview","singleton/Utils"],function(e,t){"use strict";var n=e.extend({permissions:["canPromote"],triggers:{click:"posttools:promote"},onPosttoolsOpened:function(){var e=this.model&&parseInt(t.getKinjaMeta().postId,10)===this.model.get("sharedPostId");e&&this.$el.addClass("hide")}});return n}),define("app/post/posttools/view/posttools.blockview",["app/post/posttools/view/posttools.menuitemview","singleton/CurrentUser"],function(e,t){"use strict";var n=e.extend({permissions:["canBlock"],events:{click:"_blockBlog"},modelEvents:{"posttools:blockStatusUpdated":"_finishRender"},collectionEvents:{"posttools:block posttools:unblock sync":"_checkBlockStatus"},_checkBlockStatus:function(){this.triggerMethod("posttools:checkBlockStatus",{model:this.model,collection:this.collection})},_blockBlog:function(e){e.preventDefault(),this.triggerMethod("posttools:block",{model:this.model,collection:this.collection,targetBlogName:this._getTargetBlogName(),targetAuthorName:this._getTargetAuthorName()}),this.$el.siblings(".js_unfollowforblog").addClass("hide"),this.$el.siblings(".js_followforblog").removeClass("hide"),this.$el.siblings(".js_unfollowforuser").addClass("hide"),this.$el.siblings(".js_followforuser").removeClass("hide")},_correctBlockText:function(e){var n=this.$el.find("span"),s=n.text(),t=e?"Unblock":"Block",t=s.replace(/Unblock|Block/,t);n.text(t)},_finishRender:function(t){this._correctBlockText(t),e.prototype.onRender.call(this)},_getTargetBlogName:function(){return this.$el.data("targetblogname")},_getTargetAuthorName:function(){return this.$el.data("targetauthorname")},onRender:function(){var e=this;t.onAuth.always(function(){e._canShow()?e._checkBlockStatus():e._hide()})}});return n}),define("app/post/posttools/view/posttools.hideview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["userIsSuper"],triggers:{click:"posttools:hide"}});return t}),define("app/post/posttools/view/posttools.kinjashareview",["app/post/posttools/view/posttools.menuitemview","singleton/Utils"],function(e,t){"use strict";var n=e.extend({permissions:[],events:{click:"onKinjaShareClick"},onKinjaShareClick:function(){var e=parseInt(t.getKinjaMeta().postId,10)===this.model.get("sharedPostId"),n=this.model.get("isStarter");this.trigger("posttools:kinjaShare",this.model,{showReframe:!e&&n})}});return n}),define("app/post/posttools/view/posttools.kinjaunshareview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({permissions:["canSharePost","canUnshareRepostedPost"],triggers:{click:"posttools:undorepost"}});return t}),define("app/post/posttools/view/posttools.externalshareview",["jquery","app/post/posttools/view/posttools.menuitemview"],function(e,t){"use strict";var n=t.extend({permissions:[],ui:{sharePostButton:".js_share-post-item"},triggers:{"click @ui.sharePostButton":"posttools:externalShare"},onRender:function(){var t=function(t){return e("<div/>").html(t).text()},n=function(e){return e?e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)}):""},s=this.model.get("headline")||this.model.get("first100Characters")||this.model.get("compact"),o=this.ui.sharePostButton.attr("href");this.ui.sharePostButton.attr("href",o.replace("POST_TITLE",encodeURIComponent(t(n(s)))))}});return n}),define("templates/tiger/components/groupchats/flagreason",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.groupchats.flagreason=function(e,n,s){return'<form><label class="reason-head">Why are you flagging this?<a class="icon" href="http://help.gawker.com/customer/portal/articles/1726140-what-is-flagging-?b_id=5895" target="_blank">'+t.icons.actions.information(null,null,s)+`</a></label><div class="row radio-cont"><div class="column small-12 js_error hide proxima"><small class="warningmessage">Please select a reason</small></div><div class="columns small-12"><label><input type="radio" name="reason" value="HARASSMENT">It's harassment</label></div></div><div class="row radio-cont"><div class="columns small-12"><label><input type="radio" name="reason" value="HATE_SPEECH">It's hate speech</label></div></div><div class="row radio-cont"><div class="columns small-12"><label><input type="radio" name="reason" value="SPAM">It's spam</label></div></div><div class="flag-reason-ctas"><a class="button secondary tiny cancel js_cancel">Cancel</a><a class="button primary tiny submit js_submit">Save</a></div></form>`},s.DEBUG&&(t.components.groupchats.flagreason.soyTemplateName="tiger.components.groupchats.flagreason")}),define("module/flagging/view/FlagReasonDropdown",["backbone.marionette","templates/tiger/components/groupchats/flagreason"],function(e){"use strict";var t=e.ItemView.extend({template:tiger.components.groupchats.flagreason,className:"flag-reason-dropdown js_flagreason",events:{submit:"submit",click:"preventPropagation","click .js_cancel":"cancel","click .js_submit":"submit"},initialize:function(){},preventPropagation:function(e){e.stopPropagation()},cancel:function(){this.trigger("flagreason:cancel")},submit:function(e){e.preventDefault();var t=this.$('input[name="reason"]:checked').val();return t?this.trigger("flagreason:submit",this,t):this.$(".js_error").removeClass("hide"),!1}});return t}),define("templates/tiger/components/forms/modals/flagreason",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.forms.modals.flagreason=function(){return`<div class="show-for-medium-down flag-reason-mobile"><ul class="sticky-modal-options"><li class="js_reason-harassment" data-reason="HARASSMENT">It's harassment</li><li class="js_reason-hate-speech" data-reason="HATE_SPEECH">It's hate speech</li><li class="js_reason-spam" data-reason="SPAM">It's spam</li></ul><footer class="row"><div class="column small-12"><input type="button" class="button tiny secondary js_cancel" tabindex="5" value="Cancel" /></div></footer></div>`},s.DEBUG&&(t.components.forms.modals.flagreason.soyTemplateName="tiger.components.forms.modals.flagreason")}),define("module/flagging/view/FlagReasonModal",["jquery","backbone.marionette","templates/tiger/components/forms/modals/flagreason"],function(e,t){"use strict";var n=t.ItemView.extend({template:tiger.components.forms.modals.flagreason,tagName:"form",events:{submit:"submit","click .js_cancel":"cancel","click .js_reason-harassment":"selectReason","click .js_reason-hate-speech":"selectReason","click .js_reason-spam":"selectReason"},cancel:function(){this.trigger("flagreason:cancel")},selectReason:function(t){var n=e(t.target).attr("data-reason");if(!n)throw new Error("Empty reason code for reason!");this.trigger("flagreason:submit",this,n)}});return n}),define("apiclient/flagging",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";var s={flagPost:function(t){return t.reason?e.api.core.url+"/post/{{postId}}/flag?reason={{reason}}":e.api.core.url+"/post/{{postId}}/flag"},unflagPost:function(t){return t.reason?e.api.core.url+"/post/{{postId}}/unflag?reason={{reason}}":e.api.core.url+"/post/{{postId}}/unflag"}},o={getPosts:t.getJson(n.append(e.api.core.url+"/post/{{starterId}}/flaggedposts")),getCount:t.getJson(n.append(e.api.core.url+"/post/{{starterId}}/flaggedcount")),flagPost:t.postJson(n.append(s.flagPost)),unflagPost:t.postJson(n.append(s.unflagPost)),getBlogCount:t.getJson(n.append(e.api.core.url+"/blog/{{blogId}}/flaggedcount")),resolveFlag:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/resolve")),unresolveFlag:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/unresolve"))};return window.__karma__&&(o.__testonly__={urls:s}),o}),define("templates/tiger/components/groupchats/flagging-admin-link",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.groupchats.flaggingAdminLink=function(e){return`<div class="flagging-admin-link proxima"><a onClick="window.ga('send', 'event', 'On-Page Flagging', 'click', 'Click into moderation queue');" href="https://kinja.com/manage/`+o.$$escapeHtmlAttribute(e.blogName)+'/flagged">Moderate Flagged Replies ('+o.$$escapeHtml(e.flagCount)+")</a></div>"},s.DEBUG&&(t.components.groupchats.flaggingAdminLink.soyTemplateName="tiger.components.groupchats.flaggingAdminLink")}),define("module/flagging/ReplyFlaggingModule",["jquery","underscore","singleton/Feature","singleton/CurrentUser","singleton/Utils","singleton/WindowController","module/flagging/view/FlagReasonDropdown","module/flagging/view/FlagReasonModal","app/modal/modal.controller","apiclient/flagging","templates/tiger/components/groupchats/flagging-admin-link"],function(e,t,n,s,o,i,a,r,c,l){"use strict";var d={flaggedReplies:null,flaggedRepliesLoaded:e.Deferred(),flagCount:null,flagCountLoaded:e.Deferred(),tokenRenewed:!1,reasonDropdown:0[0],reasonModal:0[0],_loadFlaggedReplies:function(e){var t=this,n=function(n,o){t.flaggedReplies=[],o&&o.success===!0?(t.flaggedReplies=n.map(function(e){return e.postId}),t.flaggedRepliesLoaded.resolve()):o&&"InvalidSessionToken"===o.type&&d.tokenRenewed===!1?(d.tokenRenewed=!0,s.token().done(function(){d._loadFlaggedReplies(e)})):t.flaggedRepliesLoaded.reject()};l.getPosts({starterId:e}).done(n)},_loadFlagCount:function(e){var t=this,n=function(e,n){n&&n.success===!0&&(t.flagCount=Number(e)),t.flagCountLoaded.resolve()};l.getCount({starterId:e}).done(n)},_mergePostModelWithFlagInfo:function(e){var n=e.get("id");t.contains(this.flaggedReplies,n)&&e.set({allowReplies:!1,flagged:!0})},_postStatus:function(e){return 0!==e.parents(".all-threads").length?e.parents(".js_reply").hasClass("reply--unapproved")?"Pending":"Approved":"Featured"},_flagPost:function(e,s,o){var c,u,i=s.get("flagged")===!0,a=s.get("id"),r=i?"Unflag":"Flag",h=d._postStatus(e);s.get("flaggingInProgress")===!0&&t.isUndefined(d.reasonDropdown)||(s.set({flaggingInProgress:!0}),u=n.isOn("extendedflag")&&!t.isUndefined(o)&&"Flag"===r?r+" - "+o.toLowerCase():r,window.ga("send","event","On-Page Flagging",u,"Reply status: "+h),c=i?l.unflagPost({postId:a,reason:o}):l.flagPost({postId:a,reason:o}),c.done(function(e,t){0[0]!==t&&t.success===!0&&(s.set({flagged:!i,allowReplies:i,flaggingInProgress:!1}),this._syncFlaggedReplies(!i,a))}.bind(this)))},_syncFlaggedReplies:function(e,n){null!==d.flaggedReplies&&(e?d.flaggedReplies.push(n):d.flaggedReplies=t.reject(d.flaggedReplies,function(e){return e===n})),null!==d.flagCount&&(e?d.flagCount++:d.flagCount--)},_showDropdownReasonSelection:function(t,n){var s,o;d._hideReasonDropdown(),d.reasonDropdown=new a({$reply:t,model:n}),d.reasonDropdown.on("flagreason:submit",d._handlePostFlagFromDropdown),d.reasonDropdown.on("flagreason:cancel",d._hideReasonDropdown),d.reasonDropdown.render(),n.set({flaggingInProgress:!0}),d.reasonDropdown.$el.appendTo(t),s=d.reasonDropdown.$el,e(window).scrollTop()+window.innerHeight-s.height()<s.offset().top&&(o=s.offset().top-s.height(),e("body").scrollTo(o,{duration:"slow"}))},_showModalReasonSelection:function(e,t){d.reasonModal=new r({$reply:e,model:t}),d.reasonModal.on("flagreason:cancel",function(){c.close()}),d.reasonModal.on("flagreason:submit",d._handlePostFlagFromModal),c.create(d.reasonModal,{name:"flagreason",className:"reveal-modal kinja-modal sticky-modal bottom full-width"})},_handlePostFlagFromDropdown:function(e,t){var n=e.model;e.$("a,input").addClass("disabled"),n.once("change:flagged",d._hideReasonDropdown),d._flagPost(e.options.$reply,n,t)},_handlePostFlagFromModal:function(e,t){var n=e.model;e.$("a,input").addClass("disabled"),n.once("change:flagged",function(){c.close()}),d._flagPost(e.options.$reply,n,t)},_hideReasonDropdown:function(){t.isUndefined(d.reasonDropdown)||(d.reasonDropdown.options.model.set({flaggingInProgress:!1}),d.reasonDropdown.remove(),d.reasonDropdown=0[0])},API:{flaggedRepliesLoaded:function(){return d.flaggedRepliesLoaded},flagCountLoaded:function(){return d.flagCountLoaded},flaggedReplies:function(){return d.flaggedReplies},flagCount:function(){return d.flagCount},openFlagView:function(e,t){s.requireLogin("flagPost").done(function(){i.isSmall()?d._showModalReasonSelection(e,t):d._showDropdownReasonSelection(e,t)})},unflag:function(e,t){s.requireLogin("unflagPost").done(function(){d._flagPost(e.view.$el,t)})},loadFlaggedReplies:function(e){s.onAuth.done(function(){s.isLoggedIn()&&d._loadFlaggedReplies(e)})},loadFlagCount:function(e){s.onAuth.done(function(){var t=o.getKinjaMeta().blog.id;s.isLoggedIn()&&(s.isSuperuser()&&n.isOn("superuser")||s.hasRole("OWNER",t)||s.hasRole("ADMIN",t))?d._loadFlagCount(e):d.flagCountLoaded.reject()})},extendPostModel:function(e){d.flaggedRepliesLoaded.done(function(){d._mergePostModelWithFlagInfo(e)})}}};return window.__karma__&&(d.API.__testonly__=d),d.API}),define("app/post/posttools/view/posttools.flagview",["app/post/posttools/view/posttools.menuitemview","module/flagging/ReplyFlaggingModule"],function(e,t){"use strict";var n=e.extend({modelEvents:{"change:flagged":"_flaggedChanged","change:flaggingInProgress":"_flaggedChanged"},permissions:[],events:{click:"_onFlagClicked"},_flaggedChanged:function(){this.render()},_canShow:function(){return this.model.get("flagged")!==!0},_isDisabled:function(){return this.model.get("flaggingInProgress")===!0},_onFlagClicked:function(e){e.preventDefault();var n=this.$el.parents(".js_reply");t.openFlagView(n,this.model)}});return n}),define("app/post/posttools/view/posttools.unflagview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";var t=e.extend({modelEvents:{"change:flagged":"_flaggedChanged","change:flaggingInProgress":"_flaggedChanged"},permissions:[],triggers:{click:"posttools:unflag"},_flaggedChanged:function(){this.render()},_canShow:function(){return this.model.get("flagged")===!0},_isDisabled:function(){return this.model.get("flaggingInProgress")===!0}});return t}),define("app/post/posttools/view/reposttools.unscheduleview",["app/post/posttools/view/posttools.menuitemview"],function(e){"use strict";return e.extend({permissions:["canSharePost"],triggers:{click:"reposttools:unschedule"}})}),define("app/post/posttools/view/posttools.pupilview",["jquery","underscore","app/post/posttools/view/posttools.menuitemview"],function(e,t,n){"use strict";var s=n.extend({permissions:["canPromote"],triggers:{click:"posttools:pupil"}});return s}),define("templates/tiger/components/post/meta/post-dropdown",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.post.meta.postDropdown=function(e,n,s){var r="",c=e.post.defaultBlogId!=(null==e.blog?null:e.blog.id)&&"POSTACTION"==(null==e.post.meta?null:e.post.meta.typ),i=null!=(null==e.blog?null:e.blog.name)?null==e.blog?null:e.blog.name:e.post.defaultBlogName,a=null!=(null==e.blog?null:e.blog.displayName)?null==e.blog?null:e.blog.displayName:i;return r+='<ul id="dropdown-'+o.$$escapeHtmlAttribute(e.post.id)+'" class="f-dropdown proxima js_post-dropdown js_follow-controls js_user-follow-controls whitelisted-links" data-postid="'+o.$$escapeHtmlAttribute(e.post.id)+'" data-starterid="'+o.$$escapeHtmlAttribute(e.post.starterId)+'" data-authorid="'+o.$$escapeHtmlAttribute(e.post.author.id)+'" data-blogid="'+o.$$escapeHtmlAttribute(e.post.authorBlogId)+'" data-sourceblogid="'+o.$$escapeHtmlAttribute(null==e.blog?null:e.blog.id)+'" data-dropdown-content>'+("reply"==e.mode?'<li class="js_edit-reply hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.actions.write(null,null,s)+"Edit</a></li>":'<li class="js_edit-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.actions.write(null,null,s)+"Edit</a></li>")+(c?'<li class="js_kinja-unshare hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.essential.externalLink(null,null,s)+"Unshare</a></li>":'<li class="js_delete-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.essential.close(null,null,s)+"Delete</a></li>")+("DRAFT"!=e.post.status?t.components.invites.menuItems.invitePostDropdownItems(null,null,s):"")+("reply"==e.mode&&"profilepage"!=e.pageType?`<li data-analytics-target="groupChat" class="js_followforuser hover-icon readonly-hide" onclick="window.ga('send', 'event', 'Group Chats', 'click', 'Drop down - follow user click');"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">`+t.icons.essential.add(null,null,s)+"Follow "+o.$$escapeHtml(e.post.authorBlogName)+'</a></li><li class="js_unfollowforuser hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.essential.checkmark(null,null,s)+"Unfollow "+o.$$escapeHtml(e.post.authorBlogName)+"</a></li>"+("private"!=e.pageType&&"dashboard"!=e.pageType?'<li class="js_followforblog js_approveforblog hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+(s.features.approvemessage?t.icons.essential.add(null,null,s)+"Approve "+o.$$escapeHtml(e.post.authorBlogName)+" on "+o.$$escapeHtml(a):t.icons.essential.add(null,null,s)+"Follow "+o.$$escapeHtml(e.post.authorBlogName)+" for "+o.$$escapeHtml(i))+'</a></li><li class="js_unfollowforblog js_unapproveforblog hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+(s.features.approvemessage?t.icons.essential.checkmark(null,null,s)+"Remove "+o.$$escapeHtml(e.post.authorBlogName)+" from "+o.$$escapeHtml(a)+" approve list":t.icons.essential.checkmark(null,null,s)+"Unfollow "+o.$$escapeHtml(e.post.authorBlogName)+" for "+o.$$escapeHtml(i))+"</a></li>":""):"DRAFT"!=e.post.status?'<li class="js_promote hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.essential.starCircle(null,null,s)+"Promote</a></li>":"")+("DRAFT"!=e.post.status&&"dashboard"!=e.pageType?`<li class="js_dismiss hover-icon hide readonly-hide"><a href="#" class="dismiss icon--svg u-darkened--onhover u-prepended" rel="nofollow" onclick="window.ga('send', 'event', 'Group Chats', 'click', 'Dismiss click');">`+t.icons.actions.userRemove(null,null,s)+`Dismiss</a><a href="#" class="undismiss icon--svg u-darkened--onhover u-prepended" rel="nofollow" onclick="window.ga('send', 'event', 'Group Chats', 'click', 'Undismiss click');">`+t.icons.actions.userRemove(null,null,s)+'Undismiss</a></li><li class="js_block hover-icon hide disabled readonly-hide" data-blogid="'+o.$$escapeHtmlAttribute(e.post.defaultBlogId)+'" data-targetblogid="'+o.$$escapeHtmlAttribute(e.post.authorBlogId)+'" data-targetblogname="'+o.$$escapeHtmlAttribute(i)+'" data-targetauthorname="'+o.$$escapeHtmlAttribute(e.post.author.displayName)+'"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.actions.disabled(null,null,s)+"<span>Block for "+o.$$escapeHtml(i)+'</span></a></li><li class="js_hide-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.actions.disabled(null,null,s)+"Hide</a></li>":"")+("permalink"==e.pageType&&"DRAFT"!=e.post.status?("reply"==e.mode?'<li class="js_flag-post hover-icon readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.actions.flag(null,null,s)+'Flag</a></li><li class="js_unflag-post unflag-post hover-icon readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+t.icons.actions.flag(null,null,s)+"Unflag</a></li>":s.features.pupil_rating?'<li class="js_pupil-rules-block"><a class="js_pupil-rules hover-icon icon--svg u-darkened--onhover u-prepended" href="#" rel="nofollow">'+t.icons.actions.writePaper(null,null,s)+"Open Pupil Rules</a></li>":"")+'<li class="js_kinja-share-block readonly-hide"><a class="js_kinja-share hover-icon icon--svg u-darkened--onhover u-prepended" href="#" rel="nofollow">'+t.icons.essential.externalLink(null,null,s)+'Share to Kinja</a></li><li class="js_go-to-permalink"><a class="hover-icon icon--svg u-darkened--onhover u-prepended" href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+`" onclick="window.ga('send', 'event', 'Group Chats', 'click', 'Drop down - Go to permalink click');">`+t.icons.essential.link(null,null,s)+"Go to permalink</a></li>":"")+("dashboard"==e.pageType&&"reply"==e.mode&&"DRAFT"!=e.post.status?'<li class="js_block readonly-hide" data-blogid="'+o.$$escapeHtmlAttribute(e.post.defaultBlogId)+'" data-targetblogid="'+o.$$escapeHtmlAttribute(e.post.authorBlogId)+'" data-targetblogname="'+o.$$escapeHtmlAttribute(i)+'" data-targetauthorname="'+o.$$escapeHtmlAttribute(e.post.author.displayName)+`"><a href="#" rel="nofollow" onclick="window.ga('send', 'event', 'Group Chats', 'click', 'Block User click');" class="icon--svg u-darkened--onhover u-prepended">`+t.icons.essential.close(null,null,s)+"Block user for blog</a></li>":"")+"</ul>"},s.DEBUG&&(t.components.post.meta.postDropdown.soyTemplateName="tiger.components.post.meta.postDropdown"),t.components.post.meta.postDropdownTrigger=function(e,n,s){return'<a href="#" target="_self" class="post-dropdown-trigger js_post-menu-toggler icon--svg u-highlighted--onhover" data-dropdown="dropdown-'+o.$$escapeHtmlAttribute(e.post.id)+`" onclick="window.ga('send', 'event', 'Group Chats', 'click', 'Drop down click');">`+(s.features.newstream?t.icons.essential.toolsGiant(null,null,s):t.icons.essential.chevronBottom(null,null,s))+"</a>"},s.DEBUG&&(t.components.post.meta.postDropdownTrigger.soyTemplateName="tiger.components.post.meta.postDropdownTrigger")}),define("app/post/posttools/posttools.menuview",["jquery","underscore","backbone","backbone.marionette","singleton/CurrentUser","singleton/CurrentBlog","singleton/EventDispatcher","singleton/Utils","app/post/mixins/post.userPermissions","app/post/posttools/view/posttools.editview","app/post/posttools/view/posttools.editreplyview","app/post/posttools/view/posttools.deleteview","app/post/posttools/view/posttools.invitemanuallyview","app/post/posttools/view/posttools.dismissview","app/post/posttools/view/posttools.promoteview","app/post/posttools/view/posttools.blockview","app/post/posttools/view/posttools.hideview","app/post/posttools/view/posttools.kinjashareview","app/post/posttools/view/posttools.kinjaunshareview","app/post/posttools/view/posttools.externalshareview","app/post/posttools/view/posttools.flagview","app/post/posttools/view/posttools.unflagview","app/post/posttools/view/reposttools.unscheduleview","app/post/posttools/view/posttools.pupilview","templates/tiger/components/post/meta/post-dropdown"],function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O){"use strict";var x=["profilepage","dashboard","manageblog"],C=s.ItemView.extend(t.extend({},c,{menuItemViewClasses:{".js_pupil-rules":O,".js_-post":l,".js_edit-post":l,".js_edit-reply":-1===t.indexOf(x,r.getKinjaMeta().pageType)?d:l,".js_delete-post":u,".js_invite-to-post-manually":h,".js_dismiss":m,".js_promote":f,".js_block":p,".js_hide-post":g,".js_kinja-share":v,".js_kinja-unshare":b,".js_external-share":j,".js_flag-post":y,".js_unflag-post":_,".js_unschedule-repost":w},events:{"requested.fndtn.dropdown .js_post-menu-toggler":"onPosttoolsRequested"},triggers:{"opened.fndtn.dropdown .js_post-dropdown":"posttools:opened"},menuItemViews:[],permissions:["userIsSuper","canEditPost","canPromote","canDismissPost","canSharePost"],initialize:function(e){a.on("blog:block:success"+this.model.id,this.render,this),this.blockedBlogCollection=e.blockedBlogCollection},_instantiateMenuItemViewClasses:function(e){return e=e||this.$el,Object.keys(this.menuItemViewClasses).reduce(function(n,s){var o=e.find(s),i=t.partial(this._createMenuItemClass.bind(this),s);return o.length?n.concat(t.map(o,i)):n}.bind(this),[])},_createMenuItemClass:function(t,n){var o=this.menuItemViewClasses[t],s={el:e(n),model:this.model};return".js_block"===t&&(s.collection=this.blockedBlogCollection),new o(s)},_bindEvents:function(){o.onAuthStateChange(this._refreshMenu.bind(this))},_refreshMenu:function(){var t="permalink"===r.getKinjaMeta().pageType,e=this,n=function(){return e.$("li:not(.hide)").length};e._renderMenuItems(),e.trigger("posttools:menuview:togglehidden",!t&&!n())},_renderMenuItems:function(){this.menuItemViews.call("render")},_captureMenuItemEvents:function(){this.menuItemViews.call("on","all",this.trigger,this)},_adjustMenuHeight:function(){var n,t=this.$(".js_post-dropdown"),s=e(window.document).height(),o=this.$el.offset().top,i=s-o-t.height();0>i&&(n=s-o,t.height(n+"px"),t.addClass("scroll"))},onPosttoolsOpened:function(){t.isEmpty(this.menuItemViews)?this.listenToOnce(this,"posttools:content:render",this.onPosttoolsOpened):(this.menuItemViews.call("triggerMethod","posttools:opened"),this._adjustMenuHeight())},onPosttoolsRequested:function(e,t){var n=s.Renderer.render(tiger.components.post.meta.postDropdown,{post:this.model.toJSON(),mode:"reply",pageType:r.getKinjaMeta().pageType,blog:i});t.resolve(n),this.onContentRender()},render:function(){var e="permalink"===r.getKinjaMeta().pageType;return this.onContentRender(),e&&this.trigger("posttools:menuview:togglehidden",!1),this},onContentRender:function(){var e;this.menuItemViews.length||(e=this._instantiateMenuItemViewClasses(),this.menuItemViews=new n.ChildViewContainer(e),this._captureMenuItemEvents()),this._renderMenuItems(),this._bindEvents(),this.trigger("posttools:content:render")}}));return C}),define("app/post/posttools/controller/posttools.dismiss.controller",[],function(){"use strict";var e={API:{dismiss:function(e){e.setAction("dismiss",e.get("defaultBlogId"),{success:function(){e.trigger("posttools:post:dismissed"),e.trigger("annotation:remove")}.bind(this),error:function(e){throw new Error("PostTools.dismissPost(): "+e.reason)}})},undismiss:function(e){e.setAction("actionreset",e.get("defaultBlogId"),{success:function(){e.trigger("posttools:post:undismissed")}.bind(this),error:function(e){throw new Error("PostTools.undismissPost(): "+e.reason)}})}}};return e.API}),define("collection/blog.subscribersCollection",["config","underscore","backbone","singleton/CurrentUser"],function(e,t,n,s){"use strict";var o=n.Collection.extend({idCache:[],initialize:function(e,t){if(!t||t&&(!t.blogId||!t.type))throw new Error("Missing options for BlogSubscribersCollection");this.type=t.type,this.blogId=t.blogId,t.userId&&(this.userId=t.userId),0[0]!==t.withNames&&(this.withNames=t.withNames),this.enableShortening=t.enableShortening||!1,this.on("add remove request sync",function(){this.idCache=[]})},parse:function(e){var o=this,s=e&&e.data?e.data:null,n=[];return s&&(n=this.withNames?s.map(function(e){return t.isUndefined(e.id)&&(e.id=e.authorId?e.defaultBlogId:e.blogId),e.sourceBlogId=o.blogId,e}):s.map(function(e){return{id:e}})),this.enableShortening===!0&&n.length>1e3&&(n=n.slice(n.length-1e3,n.length),this.shortened=!0),n},sync:function(o,i,a){var r,c;switch(this.idCache=[],o){case"read":switch(c="GET",i.type){case"followed":r=this.withNames?e.api.profile.url+"/blogfollow/views/followedByWithNames?blogId="+i.blogId:e.api.profile.url+"/blogfollow/views/followedBy?blogId="+i.blogId;break;case"followers":r=e.api.profile.url+"/blogfollow/views/followersOf?blogId="+i.blogId;break;case"followedUsers":r=e.api.profile.url+"/userfollow/views/followedUsers?userId="+i.userId+"&token="+s.get("token");break;case"followedBlogs":r=e.api.profile.url+"/userfollow/views/followedBlogs?userId="+i.userId+"&token="+s.get("token");break;case"blocked":r=this.withNames?e.api.profile.url+"/blogblock/views/byBlogWithNames?blogId="+i.blogId:e.api.profile.url+"/blogblock/views/byBlog?blogId="+i.blogId;break;default:throw new Error("blog.subscribersCollection.sync(): unsupported method in sync")}break;default:throw new Error("blog.subscribersCollection.sync(): unsupported method in sync")}return n.ajax(t.extend({type:c,dataType:"json",url:r},a))},getIds:function(){var e=this.idCache.length;return e&&e===this.length?this.idCache:this.pluck("id")}});return o}),define("templates/tiger/messages/postAction",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.messages.postAction.areYouSureToDelPost=function(){return"Are you sure you want to delete this post?"},s.DEBUG&&(t.messages.postAction.areYouSureToDelPost.soyTemplateName="tiger.messages.postAction.areYouSureToDelPost"),t.messages.postAction.confirmHidePost=function(){return"Are you sure you want to hide this?"},s.DEBUG&&(t.messages.postAction.confirmHidePost.soyTemplateName="tiger.messages.postAction.confirmHidePost"),t.messages.postAction.confirmDismissPost=function(){return"Are you sure you want to dismiss this reply?"},s.DEBUG&&(t.messages.postAction.confirmDismissPost.soyTemplateName="tiger.messages.postAction.confirmDismissPost"),t.messages.postAction.confirmBlockBlog=function(e){return""+("block"==e.action?"Are you sure you want to block "+o.$$escapeHtml(e.username)+" on "+o.$$escapeHtml(e.sitename)+"?":"Are you sure you want to unblock "+o.$$escapeHtml(e.username)+" on "+o.$$escapeHtml(e.sitename)+"?")},s.DEBUG&&(t.messages.postAction.confirmBlockBlog.soyTemplateName="tiger.messages.postAction.confirmBlockBlog"),t.messages.postAction.selfBlockError=function(){return"You should not block yourself."},s.DEBUG&&(t.messages.postAction.selfBlockError.soyTemplateName="tiger.messages.postAction.selfBlockError"),t.messages.postAction.blogBockMember=function(){return"Can't block a member of the blog."},s.DEBUG&&(t.messages.postAction.blogBockMember.soyTemplateName="tiger.messages.postAction.blogBockMember"),t.messages.postAction.postReposted=function(e){return"Shared to "+o.$$escapeHtml(e.blogName)+'. <a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.blogUrl))+'">View &raquo;</a>'},s.DEBUG&&(t.messages.postAction.postReposted.soyTemplateName="tiger.messages.postAction.postReposted"),t.messages.postAction.postScheduledRepost=function(){return"Your post has been scheduled to publish."},s.DEBUG&&(t.messages.postAction.postScheduledRepost.soyTemplateName="tiger.messages.postAction.postScheduledRepost"),t.messages.postAction.repostRemoved=function(){return"Post successfully un-shared from this blog (it may take 1-2 minutes for it to stop displaying)"},s.DEBUG&&(t.messages.postAction.repostRemoved.soyTemplateName="tiger.messages.postAction.repostRemoved"),t.messages.postAction.unsharePost=function(){return"Removed share"},s.DEBUG&&(t.messages.postAction.unsharePost.soyTemplateName="tiger.messages.postAction.unsharePost"),t.messages.postAction.areYouSureToUnschedRepost=function(){return"Are you sure you want to unschedule this repost?"},s.DEBUG&&(t.messages.postAction.areYouSureToUnschedRepost.soyTemplateName="tiger.messages.postAction.areYouSureToUnschedRepost"),t.messages.postAction.postDeleted=function(){return"The post has been deleted successfully."},s.DEBUG&&(t.messages.postAction.postDeleted.soyTemplateName="tiger.messages.postAction.postDeleted"),t.messages.postAction.repostUnscheduled=function(){return"The repost has been unscheduled successfully."},s.DEBUG&&(t.messages.postAction.repostUnscheduled.soyTemplateName="tiger.messages.postAction.repostUnscheduled"),t.messages.postAction.postRecommended=function(){return"You recommended a post."},s.DEBUG&&(t.messages.postAction.postRecommended.soyTemplateName="tiger.messages.postAction.postRecommended"),t.messages.postAction.undoDismissMsg=function(){return"You have successfully dismissed this reply."},s.DEBUG&&(t.messages.postAction.undoDismissMsg.soyTemplateName="tiger.messages.postAction.undoDismissMsg"),t.messages.postAction.undoBlockMsg=function(e){return"You have successfully dismissed this reply and blocked "+o.$$escapeHtml(e.userName)+" from "+o.$$escapeHtml(e.blogName)},s.DEBUG&&(t.messages.postAction.undoBlockMsg.soyTemplateName="tiger.messages.postAction.undoBlockMsg"),t.messages.postAction.undoResolveMsg=function(){return"You have successfully resolved the flag on this reply."},s.DEBUG&&(t.messages.postAction.undoResolveMsg.soyTemplateName="tiger.messages.postAction.undoResolveMsg")}),define("app/post/posttools/controller/posttools.block.controller",["jquery","singleton/CurrentUser","singleton/EventDispatcher","collection/blog.subscribersCollection","templates/tiger/messages/postAction"],function(e,t,n,s){"use strict";var o={_blogsBlockedHash:{},_postIsBlocked:function(e,t){return-1!==t.indexOf(e.get("authorBlogId"))},_blockBlog:function(e,n){var i,a=n.targetBlogId,r=n.confirmation,s=n.blockedBlogCollection,l=e.get("defaultBlogId"),d=n.targetBlogName,u=n.targetAuthorName,c=n.forceAction;"undefined"!=typeof c?(i=c,t.set("forceAction",c)):i=o._postIsBlocked(e,n.blockedBlogIds)?"unblock":"block",("boolean"==typeof r&&r||r({action:i,username:u,sitename:d}))&&t.setBlogAction(i,l,a,{success:function(n){var r,o=t.get("forceAction");n?"block"===i?(s.add({id:a}),s.trigger("posttools:block"),e.trigger("posttools:block")):(r=s.findWhere({id:a}),r&&s.remove(r),s.trigger("posttools:unblock"),e.trigger("posttools:unblock")):("block"===o||"unblock"===o)&&(s.trigger("posttools:"+o),e.trigger("posttools:"+o))},error:function(e,t){var n;switch(t.code){case"BLOG_BLOCK_MEMBER":n=tiger.messages.postAction.blogBockMember;break;default:n=t?t.message:e.reason}o._showErrorMessage(n)}})},_blockedBlogsInitialized:function(t){var n;return o._blogsBlockedHash.hasOwnProperty(t)||(o._blogsBlockedHash[t]=o.API.getBlockedBlogCollection(t)),o._blogsBlockedHash[t].fetched?(n=e.Deferred(),n.resolve(o._blogsBlockedHash[t]),n):(o._blogsBlockedHash[t].fetched=!0,o._blogsBlockedHash[t].fetch())},_showErrorMessage:function(e){n.trigger("successbox:display",{message:e,warningBox:!0,dismissable:!0})},API:{block:function(t,n,s,i,a,r){var c,l=t.get("defaultBlogId"),d=t.get("authorBlogId");return l===d?(o._showErrorMessage(tiger.messages.postAction.selfBlockError),!1):void e.when(o._blockedBlogsInitialized(l)).then(function(){c={targetBlogId:d,blockedBlogIds:n.getIds(),blockedBlogCollection:n,confirmation:s,targetBlogName:i,targetAuthorName:a,forceAction:r},o._blockBlog(t,c)})},getBlockedBlogCollection:function(e){return o._blogsBlockedHash.hasOwnProperty(e)||(o._blogsBlockedHash[e]=new s([],{blogId:e,type:"blocked",withNames:!1})),o._blogsBlockedHash[e]},checkBlockStatus:function(t,n){var s=t.get("defaultBlogId");e.when(o._blockedBlogsInitialized(s)).then(function(){t.trigger("posttools:blockStatusUpdated",o._postIsBlocked(t,n.getIds()))})}}};return window.__karma__&&(o.API.__testonly__=o),o.API}),define("app/post/mixins/post.successMessage",["singleton/Renderer","singleton/EventDispatcher"],function(e,t){"use strict";var n={_displaySuccessMessage:function(n,s){t.trigger("successbox:display",{message:e.renderTemplate(n,s||{})})},_displayChannelMessage:function(n,s){t.trigger("successbox:display",{message:e.renderTemplate(n,s||{}),timeout:5e3})}};return n}),define("app/post/posttools/controller/posttools.like.controller",["jquery","underscore","singleton/CurrentUser","module/KinjaAnalytics","singleton/Utils","app/post/mixins/post.successMessage","templates/tiger/messages/postAction"],function(e,t,n,s,o,i){"use strict";var a={};return a=t.extend(a,i,{_trackRecommendation:function(e,t){var n,r=e.get("isStarter")?"Post":"Comment",i="sharingBottom"===t.$el.attr("data-analytics-target"),a="groupChat"===t.$el.parent().attr("data-analytics-target"),c="permalink"===o.getKinjaMeta().pageType;window.ga("send","event","Recommendation",r+" Recommended",e.get("permalink")),(!c||i||a)&&(o.getKinjaMeta().pageType===o.pageTypes.frontpage?n="homepage":o.getKinjaMeta().pageType===o.pageTypes.dashboard?n="dashboard":i?n="sharingBottom":a&&(n="groupChat"),s.pushEvent("RECOMMENDATION","POST",t.model.get("id"),{uiElement:n}))},_likePost:function(n,s){var o=n.get("liked")?"unlike":"like",i=n.setLike(o,{success:function(e){if("like"===o&&(a._trackRecommendation(n,s),a._displaySuccessMessage(tiger.messages.postAction.postRecommended),!n.get("isStarter")&&!n.get("approved"))){var i=t.pluck(e.response.approvalResult.approvedReplies,"postId"),r=s.model.get("id");-1!==t.indexOf(i,r)&&s.model.set({approved:!0})}},error:function(e){throw new Error("PostTools.likePost(): "+e.reason)}}),r=function(){n.trigger("posttools:post:likeCount:updated")};e.when(i).then(r)},API:{like:function(t,s){return!!e("body").hasClass("read-only")||void n.requireLogin("likePost").done(function(){a._likePost(t,s)})}}}),a.API}),define("apiclient/post",["config","apiclient/apirequest","apiclient/gettoken","singleton/Feature"],function(e,t,n,s){"use strict";var i,o=s.isOn("postsecuretoken")?e.api.core.secureUrl+"/post":e.api.core.url+"/post";return i={create:t.postJson(n.append(o+"/add",s.isOn("postsecuretoken")?n.secure:n.fresh,!0)),read:t.getJson(n.append(o+"/preview/{{id}}",s.isOn("postsecuretoken")?n.secure:n.fresh)),update:t.postJson(n.append(o+"/{{id}}/update",s.isOn("postsecuretoken")?n.secure:n.fresh,!0)),delete:t.postJson(n.append(o+"/{{id}}/delete",s.isOn("postsecuretoken")?n.secure:n.fresh,!0)),generatePostJson:function(e){return t.postJson(n.append(o+e,s.isOn("postsecuretoken")?n.secure:n.fresh,!0))},socialStats:t.getJson(e.api.core.url+"/dfp/post/{{id}}/stats")}}),define("model/post/Post",["config","jquery","backbone","underscore","singleton/CurrentUser","singleton/Utils","apiclient/gettoken","apiclient/post"],function(e,t,n,s,o,i,a,r){"use strict";var c=t("<div />"),d=function(e){var s,t=e.getHours(),n=e.getMinutes(),o=e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear();return 10>t&&(t="0"+t),10>n&&(n="0"+n),s=t+":"+n,{MdyHm:[o,s].join(" ")}},l={dateTimeFormat:/^\d{1,2}\/\d{1,2}\/\d{4} \d{1,2}:\d{2}$/,chompImgType:/img\.gawkerassets\.com\/img\/(\w+)\/[\w-]+\./g},u=n.Model.extend({constructor:function(e){window.__postModelStorage=window.__postModelStorage||{};var t,o,s=window.__postModelStorage,i=0[0]!==e&&0[0]!==e.id&&0[0]!==s,a={};if(i&&0[0]!==s[e.id]){for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&(a[t]=e[t]);return o=s[e.id],o.set(a),o}n.Model.prototype.constructor.apply(this,arguments),i&&(s[e.id]=this)},initialize:function(){l=t.extend(l,{mediaInPost:new RegExp("<("+this.mediaTags.join("|")+")","gim")})},storeInMemory:function(){var e=window.__postModelStorage||{},t=0[0]!==this.id&&0[0]!==e;return t&&0[0]!==e[this.id]?e[this.id].set(this.attributes):e[this.id]=this,this},mediaTags:["img","embed","object","iframe","video","audio","canvas"],defaults:{promoteState:{},publishTime:d(new Date),blogs:new n.Collection,liked:!1},validationRules:{PUBLISHTIME_IS_REQUIRED:function(e){var t=!0;return"SCHEDULED"!==e.status||e.publishTimeMillis||(t=!1),t},POST_CONTENT_IS_REQUIRED:function(e){var n=!0,s=e.headline&&t.trim(c.html(e.headline)),o=e.original&&t.trim(c.html(e.original).text()),i=e.original&&(l.mediaInPost.test(e.original)||c.html(e.original).find("img").length),a=e.hasFile||e.files&&e.files.length;return s||o||i||a||(n=!1),n},POST_CONTENT_CANNOT_CONTAIN_BAD_CONTENT:function(e){var t=!0,n=["form"].join("");return c.html(e.original).find(n).length&&(t=!1),t}},savePipeline:t.Deferred().resolve(),publishTime:function(e){return d(e)},sync:function(e,n,o){var i,c,l,d,u,h;if("create"!==e&&(0[0]===n.id||null===n.id))throw new Error("Post.sync(): Model undefined");switch(n.attributes.meta={},"undefined"!=typeof n.attributes.status&&(n.attributes.meta.status=n.attributes.status),"undefined"!=typeof n.attributes.allowReplies&&(n.attributes.meta.allowReplies=n.attributes.allowReplies),"undefined"!=typeof n.attributes.showByline&&(n.attributes.meta.showByline=n.attributes.showByline),"undefined"!=typeof n.attributes.byline&&(n.attributes.meta.byline=n.attributes.byline),"undefined"!=typeof n.attributes.properties&&(n.attributes.meta.properties=n.attributes.properties),e){case"create":c="POST",l=n.has("parentId")&&""!==n.get("parentId")?"/api/core/post/"+n.get("parentId")+"/jsonReplyWithApproval":"/api/core/post/add",u=JSON.stringify(n);break;case"read":c="GET",l=0[0]!==o.preview&&o.preview===!0?"/api/core/post/preview/"+n.id:0[0]!==o.showcase&&o.showcase===!0?"/api/core/post/showcase/"+n.id:"/api/core/post/"+n.id;break;case"update":c="POST",l="/api/core/post/"+n.id+"/update",u=JSON.stringify(n);break;case"delete":c="POST",l="/api/core/post/"+n.id+"/delete"}return d={type:c,dataType:"json",contentType:"application/json",url:l,data:u||null},i=t.Deferred(),h=i.promise(),a.secure().done(function(a){d.url=d.url+"?token="+a,"delete"===e?r[e]({id:n.id},o).done(i.resolve).fail(i.reject):t.ajax(s.extend(d,o)).done(i.resolve).fail(i.reject)}),h},parse:function(e){if(0[0]===e)throw new Error("Post.parse(): no response to parse");var t={};return t=e.data?e.data:e,0[0]!==t.id&&null!==t.id&&(t.id=parseInt(t.id,10)),t.tagDescriptions=t.tags.map(function(e){return e.description}),t.images&&t.images.length&&(t.images=[]),t},toFormData:function(){var t=["id","headline","original","tags","publishTimeMillis","publishTimeZone","status","blogId","defaultBlogId","annotation.annotationType","annotation.imageUrl","annotation.imageChompId","annotation.imageWidth","annotation.imageHeight","annotation.x","annotation.y","annotation.annotationText","annotation.annotationTextHash","allowReplies","sponsored","showByline","byline","salesAvatar","salesAvatarMap","share","properties","shareBlogId","sharedPostId","images","parentId","adZone"],e=["status","allowReplies","showByline","byline","properties"],n=function(t){var n=t[0],o=t[1];return-1!==s.indexOf(e,n)&&(n="meta."+n),[n,o]},o=s.pick(this.toJSON(),s.union(t,s.map(e,function(e){return"meta."+e}))),i=s.object(s.pairs(o).map(n));return i},getUrl:function(){return 0[0]!==this.get("permalink")?this.get("permalink"):"/"+this.id},getActionState:function(){var e=t.Deferred();return this.has("actionState")?e.resolve():this.getPostInfo().done(function(){e.resolve()}),e.promise()},getPostInfo:function(n){var s,i=this,a=parseInt(this.id,10);if(!o.isLoggedIn())throw new Error("Post.getPostInfo(): user not logged in");return n=n||{},n.success=n.success||function(){},s=[e.api.core.url,"/post/",a,"/actionstatus?token=",o.get("token")].join(""),t.ajax({type:"GET",dataType:"jsonp",jsonp:"jsonp",url:s,success:function(e){200===e.meta.status&&(i.setActionState(e.data),n.success.call(i))}})},isPublished:function(){return"PUBLISHED"===this.get("status")},setAction:function(t,n,s){var o,i={};if(!t||"repost"!==t&&"dismiss"!==t&&"actionreset"!==t)throw new Error("Post:setAction(): Invalid post action: "+t);if(!n)throw new Error("Post:setAction(): Invalid blogId: "+n);return o="repost"===t?e.api.core.url+"/post/"+this.id+"/"+t+"/"+n:"/ajax/post/"+this.id+"/"+t+"/"+n,"repost"===t&&s.publishTimeMillis&&(i.repostTime=s.publishTimeMillis),this.setLikeOrAction(s,t,o,i)},setLikeOrAction:function(e,n,s,i){var r,c,l,d;return e=e||{},i=i||{},e.success=e.success||function(){},e.error=e.error||function(){},o.isLoggedIn()||e.error.call(this,{reason:"user"}),c=t.Deferred(),d=c.promise(),r=this,a.fresh().done(function(o){i.token=o,l="repost"===n?{url:s+"?"+t.param(i),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:"{}"}:{url:s+"?"+t.param(i),type:"POST"},t.ajax(l).done(function(t){0[0]!==t.meta?"repost"===n||"dismiss"===n||"actionreset"===n?(r.setActionState(t.data),e.success.call(r,{response:t.data})):(r.setLikeState(t.data),e.success.call(r,{response:t.data})):e.error.call(r,{reason:"action error"}),c.resolve()}).fail(function(t){e.error.call(this,t.responseJSON,t.status,t.statusText),c.reject(t.responseJSON,t.status,t.statusText)})}),d},setActionState:function(e){var t={};s.each(e,function(e){t[e.blogId]=e.relation.toLowerCase()},this),this.set({actionState:t})},setLike:function(e,t){var n,o=["like","unlike"];if(!e||!s.contains(o,e))throw new Error("Post:setLike(): Invalid post action: "+e);return"like"===e&&(e+="AndApprove"),n="likeAndApprove"!==e?["/api/core/post",this.id,e].join("/"):["/ajax/post",this.id,e].join("/"),this.setLikeOrAction(t,e,n)},setLikeState:function(e){var t=e||{},n=t.like||t;0[0]!==n.objectId&&n.objectId===this.get("id")?this.set({liked:!0}):this.set({liked:!1})},prepareAnnotations:function(){if(this.has("annotation")){var e=this.get("annotation"),n=t().text(e.annotationText),s=170;0[0]===e.annotationShortText&&n.length>s&&(e.annotationShortText=i.cut(n,s))}return this},parseFromDom:function(e){var t=JSON.parse(decodeURIComponent(e.data("model")));return new u(t)},replaceImagesWithOriginal:function(){var e=this.get("display");return this.set("display",e.replace(l.chompImgType,"img.gawkerassets.com/img/$1/original.")),this},validate:function(){var e=[],t=this.toJSON();return t.mode&&s.each(this.validationRules,function(n,s){n(t)||e.push({error:"CLIENT_VALIDATION_ERROR",reason:s})},this),!!e.length&&e},getShareOptionsForUser:function(e){var i=t.Deferred(),n=[],a=[],r=[],o=e.get("defaultBlogId"),c=!1;return this.getActionState().done(function(){s.each(this.get("actionState"),function(e,t){"repost"===e&&n.push(parseInt(t,10))}),c=-1!==s.indexOf(n,o),e.get("membership").each(function(e){e.get("blogId")===o||"ENABLED"!==e.get("blog").status&&"SPAM"!==e.get("blog").status||(-1!==s.indexOf(n,e.get("blog").id)?r.push({name:e.get("blog").displayName,id:e.get("blog").id}):a.push({name:e.get("blog").displayName,id:e.get("blog").id}))},this),i.resolve({repostedTo:n,repostedToPersonal:c,personalBlogId:o,blogsUndo:r,blogsRepost:a})}.bind(this)),i.promise()}});return u}),define("app/post/posttools/controller/posttools.hide.controller",["config","jquery","singleton/Feature","singleton/CurrentUser","model/post/Post"],function(e,t,n,s,o){"use strict";var i={API:{hide:function(i,a){var l=i.get("id"),d=e.api.core.url+"/post/"+l+"/hide?token="+s.get("token"),r=null,c="/";s.isSuperuser()&&n.isOn("superuser")&&a()&&(i.has("parentId")&&(r=new o({id:i.get("parentId")}),c=r.has("permalink")?r.get("permalink"):"/"+r.id),t.ajax({url:d,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){0[0]!==e.meta&&e.meta.success===!0&&window.setTimeout(function(){window.location.href=c},1e3)}}))}}};return i.API}),define("templates/tiger/components/fullscreen-spinner",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.fullscreenSpinner=function(e,n,s){return'<div class="loading-full animate"><div class="loading-message-box">'+t.components.spinner.bounce(null,null,s)+"</div></div>"},s.DEBUG&&(t.components.fullscreenSpinner.soyTemplateName="tiger.components.fullscreenSpinner")}),define("view/Spinner",["jquery","view/BaseView","templates/tiger/components/spinner","templates/tiger/components/fullscreen-spinner"],function(e,t){"use strict";var n=t.extend({visible:!0,fullscreen:!1,tagName:"div",className:"spinner-wrapper",initialize:function(e){this.visible=0[0]===e.initiallyVisible||e.initiallyVisible,this.fullscreen=0[0]!==e.fullscreen&&e.fullscreen,this.render()},render:function(){var t;return this.visible&&(t=this.fullscreen?this.soyToHtml(tiger.components.fullscreenSpinner):this.soyToHtml(tiger.components.spinner.bounce,{})),this.$el.html(t),this.fullscreen?e(this.el).find(".animate").addClass("in"):e(this.el).addClass("with-margin"),this}});return n}),define("apiclient/repost",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";return{unschedule:t.postJson(n.append(e.api.core.url+"/blog/{{blogId}}/removeRepostJob/{{postId}}")),reschedule:t.postJson(n.append(e.api.core.url+"/blog/{{blogId}}/updateRepostJob/{{postId}}?repostTime={{repostTime}}"))}}),define("app/post/posttools/posttools.controller",["jquery","underscore","singleton/CurrentUser","singleton/EventDispatcher","singleton/Feature","singleton/Utils","singleton/util/loadEditor","module/KinjaAnalytics","view/BaseView","app/post/common/post.layout","app/post/mixins/post.confirmationPrompt","app/post/posttools/posttools.menuview","app/post/posttools/controller/posttools.dismiss.controller","app/post/posttools/controller/posttools.block.controller","app/post/posttools/controller/posttools.like.controller","app/post/posttools/controller/posttools.hide.controller","module/flagging/ReplyFlaggingModule","app/post/mixins/post.successMessage","app/MarionetteApp","view/Spinner","apiclient/repost","templates/tiger/messages/postAction"],function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y){"use strict";var _=t.extend({},d,v,{_openSpinnerUntil:function(n,s){s=t.defaults({},{fullscreen:!0});var o=new j(s);return o.$el.appendTo("body"),e.when(n).then(o.remove.bind(o))},_like:function(e){e.model.get("tags")&&e.model.get("tags").length&&o.isOn("channels")&&!e.model.get("liked")&&b.vent.trigger("add:channel",{channelName:e.model.get("tags")[0].name,url:e.model.get("tags")[0].urlName}),f.like(e.model,e.view)},_reply:function(){require(["module/DiscussionModule"],function(e){e.replyToStarterPost()})},_dismiss:function(e){_._confirmationPrompt(tiger.messages.postAction.confirmDismissPost)&&h.dismiss(e.model)},_undismiss:function(e){h.undismiss(e.model)},_getDismissState:function(e){e.model.getActionState()},_delete:function(e){var n,s=e.model,o=this,a="dashboard"===i.getKinjaMeta().pageType||"manageblog"===i.getKinjaMeta().pageType;_._confirmationPrompt(tiger.messages.postAction.areYouSureToDelPost)&&(s.on("destroy",function(){o._displaySuccessMessage(tiger.messages.postAction.postDeleted),n=function(){window.location=a?window.location.pathname:c.prototype.cachebuster.call(c.prototype,"/")},t.delay(n,2e3)}),s.destroy({wait:!0}))},_unscheduleRepost:function(e){var n=this,s=e.view.el.getAttribute("data-postid"),o=e.view.el.getAttribute("data-blogid"),a=function(){window.location="private"===i.getKinjaMeta().pageType?window.location.pathname:c.prototype.cachebuster.call(c.prototype,"/")},r=function(){n._displaySuccessMessage(tiger.messages.postAction.repostUnscheduled),t.delay(a,2e3)};_._confirmationPrompt(tiger.messages.postAction.areYouSureToUnschedRepost)&&y.unschedule({postId:s,blogId:o}).done(r)},_promote:function(e){var t=e.model.id,s=n.hasPermission("SALES")||n.isSuperUser(),o=window.location.port?"http://kinja.dev:9000":"http://kinja.com";s&&(window.location.href=o+"/dfp/promotions/"+t)},_checkBlockStatus:function(e){m.checkBlockStatus(e.model,e.collection)},_postIsBlocked:function(e,t){return-1!==t.indexOf(e.get("authorBlogId"))},_block:function(e){var t=function(e){return _._confirmationPrompt(tiger.messages.postAction.confirmBlockBlog,e)};m.block(e.model,e.collection,t,e.targetBlogName,e.targetAuthorName)},_hide:function(e){var t=function(){return _._confirmationPrompt(tiger.messages.postAction.confirmHidePost)};p.hide(e.model,t)},_unflag:function(e){g.unflag(e,e.model)},_kinjaShare:function(e){var t;n.requireLogin("kinjaSharePost").done(function(){t=function(){return a().then(function(t){t.sharePost(e)})},e.has("original")?this._openSpinnerUntil(t()):this._openSpinnerUntil(e.fetch({success:t,preview:"PUBLISHED"!==e.get("status")}).then(t)),r.pushEvent("SHARE","POST",e.get("id"),{uiElement:"dropdown"})}.bind(this))},_externalShare:function(e){var n=e.view.$(".js_share-post-item"),o=n.attr("href"),i={twitter:"toolbar=0,status=0,width=480,height=360",facebook:"toolbar=0,status=0,width=480,height=360",tumblr:"toolbar=0,status=0,width=450,height=430"},s=t.intersection(n.attr("class").split(/\s+/),["twitter","facebook","tumblr"])[0];window.open(o,"share"+s,i[s])},_repost:function(e,t){var o="repost",i=this,s=n.get("membership").find(function(e){return e.get("blogId")===parseInt(t,10)});e.setAction(o,t,{success:function(){i._displaySuccessMessage(tiger.messages.postAction.postReposted,{blogName:s.get("blog").displayName,blogUrl:"http://"+s.get("blog").canonicalHost})},error:function(e){throw new Error("PostTools.repostPost(): "+e.reason)}})},_undoRepost:function(e){var t="actionreset",n=e.targetBlogId,s=e.model,o=this;s.setAction(t,n,{success:function(){o._displaySuccessMessage(tiger.messages.postAction.repostRemoved)},error:function(e){throw new Error("PostTools.undoRepost(): "+e.reason)}})},_openPupilModal:function(){var t=e.Deferred();return require(["app/pupil/PupilController"],function(e){e.show().then(t.resolve.bind(t))}.bind(this)),this._openSpinnerUntil(t)},_bindEvents:function(e,t){e.on("posttools:like",this._like.bind(this)),e.on("posttools:reply",this._reply.bind(this)),t.on("posttools:dismiss",this._dismiss.bind(this)),t.on("posttools:undismiss",this._undismiss.bind(this)),t.on("posttools:getDismissState",this._getDismissState.bind(this)),t.on("posttools:delete",this._delete.bind(this)),t.on("posttools:promote",this._promote.bind(this)),t.on("posttools:block",this._block.bind(this)),t.on("posttools:checkBlockStatus",this._checkBlockStatus.bind(this)),t.on("posttools:hide",this._hide.bind(this)),t.on("posttools:unflag",this._unflag.bind(this)),t.on("posttools:kinjaShare",this._kinjaShare.bind(this)),t.on("posttools:externalShare",this._externalShare.bind(this)),t.on("posttools:repost",this._repost.bind(this)),t.on("posttools:undorepost",this._undoRepost.bind(this)),t.on("close",function(){n.off(null,null,t),s.off(null,null,t),t.model.off(null,null,t)}),t.on("posttools:menuview:togglehidden",function(t){e.togglePostToolsVisibility(t)}),t.on("reposttools:unschedule",this._unscheduleRepost.bind(this)),t.on("posttools:pupil",this._openPupilModal.bind(this))},API:{startPostTools:function(e,t){var r="undefined"!=typeof t.get("defaultBlogId")?t.get("defaultBlogId"):i.getKinjaMeta().blog.id,o=new u({el:e.find(".js_post-dropdown-ct"),model:t,blockedBlogCollection:m.getBlockedBlogCollection(r)}),a=new l({el:e,model:t});a.post.attachView(o),a.bindUIElements(),a.updateUserState(),_._bindEvents(a,o),s.on("posttools:close:"+t.get("id"),function(){o.close()}),n.onAuth.done(o.render.bind(o))},closePostTools:function(e){s.trigger("posttools:close:"+e)},bindEvents:function(e,t){_._bindEvents(e,t)}}});return _.API}),define("view/PostView",["jquery","underscore","view/BaseView","singleton/PostInsetTools","singleton/Utils","singleton/EventDispatcher","singleton/Feature","app/post/posttools/posttools.controller","view/SuccessBox"],function(e,t,n,s,o,i,a,r,c){"use strict";var l=n.extend({postTool:null,events:{"click .lazy-gif.thawable":"thawImage"},initialize:function(){this.$(".item-content").on("click",this.navigateToArticle.bind(this)),this.$(".js_read-more").on("click",this.gaTrackClick.bind(this)),this.$(".js_entry-title").on("click",this.gaTrackClick.bind(this)),this.$(".js_meta-byline a").on("click",this.gaTrackClick.bind(this)),this.$(".js_marquee-asset a").on("click",this.gaTrackClick.bind(this)),this.$(".js_publish_time").on("click",this.gaTrackClick.bind(this)),this.handleCustomIframes()},start:function(){return r.startPostTools(this.$el,this.model),"permalink"===o.getKinjaMeta().pageType&&(a.isOn("webpack")?require.ensure(["gawkerlib/lightboxer","lib/amd-wrapped/jquery.lightbox-0.5"],function(e){var t=e("gawkerlib/lightboxer");t(this.$el)}.bind(this)):require(["gawkerlib/lightboxer","lib/amd-wrapped/jquery.lightbox-0.5"],function(e){e(this.$el)}.bind(this))),this.fixMarkup(),e.cookie("editor_warnings")&&this.showEditorWarnings(),this},showEditorWarnings:function(){var n,o,s=JSON.parse(e.cookie("editor_warnings")),i=/(http(s)?:\/\/[a-zA-Z0-9-_]+\.[a-zA-Z]+(.)+)+/gi,r=s.length;s&&(e.removeCookie("editor_warnings"),t.each(s,function(e,t){n=e.message.match(i),o=e.message.replace(i,"");var s=new c({message:o+'<br/><a href="'+n+'" target="_blank">'+n+"</a>",permanent:!0,warningBox:!0,hidden:a.isOn("editor_warnings_collapsed")&&t>0});s.render(),a.isOn("editor_warnings_collapsed")&&0===t&&r>1&&s.attachMoreWarningsBox(r)}))},fixMarkup:function(){if("permalink"!==this.getPageType())return!1;var n=this;t.each(this.$el.find(".referenced ~ .content-ad"),function(t){var n=e(t);n.appendTo(n.prev())}),this.$el.find("blockquote .inset_placeholder").each(function(){e(this).closest("blockquote").before(this)}),s.render(this.$el),this.$el.find(".js_reel").each(function(){n.createReel(this)}),this.$el.find(".js_slider").each(function(){var t=e(this),s=t.attr("data-uri1"),o=t.attr("data-uri2"),i=t.attr("data-percent");n.renderSlider(t,s,o,i)})},renderSlider:function(t,n,s,i){function d(e,t){var n=t-e;return 6>n&&(n=6),n>630&&(n=630),n}function u(e,t,n,s){s&&(t.stop().animate({width:e},0),n.stop().animate({right:628-e},0))}var a,h=640*i*.01,f=o.imageUrl(n,"k-bigpic"),p=o.imageUrl(s,"k-bigpic"),g=e('<div id="sliderBottom" style="background-image: url('+p+');"></div>'),c=e('<div id="sliderTop" style="background-image: url('+f+');"></div>'),l=e('<div id="sliderArrows"></div>'),r=!1,m=t.offset().left;t.html('<div id="slider"></div>').append(g,c,l),a=t.find("#slider"),c.stop().animate({width:h},1e3),l.stop().animate({right:628-h},1e3),a.bind("mousedown touchstart",function(e){r=!0;var t=d(m,e.pageX);return u(t,c,l,r),a.bind("mousemove touchmove",function(e){var t=d(m,e.pageX);u(t,c,l,r)}),!1}).bind("mouseup touchend",function(){r=!1,a.stop()}).mouseleave(function(){r=!1,a.stop()})},remove:function(){r.closePostTools(this.model.get("id"))},render:function(){return this},createReel:function(t){var n,s,o=e(t),r=636,h=Math.round(r/(16/9)),c=[],i={},l=o.data("url"),d=o.data("cols"),a=o.data("rows"),u=e('<img class="greel" src="'+l+'A00.jpg" alt="" width="'+r+'" height="'+h+'" />');for(o.append(u),s=0;a>s;s++)for(n=0;d>n;n++)c.push(String.fromCharCode(s+65)+(10>n?"0":"")+n+".jpg");i={frames:d,path:l,images:c,cw:!0,revolution:{x:300,y:100},inversed:!0,suffix:"",wheelable:!1},1!==a&&(i.rows=a),require(["lib/amd-wrapped/jquery.reel"],function(){u.one("load",function(){e(this).reel(i)})})},truncatePostText:function(e,t){var a=t?"":"&hellip;",s=e||320,i=this.$el.find(".read-more").detach(),n=this.$el.find("p.first-text");n.text().length>s&&n.html(o.cutHtml(n.html(),s,a)),n.append(i)},truncateWidePostText:function(e,t){this.$el.parent().hasClass("wide")&&this.truncatePostText(e,t)},navigateToArticle:function(t){if(2!==t.button){var n,s=e(t.target);if(!s.parents(".thumb-inset").length&&!s.closest(".js_post-menu-toggler").length&&!s.closest("a").attr("href")){if(n=this.$(".js_read-more").attr("href"),this.gaTrackClick(),1===t.button||t.ctrlKey||t.metaKey||"dashboard"===o.getKinjaMeta().pageType)return window.open(n,"_blank"),!1;window.location=n}}},thawImage:function(t){t.preventDefault(),i.trigger("thawImage",{$el:e(t.target)})},gaTrackClick:function(){var n=t.indexOf(e(".post-list .js_post_item"),this.$el[0])+1;n>0&&23>n&&window.ga("send","event","Front page click","Front page post click","position - "+n)},handleCustomIframes:function(){var t=e("iframe.custom.aspect");t.each(function(){var t=e(this);t.data("aspectRatio",t.height()/t.width()).removeAttr("height").removeAttr("width")}),t.length&&e(window).resize(function(){t.each(function(){var t=e(this),n=t.parent().width();t.width(n).height(n*t.data("aspectRatio"))})}).resize()}});return l}),define("view/posttools/ApproveToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","model/post/Post","singleton/CurrentUser","singleton/CurrentBlog"],function(e,t,n,s,o,i,a){"use strict";var r,c;return r=function(e,n,s){return t.map(n,function(t){var n=s?'[data-sourceblogid="'+s+'"]':"";return"."+e+'[data-blogid="'+t+'"]'+n}).join(", ")},c=s.extend({events:{"click .js_followforblog":"followUserForBlog","click .js_unfollowforblog":"unfollowUserForBlog"},initialize:function(){var e=t.debounce(this.update,1e3);i.onAuthStateChange(e.bind(this)),this.on("update",e,this)},update:function(n){var s;return n=n||{},s=n.el||e("body"),i.onAuth.done(function(){if(i.isLoggedIn()){var o=function(t){return parseInt(e(t).data("blogid"),10)},n=s.find(".js_follow-controls"),a=t.without(t.unique(t.map(n,o)),0[0]);this.updateBlogFollows(a,n)}}.bind(this)),this},updateBlogFollows:function(e,n){var s=function(n){(i.hasRole("AUTHOR",n)||i.isSuperuser())&&a.getFollowedBlogIds().done(function(){var s=t.intersection(a.followedBlogIds,e),o=t.difference(e,s);this.updateFollowState(s,"follow",n),this.updateFollowState(o,"unfollow",n)}.bind(this))};t.chain(n).union([a.id]).unique().compact().each(s,this)},followUserForBlog:function(t){var s=e(t.currentTarget).closest(".js_follow-controls");return n.pushEvent("FOLLOW","USER",s.data("blogid"),{uiElement:"groupChat"}),this.followReplyAction("blogfollow",t),!1},unfollowUserForBlog:function(e){return this.followReplyAction("unfollow",e),!1},followReplyAction:function(n,s){var c,d,l=e(s.currentTarget).closest(".js_follow-controls"),h=l.data("postid"),r=l.data("blogid"),u=function(){var e=a.id;return r!==i.get("defaultBlogId")&&void i.setBlogAction(n,e,r,{success:function(e){var s;c=new o({id:h}),"blogfollow"===n&&!c.get("isStarter")&&!c.get("approved")&&e.data&&e.data.approvedReplies&&(d=t.pluck(e.data.approvedReplies,"postId"),l.closest(".js_reply").trigger("approval",{approvedReplyIDs:d})),s="unfollow"===n?t.without(a.followedBlogIds,r):t.union(a.followedBlogIds,[r]),a.followedBlogIds=s,this.update()}.bind(this),error:function(e){throw new Error("PostTools.followBlog(): "+e.reason)}})}.bind(this);i.requireLogin("blogFollowTool").done(function(){u()})},updateFollowState:function(e,t,n){this.updateFollowControls(e,t,n)},updateFollowControls:function(t,n,s){var o=r("js_follow-controls",t,s);this.$(o).each(function(t,s){var a=e(s),r=parseInt(a.data("blogid"),10),o=i.get("defaultBlogId")===r;a.find(".js_followforblog").toggleClass("hide","follow"===n||o).end().find(".js_unfollowforblog").toggleClass("hide","unfollow"===n||o)})},removeControls:function(t){t=t||e("body"),t.find(".js_followforblog, .js_unfollowforblog").addClass("hide")}})}),define("view/posttools/UserFollowToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","singleton/CurrentUser"],function(e,t,n,s,o){"use strict";var i,a;return i=function(e,n){return t.map(n,function(t){return"."+e+'[data-authorid="'+t+'"]'}).join(", ")},a=s.extend({events:{"click .js_followforuser":"followUserForUser","click .js_unfollowforuser":"unfollowUserForUser"},initialize:function(){var e=t.debounce(this.update,1e3);o.onLoggedIn.done(e.bind(this)),this.on("update",e,this)},update:function(t){var n,s;return t=t||{},s=t.el||e("body"),n=o.get("followedAuthorIds"),this.toggleMarker(n,"follow"),this.updateUserFollows(n,"follow"),this},updateUserFollows:function(n,s){var a=i("js_user-follow-controls",t.without(n,o.id)),r=e('.js_user-follow-controls[data-authorid="'+o.id+'"]');r.find(".js_followforuser, .js_unfollowforuser").addClass("hide"),e(a).find(".js_followforuser").toggleClass("hide","follow"===s).end().find(".js_unfollowforuser").toggleClass("hide","unfollow"===s)},followUserForUser:function(e){return this.userfollowAction(e),!1},unfollowUserForUser:function(e){return this.userunfollowAction(e),!1},userfollowAction:function(t){var a=e(t.currentTarget).closest(".js_user-follow-controls"),s=a.attr("data-authorid"),i=e(t.currentTarget).attr("data-analytics-target");i&&n.pushEvent("FOLLOW","USER",s,{uiElement:i}),o.requireLogin("userfollow").done(function(){o.followUser(s).done(function(){this.toggleMarker([s],"follow"),this.updateUserFollows([s],"follow")}.bind(this))}.bind(this))},userunfollowAction:function(t){var s=e(t.currentTarget).closest(".js_user-follow-controls"),n=s.attr("data-authorid");o.requireLogin("authorunfollow").done(function(){o.unfollowUser(n).done(function(){this.toggleMarker([n],"unfollow"),this.updateUserFollows([n],"unfollow")}.bind(this))}.bind(this))},toggleMarker:function(e,t){var n=i("js_author",e);this.$(n).toggleClass("followed","follow"===t)},resetControls:function(t){t=t||e("body"),t.find(".js_followforuser").removeClass("hide"),t.find(".js_unfollowforuser").addClass("hide")},removeAvatarMarker:function(t){t=t||e("body"),t.find(".js_author").removeClass("followed")},removePlaceholderBtn:function(t){t=t||e("body"),t.find(".js_list-control__empty").addClass("hide")}})}),define("apiclient/likestate",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";var s;return s={getForPosts:t.getJson(n.append(e.api.core.url+"/like/status"),{}),getForStarter:t.getJson(n.append(e.api.core.url+"/like/{{starterId}}"),{})}}),define("singleton/PostHelper",["jquery","underscore","singleton/CurrentUser","model/post/Post","apiclient/likestate"],function(e,t,n,s,o){"use strict";var i={parsePostModelDataFromDom:function(e){return JSON.parse(decodeURIComponent(e.data("model")))},parseFromDom:function(n){var i,o=[];return i=t.isUndefined(n)?e("body").find(".js_post_item, .js_reply, .js_event_item"):n.is(".js_post_item, .js_reply, .js_event_item")?n:n.find(".js_post_item, .js_reply, .js_event_item"),t.each(i,function(t){var n=e(t),i={};0[0]!==n.data("model")?(i=this.parsePostModelDataFromDom(n),o.push({model:new s(i),node:n})):0[0]!==n.data("id")&&o.push({model:new s({id:n.data("id")}),node:n})},this),o},likeStatusFor:function(e){var s=t.map(e,function(e){return e.model.id});n.onAuth.done(function(){return!!(n.isLoggedIn()&&s)&&void o.getForPosts({id:s},{traditional:!0}).done(function(n){t.each(n,function(n){var o=n.objectId,s=t.find(e,function(e){return e.model.id===o});s&&s.model.setLikeState(n)})})}.bind(this))},getContentType:function(e){return e.get("contentType")}};return i}),define("app/mixins/PostViewLoader",["jquery","underscore","view/PostView","view/posttools/ApproveToolView","view/posttools/BlogFollowToolView","view/posttools/UserFollowToolView","singleton/PostHelper"],function(e,t,n,s,o,i,a){"use strict";var r={followtool:null,initPostTools:function(){var t=e("body");this.on("update.postlist.post",this.addPosts,this),this.userfollowtool=new i({el:t}),this.blogfollowtool=new o({el:t}),this.approvetool=new s({el:t}),this.on("update.follows",this.addFollowButtons,this),this.addPosts({el:e("body")})},addFollowButtons:function(e){this.userfollowtool.trigger("update",{el:e.el}),this.blogfollowtool.trigger("update",{el:e.el}),this.approvetool.trigger("update",{el:e.el})},addPosts:function(s){var o,i;s=s||{},i=s.el||e("body"),o=a.parseFromDom(i),t.each(o,function(e){var t=new n({model:e.model,el:e.node});t.start(),s.callback&&s.callback.call(this,t)},this),o.length>0&&a.likeStatusFor(o),this.addFollowButtons({el:i})}};return r}),define("apiclient/recommendation",["config","apiclient/apirequest","apiclient/gettoken"],function(e,t,n){"use strict";return{recommendPost:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/recommendAsset")),unrecommendPost:t.postJson(n.append(e.api.core.url+"/post/{{postId}}/unrecommendAsset"))}}),define("templates/tiger/components/post/button/recommend-button",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.post.button.recommendButton=function(e,n,s){var i="",a=e.assetId?e.assetId:"";return i+='<a href="#" class="recommend js_recommend '+o.$$escapeHtmlAttribute(e.type)+"-recommend js_"+o.$$escapeHtmlAttribute(e.type)+"-recommend "+(e.isActive?" active ":"")+' readonly-hide icon--svg" data-asset-source="'+o.$$escapeHtmlAttribute(e.assetSource)+'" data-asset-id="'+o.$$escapeHtmlAttribute(a)+'"'+(e.isRecommendable?'title="Recommend':"video"==e.type?'title="Recommend (WARNING: Minimum recommended front page video thumbnail size is 640×360. This video has a smaller thumbnail. Visual degradation may occur.)':'title="Recommend (WARNING: Minimum recommended front page image size is 640×360. This '+o.$$escapeHtmlAttribute(e.type)+" is smaller. Visual degradation may occur.)")+'">'+t.icons.essential.star(null,null,s)+"</a>"},s.DEBUG&&(t.components.post.button.recommendButton.soyTemplateName="tiger.components.post.button.recommendButton")}),define("app/mixins/RecommendAssetMixin",["jquery","underscore","singleton/EventDispatcher","singleton/Utils","view/BaseView","model/post/Post","apiclient/recommendation","templates/tiger/components/post/button/recommend-button","templates/tiger/messages"],function(e,t,n,s,o,i,a){"use strict";var r=o.extend({initialize:function(e){this.model=e.model,this.assets=this.filterAssets(this.model),this.renderUI()},filterAssets:function(e){var n=t.compact(t.map(e.get("images"),this.filterAndCreateImageObject,this)),s=t.compact(t.map(e.get("videos"),this.createVideoObject,this));return n.concat(s)},filterAndCreateImageObject:function(e){var n,s;return n=null!==e.id?e.id:"",s=n?this.$('[data-chomp-id="'+n+'"]'):this.$('[src="'+(null!==e.src?e.src:"")+'"]'),t.extend(e,{$el:s,type:"image"})},createVideoObject:function(e){var n=e.src.split("#")[0],s=this.$('[data-recommend-id="'+n+'"]');return t.extend(e,{$el:s,type:"video"})},recommendAsset:function(e,t){var n=t?"image://"+String(t):e;return a.recommendPost({postId:this.model.get("id"),assetUri:n}).then(this.updateAssetsData.bind(this)).then(this.renderUI.bind(this))},unrecommendAsset:function(e,t){var n=t?"image://"+String(t):e;return a.unrecommendPost({postId:this.model.get("id"),assetUri:n}).then(this.updateAssetsData.bind(this)).then(this.renderUI.bind(this))},updateAssetsData:function(e){var t=new i(e);this.assets=this.filterAssets(t)},renderUI:function(){this.$(".js_post_item").find(".js_recommend").remove(),this.renderRecommendButtons(),this.bindRecommendEvents()},renderRecommendButtons:function(){t.each(this.assets,function(e){this.renderRecommendButton(e)},this)},renderRecommendButton:function(t){var n,o=tiger.components.post.button.recommendButton,i={isActive:t.recommended,type:t.type,assetId:0[0]!==t.id?String(t.id):"",assetSource:t.src||t.uri,isRecommendable:this.calcRecommendability(t)},s=this.soyToHtml(o,i);switch(t.type){case"image":n=t.$el.closest(".img-border"),0===n.length&&(n=t.$el.closest(".columns"),e(s).addClass("marquee-recommend-btn"));break;case"video":n=t.$el.closest(".flex-video")}n.append(s)},calcRecommendability:function(e){var n=!1,t=s.getKinjaMeta();return n=e.thumbnails&&e.thumbnails.length?e.thumbnails[0].width>=t.imageSizes.KinjaExtraLarge.width:e.width>=t.imageSizes.KinjaExtraLarge.width},displayRecommendMessage:function(){n.trigger("successbox:display",{message:tiger.messages.assetRecommended})},displayUnrecommendMessage:function(){n.trigger("successbox:display",{message:tiger.messages.assetUnrecommended})},bindRecommendEvents:function(){this.$(".js_post-wrapper").off("click",".js_recommend"),this.$(".js_post-wrapper").on("click",".js_recommend",this.recommendClickHandler.bind(this))},recommendClickHandler:function(t){var n=e(t.currentTarget);return this.handleRecommendation(n.data("asset-source"),n.data("asset-id")),!1},handleRecommendation:function(n,s){var i=t.find(this.assets,function(e){return e.recommended===!0}),a=null,r=null,o=null;i&&(a=i.src||i.uri,r=i.id),a?(o=e.when(this.unrecommendAsset(a,r)),a===n?o.then(this.displayUnrecommendMessage):t.delay(function(){o.then(this.recommendAsset(n,s)),o.then(this.displayRecommendMessage)}.bind(this),600)):(o=e.when(this.recommendAsset(n,s)),o.then(this.displayRecommendMessage))}});return{startRecommendAssetMixin:function(e){if(e){var t,n=e.has("images")&&e.get("images").length>0,s=e.has("videos")&&e.get("videos").length>0;(n||s)&&(t=new r({model:e,el:this.el}))}}}}),define("view/ImageLoader",["jquery","underscore","singleton/EventDispatcher","view/BaseView","singleton/Feature","lib/waypoints","lib/jquery.browser.mobile"],function(e,t,n,s,o){"use strict";var r=e(document),a=e(window),c={initialLookaheadFactor:.8,lookaheadFactor:2.6,containerClass:"lazy-image"},i="loaded",l=s.extend({$allWrappers:e(),$allImages:e(),_watchedImages:[],viewportHeight:0,scrollTop:0,initialize:function(e){this.options=t.defaults(e||{},c),t.bindAll(this,"loadIfVisible","handleScroll","handleScrollNew"),this.registerImages(this.$el),this.addScrollEvents(),n.on("rendered.postlist.reply",function(e){this.registerImages(e.el)}.bind(this))},registerImages:function(n){var s=this.options.containerClass,o=n.find("."+s),i=o.find("img, iframe");this.$allWrappers=this.$allWrappers.add(o),this.$allImages=this.$allImages.add(i),this._watchedImages=this._watchedImages.concat(t.map(i,function(t){var n=e(t);return[n,n.outerHeight(),n.offset().top]})),this.$allImages.each(function(t,n){var o=e(n);o.data("wrapper",o.closest("."+s))}),this.trigger("images:registered")},addScrollEvents:function(){var n=t.bind(function(){this.viewportHeight=e.waypoints("viewportHeight")},this);n(),a.resize(t.debounce(n,1e3)),o.isOn("imageloader")?(a.scroll(t.throttle(t.partial(this.handleScrollNew,this.options.lookaheadFactor),500)),this.handleScrollNew(this.options.initialLookaheadFactor)):(a.scroll(t.throttle(t.partial(this.handleScroll,this.options.lookaheadFactor),500)),this.handleScroll(this.options.initialLookaheadFactor))},loadImage:function(t){var n=e(t);n.data(i)||this.waitForPlaceholder(n)},reinitializeInterchange:t.once(function(){e(document).foundation("interchange")}),updateInterchange:t.throttle(function(){this.reinitializeInterchange(),e(document).foundation("interchange","reflow")},150),_loadImage:function(e){var n,s=e.data("src"),o=e.data("lazyInterchange");this.trigger("imageLoading",{$el:e}),n=t.bind(function(){e.off("load",n).addClass("lazy-loaded"),this.trigger("imageLoaded",{$el:e}),this._watchedImages=this._watchedImages.filter(function(t){return!e.is(t[0])})},this),e.load(n).data(i,!0),s?e.attr("src",s):o?(e.attr("data-interchange",o),this.updateInterchange()):e.load()},waitForPlaceholder:function(e){var n,s="await-placeholder",o=e.data("wrapper");o.hasClass("asset-loading")?e.data(s)||(e.data(s,!0),n=t.bind(function(){e.off("load",n),this._loadImage(e)},this),e.load(n)):this._loadImage(e)},loadIfVisible:function(e,t,n){!e.data(i)&&this.inViewPort(e,t,n)&&this.loadImage(e)},loadIfVisibleNew:function(e,t,n,s){!e.data(i)&&this.inViewPortNew(e,t,n,s)&&this.loadImage(e)},inViewPort:function(e,t,n,s){var o=this.scrollTop,c=s||this.options.lookaheadFactor,i=this.viewportHeight,a=i*c,l=o+i+a,d=o-a,r=Math.round(n),u=Math.round(r+t),h=u>d,m=l>r;return h&&m},inViewPortNew:function(e,t,n,s){var o=this.scrollTop,c=s||this.options.lookaheadFactor,i=this.viewportHeight,a=i*c,l=o+i+a,d=o-a,r=Math.round(n),u=Math.round(r+t),h=u>d,m=l>r;return h&&m},handleScrollNew:function(e){this._watchedImages.length&&(this.scrollTop=window.pageYOffset||r.scrollTop(),t.each(this._watchedImages,function(t){var n=t[0],s=t[1],o=t[2];this.loadIfVisibleNew(n,s,o,e)},this))},handleScroll:function(e){this._watchedImages.length&&(this.scrollTop=window.pageYOffset||r.scrollTop(),t.each(this._watchedImages,function(t){var n=t[0],s=t[1],o=t[2];this.loadIfVisible(n,s,o,e)},this))}});return l}),define("view/GifImageLoader",["jquery","underscore","singleton/EventDispatcher","singleton/Feature","view/ImageLoader","lib/jquery.browser.mobile","templates/tiger/components/spinner"],function(e,t,n,s,o){"use strict";var i,a={mobileGifs:!0,gifClass:"lazy-gif",thawableClass:"thawable",thawingClass:"thawing",thawedClass:"thawed"};return i=o.extend({initialize:function(e){t.extend(this.options,t.defaults(e||{},a)),this.addEvents(),this.on("images:registered",this.markImagesThawable),o.prototype.initialize.apply(this,arguments)},addEvents:function(){var o=this.options.gifClass,t=function(e){return e.data("wrapper").hasClass(o)};e.browser.mobile||(s.isOn("webm")||this.on("imageLoading",function(n){var s=n.$el,o=new Image,i=s.data("anim-src");t(s)&&e(o).attr("src",i)},this),this.on("imageLoaded",function(e){var n=e.$el;t(n)&&this.thawImage(n)},this)),n.on("thawImage",function(e){var t=e.$el;"IMG"!==t.prop("tagName")&&(t=t.find("img")),this.thawImage(t)},this)},markImagesThawable:function(){var t=this.options;e.browser.mobile&&t.mobileGifs&&this.$allWrappers.addClass(t.thawableClass)},thawImage:function(t){var n,o,i,a;s.isOn("webm")?(n=e("<video>"),a=n[0].canPlayType("video/webm")?t.data("webm-src"):t.data("mp4-src"),n.attr({autoplay:!0,controls:e.browser.mobile,loop:!0,muted:!0,src:a,poster:t.attr("src"),class:t.attr("class"),style:t.attr("style"),width:t.attr("width"),height:t.attr("height"),"data-chomp-id":t.data("chomp-id")}),n.data("wrapper",t.data("wrapper")),this.startLoadIndicator(n),t.replaceWith(n)):(o=t.data("animSrc")||t.data("assetUrl"),i=t.data("animInterchange"),this.startLoadIndicator(t),o&&t.attr("src",o),i&&(t.attr("data-interchange",i),this.updateInterchange()))},startLoadIndicator:function(t){var o=e(t),i=o.data("wrapper"),n=this.options,a=function(){i.removeClass(n.thawingClass).addClass(n.thawedClass),r.remove()},r=e(tiger.components.spinner.gifthaw()).appendTo(i);i.removeClass(n.thawableClass).addClass(n.thawingClass),o.load(a).error(a),s.isOn("webm")&&o.on("loadedmetadata",a)}})}),function(e){function i(e,t,n){var i=0,f=[0],p="",o=null,p=n||"UTF8";if("UTF8"!==p&&"UTF16"!==p)throw"encoding must be UTF8 or UTF16";if("HEX"===t){if(0!==e.length%2)throw"srcString of HEX type must be in byte increments";o=h(e),i=o.binLen,f=o.value}else if("TEXT"===t)o=m(e,p),i=o.binLen,f=o.value;else if("B64"===t)o=u(e),i=o.binLen,f=o.value;else{if("BYTES"!==t)throw"inputFormat must be HEX, TEXT, B64, or BYTES";o=a(e),i=o.binLen,f=o.value}this.getHash=function(e,t,n,o){var u,a=null,h=f.slice(),m=i;if(3===arguments.length?"number"!=typeof n&&(o=n,n=1):2===arguments.length&&(n=1),n!==parseInt(n,10)||1>n)throw"numRounds must a integer >= 1";switch(t){case"HEX":a=d;break;case"B64":a=r;break;case"BYTES":a=c;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-1"!==e)throw"Chosen SHA variant is not supported";for(u=0;n>u;u+=1)h=s(h,m),m=160;return a(h,l(o))},this.getHMAC=function(e,t,n,o,g){var v,b,j,y,_=[],w=[];switch(v=null,o){case"HEX":o=d;break;case"B64":o=r;break;case"BYTES":o=c;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-1"!==n)throw"Chosen SHA variant is not supported";if(b=64,y=160,"HEX"===t)v=h(e),j=v.binLen,v=v.value;else if("TEXT"===t)v=m(e,p),j=v.binLen,v=v.value;else if("B64"===t)v=u(e),j=v.binLen,v=v.value;else{if("BYTES"!==t)throw"inputFormat must be HEX, TEXT, B64, or BYTES";v=a(e),j=v.binLen,v=v.value}if(e=8*b,t=b/4-1,j/8>b){if("SHA-1"!==n)throw"Unexpected error in HMAC implementation";v=s(v,j),v[t]&=4294967040}else b>j/8&&(v[t]&=4294967040);for(b=0;t>=b;b+=1)_[b]=909522486^v[b],w[b]=1549556828^v[b];if("SHA-1"!==n)throw"Unexpected error in HMAC implementation";return n=s(w.concat(s(_.concat(f),e+i)),e+y),o(n,l(g))}}function m(e,t){var n,s,a=[],i=[],o=0;if("UTF8"===t)for(s=0;s<e.length;s+=1)for(n=e.charCodeAt(s),i=[],128>n?i.push(n):2048>n?(i.push(192|n>>>6),i.push(128|63&n)):55296>n||n>=57344?i.push(224|n>>>12,128|n>>>6&63,128|63&n):(s+=1,n=65536+((1023&n)<<10|1023&e.charCodeAt(s)),i.push(240|n>>>18,128|n>>>12&63,128|n>>>6&63,128|63&n)),n=0;n<i.length;n+=1)(o>>>2)+1>a.length&&a.push(0),a[o>>>2]|=i[n]<<24-o%4*8,o+=1;else if("UTF16"===t)for(s=0;s<e.length;s+=1)(o>>>2)+1>a.length&&a.push(0),a[o>>>2]|=e.charCodeAt(s)<<16-o%4*8,o+=2;return{value:a,binLen:8*o}}function h(e){var t,n,o=[],s=e.length;if(0!==s%2)throw"String of HEX type must be in byte increments";for(t=0;s>t;t+=2){if(n=parseInt(e.substr(t,2),16),n!=n)throw"String of HEX type contains invalid characters";o[t>>>3]|=n<<24-t%8*4}return{value:o,binLen:4*s}}function a(e){var t,s,n=[];for(t=0;t<e.length;t+=1)s=e.charCodeAt(t),(t>>>2)+1>n.length&&n.push(0),n[t>>>2]|=s<<24-t%4*8;return{value:n,binLen:8*e.length}}function u(e){var t,n,s,o,a,r=[],i=0;if(-1===e.search(/^[a-zA-Z0-9=+/]+$/))throw"Invalid character in base-64 string";if(n=e.indexOf("="),e=e.replace(/=/g,""),-1!==n&&n<e.length)throw"Invalid '=' found in base-64 string";for(s=0;s<e.length;s+=4){for(o=e.substr(s,4),t=a=0;t<o.length;t+=1)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(o[t]),a|=n<<18-6*t;for(t=0;t<o.length-1;t+=1)r[i>>2]|=(a>>>16-8*t&255)<<24-i%4*8,i+=1}return{value:r,binLen:8*i}}function d(e,t){var n,s,o="",i=4*e.length;for(n=0;i>n;n+=1)s=e[n>>>2]>>>8*(3-n%4),o+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(15&s);return t.outputUpper?o.toUpperCase():o}function r(e,t){var n,s,i,o="",a=4*e.length;for(n=0;a>n;n+=3)for(i=(e[n>>>2]>>>8*(3-n%4)&255)<<16|(e[n+1>>>2]>>>8*(3-(n+1)%4)&255)<<8|e[n+2>>>2]>>>8*(3-(n+2)%4)&255,s=0;4>s;s+=1)o=8*n+6*s<=32*e.length?o+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-s)&63):o+t.b64Pad;return o}function c(e){var t,n,s="",o=4*e.length;for(t=0;o>t;t+=1)n=e[t>>>2]>>>8*(3-t%4)&255,s+=String.fromCharCode(n);return s}function l(e){var t={outputUpper:!1,b64Pad:"="};try{e.hasOwnProperty("outputUpper")&&(t.outputUpper=e.outputUpper),e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad)}catch{}if("boolean"!=typeof t.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof t.b64Pad)throw"Invalid b64Pad formatting option";return t}function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function o(e,t,n,s,o){var i=(65535&e)+(65535&t)+(65535&n)+(65535&s)+(65535&o);return((e>>>16)+(t>>>16)+(n>>>16)+(s>>>16)+(o>>>16)+(i>>>16)&65535)<<16|65535&i}function s(e,s){var i,r,c,l,u,h,m,f,p,d=[],a=[1732584193,4023233417,2562383102,271733878,3285377520];for(e[s>>>5]|=128<<24-s%32,e[(s+65>>>9<<4)+15]=s,p=e.length,m=0;p>m;m+=16){for(u=a[0],r=a[1],c=a[2],l=a[3],h=a[4],i=0;80>i;i+=1)d[i]=16>i?e[i+m]:t(d[i-3]^d[i-8]^d[i-14]^d[i-16],1),f=20>i?o(t(u,5),r&c^~r&l,h,1518500249,d[i]):40>i?o(t(u,5),r^c^l,h,1859775393,d[i]):60>i?o(t(u,5),r&c^r&l^c&l,h,2400959708,d[i]):o(t(u,5),r^c^l,h,3395469782,d[i]),h=l,l=c,c=t(r,30),r=u,u=f;a[0]=n(u,a[0]),a[1]=n(r,a[1]),a[2]=n(c,a[2]),a[3]=n(l,a[3]),a[4]=n(h,a[4])}return a}"function"==typeof define&&define.amd?define("lib/sha1",[],function(){return i}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=i:exports=i:e.jsSHA=i}(this),define("gawkerlib/urlUtil",["underscore"],function(e){"use strict";var t={toQueryString:function(t){var n=e.reduce(t,function(e,t,n){return e.push(n+"="+encodeURIComponent(t)),e},[]).join("&");return n.length>0&&(n="?"+n),n},fromQueryString:function(t){return e.reduce(t.replace("?","").split("&"),function(t,n){return n.length>0&&e.extend(t,e.object([e.map(n.split("="),decodeURIComponent)])),t},{})}};return t}),define("module/discussion/discussion.channel",["backbone","underscore"],function(e,t){"use strict";return t.extend({},e.Events)}),define("view/sharingfooter.view",["jquery","underscore","backbone.marionette","singleton/WindowController","module/discussion/discussion.channel","app/post/posttools/controller/posttools.like.controller"],function(e,t,n,s,o,i){"use strict";var a=n.ItemView.extend({ui:{likeButton:".js_like",likeIcon:".js_like_icon",likeCountPlaceholder:".js_like_count",replyButton:".js_reply-to-post",replyCount:".js_reply-count",sharePostButton:".js_share-post-item"},modelEvents:{"change:liked":"_updateLikeIconClasses","posttools:post:likeCount:updated":"_updateLikeCount"},events:{"click a":function(e){e.preventDefault()},"click @ui.replyButton":"reply","click @ui.likeButton":"like","click @ui.sharePostButton":"externalShare","touchstart a":"onTouchStart","touchend a":"onTouchEnd"},onTouchStart:function(t){e(t.target).addClass("hovered")},onTouchEnd:function(t){window.setTimeout(function(){e(t.target).removeClass("hovered")},200)},reply:function(){var n=e(".replies-wrapper"),o=1e3;return s.isPartiallyVisible(n)||t.throttle(e.scrollTo(e(n),{duration:o,easing:"easeInOutQuad"}),o),!1},like:t.debounce(function(){return i.like(this.model,this),!1},300),externalShare:function(n){var s=e(n.currentTarget),i=s.attr("href"),a={twitter:"toolbar=0,status=0,width=480,height=360,top="+(window.screen.height/2-180)+",left="+(window.screen.width/2-240),facebook:"toolbar=0,status=0,width=480,height=360,top="+(window.screen.height/2-180)+",left="+(window.screen.width/2-240)},o=t.intersection(s.attr("class").split(/\s+/),["twitter","facebook"])[0];return window.open(i,"share"+o,a[o]),s.addClass("used"),!1},initialize:function(){e.easing.easeInOutQuad=function(e,t,n,s,o){return(t/=o/2)<1?s/2*t*t+n:-s/2*(--t*(t-2)-1)+n};var t=function(t){return e("<div/>").html(t).text()},n=function(e){return e?e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)}):""},s=this.model.get("headline")||this.model.get("first100Characters")||this.model.get("compact");this.$(this.ui.sharePostButton).each(function(o,i){var a=e(i),r=a.attr("href");a.attr("href",r.replace("POST_TITLE",encodeURIComponent(t(n(s)))))}),this.listenTo(o,"newComment",this.updateCommentCount)},updateCommentCount:function(){var e=this.$(this.ui.replyCount);e.html(parseInt(e.html(),10)+1)},_updateLikeIconClasses:function(){this.$(this.ui.likeIcon).toggleClass("active",this.model.get("liked"))},_updateLikeCount:function(){var t=parseInt(e(".js_like.button-recommend-post").data("likecount"),10)||0;this.$(this.ui.likeCountPlaceholder).text(t||"0")}});return a}),define("lib/amd-wrapped/base64",[],function(){"use strict";function s(e){var n,o,s=[],t=0;for(e=encodeURI(e),o=e.length;o>t;)n=e[t],t+=1,"%"!==n?s.push(n.charCodeAt(0)):(n=e[t]+e[t+1],s.push(parseInt(n,16)),t+=2);return s}function o(e){for(var t,o,i,s=[],n=0,a=e.length;a>n;)t=e[n],o=e[n+1],i=e[n+2],128>t?(s.push(String.fromCharCode(t)),n+=1):t>191&&224>t?(s.push(String.fromCharCode((31&t)<<6|63&o)),n+=2):(s.push(String.fromCharCode((15&t)<<12|(63&o)<<6|63&i)),n+=3);return s.join("")}function i(n){var o,a="",i=s(n),r=i.length;for(o=0;r-2>o;o+=3)a+=e[i[o]>>2],a+=e[((3&i[o])<<4)+(i[o+1]>>4)],a+=e[((15&i[o+1])<<2)+(i[o+2]>>6)],a+=e[63&i[o+2]];return r%3&&(o=r-r%3,a+=e[i[o]>>2],r%3===2?(a+=e[((3&i[o])<<4)+(i[o+1]>>4)],a+=e[(15&i[o+1])<<2],a+=t):(a+=e[(3&i[o])<<4],a+=t+t)),a}function a(e){var c,l,s=0,d=[],i=0,a=0;for(s=0;s<e.length;s++)l=e.charCodeAt(s),c=r[127&l],-1===c?n("WARN: Illegal characters (code="+l+") in position "+s):(a=a<<6|c,i+=6,i>=8&&(i-=8,t!==e.charAt(s)&&d.push(a>>i&255),a&=(1<<i)-1));return i?(n("ERROR: Corrupted base64 string"),null):o(d)}var n=function(){},t="=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return window.console&&window.console.log&&(n=function(e){window.console.log(e)}),{encode:i,decode:a}}),define("module/promotions/promotions.model",["underscore","backbone","apiclient/post","lib/amd-wrapped/base64"],function(e,t,n,s){"use strict";var o=t.Model.extend({defaults:{starCount:0,replyCount:0,viewCount:0},initialize:function(){var e=this.get("id");"PROMOTION_SIDEBAR"===this.get("zoneType")&&n.socialStats({id:e}).done(function(e,t){200===t.status&&(this.set("starCount",e.likes),this.set("replyCount",e.replies),this.set("viewCount",e.views))}.bind(this))},parse:function(e){var t={postUrl:e.postUrl,dfpTracker:e.dfpTracker,version:e.version,headline:e.version>=12?s.decode(e.post_headline):e.post_headline,plaintext:e.post_plaintext,shortExcerpt:e.version>=12?s.decode(e.post_shortExcerpt):e.post_shortExcerpt,promotionByline:e.version>=12?s.decode(e.post_promotionByline):e.post_promotionByline,authorByline:e.version>=12?s.decode(e.post_authorByline):e.post_authorByline,permalinkPath:e.post_permalinkPath,trackingPixel:e.trackingPixel,publishTime:e.publishTime,hasReadMore:e.hasReadMore,sponsored:e.sponsored,author:e.author,headlineImage:e.headlineImage,id:e.postId,impressionTracker:e.impressionTracker,zoneType:e.zoneType};return t},toSoyData:function(){return{post:{id:this.get("id"),title:this.get("headline"),url:this.get("permalinkPath"),shortExcerpt:this.get("shortExcerpt"),authorByline:this.get("authorByline"),author:this.get("author"),sponsored:this.get("sponsored"),promotionByline:this.get("promotionByline"),headlineImage:this.get("headlineImage"),trackingPixel:this.get("trackingPixel"),publishTime:this.get("publishTime"),modelData:encodeURIComponent(JSON.stringify(e.clone(this.attributes)))}}}});return o}),define("templates/tiger/utils/crop-type",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.utils.cropType=function(e){return""+o.$$escapeHtml("centered"==e.name?"KinjaCentered":"uncropped"==e.name?"KinjaUncropped":"Kinja")},s.DEBUG&&(t.utils.cropType.soyTemplateName="tiger.utils.cropType"),t.utils.cropType__Ce4=function(e){return""+o.$$filterHtmlAttributes("centered"==e.name?"KinjaCentered":"uncropped"==e.name?"KinjaUncropped":"Kinja")},s.DEBUG&&(t.utils.cropType__Ce4.soyTemplateName="tiger.utils.cropType__Ce4")}),define("templates/tiger/components/promotions/post",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.promotions.post=function(e,n,s){var a,r='<article class="post hentry js_post_item status-published post-item-frontpage js_promoted" data-id="'+o.$$escapeHtmlAttribute(e.post.id)+'" id="post_'+o.$$escapeHtmlAttribute(e.post.id)+'" data-model="'+o.$$escapeHtmlAttribute(e.post.modelData)+'">'+t.components.promotions.head({headline:e.post.title,permalink:e.post.url,headerLevel:5},null,s)+'<div class="meta-container without-dropdown">'+t.components.promotions.meta(e,null,s)+t.components.promotions.postDropDownWrapper(e,null,s)+"</div>",i=0,c=""+(0==i?"large-12":1==i?"medium-9":2==i?"medium-6":"");return r+='<div class="row package standard-package"><div class="'+o.$$escapeHtmlAttribute(c)+' columns item-content hover-highlight entry-summary">'+t.components.promotions.mainMedia(e,null,s),a=""+t.components.promotions.readMore(e,null,s),r+=(e.post.shortExcerpt?o.$$filterNoAutoescape(e.post.shortExcerpt)+o.$$filterNoAutoescape(a):'<p class="first-text">'+o.$$filterNoAutoescape(e.post.plaintext)+o.$$filterNoAutoescape(a)+"</p>")+"</div></div>"+(e.post.trackingPixel?'<img style="position:absolute" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.trackingPixel))+'" width="1" height="1">':"")+"</article>"},s.DEBUG&&(t.components.promotions.post.soyTemplateName="tiger.components.promotions.post"),t.components.promotions.head=function(e){return""+(e.headline?'<header><h1 class="headline'+o.$$escapeHtmlAttribute(e.headerLevel&&e.headerLevel>1?" h"+e.headerLevel:"")+' hover-highlight entry-title"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.permalink))+'">'+o.$$filterNoAutoescape(e.headline)+"</a></h1></header>":"")},s.DEBUG&&(t.components.promotions.head.soyTemplateName="tiger.components.promotions.head"),t.components.promotions.meta=function(e,n,s){return'<div class="meta">'+t.components.promotions.postInfo(e,null,s)+'<div class="meta-byline js_meta-byline"><span class="display-name author vcard">'+(e.post.authorByline?o.$$filterNoAutoescape(window.kinja.stripHtmlTags(e.post.authorByline,"")):'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.author.screenName)+'" rel="nofollow">'+o.$$filterNoAutoescape(e.post.author.displayName)+"</a>")+"</span>"+t.components.promotions.promotedByline(e,null,s)+"</div></div>"},s.DEBUG&&(t.components.promotions.meta.soyTemplateName="tiger.components.promotions.meta"),t.components.promotions.promotedByline=function(e,n,s){var i='<span class="meta-promoted"><span class="promoted-dot">&middot;</span> '+(e.post.sponsored?'<span class="sponsored-label text-upper">Sponsored</span><span class="icon--svg u-prepended u-appended">'+t.icons.essential.starCircle(null,null,s)+"</span>":""),a=""+(e.post.promotionByline&&""!=e.post.promotionByline?o.$$escapeHtml(e.post.promotionByline):e.post.author&&e.post.author.displayName?o.$$escapeHtml(e.post.author.displayName):"");return i+='Promoted by <span class="js_promoted_displayName">'+o.$$filterNoAutoescape(a)+"</span></span>"},s.DEBUG&&(t.components.promotions.promotedByline.soyTemplateName="tiger.components.promotions.promotedByline"),t.components.promotions.mainMediaInterchange=function(e,n,s){var c="",i=""+t.utils.cropType({name:e.cropName},null,s),a=e.animated?e.image.format:e.image.frozenFormat,r="["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (default)], ["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (small)], ["+window.kinja.imageUrl(e.image.id,i+"Medium",a)+", (medium)], ["+(s.features.facethumbs?window.kinja.imageUrl(e.image.id,"KinjaThumb",a):window.kinja.imageUrl(e.image.id,i+"Small",a))+", (large)]";return c+=(e.animated?'data-anim-interchange="'+o.$$escapeHtml(r)+'"':e.lazyload?'data-lazy-interchange="'+o.$$escapeHtml(r)+'"':'data-interchange="'+o.$$escapeHtml(r)+'"')+'data-webm-src="'+o.$$escapeHtml(window.kinja.imageUrl(e.image.id,i+"-xlarge","webm"))+'" data-mp4-src="'+o.$$escapeHtml(window.kinja.imageUrl(e.image.id,i+"-xlarge","mp4"))+'"'},s.DEBUG&&(t.components.promotions.mainMediaInterchange.soyTemplateName="tiger.components.promotions.mainMediaInterchange"),t.components.promotions.mainMediaImage=function(e,n,s){var i="",a=""+t.utils.cropType({name:e.cropName},null,s);return i+='<img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(window.kinja.imageUrl(e.image.id,a+"-xlarge",e.image.format)))+'"'+t.components.promotions.mainMediaInterchange__Ce4(e,null,s)+(e.image.isAnimated?t.components.promotions.mainMediaInterchange__Ce4(o.$$augmentMap(e,{animated:!0}),null,s):"")+'width="132" height="74">'},s.DEBUG&&(t.components.promotions.mainMediaImage.soyTemplateName="tiger.components.promotions.mainMediaImage"),t.components.promotions.mainMedia=function(e,n,s){var i,a="";return e.post.headlineImage&&e.post.headlineImage.type&&(i="video"==e.post.headlineImage.type,a+='<div class="main-media fullwidth-for-small">'+("image"==e.post.headlineImage.type||i?'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.url))+`" rel="nofollow" onclick="window.ga('send', 'event', 'Front page click', 'click', 'Front page click - post image', 'standard recommended');"><span class="`+(i?"video-thumb-play":"")+' img-border">'+t.components.promotions.mainMediaImage(o.$$augmentMap(e,{cropName:i?"centered":"default",image:e.post.headlineImage}),null,s)+(i?'<span class="play-icon">'+t.icons.actions.playIcon(null,null,s)+"</span>":"")+"</span></a>":"")+"</div>"),a},s.DEBUG&&(t.components.promotions.mainMedia.soyTemplateName="tiger.components.promotions.mainMedia"),t.components.promotions.readMore=function(e){return'<span class="read-more hide-for-billboard"> <a class="js_read-more" href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.url))+'" rel="nofollow">&raquo;</a><span class="timestamp proxima text-tiny nowrap"><span class="publish-time js_publish_time"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.url))+'" rel="nofollow"><span class="published updated">'+o.$$escapeHtml(e.post.publishTime.Mddyyhmma)+"</span></a></span></span></span>"},s.DEBUG&&(t.components.promotions.readMore.soyTemplateName="tiger.components.promotions.readMore"),t.components.promotions.postInfo=function(e,n,s){return'<span class="meta-tools"><div class="view-count-container"></div><a data-likecount="'+o.$$escapeHtmlAttribute(null!=e.post.likes?e.post.likes:0)+'" href="#" class="js_like button-recommend-post hover-icon icon--svg u-darken--onhover js_like_icon" title="Recommend"><span class="js_like_count">'+(e.post.likes&&e.post.likes>0?o.$$escapeHtml(e.post.likes):"")+"</span>"+t.icons.essential.star(null,null,s)+"</a></span>"},s.DEBUG&&(t.components.promotions.postInfo.soyTemplateName="tiger.components.promotions.postInfo"),t.components.promotions.postDropDownWrapper=function(e,n,s){return'<div class="post-dropdown-ct js_post-dropdown-ct">'+t.components.promotions.postDropdown(e,null,s)+"</div>"},s.DEBUG&&(t.components.promotions.postDropDownWrapper.soyTemplateName="tiger.components.promotions.postDropDownWrapper"),t.components.promotions.postDropdown=function(e,n,s){return'<ul id="dropdown-'+o.$$escapeHtmlAttribute(e.post.id)+'" class="f-dropdown proxima js_post-dropdown js_follow-controls js_user-follow-controls whitelisted-links" data-postid="'+o.$$escapeHtmlAttribute(e.post.id)+'" data-starterid="'+o.$$escapeHtmlAttribute(e.post.id)+'" data-authorid="'+o.$$escapeHtmlAttribute(e.post.author.id)+'" data-blogid="'+o.$$escapeHtmlAttribute(e.post.defaultBlogId)+'" data-sourceblogid="'+o.$$escapeHtmlAttribute(null==e.blog?null:e.blog.id)+'" data-dropdown-content><li class="js_edit-post hover-icon hide readonly-hide"><a href="#" rel="nofollow"><span class="icon--svg u-prepended">'+t.icons.actions.write(null,null,s)+'</span></a></li><li class="js_delete-post hover-icon hide readonly-hide"><a href="#" rel="nofollow"><span class="icon--svg u-prepended">'+t.icons.essential.close(null,null,s)+'</span></a></li></ul><a href="#" target="_self" class="secondary transparent toggle-30 js_post-menu-toggler post-dropdown-trigger icon--svg u-highlighted--onhover" data-dropdown="dropdown-'+o.$$escapeHtmlAttribute(e.post.id)+'">'+t.icons.essential.chevronBottom(null,null,s)+"</a>"},s.DEBUG&&(t.components.promotions.postDropdown.soyTemplateName="tiger.components.promotions.postDropdown"),t.components.promotions.mainMediaInterchange__Ce4=function(e,n,s){var c="",i=""+t.utils.cropType__Ce4({name:e.cropName},null,s),a=e.animated?e.image.format:e.image.frozenFormat,r="["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (default)], ["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (small)], ["+window.kinja.imageUrl(e.image.id,i+"Medium",a)+", (medium)], ["+(s.features.facethumbs?window.kinja.imageUrl(e.image.id,"KinjaThumb",a):window.kinja.imageUrl(e.image.id,i+"Small",a))+", (large)]";return c+=(e.animated?'data-anim-interchange="'+o.$$escapeHtmlAttribute(r)+'"':e.lazyload?'data-lazy-interchange="'+o.$$escapeHtmlAttribute(r)+'"':'data-interchange="'+o.$$escapeHtmlAttribute(r)+'"')+'data-webm-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(e.image.id,i+"-xlarge","webm"))+'" data-mp4-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(e.image.id,i+"-xlarge","mp4"))+'"'},s.DEBUG&&(t.components.promotions.mainMediaInterchange__Ce4.soyTemplateName="tiger.components.promotions.mainMediaInterchange__Ce4")}),define("templates/tiger/components/promotions/sidebar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.promotions.sidebar=function(e,n,s){var a,r,i="",c=s.features.fullheadline?130:73;return i+='<div class="sidebar-item sidebar-module js_leftrailmodule leftrailmodule--promoted"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.url))+'" class="js_promoted-sidebar--link">'+(e.post.headlineImage&&e.post.headlineImage.src?'<span class="thumbnail-wrapper img--16x9"><span class="data-overlay hide"><ul><li class="js_promoted-sidebar--starcount hide"><span class="text"></span>'+t.icons.essential.star(null,null,s)+'</li><li class="js_promoted-sidebar--replycount hide"><span class="text"></span>'+t.icons.essential.bubble(null,null,s)+'</li><li class="js_promoted-sidebar--viewcount hide"><span class="text"></span>'+t.icons.essential.flame(null,null,s)+'</li></ul></span><img src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.headlineImage.src))+'" alt="'+o.$$escapeHtmlAttribute(e.post.headline)+'" /><span class="sponsored-overlay">Sponsored</span></span>':""),a=""+(e.post.promotionByline&&""!=e.post.promotionByline?o.$$escapeHtml(e.post.promotionByline):e.post.author&&e.post.author.displayName?o.$$escapeHtml(e.post.author.displayName):""),i+='<div class="meta meta--source"><div class="icon--svg">'+t.icons.actions.dollar(null,null,s)+'</div><div class="byline-text"><strong>Promoted by '+o.$$filterNoAutoescape(a)+"</strong> &middot; "+(e.post.authorByline?o.$$filterNoAutoescape(window.kinja.stripHtmlTags(e.post.authorByline,"")):'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.author.screenName)+'" rel="nofollow">'+o.$$filterNoAutoescape(e.post.author.displayName)+"</a>")+'</div></div><h4 class="headline">'+o.$$filterNoAutoescape(window.kinja.truncateHtml(e.post.title,c))+"</h4>",r=""+t.utils.relativeTime({time:e.post.publishTime},null,s),i+='<div class="meta"><time>'+o.$$filterNoAutoescape(r)+"</time></div>"+(e.post.trackingPixel?'<img style="position:absolute" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.trackingPixel))+'" width="1" height="1">':"")+"</a></div>"},s.DEBUG&&(t.components.promotions.sidebar.soyTemplateName="tiger.components.promotions.sidebar")}),define("templates/tiger/components/invites/menu-items",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s){t.components.invites.menuItems.invitePostDropdownItems=function(e,n,s){return'<li class="js_invite-to-post-manually hover-icon hide"><a href="#" rel="nofollow" class="icon--svg">'+t.icons.places.mail(null,null,s)+"Invite manually</a></li>"},s.DEBUG&&(t.components.invites.menuItems.invitePostDropdownItems.soyTemplateName="tiger.components.invites.menuItems.invitePostDropdownItems")}),define("templates/tiger/components/post/pe-list-item",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o,i){t.components.post.pe_item=function(e,n,s){var i="",a=(!e.post.isPromoted&&e.excerptOnly,""+o.$$escapeHtml(e.post.isBillboardPost&&e.post.showByline&&""!=e.post.byline?" billboard":"")+o.$$escapeHtml(e.sharingPost?" shared":"")+o.$$escapeHtml("true"==e.stream?" stream":""));return i+=(e.post.ads&&e.post.ads.ad16x9?t.components.ad.preroll(null,null,s):"")+'<div class="post-wrapper js_post-wrapper '+o.$$escapeHtmlAttribute(a)+'" '+(e.post.isPromoted?"data-postIdWrapper='"+o.$$escapeHtmlAttribute(e.post.id)+`' data-promotionData="`+o.$$escapeHtmlAttribute(e.post.promotionJson)+'" data-adZone="'+o.$$escapeHtmlAttribute(e.post.adZone)+'" data-headline="'+o.$$escapeHtmlAttribute(e.post.headline)+'" data-tagUrlNames="'+o.$$escapeHtmlAttribute(e.post.tagUrlNames)+'"':"")+" >"+t.components.post.pe_article(e,null,s)+"</div>"+(e.post.ads&&e.post.ads.ad1x1&&e.post.sponsored?t.components.ad.tracker({postAdZone:e.post.adZone,postId:e.post.id},null,s):"")},s.DEBUG&&(t.components.post.pe_item.soyTemplateName="tiger.components.post.pe_item"),t.components.post.pe_article=function(e,n,s){var a="",r=""+("DRAFT"==e.post.status?"status-draft":"SCHEDULED"==e.post.status?"status-scheduled":"status-published"),c="postlist__item hentry js_post_item "+o.$$escapeHtml(r)+" post-item-"+o.$$escapeHtml(e.pageType)+(e.post.isPromoted?" js_promoted":"")+(1==e.post.isRecommended?" marquee-post":""),i=e.index&&e.index>2,l=!e.post.aboveHeadline&&e.post.leftOfHeadline;return a+='<article class="'+o.$$escapeHtmlAttribute(c)+'" data-id="'+o.$$escapeHtmlAttribute(e.post.id)+'" id="post_'+o.$$escapeHtmlAttribute(e.post.id)+'"'+(e.post.jsModelJson?' data-model="'+o.$$escapeUri(e.post.jsModelJson)+'"':"")+">"+t.components.post.secondaryByline(e,null,s)+'<header><h1 class="headline entry-title js_entry-title'+(e.post.isRecommended?" featured":"")+'"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'"'+(e.post.isPromoted?' rel="nofollow"':"")+">"+o.$$filterNoAutoescape(e.post.headline)+"</a></h1>"+t.components.post.peMeta(e,null,s)+'</header><div class="item__content'+(l?" item__content--thumb":"")+'">'+(e.post.aboveHeadline?t.components.post.media.large({lazyload:i,image:e.post.aboveHeadline,permalink:e.post.permalink,nofollow:e.post.isPromoted},null,s):e.post.leftOfHeadline?t.components.post.media.medium({lazyload:i,image:e.post.leftOfHeadline,permalink:e.post.permalink,nofollow:e.post.isPromoted},null,s):"")+'<div class="excerpt entry-summary">'+o.$$filterNoAutoescape(e.post.shortExcerpt)+"</div></div></article>"+(null==e.index||0!=e.index||e.post.sponsored||e.post.isPromoted?"":t.components.ad.mobile(null,null,s))},s.DEBUG&&(t.components.post.pe_article.soyTemplateName="tiger.components.post.pe_article"),t.components.post.secondaryByline=function(e,n,s){var i="",a=e.post&&e.post.postAction&&"REPOST"==e.post.postAction.relation,r=(e.post.sharedPost?e.post.sharedPost.replyCount:e.post.replyCount?e.post.replyCount:0,e.post.sponsored||e.post.isPromoted),c=""+(e.post.promotionByline&&""!=e.post.promotionByline?o.$$escapeHtml(e.post.promotionByline):e.post.author&&e.post.author.displayName?o.$$escapeHtml(e.post.author.displayName):""),l=e.post.sponsored;return i+="permalink"!=e.pageType?'<div class="meta--pe secondary-byline">'+(r?'<div class="meta__text">Promoted by '+o.$$escapeHtml(c)+"</div>":a?'<div class="meta__text">'+t.icons.places.sharedpostSmall(null,null,s)+" Shared from "+o.$$escapeHtml(e.post.defaultBlogName)+"</div>":"")+(l?'<div class="meta__label meta__label--sponsored">Sponsored</div>':"")+"</div>":""},s.DEBUG&&(t.components.post.secondaryByline.soyTemplateName="tiger.components.post.secondaryByline"),t.components.post.peMeta=function(e,n,s){var l,a="",f=e.post&&e.post.postAction&&"REPOST"==e.post.postAction.relation,d=e.post.sharedPost?e.post.sharedPost.replyCount:e.post.replyCount?e.post.replyCount:0,p=(e.post.sponsored||e.post.isPromoted,""+(e.post.promotionByline&&""!=e.post.promotionByline?o.$$escapeHtml(e.post.promotionByline):e.post.author&&e.post.author.displayName?o.$$escapeHtml(e.post.author.displayName):""),e.post.sponsored),r=""+(e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?"//kinja.com/"+o.$$escapeHtml(e.post.author.screenName):""),r=i.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(r),u=e.post.byline&&""!=e.post.byline?e.post.byline:e.post.author.displayName,h=e.scheduledRepost;if(a+='<div class="meta--pe">'+("permalink"==e.pageType?'<div class="meta__avatar'+(p?" sponsored":"")+'">'+(f?t.components.post.streamMetaSharedAvatars({post:e.post,sharerAuthor:e.post.postAction.author},null,s):h?t.components.post.streamMetaSharedAvatars({post:e.post,sharerAuthor:e.scheduledRepost.author},null,s):t.components.post.streamMetaAvatar(e,null,s))+'<span class="avatar__badge avatar__badge--sponsored">'+t.icons.actions.dollarCircle(null,null,s)+"</span></div>":"")+'<div class="meta__text"><div class="meta__byline author">'+(r?'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(r))+'">'+o.$$escapeHtml(u)+"</a>":o.$$escapeHtml(u))+'</div><time class="meta__time updated" datetime="'+o.$$escapeHtmlAttribute(e.post.publishTime.yMdHmsZ)+'"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'" target="_self" title="'+o.$$escapeHtmlAttribute(e.post.publishTime.Mddyyhmma)+'" '+(e.post.isPromoted?'rel="nofollow"':"")+">"+(h?"<b>Scheduled share:</b> "+o.$$escapeHtml(window.kinja.formatTime(e.scheduledRepost.repostTime,"M/dd/yy h:mma",e.post.timezone,"en-US")):"DRAFT"==e.post.status?"<b>Draft:</b> "+o.$$escapeHtml(window.kinja.formatTime(e.post.publishTime.timestamp,"M/dd/yy h:mma",e.post.timezone,"en-US")):"SCHEDULED"==e.post.status?"<b>Scheduled:</b> "+o.$$escapeHtml(window.kinja.formatTime(e.post.publishTime.timestamp,"M/dd/yy h:mma",e.post.timezone,"en-US")):t.messages.time.relativeTime({type:e.post.publishTime.relative.type,amount:e.post.publishTime.relative.amount,hmma:e.post.publishTime.hmma,day:e.post.publishTime.day,Mddyyhmma:e.post.publishTime.Mddyyhmma,timestamp:e.post.publishTime.timestamp},null,s))+"</a></time>",e.tags&&e.tags[0]){if(a+='<div class="tags-container"><a class="first-tag" href="/tag/'+o.$$escapeHtmlAttribute(e.tags[0].urlName)+'" data-urlname="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.tags[0].urlName))+`" data-dropdown="taglist" data-options="is_hover:true;autoalign:true;" onclick="window.ga('send', 'event', 'Permalink meta', 'Tag click', 'First tag click');">Filed to: <span>`+o.$$escapeHtml(e.tags[0].desc)+"</span>"+t.icons.essential.chevronBottom(null,null,s)+"</a>",e.tags.length>1){a+='<div id="taglist" class="tiny f-dropdown text-upper" data-dropdown-content><div><ul>';for(var m=e.tags,g=m.length,c=0;g>c;c++)l=m[c],a+=c>=1?'<li><a href="/tag/'+o.$$escapeHtmlAttribute(l.urlName)+'" data-urlname="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(l.urlName))+`" onclick="window.ga('send', 'event', 'Permalink meta', 'Tag click', 'Dropdown tag click');">`+o.$$escapeHtml(l.desc)+"</a></li>":"";a+="</ul></div></div>"}a+="</div>"}return a+='</div><div class="meta__right"><div class="'+(s.features.newstream?"meta__data":"")+' view-count-container"></div>'+(d&&d>0?'<a class="meta__data meta__data--comment" href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'#replies">'+t.icons.essential.bubbleGiant(null,null,s)+"<span>"+o.$$escapeHtml(d)+"</span></a>":"")+'<a href="#" class="meta__data meta__data--recommend js_like icon--svg u-darkened--onhover js_like_icon" title="Recommend" data-likecount="'+o.$$escapeHtmlAttribute(null!=e.post.likes?e.post.likes:0)+'" data-analytics-target="starterTop">'+t.icons.essential.starGiant(null,null,s)+'<span class="js_like_count">'+(e.post.likes&&e.post.likes>0?o.$$escapeHtml(e.post.likes):"")+'</span></a><div class="meta__tools js_meta-tools post-dropdown-ct js_post-dropdown-ct hide">'+t.components.post.meta.postDropdown({post:e.post,mode:"post",pageType:e.pageType,blog:e.blog},null,s)+'<a href="#" target="_self" class="post-dropdown-trigger js_post-menu-toggler icon--svg u-darkened--onhover" data-dropdown="dropdown-'+o.$$escapeHtmlAttribute(e.post.id)+'">'+t.icons.essential.toolsGiant(null,null,s)+"</a></div></div></div>"},s.DEBUG&&(t.components.post.peMeta.soyTemplateName="tiger.components.post.peMeta"),t.components.post.streamMetaAvatar=function(e,n,s){var l="",c="gif"==(null==e.post.author.avatar?null:e.post.author.avatar.format)?"jpg":null==e.post.author.avatar?null:e.post.author.avatar.format,r=""+(e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?""+window.kinja.imageUrl(e.post.author.avatar.id,"avt-small",c):e.post.salesAvatarMap&&e.post.salesAvatarMap.id?""+window.kinja.imageUrl(e.post.salesAvatarMap.id,"avt-small",c):""),r=i.$$markUnsanitizedTextForInternalBlocks(r),a=""+(e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?"//kinja.com/"+o.$$escapeHtml(e.post.author.screenName):""),a=i.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(a);return e.post.byline&&""!=e.post.byline?e.post.byline:e.post.author.displayName,l+=(a?'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(a))+'" class="avatar__link"'+(e.post.isPromoted?' rel="nofollow"':"")+">":"")+(r?'<img class="avatar__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(r))+'" />':t.icons.places.avatarBig(null,null,s))+(a?"</a>":"")},s.DEBUG&&(t.components.post.streamMetaAvatar.soyTemplateName="tiger.components.post.streamMetaAvatar"),t.components.post.streamMetaSharedAvatars=function(e){var l="",c="gif"==(null==e.post.author.avatar?null:e.post.author.avatar.format)?"jpg":null==e.post.author.avatar?null:e.post.author.avatar.format,d="gif"==(null==e.sharerAuthor.avatar?null:e.sharerAuthor.avatar.format)?"jpg":null==e.sharerAuthor.avatar?null:e.sharerAuthor.avatar.format,s=""+(e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?""+window.kinja.imageUrl(e.post.author.avatar.id,"avt-small",c):e.post.salesAvatarMap&&e.post.salesAvatarMap.id?""+window.kinja.imageUrl(e.post.salesAvatarMap.id,"avt-small",c):""),s=i.$$markUnsanitizedTextForInternalBlocks(s),u=window.kinja.imageUrl(e.sharerAuthor.avatar.id,"avt-small",d),a=""+(e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?"//kinja.com/"+o.$$escapeHtml(e.post.author.screenName):""),a=i.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(a),r="//kinja.com/"+e.sharerAuthor.screenName,r=i.$$markUnsanitizedTextForInternalBlocks(r);return e.post.byline&&""!=e.post.byline?e.post.byline:e.post.author.displayName,e.sharerAuthor.displayName,l+='<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(r))+'" class="avatar__link"'+(e.post.isPromoted?' rel="nofollow"':"")+">"+(e.sharerAuthor.id==e.post.author.id?'<img class="avatar__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(s))+'" />':'<span class="avatar-wrapper sharedauthor"><img class="avatar__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(s))+'" /></span><span class="avatar-wrapper sharingauthor"><img class="avatar__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(u))+'" /></span>')+'</a><div class="avatar__popover hide">'+(a?'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(a))+'" class="avatar__link"'+(e.post.isPromoted?' rel="nofollow"':"")+'><img class="avatar__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(s))+'" /></a>':s?'<img class="avatar__img" src="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(s))+'" />':"")+"</div>"},s.DEBUG&&(t.components.post.streamMetaSharedAvatars.soyTemplateName="tiger.components.post.streamMetaSharedAvatars")}),define("templates/tiger/components/post/media/medium",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.post.media.medium=function(e,n,s){var a="",i=e.image.isVideo;return a+='<figure class="asset main-media fullwidth-for-small"><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.permalink))+'"'+(e.nofollow?' rel="nofollow"':"")+'><span class="'+(i?"video-thumb-play":"")+" img-border"+(e.image.isAnimated?" lazy-gif lazy-image ":e.lazyload?" lazy-image":"")+'">'+t.components.post.media.mainMediaImage({cropName:i?"centered":"default",image:e.image,lazyload:e.lazyload,animated:e.image.isAnimated},null,s)+(i?'<span class="play-icon">'+t.icons.actions.playIcon(null,null,s)+"</span>":"")+"</span></a></figure>"},s.DEBUG&&(t.components.post.media.medium.soyTemplateName="tiger.components.post.media.medium"),t.components.post.media.mainMediaImage=function(e,n,s){var r="",c=""+t.utils.cropType({name:e.cropName},null,s),i=e.image.isAnimated,l=e.image.height?e.image.height:74,d=e.image.width?e.image.width:132,u=i?e.image.frozenFormat:e.image.format,a=""+o.$$escapeHtml(window.kinja.imageUrl(e.image.id,c+"Medium",u)),h=i&&e.lazyload;return r+='<img src="'+(e.lazyload?"data:image/svg+xml;charset=utf-8,%3Csvg xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg' viewBox%3D'0 0 "+o.$$escapeHtmlAttribute(d)+" "+o.$$escapeHtmlAttribute(l)+"'%2F%3E":o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(a)))+'"'+(h?'data-src="'+o.$$escapeHtmlAttribute(a)+'"':"")+t.components.post.media.mainMediaInterchange__Ce4(e,null,s)+(i?t.components.post.media.mainMediaInterchange__Ce4(o.$$augmentMap(e,{animated:!0}),null,s):"")+"/>"},s.DEBUG&&(t.components.post.media.mainMediaImage.soyTemplateName="tiger.components.post.media.mainMediaImage"),t.components.post.media.mainMediaInterchange=function(e,n,s){var c="",i=""+t.utils.cropType({name:e.cropName},null,s),a=""+(e.animated?o.$$escapeHtml(e.image.format):o.$$escapeHtml(e.image.frozenFormat)),r="["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (default)], ["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (small)], ["+window.kinja.imageUrl(e.image.id,i+"Medium",a)+", (medium)], ["+(s.features.facethumbs?window.kinja.imageUrl(e.image.id,"KinjaThumb",a):window.kinja.imageUrl(e.image.id,i+"Small",a))+", (large)]";return c+=(e.animated?'data-anim-interchange="'+o.$$escapeHtml(r)+'"':e.lazyload?'data-lazy-interchange="'+o.$$escapeHtml(r)+'"':'data-interchange="'+o.$$escapeHtml(r)+'"')+(s.features.webm?'data-webm-src="'+o.$$escapeHtml(window.kinja.imageUrl(e.image.id,i+"-xlarge","webm"))+'" data-mp4-src="'+o.$$escapeHtml(window.kinja.imageUrl(e.image.id,i+"-xlarge","mp4"))+'"':"")},s.DEBUG&&(t.components.post.media.mainMediaInterchange.soyTemplateName="tiger.components.post.media.mainMediaInterchange"),t.components.post.media.mainMediaInterchange__Ce4=function(e,n,s){var c="",i=""+t.utils.cropType__Ce4({name:e.cropName},null,s),a=""+(e.animated?o.$$filterHtmlAttributes(e.image.format):o.$$filterHtmlAttributes(e.image.frozenFormat)),r="["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (default)], ["+window.kinja.imageUrl(e.image.id,i+"ExtraLarge",a)+", (small)], ["+window.kinja.imageUrl(e.image.id,i+"Medium",a)+", (medium)], ["+(s.features.facethumbs?window.kinja.imageUrl(e.image.id,"KinjaThumb",a):window.kinja.imageUrl(e.image.id,i+"Small",a))+", (large)]";return c+=(e.animated?'data-anim-interchange="'+o.$$escapeHtmlAttribute(r)+'"':e.lazyload?'data-lazy-interchange="'+o.$$escapeHtmlAttribute(r)+'"':'data-interchange="'+o.$$escapeHtmlAttribute(r)+'"')+(s.features.webm?'data-webm-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(e.image.id,i+"-xlarge","webm"))+'" data-mp4-src="'+o.$$escapeHtmlAttribute(window.kinja.imageUrl(e.image.id,i+"-xlarge","mp4"))+'"':"")},s.DEBUG&&(t.components.post.media.mainMediaInterchange__Ce4.soyTemplateName="tiger.components.post.media.mainMediaInterchange__Ce4")}),define("module/promotions/promotions.itemview",["jquery","underscore","backbone.marionette","singleton/EventDispatcher","singleton/Feature","singleton/Renderer","module/promotions/promotions.model","templates/tiger/utils/crop-type","templates/tiger/components/promotions/post","templates/tiger/components/promotions/sidebar","templates/tiger/components/invites/menu-items","templates/tiger/components/post/pe-list-item","templates/tiger/components/post/media/medium","templates/tiger/utils/relative-time","templates/tiger/section/sidebar","templates/tiger/messages"],function(e,t,n,s,o,i,a){"use strict";var r=n.ItemView.extend({model:a,template:o.isOn("newstream")?tiger.components.post.pe_item:tiger.components.promotions.post,readMorePlaceholder:'<span class="read-more-placeholder"></span></p>',$container:null,className:"post-wrapper js_post-wrapper",ui:{headline:".headline",excerpt:".package",promotedSidebarLink:".js_promoted-sidebar--link",dataOverlay:".data-overlay",starCount:".js_promoted-sidebar--starcount",replyCount:".js_promoted-sidebar--replycount",viewCount:".js_promoted-sidebar--viewcount"},modelEvents:{"change:starCount":"updateDataOverlay","change:replyCount":"updateDataOverlay","change:viewCount":"updateDataOverlay"},events:{"click @ui.headline":"onPostClicked","click @ui.promotedSidebarLink":"onPostClicked","click @ui.excerpt":"onPostClicked"},initialize:function(e){var t="",s=e.innerEl,n=this.model.get("zoneType");this.$container=s.closest(".ad-promotions-container"),n&&"PROMOTION_SIDEBAR"===n&&(this.template=tiger.components.promotions.sidebar),t=this.$container.data("mobile")?"show-for-medium-down":"hide-for-medium-down animate-slidedown animate-closed",this.$el.addClass(t)},serializeData:function(){var e;return o.isOn("newstream")?(e=this.model.toSoyData(),e.post.headline=e.post.title,e.post.byline=e.post.authorByline,e.post.leftOfHeadline=e.post.headlineImage,e.post.permalink=e.post.url):(this.injectReadMorePlaceholder(),e=this.model.toSoyData()),e},injectReadMorePlaceholder:function(){var e=this.model.get("shortExcerpt");e&&(e=e.replace(/<\/p>$/,this.readMorePlaceholder),this.model.set({shortExcerpt:e}))},onPostClicked:function(t){var n,s=e(t.target);(!s.attr("href")||s.hasClass("js_read-more"))&&(t.preventDefault(),n=this.constructPermalink(),window.location.href=n)},updateDataOverlay:function(e,n){var o,a=t.keys(this.model.changedAttributes())[0],s=this.ui[a];s&&n>0&&(o=i.renderTemplate(tiger.section.sidebar.numberFormat,{number:n}),s.find(".text").html(o),s.removeClass("hide"),this.ui.dataOverlay.removeClass("hide"))},constructPermalink:function(){var e,t=window.location.protocol+"//"+window.location.host,n=this.model.get("dfpTracker"),s=this.model.get("permalinkPath");return e=n+t+s},onRender:function(){this.$container.before(this.el),this.$el.removeClass("animate-closed"),s.trigger("update.postlist.post",{el:this.$el})}});return r}),define("module/promotions/promotions.controller",["jquery","module/ads/ads.events","module/promotions/promotions.model","module/promotions/promotions.itemview"],function(e,t,n,s){"use strict";var o={views:[],_startPromotions:function(){window.location.search.match(/startTime/)||this._registerEvents()},_registerEvents:function(){t.on("ads.zonedisplayed",this.onPromotionAdded,this),t.on("ads.forcedisplay",this._renderPromotedPost)},onPromotionAdded:function(e){var t=e.model.get("zoneType");("PROMOTION"===t||"PROMOTION_MOBILE"===t||"PROMOTION_SIDEBAR"===t)&&o.renderPromotedPost(e)},renderPromotedPost:function(e){var t,n=this.getPromotedPost(e);n&&(t=new s({innerEl:e.$el.closest(".js_ad-promotion"),model:n}),t.render(),this.views.push(t))},_renderPromotedPost:function(){var t,n=e(".js_ad-promotion-desktop iframe").first(),i=o._getPromotedPost(n);i&&(t=new s({innerEl:n.closest(".js_ad-promotion"),model:i}),t.render(),o.views.push(t))},getPromotedPost:function(e){var t,s,i=this,o=e.$el.find("div > iframe");return o.length>0&&(t=i.extractPromotionData(o),t&&(t.zoneType=e.model.get("zoneType"),s=new n(t,{parse:!0}))),s},_getPromotedPost:function(e){var t,s,i=e;return i.length>0&&(t=o.extractPromotionData(i),t&&(s=new n(t,{parse:!0}))),s},parseJsonFuture:function(e){var t;try{return e=e.replace(/"\\&quot;/gm,'\\"'),e=e.replace(/\\&quot;/gm,"\\"),t=JSON.parse(e)}catch{return window.console.warn("parseJsonFuture failed for promoted post, trying parseJsonV4 next"),this.parseJsonV4(e)}},parseJsonV4:function(e){var t;try{return t=JSON.parse(e)}catch{return window.console.warn("parseJsonV4 failed for promoted post, trying native parseJson next"),this.parseJson(e)}},parseJson:function(e){var t;e=e.replace(/"\\&quot;/gm,'\\"'),e=e.replace(/\\&quot;/gm,"\\");try{t=JSON.parse(e)}catch(t){window.console.error("Unable to parse JSON string of promoted post"),window.console.error(e),window.console.error(t)}return t},getJsonVersion:function(e){var t,n;return t=e.match(/"version":\s*"([0-9]+)"/),n=null!==t&&2===t.length?parseInt(t[1],10):0},cleanJsonString:function(e){var t,n,o,s=e;if(n=e.match(/<a href="tel:[0-9]+">[0-9]+<\/a>/gi),o=n?n.length:0)try{for(t=0;o>t;t++)s=s.replace(n[t],n[t].match(/([0-9]+)/)[0])}catch(e){window.console.warn("Error while cleaning json string for promoted post"),window.console.warn(e)}return s},extractPromotionData:function(t){var n,s,o,i,a;return s=e(t).contents().find("body").html(),i=s.search(/<script/),n=s.slice(0,i),o=this.getJsonVersion(n),n=this.cleanJsonString(n),""!==n&&(a=o>=6?this.parseJsonFuture(n):o>=4?this.parseJsonV4(n):this.parseJson(n))},API:{startPromotions:function(){o._startPromotions()},forcedisplay:function(){t.trigger("ads.forcedisplay")}}};return window.kinjaads=window.kinjaads||{},window.kinjaads.queue=window.kinjaads.queue||[],window.kinjaads.forcedisplay=o.API.forcedisplay,o.API}),define("templates/tiger/components/post/meta/meta-components",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(e,t,n,s,o){t.components.post.meta.byline=function(e){var s,i=""+("repost"==e.mode&&e.reposter?o.$$escapeHtml(e.reposter.displayName)+' <span class="text-italic">shared a post by</span> '+(""==e.post.byline?'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.author.screenName)+'" class="text-light fn url"'+(e.post.isPromoted?' rel="nofollow"':"")+">"+o.$$escapeHtml(e.post.author.displayName)+"</a>":o.$$escapeHtml(window.kinja.stripHtmlTags(e.post.byline,""))):"");return e.post.showByline&&(!e.post.postAction||!e.post.postAction.author)&&"repost"!=e.mode&&((i+='<span class="display-name author vcard">'+(""==e.post.byline?'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.author.screenName)+`" onclick="window.ga('send', 'event', 'byline', 'click', `+(e.pageType?" '"+o.$$escapeHtmlAttribute(o.$$escapeJsString(e.pageType))+"' ":" 'private'")+');" '+(e.post.isPromoted?' rel="nofollow"':"")+' class="fn url">'+o.$$escapeHtml(e.post.author.displayName)+"</a>":o.$$escapeHtml(window.kinja.stripHtmlTags(e.post.byline,"")))+"</span>",e.post.allowReplies&&"reply"!=e.mode)&&(s=e.post.sharedPost?e.post.sharedPost.replyCount:e.post.replyCount?e.post.replyCount:0,i+=s&&s>0?' <a href="'+("permalink"!=e.pageType?o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink)):"")+'#replies" class="text-light" rel="nofollow">'+(1==s?"and "+o.$$escapeHtml(s)+" other":"and "+o.$$escapeHtml(s)+" others")+"</a>":""),i+="reply"==e.mode&&e.post.replyMeta.parentAuthor?'&nbsp;replied to a post by&nbsp;<span class="strong">'+(""==e.post.replyMeta.parentByline?'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.replyMeta.parentAuthor.screenName)+'" class="text-light fn url"'+(e.post.isPromoted?' rel="nofollow"':"")+">"+o.$$escapeHtml(e.post.replyMeta.parentAuthor.displayName)+"</a>":o.$$escapeHtml(e.post.replyMeta.parentByline))+"</span>":""),i+=(e.post.postAction&&e.post.postAction.author&&"repost"!=e.mode?o.$$escapeHtml(e.post.postAction.author.displayName)+' <span class="text-italic">'+("shared-reply"==e.mode?"shared a reply by":"shared a post by")+'</span> <span class="author vcard">'+(""==e.post.byline?'<a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.author.screenName)+'" class="text-light fn url"'+(e.post.isPromoted?' rel="nofollow"':"")+">"+o.$$escapeHtml(e.post.author.displayName)+"</a>":o.$$escapeHtml(window.kinja.stripHtmlTags(e.post.byline,"")))+"</span>":"")+("profileposts"==e.pageType?'<p class="posted-on-blog">posted on<a href="//'+o.$$escapeHtmlAttribute(e.post.defaultBlogHost)+'"> '+o.$$escapeHtml(e.post.defaultBlogName)+"</a></p>":"")},s.DEBUG&&(t.components.post.meta.byline.soyTemplateName="tiger.components.post.meta.byline"),t.components.post.meta.topByline=function(e,n,s){if(i="",e.post.showByline)if(""==e.post.byline){if(i+='<span class="display-name author vcard"><a href="//kinja.com/'+o.$$escapeHtmlAttribute(e.post.author.screenName)+'" target="_self" '+(e.post.isPromoted?'rel="nofollow"':"")+` class="fn url" onclick="window.ga('send', 'event', 'byline', 'click', 'permalink');" >`+o.$$escapeHtml(e.post.author.displayName)+"</a>",c=(null==s.replyData?null:s.replyData.atUser)==e.post.authorBlogName,i+=(c?'<span class="moderator-name">, Host</span>':"")+("reply"==e.mode&&(null==e.post.replyMeta?null:null==e.post.replyMeta.parentAuthor?null:e.post.replyMeta.parentAuthor.displayName)?'<span class="reply-author replyto-author"><span class="icon--svg u-downsized">'+t.icons.essential.chevronRight(null,null,s)+"</span>"+((null==e.post.replyMeta?null:e.post.replyMeta.showParentByline)&&""!=(null==e.post.replyMeta?null:e.post.replyMeta.parentByline)?o.$$escapeHtml(window.kinja.stripHtmlTags(e.post.replyMeta.parentByline,"")):o.$$escapeHtml(e.post.replyMeta.parentAuthor.displayName))+"</span>":"")+(e.contributors?' <span class="text-normal text-tiny">'+(1==e.contributors?"and 1 other":e.contributors>1?"and "+o.$$escapeHtml(e.contributors)+" others":"")+"</span>":"")+"</span>",e.blog&&e.post.isStarter&&e.post.defaultBlogId!=e.post.author.defaultBlogId&&e.post.defaultBlogId!=e.blog.id||e.forSharedPost){i+='<span class="published-on">';for(var i,a,c,l=e.post.blogs,d=l.length,r=0;d>r;r++)a=l[r],i+=a.id==e.post.defaultBlogId?' on <a class="blog-name" href="http://'+o.$$escapeHtmlAttribute(a.canonicalHost)+'" target="_self" '+(e.post.isPromoted?'rel="nofollow"':"")+">"+o.$$escapeHtml(a.displayName)+"</a>":"";i+="</span>"}}else i+='<span class="display-name">'+o.$$escapeHtml(window.kinja.stripHtmlTags(e.post.byline,""))+"</span>";return i+=e.post.postAction&&e.post.postAction.author&&e.post.postAction.author.displayName?'<span class="reposted-by">shared by <span class="text-upper">'+o.$$escapeHtml(e.post.postAction.author.displayName)+"</span></span>":""},s.DEBUG&&(t.components.post.meta.topByline.soyTemplateName="tiger.components.post.meta.topByline"),t.components.post.meta.promotedByline=function(e,n,s){var a,i='<span class="meta-promoted"><span class="promoted-dot">&middot;</span> '+(e.post.sponsored||e.post.isBillboardPost?'<span class="sponsored-label text-upper">Sponsored</span><span class="icon--svg">'+t.icons.essential.starCircle(null,null,s)+"</span>":"");return e.post.isPromoted&&(a=""+(e.post.promotion&&e.post.promotion.byline&&""!=e.post.promotion.byline?o.$$escapeHtml(e.post.promotion.byline):e.post.promotion&&e.post.promotion.authorDisplayName?o.$$escapeHtml(e.post.promotion.authorDisplayName):""),i+='Promoted by <span class="js_promoted_displayName">'+o.$$filterNoAutoescape(a)+"</span>"),i+="</span>"},s.DEBUG&&(t.components.post.meta.promotedByline.soyTemplateName="tiger.components.post.meta.promotedByline"),t.components.post.meta.publishTime=function(e,n,s){return'<span class="publish-time js_publish_time" data-publishtime="'+o.$$escapeHtmlAttribute(e.post.publishTimeMillis)+'">'+(e.post.postAction&&e.post.postAction.createTime?'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'" target="_self" '+(e.post.isPromoted?'rel="nofollow"':"")+(e.showRelativeTime?' title="'+o.$$escapeHtmlAttribute(e.post.postAction.createTime.Mddyyhmma)+'"':"")+">"+(e.showRelativeTime?t.components.post.meta.relativeTime({time:e.post.postAction.createTime},null,s):"")+'<span class="'+(e.showRelativeTime?"hide ":"")+'published updated">'+o.$$escapeHtml(e.post.postAction.createTime.Mddyyhmma)+"</span></a>":e.post.publishTime?"SCHEDULED"==e.post.status?'Scheduled:<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'" target="_self" '+(e.post.isPromoted?'rel="nofollow"':"")+(e.showRelativeTime?' title="'+o.$$escapeHtmlAttribute(e.post.publishTime.Mddyyhmma)+'"':"")+">"+(e.showRelativeTime?t.components.post.meta.relativeTime({time:e.post.publishTime},null,s):"")+'<span class="'+(e.showRelativeTime?"hide ":"")+'published updated">'+o.$$escapeHtml(e.post.publishTime.Mddyyhmma)+'</span></a><span class="icon--svg u-prepended">'+t.icons.actions.clock(null,null,s)+"</span>":"DRAFT"==e.post.status?'Draft<span class="icon--svg u-prepended">'+t.icons.actions.write(null,null,s)+'</span><a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'" target="_self" '+(e.post.isPromoted?'rel="nofollow"':"")+(e.showRelativeTime?' title="'+o.$$escapeHtmlAttribute(e.post.publishTime.Mddyyhmma)+'"':"")+">"+(e.showRelativeTime?t.components.post.meta.relativeTime({time:e.post.publishTime},null,s):"")+'<span class="'+(e.showRelativeTime?"hide ":"")+'published updated">'+o.$$escapeHtml(e.post.publishTime.Mddyyhmma)+"</span></a>":'<a href="'+o.$$escapeHtmlAttribute(o.$$filterNormalizeUri(e.post.permalink))+'" target="_self" '+(e.post.isPromoted?'rel="nofollow"':"")+(e.showRelativeTime?' title="'+o.$$escapeHtmlAttribute(e.post.publishTime.Mddyyhmma)+'"':"")+">"+(e.showRelativeTime?t.components.post.meta.relativeTime({time:e.post.publishTime},null,s):"")+'<span class="'+(e.showRelativeTime?"hide ":"")+'published updated">'+o.$$escapeHtml(e.post.publishTime.Mddyyhmma)+"</span></a>":"")+"</span>"},s.DEBUG&&(t.components.post.meta.publishTime.soyTemplateName="tiger.components.post.meta.publishTime"),t.components.post.meta.avatarContainer=function(e,n,s){var a,o="",i="avt-small";return e.post.showByline&&""==e.post.byline&&(null==e.post.author?null:e.post.author.avatar)?(a="gif"==e.post.author.avatar.format?"jpg":e.post.author.avatar.format,o+=t.components.post.meta.avatarDisplay({url:"//kinja.com/"+e.post.author.screenName,avatar:window.kinja.imageUrl(e.post.author.avatar.id,i,a),nofollow:e.post.isPromoted},null,s)):o+=e.post.salesAvatarMap&&e.post.salesAvatarMap.id?t.components.post.meta.avatarDisplay({avatar:window.kinja.imageUrl(e.post.salesAvatarMap.id,i)},null,s):t.components.post.meta.avatarDisplay(null,null,s),o},s.DEBUG&&(t.components.post.meta.avatarContainer.soyTemplateName="tiger.components.post.meta.avatarContainer"),t.components.post.meta.postInfo=function(e,n,s){return'<span class="meta-tools"><div class="view-count-container"></div><a data-likecount="'+o.$$escapeHtmlAttribute(null!=e.post.likes?e.post.likes:0)+'" href="#" data-analytics-target="starterTop" class="js_like button-recommend-post hover-icon icon--svg u-darkened--onhover js_like_icon" title="Recommend"><span class="js_like_count">'+(e.post.likes&&e.post.likes>0?o.$$escapeHtml(e.post.likes):"")+"</span>"+t.icons.essential.star(null,null,s)+"</a></span>"},s.DEBUG&&(t.components.post.meta.postInfo.soyTemplateName="tiger.components.post.meta.postInfo"),t.components.post.meta.postViewCount=function(e,n,s){return""+(e.isBlip&&!e.isBillboardPost||e.forSharedPost?"":e.viewstats&&e.viewstats.nonUniqueFormatted&&"0"!=e.viewstats.nonUniqueFormatted&&("permalink"==e.pageType||"dashboard"==e.pageType||"manageblog"==e.pageType)?(s.features.newstream?t.icons.essential.flameGiant(null,null,s):"")+'<span class="view-count '+(s.features.newstream?"":"icon--svg")+'" '+(e.viewstats.uniqueFormatted?' title="'+o.$$escapeHtmlAttribute(e.viewstats.uniqueFormatted)+' New Visitors"':"")+">"+o.$$escapeHtml(e.viewstats.nonUniqueFormatted)+(s.features.newstream?"":t.icons.essential.flame(null,null,s))+"</span>":"")},s.DEBUG&&(t.components.post.meta.postViewCount.soyTemplateName="tiger.components.post.meta.postViewCount")}),define("module/PostApp",["jquery","underscore","singleton/Utils","singleton/CurrentUser","singleton/CurrentBlog","singleton/Feature","singleton/IframeResizer","module/BaseApp","module/KinjaAnalytics","app/MarionetteApp","app/AnnotationApplet","app/mixins/PostViewLoader","app/mixins/RecommendAssetMixin","model/post/Post","view/GifImageLoader","lib/sha1","gawkerlib/urlUtil","view/sharingfooter.view","singleton/WindowController","module/promotions/promotions.controller","app/leftrail/leftrailContainedList.view","module/ads/ads.events","lib/jquery.cookie","templates/tiger/components/post/meta/meta-components","templates/tiger/section/sidebar"],function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_){"use strict";var w,O=r.extend(t.extend({},u,h,{starterPost:null,initApp:function(){r.prototype.initApp.call(this),this.starterPost=new m(n.getKinjaMeta().post),this.initPostTools(this.starterPost.id),this.imageLoader=new f({el:document}),e(".js_ad-mobile-second").length&&e(".js_ad-mobile-waypoint").length&&b.isSmall()&&e(".js_ad-mobile-waypoint").waypoint({handler:function(t){"down"===t&&_.trigger("ads.dynamicad.load",e(".js_ad-mobile-second .js_ad-container"),"MOBILE_SECOND")},offset:"50%",triggerOnce:!0})},start:function(){var r,c=o.blogGroup||"default";i.isOn("delaydiscussion")&&!n.isCommentPermalinkPage()?b.registerWaypointWithTimeout(e(l.discussionRegion.el),"150%",this.startDiscussionApplet.bind(this),1e4):this.startDiscussionApplet(),this.startAnnotations(),i.isOn("nosocialscripts")||b.registerWaypointWithTimeout(e(".fb-like"),"150%",this.loadFacebook.bind(this),3e3),this.startAmazonStats(),this.startAmazonTextLinksWithSha(),this.insertViewstats(),i.isOn("no3rdparty")||((i.isOn("moatads_promoted")||i.isOn("moatads_headertag"))&&this.insertMoatAdScript(),(i.isOn("taboola")||i.isOn("only_taboola"))&&this.addTaboola()),s.onLoggedIn.done(t.bind(this.initAssetRecommendation,this)),i.isOn("analyticstracking")&&this.initPermalinkViewTracking(),a.start(),i.isOn("post_completion")&&this.trackPostCompletion(),j.startPromotions(),r=e("#sharingfooter"),r.length>0&&(this.sharingfooter=new v({el:r,model:this.starterPost})),window.markUserTime("JS - After PostApp start - "+(i.isOn("webpack")?"Webpack":"Require")+" - "+c)},initLeftrailContained:function(){var n;i.isOn("personalized_trending_module")||i.isOn("trending_test_c")?e.ajax("//kinja.com/api/analytics/kala/recommendedPostsForUser",{xhrFields:{withCredentials:!0},crossDomain:!0}).done(function(s){var o=s.data||[],i="?"+o.map(function(e){return"id="+e}).join("&");e.ajax("/api/core/corepost/getList"+i).done(function(s){var i=s.data||[],o=i.map(function(n){return e.extend(n,{authorNameOrByline:n.author.displayName||n.byline,image:n.sharingMainImage||(n.images||[])[0],defaultBlogName:(t.find(n.blogs,function(e){return e.id===n.defaultBlogId})||{}).displayName})}).slice(0,3);n=new y({el:".js_sidebar",trendingPosts:o.length>2?o:0[0]}),n.render()})}).fail(function(){n=new y({el:".js_sidebar"}),n.render()}):(n=new y({el:".js_sidebar"}),n.render())},startDiscussionApplet:function(){return require(["module/DiscussionIconModule"],function(){}),this.shouldLoadReplies()&&require(["module/DiscussionModule"],function(e){l.discussionRegion.show(e)}),!1},shouldLoadReplies:function(){return this.starterPost.get("allowReplies")!==!1||0!==this.starterPost.get("replyCount")},startAnnotations:function(){new d({model:this.starterPost,el:e("body")}).startApp()},startAmazonStats:function(){var t=this;s.onLoggedIn.done(function(){s.hasPermission("SALES")&&"on"===n.getParameterByName("amazonstats")&&require(["module/AmazonStats"],function(n){var s=e(".post-wrapper article.post"),o=new n({postId:t.starterPost.id});s.prepend(o.$el)})}.bind(this))},startAmazonTextLinks:function(){if(""===document.referrer)return!1;var s=t.filter(e(".post-content a"),function(t){return!!e(t).data("amazontag")}),n=document.referrer.match(/:\/\/([^/]+)\//);null!==n&&(n=n[1],t.each(s,function(t){var s=e(t).attr("href").replace("&ascsubtag=","&ascsubtag=[r|"+n);e(t).attr("href",s)}))},startAmazonTextLinksWithSha:function(){var s=function(e){var t=new p(e,"TEXT");return t.getHash("SHA-1","HEX")},l=function(e){var t=document.referrer;return""===t?e:"[r|"+t+e},i=function(e){return e.split("?")[0]},n=function(e){return g.fromQueryString(e.split("?")[1])},c=function(e){var t=n(e),s=t.ascsubtag;return t.rawdata=s,i(e)+g.toQueryString(t)},r=function(){return t.filter(e(".post-content a"),function(t){return!!e(t).data("amazontag")})},a=function(e){var t=n(e),s=t.rawdata;return s},o=function(e,t){var o=i(t),s=n(t),a=s.ascsubtag,r=e(a);return s.ascsubtag=r,o+g.toQueryString(s)},d=function(e){return o(l,e)},u=function(e){return o(s,e)},h=function(t){e(t).click(function(){var n=a(e(t).attr("href")),o=encodeURIComponent(n);e.ajax("/api/ecommerce/amazon/putSubtag?data="+o,{type:"GET",error:function(e){require(["module/Raven"],function(t){t.captureMessage("Analytics: Could not send subtag",{extra:{subtag:n,subtagSha:s(n),analyticsResponse:e.status,analyticsResponseStatusText:e.statusText,analyticsResponseText:e.responseText}})})}})})},m=function(t,n){var o=String(e(n).attr("href")),s=t(o);return e(n).attr("href",s),s},f=function(e){m(t.compose(u,c,d),e)};t.forEach(r(),function(e){f(e),h(e)})},initUserTools:function(){var t,e=this.options.id;n.getKinjaMeta().post&&n.getKinjaMeta().post.id!==this.options.id&&(e=n.getKinjaMeta().post.id),t=new m({id:e})},trackPostCompletion:function(){var n=e(window),s=e(".post-bottom").offset().top,o=function(){var e=n.height(),t=e+n.scrollTop();t>s&&(window.ga("send","event","post completion","post completion",{nonInteraction:1}),n.off("scroll.postCompletion"))};n.on("scroll.postCompletion",t.throttle(o,1e3))},insertMoatAdScript:function(){if(!n.getKinjaMeta().post.sponsored)return!1;var t=['<script type="text/javascript">',"(function(){",'var a=document,b=a.createElement("script"),a=a.getElementsByTagName("script")[0];','b.type="text/javascript";b.async=!0;','b.src="http://js.moatads.com/gawkersppage4859385728/moatcontent.js";',"a.parentNode.insertBefore(b,a)","})();","<\/script>"];e("body").append(t.join(""))},initAssetRecommendation:function(){var e=new m(n.getKinjaMeta().post),t=s.hasRole("ADMIN",e.get("defaultBlogId")),o=s.isSuperuser()&&i.isOn("superuser");(t||o)&&this.startRecommendAssetMixin(e)},insertViewstats:function(){var s=this,t=this.starterPost.get("id"),o=this.options.id,i=new m({id:t}),r=function(e,t){var n=s.soyToHtml(tiger.components.post.meta.postViewCount,{isBlip:i.get("isBlip"),isBillboardPost:i.get("isBillboardPost"),viewstats:e});s.$el.find(".view-count-container").eq(t).html(n)},a=function(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},n=function(t,n){e.ajax("/api/analytics/kala/viewsForPost?id="+t).done(function(e){var t=e.data[0]||{},s=a(t.views||0),o=a(t.uniqueViews||0);t.nonUniqueFormatted=s,t.uniqueFormatted=o,r(t,n)})};t!==o?(n(t,0),n(o,1)):n(t,0)},initPermalinkViewTracking:function(){var t=this.starterPost.get("id"),i=e(".js_stats").data("unique")||!1,n=e("#analytics-permalink-view").data(),a=n.authorId,r=(n.tagIds||"").toString().split(",");c.setContext(o.id,"PERMALINK",t),c.pushEvent("PERMALINK_VIEW","POST",t,{blogName:o.canonicalHost,unique:i,authorId:a.toString(),isLoggedIn:s.isLoggedIn()?1:0},{tagIds:r})},loadFacebook:function(){e.getScript("https://connect.facebook.net/en_US/sdk.js",function(){window.fbAsyncInit=function(){window.FB.init({appId:n.getKinjaMeta().blog&&n.getKinjaMeta().blog.fbAppId?n.getKinjaMeta().blog.fbAppId:"36368793975",version:"v2.0",status:!0,cookie:!0,xfbml:!0})}})},addTaboola:function(){var n=this.starterPost.get("sponsored"),e="Below Article Thumbnails Organic",t=window.parseInt(i.value("discussion_truncation")||0,10);t&&(e+=" - "+t+" Threads"),window._taboola=window._taboola||[],window._taboola.push({article:"auto"}),window._taboola.push({mode:n?"organic-thumbnails-a":"thumbnails-a",container:"taboola-below-article-thumbnails",placement:e,tracking:"utm_source=taboola",target_type:"mix"})}}));return w=parseInt(n.getKinjaMeta().postId,10),"permalink"===n.getKinjaMeta().pageType&&!(w!=w)&&new O({id:w}).start()})