if("undefined"==typeof tiger)var tiger={};"undefined"==typeof tiger.components&&(tiger.components={}),"undefined"==typeof tiger.components.ad&&(tiger.components.ad={}),"undefined"==typeof tiger.components.annotation&&(tiger.components.annotation={}),"undefined"==typeof tiger.components.blogdropdown&&(tiger.components.blogdropdown={}),"undefined"==typeof tiger.components.duiModal&&(tiger.components.duiModal={}),"undefined"==typeof tiger.components.forms&&(tiger.components.forms={}),"undefined"==typeof tiger.components.forms.modals&&(tiger.components.forms.modals={}),"undefined"==typeof tiger.components.forms.search&&(tiger.components.forms.search={}),"undefined"==typeof tiger.components.groupchats&&(tiger.components.groupchats={}),"undefined"==typeof tiger.components.header&&(tiger.components.header={}),"undefined"==typeof tiger.components.header.notifications&&(tiger.components.header.notifications={}),"undefined"==typeof tiger.components.invites&&(tiger.components.invites={}),"undefined"==typeof tiger.components.invites.menuItems&&(tiger.components.invites.menuItems={}),"undefined"==typeof tiger.components.invites.modals&&(tiger.components.invites.modals={}),"undefined"==typeof tiger.components.navpanels&&(tiger.components.navpanels={}),"undefined"==typeof tiger.components.notifications&&(tiger.components.notifications={}),"undefined"==typeof tiger.components.post&&(tiger.components.post={}),"undefined"==typeof tiger.components.post.button&&(tiger.components.post.button={}),"undefined"==typeof tiger.components.post.media&&(tiger.components.post.media={}),"undefined"==typeof tiger.components.post.meta&&(tiger.components.post.meta={}),"undefined"==typeof tiger.components.promotions&&(tiger.components.promotions={}),"undefined"==typeof tiger.components.spinner&&(tiger.components.spinner={}),"undefined"==typeof tiger.components.user&&(tiger.components.user={}),"undefined"==typeof tiger.icons&&(tiger.icons={}),"undefined"==typeof tiger.icons.actions&&(tiger.icons.actions={}),"undefined"==typeof tiger.icons.essential&&(tiger.icons.essential={}),"undefined"==typeof tiger.icons.places&&(tiger.icons.places={}),"undefined"==typeof tiger.messages&&(tiger.messages={}),"undefined"==typeof tiger.messages.postAction&&(tiger.messages.postAction={}),"undefined"==typeof tiger.messages.time&&(tiger.messages.time={}),"undefined"==typeof tiger.section&&(tiger.section={}),"undefined"==typeof tiger.section.header&&(tiger.section.header={}),"undefined"==typeof tiger.section.sidebar&&(tiger.section.sidebar={}),"undefined"==typeof tiger.utils&&(tiger.utils={}),define("app/editor/config/paths",[],function(){"use strict";return{proxiedPath:"/proxy/iframe?url="}}),define("singleton/IframeResizer",["underscore","app/editor/config/paths"],function(a,b){"use strict";function c(c,d){function e(a,b,c){c.setAttribute(a,b)}if(c&&d){var f=a.filter(document.getElementsByTagName("iframe"),function(c){var e=decodeURI(c.src),f=decodeURI(d),g=b.proxiedPath+encodeURIComponent(f);return a.contains([f,g],e)});a.each(["width","height"],function(b){"number"==typeof c[b]&&a.each(f,e.bind(void 0,b,c[b]))})}}function d(b){var c,d=b.data,e=window.location.protocol+"//"+window.location.host;if((b.origin===e||b.origin.match(f))&&d){if(a.isObject(d)&&d.kinja)return d.kinja;try{c=JSON.parse(d).kinja}catch(g){}return c||!1}}var e,f;return f=/^https?:\/\/(\w+\.)?(kinja.com|gawker-labs.com|localhost:7000|kinja\.dev:9000)$/,e={start:function(){function b(a){var b=d(a);b&&b.resizeFrame&&b.sourceUrl&&c(b.resizeFrame,b.sourceUrl),b&&b.getUrl&&a.source.postMessage({kinja:{url:window.location.href}},a.origin)}window.addEventListener("message",b),window._K_MSGS&&a.each(window._K_MSGS,b),window.removeEventListener("message",window._K_MSG_L),delete window._K_MSG_L}}}),function(){"use strict";define("module/Main",["jquery","singleton/Feature","singleton/RavenConfig","singleton/Trackers","singleton/DeviceController","singleton/PerfTracker","module/ads/ads.controller","app/MarionetteApp","singleton/CurrentUser","singleton/CurrentBlog","lib/kriteo","module/foundation/Foundation5","lib/polyfills/json-null-old-android"],function(a,b,c,d,e,f,g,h){function i(){c.init(),b.isOn("no3rdparty")?d.loadDummy():(d.load(),e.setDevice(),g.startAds()),h.start(),b.isOn("frontendtiming")&&window.setTimeout(function(){f.start()},0)}return a.ajaxSetup({cache:!0}),{start:i}})}(),define("templates/tiger/messages",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.messages.areYouSureToDisconnect=function(a,b,c){return"Are you sure you want to disconnect this account?"},d.DEBUG&&(b.messages.areYouSureToDisconnect.soyTemplateName="tiger.messages.areYouSureToDisconnect"),b.messages.settingsSaved=function(a,b,c){return"Settings saved successfully."},d.DEBUG&&(b.messages.settingsSaved.soyTemplateName="tiger.messages.settingsSaved"),b.messages.confirmationEmail=function(a,b,c){return"Confirmation email has been sent."},d.DEBUG&&(b.messages.confirmationEmail.soyTemplateName="tiger.messages.confirmationEmail"),b.messages.blogPropertySaved=function(a,b,c){return"Blog property saved successfully."},d.DEBUG&&(b.messages.blogPropertySaved.soyTemplateName="tiger.messages.blogPropertySaved"),b.messages.blogPropertyCreated=function(a,b,c){return"Blog property created successfully."},d.DEBUG&&(b.messages.blogPropertyCreated.soyTemplateName="tiger.messages.blogPropertyCreated"),b.messages.blogPropertyDeleted=function(a,b,c){return"Blog property deleted successfully."},d.DEBUG&&(b.messages.blogPropertyDeleted.soyTemplateName="tiger.messages.blogPropertyDeleted"),b.messages.ownerSet=function(a,b,c){return"New owner has been set."},d.DEBUG&&(b.messages.ownerSet.soyTemplateName="tiger.messages.ownerSet"),b.messages.cannotDisconnectLoginAccount=function(a,b,c){return"You cannot disconnect your login account from Kinja. Please switch your login account, save, and try again."},d.DEBUG&&(b.messages.cannotDisconnectLoginAccount.soyTemplateName="tiger.messages.cannotDisconnectLoginAccount"),b.messages.repliesDisabled=function(a,c,d){return'<div class="twelve columns end mbx"><div class="reply-create media"><div class="img mrm icon--svg">'+b.icons.discussion.bubbleClose(null,null,d)+'</div><div class="bd proxima"><span class="msg text-small text-light">This discussion is closed</span></div></div></div>'},d.DEBUG&&(b.messages.repliesDisabled.soyTemplateName="tiger.messages.repliesDisabled"),b.messages.imageUploadError=function(a,b,c){return"Image upload error."},d.DEBUG&&(b.messages.imageUploadError.soyTemplateName="tiger.messages.imageUploadError"),b.messages.assetRecommended=function(a,b,c){return"Media recommended."},d.DEBUG&&(b.messages.assetRecommended.soyTemplateName="tiger.messages.assetRecommended"),b.messages.assetUnrecommended=function(a,b,c){return"Removed media recommendation."},d.DEBUG&&(b.messages.assetUnrecommended.soyTemplateName="tiger.messages.assetUnrecommended"),b.messages.amazonBestSellerReport=function(a,b,c){return"<p><small>If the blog list is omitted, all blogs will be taken into account. If the limit is set to 0, no limit is set.</small></p>"},d.DEBUG&&(b.messages.amazonBestSellerReport.soyTemplateName="tiger.messages.amazonBestSellerReport"),b.messages.amazonTagReport=function(a,b,c){return"<p><small>Beware: If the checkbox above is unchecked, Amazon statistics and posts will both be filtered by the date picker. This means that earnings and orders for posts which were published earlier will <strong>not</strong> be shown here.</small></p>"},d.DEBUG&&(b.messages.amazonTagReport.soyTemplateName="tiger.messages.amazonTagReport")}),define("templates/tiger/components/notifications/button",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.notifications.button=function(a,c,d){var f='<a href="#" class="js_notification-trigger hide-for-medium-down toolbar-icon notifications-menu is-loaded '+(a.notificationCount>0?"has-notification":"")+'" title="'+(a.notificationCount>999?b.messages.notifications({count:a.notificationCount},null,d):"Notifications")+'" data-dropdown="notifications-menu"><span class="icon-circle icon-notifications"></span>',g=""+(a.notificationCount>999?"infinite":a.notificationCount>99?"hundred":1==a.notificationCount?"only-one":"");return f+='<span class="notification-count js_notification-count '+e.$$escapeHtmlAttribute(g)+'">'+b.components.notifications.count(a,null,d)+"</span></a>"},d.DEBUG&&(b.components.notifications.button.soyTemplateName="tiger.components.notifications.button"),b.components.notifications.count=function(a,b,c){var d="",f=""+(a.notificationCount>999?"∞":a.notificationCount?e.$$escapeHtml(a.notificationCount):"");return d+=f?e.$$escapeHtml(f):""},d.DEBUG&&(b.components.notifications.count.soyTemplateName="tiger.components.notifications.count")}),define("templates/tiger/components/header/notifications",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.header.notifications.notificationsEmpty=function(a,b,c){return'<li class="text-center pvm js_notification-item">You have no unread notifications.</li>'},d.DEBUG&&(b.components.header.notifications.notificationsEmpty.soyTemplateName="tiger.components.header.notifications.notificationsEmpty"),b.components.header.notifications.notificationsSpinner=function(a,c,d){return'<li class="js_spinner notifications-spinner">'+b.components.spinner.bounce(null,null,d)+"</li>"},d.DEBUG&&(b.components.header.notifications.notificationsSpinner.soyTemplateName="tiger.components.header.notifications.notificationsSpinner"),b.components.header.notifications.globalNotificationsDropdown=function(a,c,d){return'<section class="notif-list"><div class="notif-list-scroll-wrapper"><ul class="js_notification-list menu-list"></ul></div><ul class="menu-list see-all-link"><li class="more"><div class="show-for-large-up"><a class="js_event-link js_see-all-notifications" data-ga="[Notifications Menu, See All Notifications Click]" href="//kinja.com/dashboard/notifications">See all notifications</a></div><div class="show-for-medium-down"><a class="button secondary hide icon--svg u-highlighted js_event-link js_see-all-notifications" data-ga="[Notifications Menu, See All Notifications Click]" href="//kinja.com/dashboard/notifications">See all notifications'+b.icons.essential.chevronRight(null,null,d)+"</a></div></li></ul></section>"},d.DEBUG&&(b.components.header.notifications.globalNotificationsDropdown.soyTemplateName="tiger.components.header.notifications.globalNotificationsDropdown"),b.components.header.notifications.globalNotificationEvent=function(a,c,d){var e="";switch(a.item.variant){case"PresentableApproval":e+=b.components.header.notifications.approval(a,null,d);break;case"PresentableUserFollow":e+=b.components.header.notifications.userfollow(a,null,d);break;case"PresentableBlogFollow":e+=b.components.header.notifications.blogfollow(a,null,d);break;case"PresentableMessage":e+=b.components.header.notifications.message(a,null,d);break;case"PresentablePostFollow":e+=b.components.header.notifications.postfollow(a,null,d);break;case"PresentablePostLikeGroup":e+=a.item.sourceAuthorData&&a.item.sourceAuthorData.id?b.components.header.notifications.postlikegroup(a,null,d):"";break;case"PresentableReply":e+=b.components.header.notifications.reply(a,null,d);break;case"PresentableRepost":e+=b.components.header.notifications.repostpost(a,null,d);break;case"PresentableShare":e+=b.components.header.notifications.sharepost(a,null,d);break;case"PresentablePendingMembership":e+=b.components.header.notifications.pendingmembership(a,null,d);break;case"PresentableMembershipResponse":e+=b.components.header.notifications.membershipresponse(a,null,d)}return e+='<span class="unread-marker"></span>'},d.DEBUG&&(b.components.header.notifications.globalNotificationEvent.soyTemplateName="tiger.components.header.notifications.globalNotificationEvent"),b.components.header.notifications.blogfollow=function(a,c,d){return'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.screenName)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.add(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.avatar.id,"avt-small",a.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.defaultBlog.displayName)+'</span><span class="event-msg">started following you.</span></span></div></div></a>'},d.DEBUG&&(b.components.header.notifications.blogfollow.soyTemplateName="tiger.components.header.notifications.blogfollow"),b.components.header.notifications.approval=function(a,c,d){return'<a href="http://'+e.$$escapeHtmlAttribute(null==a.item.sourceBlogData?null:a.item.sourceBlogData.canonicalHost)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.add(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar">'+((null==a.item.sourceBlogData?null:a.item.sourceBlogData.avatar)?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.sourceBlogData.avatar.id,"avt-small",a.item.sourceBlogData.avatar.format)))+'" />':'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.imgPath))+'icons/icon-kinja-nav.png" />')+'</span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==a.item.sourceBlogData?null:a.item.sourceBlogData.displayName)+'</span><span class="event-msg">'+(d.features.approvemessage?"approved you":"started following you")+"</span></span></div></div></a>"},d.DEBUG&&(b.components.header.notifications.approval.soyTemplateName="tiger.components.header.notifications.approval"),b.components.header.notifications.reply=function(a,c,d){var f="",g=(a.item.reply,null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName);f+=(d.features.hide_pending_replies&&!(null==a.item.postData?null:a.item.postData.approved)?'<span class="pending-label">Pending approval</span>':"")+'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(null==a.item.postData?null:a.item.postData.permalink))+'" data-ga="[Notifications Menu, Reply Notification Click]" class="js_event-link event-reply icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.bubble(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center">';var h="avt-small";return f+='<span class="avatar">'+((null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.avatar)?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.sourceAuthorData.avatar.id,h,a.item.sourceAuthorData.avatar.format)))+'" />':'<span class="avatar-default"></span>')+'</span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(g)+'</span><div class="text-normal text-small">replied to you:</div><div class="msg-excerpt">'+e.$$truncate(e.$$filterNoAutoescape(null==a.item.postData?null:a.item.postData.plaintext),80,!0)+"</div></span></div></div></a>"},d.DEBUG&&(b.components.header.notifications.reply.soyTemplateName="tiger.components.header.notifications.reply"),b.components.header.notifications.postlikegroup=function(a,c,d){var f="",g=a.item.sourceAuthorsData.length;return f+='<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(null==a.item.postData?null:a.item.postData.permalink))+'" data-ga="[Notifications Menu, Recommend Group Notification Click]" class="js_event-link event-like icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.star(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.sourceAuthorData.avatar.id,"avt-small",a.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt">'+((null==a.item.postData?null:a.item.postData.headline)?1==g?'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and one other recommended <strong>'+e.$$filterNoAutoescape(null==a.item.postData?null:a.item.postData.headline)+"</strong>.</span>":g>1?'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and '+e.$$escapeHtml(a.item.sourceAuthorsData.length)+" others recommended <strong>"+e.$$filterNoAutoescape(null==a.item.postData?null:a.item.postData.headline)+"</strong>.</span>":'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+' </span><span class="event-msg">recommended <strong>'+e.$$filterNoAutoescape(null==a.item.postData?null:a.item.postData.headline)+"</strong>.</span></span>":1==g?'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and one other recommended your post.</span></span>':g>1?'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+' </span><span class="event-msg">and '+e.$$escapeHtml(a.item.sourceAuthorsData.length)+" others recommended your post</strong>.</span></span>":'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+' </span><span class="event-msg">recommended your post.</span></span>')+"</span></div></div></a>"},d.DEBUG&&(b.components.header.notifications.postlikegroup.soyTemplateName="tiger.components.header.notifications.postlikegroup"),b.components.header.notifications.message=function(a,c,d){return'<div><div class="row collapse" data-ga="[Notifications Menu, Message Notification Click]"><div class="col small-2 center">'+b.icons.actions.lightning(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.avatar.id,"avt-small",null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+'</span> messaged you:<br><span class="msg-excerpt">'+e.$$escapeHtml(a.item.message)+"</span></span></div></div></div>"},d.DEBUG&&(b.components.header.notifications.message.soyTemplateName="tiger.components.header.notifications.message"),b.components.header.notifications.postfollow=function(a,b,c){return""},d.DEBUG&&(b.components.header.notifications.postfollow.soyTemplateName="tiger.components.header.notifications.postfollow"),b.components.header.notifications.sharepost=function(a,c,d){return'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(null==a.item.sharedData?null:a.item.sharedData.permalink))+'" data-ga="[Notification Menu, Menu - Share Notification]" class="js_event-link event-share icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.externalLink(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.sourceAuthorData.avatar.id,"avt-small",a.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared your post as <strong>'+e.$$filterNoAutoescape(null==a.item.sharedData?null:a.item.sharedData.headline)+"</strong></span></span></div></div></a>"},d.DEBUG&&(b.components.header.notifications.sharepost.soyTemplateName="tiger.components.header.notifications.sharepost"),b.components.header.notifications.repostpost=function(a,c,d){return""+(a.item.postActionData?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.item.postActionData.post.permalink))+'" data-ga="[Notification Menu, Menu - Repost Notification]" class="js_event-link event-share icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.externalLink(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.sourceAuthorData.avatar.id,"avt-small",a.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt">'+(a.item.postActionData.post.headline?'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared <strong>'+e.$$filterNoAutoescape(a.item.postActionData.post.headline)+"</strong> to "+e.$$escapeHtml(null==a.item.postActionData?null:a.item.postActionData.blog.displayName)+"</span>":'<span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+'</span><span class="event-msg">shared your reply to '+e.$$escapeHtml(null==a.item.postActionData?null:a.item.postActionData.blog.displayName)+"</span>")+"</span></div></div></a>":"")},d.DEBUG&&(b.components.header.notifications.repostpost.soyTemplateName="tiger.components.header.notifications.repostpost"),b.components.header.notifications.globalNotificationsButton=function(a,c,d){var f="",g=""+(a.notificationCount>999?"infinite":a.notificationCount>99?"hundred":1==a.notificationCount?"only-one":"");return f+='<a class="js_notif show-for-large-up js_menu-button '+(a.notificationCount?"has-notification":"")+'" data-dropdown="js_notifications--dropdown" data-ga="[Notifications Menu, Notifications Menu Click, '+(a.notificationCount?"New":"Neutral")+']">'+(a.notificationCount?'<span class="js_notifications-count notif-circle '+e.$$escapeHtmlAttribute(g)+'">'+b.components.header.notifications.count(a,null,d)+"</span>":'<span class="notif-circle">'+b.icons.actions.lightning(null,null,d)+"</span>")+'</a><a class="js_notif show-for-medium-down js_offcanvas-notif js_menu-button '+(a.notificationCount?"has-notification":"")+'" data-ga="[Notifications Menu, Notifications Menu Click, '+(a.notificationCount?"New":"Neutral")+']">'+(a.notificationCount?'<span class="js_notifications-count notif-circle '+e.$$escapeHtmlAttribute(g)+'">'+b.components.header.notifications.count(a,null,d)+"</span>":'<span class="notif-circle">'+b.icons.actions.lightning(null,null,d)+"</span>")+"</a>"},d.DEBUG&&(b.components.header.notifications.globalNotificationsButton.soyTemplateName="tiger.components.header.notifications.globalNotificationsButton"),b.components.header.notifications.count=function(a,b,c){return""+(a.notificationCount>999?"∞":e.$$escapeHtml(a.notificationCount))},d.DEBUG&&(b.components.header.notifications.count.soyTemplateName="tiger.components.header.notifications.count"),b.components.header.notifications.userfollow=function(a,c,d){return'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.screenName)+'" data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.essential.add(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.sourceAuthorData.avatar.id,"avt-small",a.item.sourceAuthorData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(null==a.item.sourceAuthorData?null:a.item.sourceAuthorData.displayName)+'</span><span class="event-msg">started following you.</span></span></div></div></a>'},d.DEBUG&&(b.components.header.notifications.userfollow.soyTemplateName="tiger.components.header.notifications.userfollow"),b.components.header.notifications.pendingmembership=function(a,c,d){return'<div data-ga="[Notifications Menu, Follow Notification Click]" class="js_event-link event-follow icon--svg u-full"><div class="row collapse"><div class="col small-2 center">'+b.icons.places.user(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.invitedByData.avatar.id,"avt-small",a.item.invitedByData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name"></span><span class="event-msg"><strong>'+e.$$escapeHtml(a.item.invitedByData.displayName)+'</strong> invited you to be an author on their blog <a href="http://'+e.$$escapeHtmlAttribute(a.item.blogData.canonicalHost)+'">'+e.$$escapeHtml(a.item.blogData.displayName)+'</a></span></span></div></div><div class="dui row collapse notification__btn-cont"><div class="col small-offset-2 small-5"><a class="button small js_invite-btn" data-accepting="true">Accept</a></div><div class="col small-5"><a class="button small secondary js_invite-btn" data-accepting="false">Decline</a></div></div></div>'},d.DEBUG&&(b.components.header.notifications.pendingmembership.soyTemplateName="tiger.components.header.notifications.pendingmembership"),b.components.header.notifications.membershipresponse=function(a,c,d){return'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.item.blogData.displayName)+'/manage" data-ga="[Notifications Menu, Membership Response Notification Click]" class="js_event-link event-follow icon--svg"><div class="row collapse"><div class="col small-2 center">'+b.icons.places.user(null,null,d)+'</div><div class="col small-10"><time>'+e.$$escapeHtml(a.item.relativeTime)+'</time></div></div><div class="row collapse"><div class="col small-2 center"><span class="avatar"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.item.inviteeData.avatar.id,"avt-small",a.item.inviteeData.avatar.format)))+'" /></span></div><div class="col small-10"><span class="txt"><span class="name">'+e.$$escapeHtml(a.item.inviteeData.displayName)+'</span><span class="event-msg">'+(a.item.accepted?"accepted your invitation.":"declined your invitation.")+"</span></span></div></div></a>"},d.DEBUG&&(b.components.header.notifications.membershipresponse.soyTemplateName="tiger.components.header.notifications.membershipresponse")}),define("app/notifdropdown/NotificationButton",["backbone.marionette","app/account/account.channel","templates/tiger/messages","templates/tiger/components/notifications/button","templates/tiger/components/header/notifications"],function(a,b){"use strict";var c=a.ItemView.extend({template:tiger.components.header.notifications.globalNotificationsButton,tagName:"span",attributes:function(){return{"data-ga":"["+["Notifications Menu","Notifications Button Click",this.model.get("notificationCount")?"New":"Neutral"].join(", ")+"]"}},activeClass:"active",modelEvents:{"change:notificationCount":"render"},render:function(){a.ItemView.prototype.render.apply(this)},doClick:function(a){this.model.isLoggedIn()?this.toggleClass():(a.stopPropagation(),this.requireLogin())},requireLogin:function(){b.trigger("loginRequired",{source:"notificationButton"})},toggleClass:function(){this.$el.toggleClass(this.activeClass)}});return c}),define("apiclient/notification",["config","apiclient/apirequest","apiclient/gettoken"],function(a,b,c){"use strict";var d,e=a.api.mantle.url,f=a.api.notification.url;return d={getNotificationCount:b.getJson(c.append(f+"/notification/views/unseenCount")),deleteNotification:b.deleteJson(c.append(f+"/notification/{{notificationId}}")),getNotifications:b.getJson(c.append(e+"/notifications/paginated/{{userId}}",c.fresh))}}),define("app/notifdropdown/notificationCount.model",["backbone","singleton/CurrentUser","apiclient/notification"],function(a,b,c){"use strict";var d=a.Model.extend({defaults:{notificationCount:0,inSync:!1},sync:function(a,d,e){var f=b.get("token"),g=b.isLoggedIn();return g&&f&&-1===f.indexOf("dummy-")?c.getNotificationCount({userId:b.id},e):void 0},isNew:function(){return!this.get("inSync")},parse:function(a){return{notificationCount:parseInt(a.data,10)||0,inSync:!0}},markAsRead:function(){this.empty(),this.save()},empty:function(){this.set({notificationCount:0})},remove:function(){this.empty(),this.stopListening()}});return d}),define("model/Notification",["backbone","apiclient/profile"],function(a,b){"use strict";var c=a.Model.extend({sync:function(a,c,d){switch(a){case"delete":return b.deleteNotification({notificationId:c.get("id")});case"update":case"create":return d.acceptingInvite?b.acceptMembershipInvitation({invitationId:c.get("invitationId")},d):b.rejectMembershipInvitation({invitationId:c.get("invitationId")},d)}}});return c}),define("templates/tiger/messages/time",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.messages.time.oneSecondAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"seconds"},null,d)},d.DEBUG&&(b.messages.time.oneSecondAgo.soyTemplateName="tiger.messages.time.oneSecondAgo"),b.messages.time.someSecondsAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"seconds",amount:a.seconds},null,d)},d.DEBUG&&(b.messages.time.someSecondsAgo.soyTemplateName="tiger.messages.time.someSecondsAgo"),b.messages.time.oneMinuteAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"minute"},null,d)},d.DEBUG&&(b.messages.time.oneMinuteAgo.soyTemplateName="tiger.messages.time.oneMinuteAgo"),b.messages.time.someMinutesAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"minutes",amount:a.minutes},null,d)},d.DEBUG&&(b.messages.time.someMinutesAgo.soyTemplateName="tiger.messages.time.someMinutesAgo"),b.messages.time.oneHourAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"hours"},null,d)},d.DEBUG&&(b.messages.time.oneHourAgo.soyTemplateName="tiger.messages.time.oneHourAgo"),b.messages.time.someHoursAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"hours",amount:a.hours},null,d)},d.DEBUG&&(b.messages.time.someHoursAgo.soyTemplateName="tiger.messages.time.someHoursAgo"),b.messages.time.oneDayAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"days"},null,d)},d.DEBUG&&(b.messages.time.oneDayAgo.soyTemplateName="tiger.messages.time.oneDayAgo"),b.messages.time.someDaysAgo=function(a,c,d){
return""+b.messages.time.relativeTime({type:"days",amount:a.days},null,d)},d.DEBUG&&(b.messages.time.someDaysAgo.soyTemplateName="tiger.messages.time.someDaysAgo"),b.messages.time.oneMonthAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"months"},null,d)},d.DEBUG&&(b.messages.time.oneMonthAgo.soyTemplateName="tiger.messages.time.oneMonthAgo"),b.messages.time.someMonthsAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"months",amount:a.months},null,d)},d.DEBUG&&(b.messages.time.someMonthsAgo.soyTemplateName="tiger.messages.time.someMonthsAgo"),b.messages.time.oneYearAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"years"},null,d)},d.DEBUG&&(b.messages.time.oneYearAgo.soyTemplateName="tiger.messages.time.oneYearAgo"),b.messages.time.someYearsAgo=function(a,c,d){return""+b.messages.time.relativeTime({type:"years",amount:a.years},null,d)},d.DEBUG&&(b.messages.time.someYearsAgo.soyTemplateName="tiger.messages.time.someYearsAgo"),b.messages.time.relativeTime=function(a,b,c){a=a||{};var d="";switch(a.type){case"seconds":d+=a.amount&&"1"!=a.amount?e.$$escapeHtml(a.amount)+" seconds ago":"1 second ago";break;case"hours":d+=a.amount&&"1"!=a.amount?e.$$escapeHtml(a.amount)+" hours ago":"an hour ago";break;case"days":d+=a.amount&&"1"!=a.amount?e.$$escapeHtml(a.amount)+" days ago":"yesterday";break;case"weeks":d+=a.amount&&"1"!=a.amount?e.$$escapeHtml(a.amount)+" weeks ago":"a week ago";break;case"months":d+=a.amount&&"1"!=a.amount?e.$$escapeHtml(a.amount)+" months ago":"a month ago";break;case"years":d+=a.amount&&"1"!=a.amount?e.$$escapeHtml(a.amount)+" years ago":"1 year ago";break;case"future":d+=e.$$escapeHtml(a.Mddyyhmma);break;case"minutes":d+=a.amount&&"1"!=a.amount?'<span class="'+(a.timestamp?"minutedisplay-"+e.$$escapeHtmlAttribute(a.timestamp):"")+'">'+e.$$escapeHtml(a.amount)+"</span> minutes ago":'<span class="'+(a.timestamp?"minutedisplay-"+e.$$escapeHtmlAttribute(a.timestamp):"")+'">A</span> minute ago';break;case"today":d+="Today "+e.$$escapeHtml(a.hmma);break;case"yesterday":d+="Yesterday "+e.$$escapeHtml(a.hmma);break;case"pastweek":d+=e.$$escapeHtml(a.day)+" "+e.$$escapeHtml(a.hmma);break;case"greaterthanweek":d+=e.$$escapeHtml(a.Mddyyhmma);break;default:d+="Just now"}return d},d.DEBUG&&(b.messages.time.relativeTime.soyTemplateName="tiger.messages.time.relativeTime")}),define("singleton/DateUtils",["singleton/Renderer","moment","templates/tiger/messages/time"],function(a,b){"use strict";var c={getRelativeTime:function(b){var c=Math.round(((new Date).getTime()-parseInt(b,10))/1e3),d=Math.round(c/60),e=Math.round(c/3600),f=Math.round(c/86400),g=Math.round(c/2592e3),h=Math.round(c/31536e3),i=a.renderTemplate,j="";return j=60>c?1===c?i(tiger.messages.time.oneSecondAgo):i(tiger.messages.time.someSecondsAgo,{seconds:c}):60>d?1===d?i(tiger.messages.time.oneMinuteAgo):i(tiger.messages.time.someMinutesAgo,{minutes:d}):24>e?1===e?i(tiger.messages.time.oneHourAgo):i(tiger.messages.time.someHoursAgo,{hours:e}):30>f?1===f?i(tiger.messages.time.oneDayAgo):i(tiger.messages.time.someDaysAgo,{days:f}):12>g?1===g?i(tiger.messages.time.oneMonthAgo):i(tiger.messages.time.someMonthsAgo,{months:g}):1===h?i(tiger.messages.time.oneYearAgo):i(tiger.messages.time.someYearsAgo,{years:h}),j.textContent.replace(/^\s+|\s+$/g,"")},getMDYYYYHHMM:function(a){return b(a).format("M/D/YYYY H:mm")},getMDYYYY:function(a){return b(a).format("M/D/YYYY")},getDateTimeLocalString:function(a){return b(a).format("YYYY-MM-DDTHH:mm:ss")},getTimeInMilliseconds:function(a){return new Date(a).getTime()}};return c}),define("collection/Notifications",["underscore","backbone","model/Notification","singleton/CurrentUser","singleton/DateUtils","singleton/Feature","apiclient/notification"],function(a,b,c,d,e,f,g){"use strict";var h=b.Collection.extend({model:c,initialize:function(c,d){b.Collection.prototype.initialize.call(this,c,d),this.options=a.extend(this.options,d||{})},sync:function(a,b,c){var e=f.isOn("pendingmember");return g.getNotifications({markAsRead:!0,userId:d.id,maxReturned:5,pinPending:e},c)},parse:function(b){return!b||!b.data||!b.meta||b.meta.error||b.meta.success&&b.meta.success!==!0?[]:a.map(b.data.items,function(a){return a.relativeTime=e.getRelativeTime(a.createdAt),a.variant=a.$variant,a})}});return h}),define("app/notifdropdown/notifdropdown.app",["jquery","app/notifdropdown/NotificationButton","app/notifdropdown/notificationCount.model","collection/Notifications","singleton/CurrentUser","singleton/EventDispatcher","app/MarionetteApp","app/account/account.channel"],function(a,b,c,d,e,f,g,h){"use strict";var i,j;return j={notifications:null,notificationCountModel:null,notificationDropdown:null,notificationOffcanvas:null,initialize:function(){var a=new d;this.notifications=a,this.initNotificationButton()},initNotificationButton:function(){this.notificationCountModel=new c,e.onLoggedIn.done(function(){this.notificationCountModel.fetch()}.bind(this)),e.on("clearNotifications",function(){this.notificationCountModel.markAsRead()},this);var d=new b({el:g.notificationRegion.el,model:this.notificationCountModel});a(g.notificationDropdownRegion.el).one("opened.fndtn.dropdown",function(){var a;this.notificationDropdown||(a=this.initNotificationDropdown(),a.done(function(){this.notificationDropdown.trigger("opened:notifications")}.bind(this)))}.bind(this)),d.render(),g.notificationRegion.attachView(d)},initNotificationDropdown:function(){var b=a.Deferred();return require(["module/NotificationListModule"],function(a){this.notificationDropdown=new a({el:g.notificationDropdownRegion.el,collection:this.notifications,model:e}),this.notificationDropdown.on("opened:notifications",function(){e.isLoggedIn()&&(j.notificationDropdown.render(),this.notifications.fetch({reset:!0})),this.notificationCountModel.empty()},this),g.notificationDropdownRegion.attachView(this.notificationDropdown),b.resolve()}.bind(this)),b},remove:function(){f.off(null,null,this),e.off(null,null,this),h.off(null,null,this),this.notificationDropdown&&(this.notificationDropdown.off(null,null,this),this.notificationDropdown=null),this.notificationCountModel&&(this.notificationCountModel.remove(),this.notificationCountModel=null)}},i={initialize:function(){return j.initialize()},fetch:function(){j.notifications.fetch()},remove:function(){j.remove()}}}),define("gawkerlib/analytics/analytics_config_prod",[],function(){"use strict";var a={rootUrl:"http://kinja.com/api/analytics/",rootUrlWoProtocol:"//kinja.com/api/analytics/"};return a}),!function(){function a(a){this.message=a}var b="undefined"!=typeof exports?exports:this,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var d,e,f=String(b),g=0,h=c,i="";f.charAt(0|g)||(h="=",g%1);i+=h.charAt(63&d>>8-g%1*8)){if(e=f.charCodeAt(g+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");d=d<<8|e}return i}),b.atob||(b.atob=function(b){var d=String(b).replace(/=+$/,"");if(d.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,f,g=0,h=0,i="";f=d.charAt(h++);~f&&(e=g%4?64*e+f:f,g++%4)?i+=String.fromCharCode(255&e>>(-2*g&6)):0)f=c.indexOf(f);return i})}(),define("lib/base64.min",function(){}),define("module/KinjaAnalytics",["jquery","gawkerlib/analytics/analytics_config_prod","lib/base64.min"],function(a,b){"use strict";var c={session:{},context:{},setContext:function(a,b,c){this.context.blogId=a,this.context.contextType=b,this.context.id=c},createPayload:function(a,b,c,d,e,f,g,h){var i={blogId:a,eventType:b,targetType:c,targetId:d,contextType:e,contextId:f,eventAttributes:g,eventAttributesExtended:h};return i},pushEvent:function(a,b,c,d,e){var f=this.createPayload(this.context.blogId?String(this.context.blogId):null,a,b,c?String(c):null,this.context.contextType,this.context.id?String(this.context.id):null,d,e);this.writeEvent(f)},setSession:function(a){return"string"==typeof a.agid&&"string"==typeof a.asid&&a.ping?(this.session.globalId=a.agid,this.session.sessionId=a.asid,this.session.ping=a.ping,!0):!1},getEventMeta:function(){var a={context:this.context,session:this.session};return a},writeEvent:function(c){var d=btoa(JSON.stringify(c)),e=b.rootUrlWoProtocol,f=Math.floor(1e3*Math.random()+1),g=e+"t/event.js?e="+d+"&cb="+f,h=this;a.ajax(g,{type:"GET",success:function(a){h.setSession(a.data)},xhrFields:{withCredentials:!0},crossDomain:!0})}};return c}),define("view/posttools/BlogFollowToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","singleton/CurrentUser"],function(a,b,c,d,e){"use strict";var f,g;return f=function(a,c){return b.map(c,function(b){return"."+a+'[data-blogid="'+b+'"]'}).join(", ")},g=d.extend({events:{"click .js_followblogforuser":"followBlogForUser","click .js_unfollowblogforuser":"unfollowBlogForUser"},initialize:function(){var a=b.debounce(this.update,1e3);e.onAuthStateChange(a.bind(this)),this.on("update",a,this)},update:function(b){var c;return b=b||{},c=b.el||a("body"),e.onAuth.done(function(){this.resetControls(c),this.removePlaceholderBtn(c),e.isLoggedIn()?(this.updateBlogFollows(e.get("followedBlogIds"),"follow"),this.hideOwnBlogs()):this.resetControls(c)}.bind(this)),this},updateBlogFollows:function(b,c){var d=f("js_follow-blog-controls",b);a(d).find(".js_followblogforuser").toggleClass("hide","follow"===c).end().find(".js_unfollowblogforuser").toggleClass("hide","unfollow"===c)},hideOwnBlogs:function(){var c=f("js_follow-blog-controls",b.pluck(e.getBlogs(),"id"));a(c).addClass("hide")},resetControls:function(a){a.find(".js_unfollowblogforuser").addClass("hide"),a.find(".js_followblogforuser").removeClass("hide")},followBlogForUser:function(a){return this.blogFollowAction(a),!1},unfollowBlogForUser:function(a){return this.blogUnfollowAction(a),!1},blogFollowAction:function(b){var d,f=a(b.currentTarget).closest(".js_follow-blog-controls"),g=parseInt(f.attr("data-blogid"),10);d="profileFollowList"===a(b.currentTarget).attr("data-analytics-target")?"profileFollowList":"header",c.pushEvent("FOLLOW","BLOG",g,{uiElement:d}),e.requireLogin("blogfollow").done(function(){return-1!==e.get("followedBlogIds").indexOf(g)?!1:void e.followBlog(g).done(function(){this.updateBlogFollows([g],"follow")}.bind(this))}.bind(this))},blogUnfollowAction:function(b){var c=a(b.currentTarget).closest(".js_follow-blog-controls"),d=parseInt(c.attr("data-blogid"),10);e.requireLogin("blogunfollow").done(function(){e.unfollowBlog(d).done(function(){this.updateBlogFollows([d],"unfollow")}.bind(this))}.bind(this))},removePlaceholderBtn:function(b){b=b||a("body"),b.find(".js_list-control__empty").addClass("hide")}})}),define("view/modal/duimodal.defaultBehavior",["jquery","backbone.marionette"],function(a,b){"use strict";var c=b.Behavior.extend({events:{"click .js_close":"onCloseModal"},onShow:function(){a("body").addClass("disable-scroll");var b=a(this.view.bodyRegion.el);window.setTimeout(function(){b.addClass("dui-modal-body-animate")},100),this.contentBlurAdd(),this.$("img[data-src]").each(function(){var b=a(this);b.attr("src",b.data("src")).removeData("src")})},onCloseModal:function(){this.view.close(),this.contentBlurRemove(),a("body").removeClass("disable-scroll")},onCloseModalTimeout:function(a){var b=this;window.setTimeout(function(){b.onCloseModal()},a)},contentBlurAdd:function(){a(".js_page-content, .js_global-nav-wrap").addClass("blur-content")},contentBlurRemove:function(){a(".js_page-content, .js_global-nav-wrap").removeClass("blur-content")}});return c}),define("view/behaviors/googleAnalytics.behavior",["jquery","underscore","backbone.marionette","singleton/Utils"],function(a,b,c,d){"use strict";var e=c.Behavior.extend({events:{"click [data-ga]:not(form)":"onGAClick","submit form[data-ga]":"onGASubmit"},onGAClick:function(b){var c,d=a(b.currentTarget),e=d.closest("a[href]").eq(0);return this.logGAEvent(b),e.length&&(c=e.attr("href"),!/^((http|https):)?\/\//.test(c)||"_blank"===e.attr("target")||b.shiftKey||b.ctrlKey||b.metaKey||(b.preventDefault(),window.setTimeout(function(){window.location.href=c},500))),!0},onGASubmit:function(b){var c=a(b.currentTarget),d=c.attr("action"),e=c.serialize();this.logGAEvent(b),b.preventDefault(),window.setTimeout(function(){window.location.href=d+"?"+e},500)},logGAEvent:function(c){var d,f=a(c.currentTarget),g=f.attr("data-ga").replace(/[\[\]]/g,"").split(/\s*,\s*/g);g=g.map(function(a){return b.contains(e.validKeys,a)?e.replacePlaceholder(a):a}),d=["send","event"].concat(g),window.ga.apply(this,d)}},{validKeys:["js_pageType","js_pageUrl"],replacePlaceholder:function(a){var b=d.getKinjaMeta();switch(a=a.replace(/js_/g,"")){case"pageType":return b.pageType;case"pageUrl":return window.location.url;default:return""}}});return e}),define("templates/tiger/components/blogdropdown",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.blogdropdown.globalBlogDropdown=function(a,c,d){var f='<div class="top-tools">'+("search"!=a.pageType?'<div class="search-box search show-for-medium-down">'+b.components.forms.search.simpleSearch(a,null,d)+'<div class="divider show-for-medium-down"></div></div>':"")+'<div class="js_login-links show-for-medium-down login-links">'+(a.isLoggedIn?"":'<a href="#" class="login-button button inverse js_login-link" data-ga="[User Menu, Login/Signup Click, js_pageType]">Log in / Sign up</a>')+"</div>"+(a.blog&&""!=a.blog?b.components.blogdropdown.blogfollowbutton(a,null,d):"")+"</div>";if(a.blogGroup&&a.blogGroup.length){f+='<ul class="blog-list related-blog-list"><li class="title">Related blogs</li>';for(var g=a.blogGroup,h=g.length,i=0;h>i;i++){var j=g[i];f+='<li><a href="http://'+e.$$escapeHtmlAttribute(j.canonicalHost)+'" data-ga="[Kinja Menu, Related Blog Click, '+e.$$escapeHtmlAttribute(j.name)+']" class="icon--svg u-prepended">'+(j.avatar?'<img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(j.avatar.id,"avt-small",j.avatar.format))+'" width="16" height="16" class="icon icon-prepend" />':'<img data-src="//x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png" width="16" height="16" class="icon icon-prepend" />')+e.$$escapeHtml(j.displayName)+"</a></li>"}f+="</ul>"}return f+='<ul class="blog-list gmg-blog-list"><li class="title">Blogs you may like</li>'+b.components.globalBlogLinks(null,null,d)+"</ul>"},d.DEBUG&&(b.components.blogdropdown.globalBlogDropdown.soyTemplateName="tiger.components.blogdropdown.globalBlogDropdown"),b.components.blogdropdown.blogfollowbutton=function(a,c,d){var f="";d.features.follow_plus;return f+='<ul class="show-for-medium-down"><li class="js_follow-controls js_follow-blog-controls follow-controls--blog-menu" data-blogid="'+e.$$escapeHtmlAttribute(a.blog.id)+'"><a href="#" class="js_followblogforuser button list-entity__button--follow follow-state following list-control--active svg-icon--white hide"><span>Follow '+e.$$escapeHtml((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"")+"</span>"+b.icons.essential.adDMSall(null,null,d)+'</a><a href="#" class="js_unfollowblogforuser button list-entity__button--following follow-state following list-control--active svg-icon--white hide"><span>Following '+e.$$escapeHtml((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"")+"</span>"+b.icons.essential.checkmarkSmall(null,null,d)+"</a></li></ul>"},d.DEBUG&&(b.components.blogdropdown.blogfollowbutton.soyTemplateName="tiger.components.blogdropdown.blogfollowbutton")}),define("templates/tiger/components/forms/search",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.forms.search.simpleSearch=function(a,c,d){return'<form method="GET" class="search search-simple" '+(a.formId?'id="'+e.$$escapeHtmlAttribute(a.formId)+'" name="'+e.$$escapeHtmlAttribute(a.formId)+'" ':"")+"action=\"/search\" onsubmit=\"window.ga('send', 'event', 'Search', 'Submit', '"+e.$$escapeHtmlAttribute(e.$$escapeJsString(a.pageType))+'\');"><div class="input-with-icon"><span class="icon--svg">'+b.icons.essential.search(null,null,d)+'</span><input type="text" placeholder="Search '+e.$$escapeHtmlAttribute((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"Kinja")+'" name="q"'+(a.query?' value="'+e.$$escapeHtmlAttribute(a.query)+'"':"")+' class="mbn" autocomplete="off" data-focus-on-display/></div></form>'},d.DEBUG&&(b.components.forms.search.simpleSearch.soyTemplateName="tiger.components.forms.search.simpleSearch"),b.components.forms.search.advancedSearch=function(a,c,d){return'<form method="GET"'+(a.formClasses?'class="'+e.$$escapeHtmlAttribute(a.formClasses)+' search" ':' class="search"')+(a.formId?' id="'+e.$$escapeHtmlAttribute(a.formId)+'" name="'+e.$$escapeHtmlAttribute(a.formId)+'" ':"")+(a.action?' action="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.action))+'"':"")+"onsubmit=\"window.ga('send', 'event', 'Search', 'Submit', '"+e.$$escapeHtmlAttribute(e.$$escapeJsString(a.pageType))+'\');"><div class="input-with-icon mbx mtm"><span class="icon--svg">'+b.icons.essential.search(null,null,d)+'</span><input type="text" placeholder="Search '+e.$$escapeHtmlAttribute((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"Kinja")+'" name="q"'+(a.query?' value="'+e.$$escapeHtmlAttribute(a.query)+'"':"")+' class="man" autocomplete="off" data-focus-on-display/></div></form>'},d.DEBUG&&(b.components.forms.search.advancedSearch.soyTemplateName="tiger.components.forms.search.advancedSearch")}),define("templates/tiger/components/bloglinks",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.globalBlogLinks=function(a,b,c){var d="",f="my2vnuuejg3jt9yqbx3z",g="rnxqtvv6advgidzfs6am",h="pch44wvo0v6acpdlt0f6",i="fdj3buryz5nuzyf2k620",j="eh1hvjxamru5z6aobgwc",k="aqhdzcldymb9mkltfhxh",l="ghxlwgdztvqerb4zptdx",m="u0939doeuioaqhspkjyc",n="fdmagj52rhclnn6dfoig";return d+='<li><a href="http://deadspin.com" data-ga="[Kinja Menu, Blogs You May Like Click, Deadspin]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(g,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Deadspin</a></li><li><a href="http://gawker.com" data-ga="[Kinja Menu, Blogs You May Like Click, Gawker]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(f,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Gawker</a></li><li><a href="http://gizmodo.com" data-ga="[Kinja Menu, Blogs You May Like Click, Gizmodo]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(i,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Gizmodo</a></li><li><a href="http://io9.com" data-ga="[Kinja Menu, Blogs You May Like Click, io9]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(j,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />io9</a></li><li><a href="http://jalopnik.com" data-ga="[Kinja Menu, Blogs You May Like Click, Jalopnik]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(k,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Jalopnik</a></li><li><a href="http://jezebel.com" data-ga="[Kinja Menu, Blogs You May Like Click, Jezebel]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(h,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Jezebel</a></li><li><a href="http://kotaku.com" data-ga="[Kinja Menu, Blogs You May Like Click, Kotaku]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(l,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Kotaku</a></li><li><a href="http://lifehacker.com" data-ga="[Kinja Menu, Blogs You May Like Click, Lifehacker]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(m,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Lifehacker</a></li><li><a href="http://sploid.gizmodo.com/" data-ga="[Kinja Menu, Blogs You May Like Click, Sploid]"><img data-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(n,"avt-small","png"))+'" width="16" height="16" class="icon icon-prepend" />Sploid</a></li>'},d.DEBUG&&(b.components.globalBlogLinks.soyTemplateName="tiger.components.globalBlogLinks")}),define("templates/tiger/components/duiModal",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.duiModal.layout=function(a,c,d){return'<a class="js_close modal-close-x">'+b.icons.essential.close(null,null,d)+'</a><div class="dui dui-modal-body"></div>'},d.DEBUG&&(b.components.duiModal.layout.soyTemplateName="tiger.components.duiModal.layout")}),define("templates/tiger/components/navpanels",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.navpanels.duiGlobalMenuPanel=function(a,c,d){return'<div class="dui-menu dui-modal fullscreen-modal left"><a class="js_close modal-close-x">'+b.icons.essential.close(null,null,d)+'</a><div class="dui dui-modal-body nav-dropdown"><div id="js_blogmenu--offcanvas">'+b.components.blogdropdown.globalBlogDropdown(a,null,d)+"</div></div></div>"},d.DEBUG&&(b.components.navpanels.duiGlobalMenuPanel.soyTemplateName="tiger.components.navpanels.duiGlobalMenuPanel")}),define("app/modalmenu/globalmenu",["jquery","backbone.marionette","singleton/CurrentUser","view/posttools/BlogFollowToolView","view/modal/duimodal.defaultBehavior","view/behaviors/googleAnalytics.behavior","app/account/account.channel","templates/tiger/components/blogdropdown","templates/tiger/components/forms/search","templates/tiger/components/bloglinks","templates/tiger/components/duiModal","templates/tiger/components/navpanels"],function(a,b,c,d,e,f,g){"use strict";function h(){a("body").removeClass("disable-scroll")}function i(){a("body").addClass("disable-scroll")}var j;return j=b.Layout.extend({template:tiger.components.navpanels.duiGlobalMenuPanel,regions:{loginRegion:".js_login-links",bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:e},GoogleAnalyticsBehavior:{behaviorClass:f}},initialize:function(){c.onLoggedIn.done(function(){this.triggerMethod("CloseModal")}.bind(this)),a(document).on("open.fndtn.reveal","[data-reveal]",h),a(document).on("close.fndtn.reveal","[data-reveal]",i)},onClose:function(){a(document).off("open.fndtn.reveal","[data-reveal]",h),a(document).off("close.fndtn.reveal","[data-reveal]",i)},events:{"click .js_login-link":"onLoginClick"},onLoginClick:function(a){a.preventDefault(),g.trigger("loginRequired",{source:"loginButton"})},serializeData:function(){return{blog:this.model.get("blog"),pageType:this.model.get("pageType"),blogGroup:this.model.get("blogGroup"),isLoggedIn:this.model.isLoggedIn()}},onRender:function(){this.$(".gmg-blog-list").before(a(".related-blog-list").clone()),this.blogfollowtool=new d({el:this.$el})},onShow:function(){this.blogfollowtool.update({el:this.$el})}})}),define("templates/tiger/section/navbar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.section.navbar=function(a,c,d){var f="",g=((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"","BlogLogo"),h=(null==a.blog?null:a.blog.logo)?window.kinja.imageUrl(a.blog.logo.id,g,a.blog.logo.format):"";""+("gawker"==(null==a.blog?null:a.blog.name)||"lifehacker"==(null==a.blog?null:a.blog.name)||"deadspin"==(null==a.blog?null:a.blog.name)||"kotaku"==(null==a.blog?null:a.blog.name)||"jezebel"==(null==a.blog?null:a.blog.name)||"io9"==(null==a.blog?null:a.blog.name)||"jalopnik"==(null==a.blog?null:a.blog.name)||"gizmodo"==(null==a.blog?null:a.blog.name)?" gmglogos":"");f+="<!-- "+(a.md5?" md5! ":"")+' --><div class="navwrap--outer js-navwrap--outer"><nav class="js_global-nav-wrap js_top-nav global-nav notransition shown"><div class="global-nav__left global-nav__triggers">';var i=a.blogList&&a.blogList.length>1?!0:!1,j="dashboard"==a.pageType||"manageblog"==a.pageType?!0:!1;f+=(j&&i?'<a class="js_show-dashboard-blogs show-dashboard-blogs show-for-medium-down icon--svg u-prepended">'+b.icons.essential.chevronLeft(null,null,d)+"</a>":"")+'<a class="js_mobile-menu-button hamburger-trigger hamburger-trigger--mobile'+(j&&i?" js_hamburger-trigger hide":"")+'" data-ga="[Kinja Menu, Menu Click, js_pageType]"><span class="icon-dustinburger"><span></span><span></span><span></span></span></a><div class="f-dropdown-ct"><a data-dropdown="global-blog" class="js_menu-button hamburger-trigger hamburger-trigger--desktop" data-ga="[Kinja Menu, Menu Click, js_pageType]"><span class="icon-dustinburger"><span></span><span></span><span></span></span></a>';var k=""+(a.blogGroup&&a.blogGroup.length?"dropdown-wide":"");return f+='<div class="proxima f-dropdown content nav-dropdown main-menu hide-for-medium-down '+e.$$escapeHtmlAttribute(k)+'" id="global-blog" data-dropdown-content><div id="js_blogmenu--dropdown">'+b.components.blogdropdown.globalBlogDropdown(a,null,d)+'</div></div><a href="#" id="global-search-trigger" class="search-trigger icon--svg u-prepended u-highlighted--onhover u-undecorated" data-dropdown="global-search" data-ga="[Kinja Menu, Search Click, js_pageType]">'+b.icons.essential.search(null,null,d)+b.icons.essential.close(null,null,d)+'</a><div class="f-dropdown content nav-dropdown search-dropdown hide-for-medium-down" id="global-search" data-dropdown-content><form method="GET" action="/search" data-ga="[Search, Submit, js_pageType]"><div class="input-with-icon icon--svg">'+b.icons.essential.search(null,null,d)+'<input id="global-search-input" type="search" name="q" placeholder="Search '+e.$$escapeHtmlAttribute((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"Kinja")+'" autocomplete="off" /></div></form></div></div></div><div class="global-nav__right global-nav__triggers js_right-user-bar">'+(d.features.fasttoken2?'<div class="js_loggedout" style="display:none">'+b.section.navbarRightLogin(null,null,d)+'</div><div class="js_loggedin" style="display:none">'+b.section.navbarRightUserBar(null,null,d)+"</div>":"")+'</div><div class="global-nav__center row"><div class="logo-wrapper large-6 columns large-offset-4">'+(a.title?a.mobileTitle?'<h1 class="js_mobile-title global-nav--title show-for-medium-down">'+e.$$escapeHtml(a.mobileTitle)+'</h1><h1 class="global-nav--title hide-for-medium-down">'+e.$$escapeHtml(a.title)+"</h1>"+(j?'<h1 class="js_dashboard-mobile-title-blogs global-nav--title hide">'+e.$$escapeHtml(a.title)+"</h1>":""):'<h1 class="global-nav--title">'+e.$$escapeHtml(a.title)+"</h1>":'<a href="//'+e.$$escapeHtmlAttribute((null==a.blog?null:a.blog.canonicalHost)?a.blog.canonicalHost:"")+'" class="logo" title="'+e.$$escapeHtmlAttribute((null==a.blog?null:a.blog.displayName)?a.blog.displayName:"")+'" data-ga="[Kinja Menu, Logo/Blog Title Click, js_pageType]">'+(""!=h?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(h))+'" alt="" />':e.$$escapeHtml((null==a.blog?null:a.blog.displayName)?a.blog.displayName:""))+"</a>"+(a.blog.id?'<div class="follow-controls follow-controls--header js_follow-controls js_follow-blog-controls" data-blogid="'+e.$$escapeHtmlAttribute(a.blog.id)+'"><a href="#" class="js_followblogforuser follow-controls__link icon--svg u-prepended u-highlighted" title="Follow'+(a.blog&&a.blog.displayName?" "+e.$$escapeHtmlAttribute(a.blog.displayName):"")+'" data-ga="[Kinja Menu, Follow Link Click, js_pageType]">'+b.icons.essential.add(null,null,d)+'Follow</a><a href="#" class="js_unfollowblogforuser follow-controls__link hide icon--svg u-prepended u-highlighted" title="Unfollow'+(a.blog&&a.blog.displayName?" "+e.$$escapeHtmlAttribute(a.blog.displayName):"")+'" data-ga="[Kinja Menu, Unfollow Link Click, js_pageType]">'+b.icons.essential.checkmark(null,null,d)+"Following</a></div>":""))+'</div></div><div class="proxima f-dropdown nav-dropdown content notif-menu" id="js_notifications--dropdown" data-dropdown-content>'+b.components.header.notifications.notificationsSpinner(null,null,d)+'</div><div class="proxima f-dropdown nav-dropdown content channels-menu" id="js_channels--dropdown" data-dropdown-content></div><div class="js_global-user scrollable-container noskimlinks noskimwords"><div class="proxima f-dropdown nav-dropdown content user-menu user-menu--mobile" id="js_usermenu--dropdown" data-dropdown-content></div></div></nav></div>'},d.DEBUG&&(b.section.navbar.soyTemplateName="tiger.section.navbar"),b.section.navbarBlogTitle=function(a,c,d){return(d.features.superuser&&d.features.superuser_notif?'<div class="momjeans-overlay js_momjeans-overlay">'+b.icons.places.momjeans(null,null,d)+"</div>":"")+'<a href="/" class="blog-title__logo site-logo js_blog-title__logo'+(a.isGmgBlog?" gmgLogos":"")+(a.showLogo?" no-fade-transition fade-in":"")+'" title="'+e.$$escapeHtmlAttribute(a.blogDisplayName)+'">'+(a.isGmgBlog?'<img class="blog-title__img logo-'+e.$$escapeHtmlAttribute(a.blogName)+'" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.imageAssetPath))+"logos/navbar/logo-"+e.$$escapeHtmlAttribute(a.blogName)+'.png" alt="" />':""!=a.logoSrc?'<img class="blog-title__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.logoSrc))+'" alt="" />':'<div class="blog-title__txt header-title proxima">'+e.$$escapeHtml(a.blogDisplayName)+"</div>")+'</a><div class="search-button"><span class="icon icon-search js_search-button__open-icon search-button__open-icon"></span></div>'},d.DEBUG&&(b.section.navbarBlogTitle.soyTemplateName="tiger.section.navbarBlogTitle"),b.section.navbarSearchBar=function(a,b,c){return(c.features.superuser&&c.features.superuser_notif?'<div class="momjeans-overlay js_momjeans-overlay"><span class="icon icon-momjeans"></span></div>':"")+'<a href="/" class="blog-title__logo site-logo js_blog-title__logo'+(a.isGmgBlog?" gmgLogos":"")+" no-fade-transition"+(a.showLogo?" fade-in":"")+'" title="'+e.$$escapeHtmlAttribute(a.blogDisplayName)+'">'+(a.isGmgBlog?'<img class="blog-title__img logo-'+e.$$escapeHtmlAttribute(a.blogName)+'" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.imageAssetPath))+"logos/navbar/logo-"+e.$$escapeHtmlAttribute(a.blogName)+'.png" alt="" />':""!=a.logoSrc?'<img class="blog-title__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.logoSrc))+'" alt="" />':'<div class="blog-title__txt header-title proxima">'+e.$$escapeHtml(a.blogDisplayName)+"</div>")+'</a><form method="GET" action="/search" class="search-bar__form js_search-bar__form" data-ga="[Search, Submit, js_pageType]"><span class="icon icon-search search-bar__icon"></span><input type="text" class="search-bar__field js_search-bar__field" name="q" placeholder="Search '+e.$$escapeHtmlAttribute(a.blogDisplayName)+'" autocomplete="off" /><div class="search-button"><span class="icon icon-x-small js_search-button__close-icon search-button__close-icon"></span></div></form><div class="search-button--placeholder"><span class="icon icon-search search-button__open-icon"></span></div>'},d.DEBUG&&(b.section.navbarSearchBar.soyTemplateName="tiger.section.navbarSearchBar"),b.section.navbarRightUserBar=function(a,c,d){return a=a||{},(d.features.channels?'<span class="notification-trigger"><a class="show-for-medium-up js_channels js_menu-button" data-dropdown="js_channels--dropdown"><span class="notif-circle"><span class="icon"><svg class="channels-icon" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>icon-hashmark</title><path d="M8.785 12h-2.97l-.552 3.16c-.097.553-.612.923-1.16.825-.543-.096-.907-.62-.81-1.174L3.785 12H.938C.42 12 0 11.556 0 11c0-.552.417-1 .938-1h3.197l.7-4H1.938C1.42 6 1 5.556 1 5c0-.552.417-1 .938-1h3.246L5.737.84c.097-.552.612-.922 1.16-.824.543.096.907.618.81 1.174L7.215 4h2.97l.552-3.16c.097-.552.612-.922 1.16-.824.543.096.907.618.81 1.174L12.215 4h2.847c.518 0 .938.444.938 1 0 .552-.417 1-.938 1h-3.197l-.7 4h2.897c.518 0 .938.444.938 1 0 .552-.417 1-.938 1h-3.246l-.553 3.16c-.097.553-.612.923-1.16.825-.543-.096-.907-.62-.81-1.174L8.785 12zm.35-2h-2.97l.7-4h2.97l-.7 4z" fill="#000" fill-rule="evenodd"/></svg></span></span></a></span>':"")+'<span class="js_notif-wrapper notification-trigger">'+(d.features.fasttoken2?b.components.header.notifications.globalNotificationsButton({
notificationCount:0},null,d):"")+'</span><div class="user-trigger" data-ga="[User Menu, Menu Click, js_pageType]"><a class="js_menu-button js_usermenu-button show-for-large-up" data-dropdown="js_usermenu--dropdown" title="User dropdown"><span class="js_avatar avatar" style="'+(a.avatar?"background-image: url("+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.avatar.url))+")":"")+'"></span></a><a class="js_offcanvas-user show-for-medium-down"><span class="js_avatar avatar" style="'+(a.avatar?"background-image: url("+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.avatar.url))+")":"")+'"></span></a></div>'},d.DEBUG&&(b.section.navbarRightUserBar.soyTemplateName="tiger.section.navbarRightUserBar"),b.section.navbarRightLogin=function(a,b,c){return'<a href="#" class="login-button button tiny inverse js_login-link" data-ga="[User Menu, Login/Signup Click, js_pageType]">Log in / Sign up</a>'},d.DEBUG&&(b.section.navbarRightLogin.soyTemplateName="tiger.section.navbarRightLogin")}),define("templates/tiger/icons/actions/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.icons.actions.arrowBottomLeft=function(a,b,c){return'<svg class="svg-icon svg-arrow-bottom-left"><use xlink:href="#iconset-arrow-bottom-left" /></svg>'},d.DEBUG&&(b.icons.actions.arrowBottomLeft.soyTemplateName="tiger.icons.actions.arrowBottomLeft"),b.icons.actions.arrowBottomRight=function(a,b,c){return'<svg class="svg-icon svg-arrow-bottom-right"><use xlink:href="#iconset-arrow-bottom-right" /></svg>'},d.DEBUG&&(b.icons.actions.arrowBottomRight.soyTemplateName="tiger.icons.actions.arrowBottomRight"),b.icons.actions.arrowBottom=function(a,b,c){return'<svg class="svg-icon svg-arrow-bottom"><use xlink:href="#iconset-arrow-bottom" /></svg>'},d.DEBUG&&(b.icons.actions.arrowBottom.soyTemplateName="tiger.icons.actions.arrowBottom"),b.icons.actions.arrowLeft=function(a,b,c){return'<svg class="svg-icon svg-arrow-left"><use xlink:href="#iconset-arrow-left" /></svg>'},d.DEBUG&&(b.icons.actions.arrowLeft.soyTemplateName="tiger.icons.actions.arrowLeft"),b.icons.actions.arrowRight=function(a,b,c){return'<svg class="svg-icon svg-arrow-right"><use xlink:href="#iconset-arrow-right" /></svg>'},d.DEBUG&&(b.icons.actions.arrowRight.soyTemplateName="tiger.icons.actions.arrowRight"),b.icons.actions.arrowTop=function(a,b,c){return'<svg class="svg-icon svg-arrow-top"><use xlink:href="#iconset-arrow-top" /></svg>'},d.DEBUG&&(b.icons.actions.arrowTop.soyTemplateName="tiger.icons.actions.arrowTop"),b.icons.actions.arrowTopLeft=function(a,b,c){return'<svg class="svg-icon svg-arrow-top-left"><use xlink:href="#iconset-arrow-top-left" /></svg>'},d.DEBUG&&(b.icons.actions.arrowTopLeft.soyTemplateName="tiger.icons.actions.arrowTopLeft"),b.icons.actions.arrowTopRight=function(a,b,c){return'<svg class="svg-icon svg-arrow-top-right"><use xlink:href="#iconset-arrow-top-right" /></svg>'},d.DEBUG&&(b.icons.actions.arrowTopRight.soyTemplateName="tiger.icons.actions.arrowTopRight"),b.icons.actions.blogAdd=function(a,b,c){return'<svg class="svg-icon svg-blog-add"><use xlink:href="#iconset-blog-add" /></svg>'},d.DEBUG&&(b.icons.actions.blogAdd.soyTemplateName="tiger.icons.actions.blogAdd"),b.icons.actions.closeSmall=function(a,b,c){return'<svg class="svg-icon svg-close-sm"><use xlink:href="#iconset-close-sm" /></svg>'},d.DEBUG&&(b.icons.actions.closeSmall.soyTemplateName="tiger.icons.actions.closeSmall"),b.icons.actions.disabled=function(a,b,c){return'<svg class="svg-icon svg-disabled"><use xlink:href="#iconset-disabled" /></svg>'},d.DEBUG&&(b.icons.actions.disabled.soyTemplateName="tiger.icons.actions.disabled"),b.icons.actions.dollar=function(a,b,c){return'<svg class="svg-icon svg-dollar"><use xlink:href="#iconset-dollar" /></svg>'},d.DEBUG&&(b.icons.actions.dollar.soyTemplateName="tiger.icons.actions.dollar"),b.icons.actions.dollarCircle=function(a,b,c){return'<svg class="svg-icon svg-dollar-circle"><use xlink:href="#iconset-dollar-circle" /></svg>'},d.DEBUG&&(b.icons.actions.dollarCircle.soyTemplateName="tiger.icons.actions.dollarCircle"),b.icons.actions.flag=function(a,b,c){return'<svg class="svg-icon svg-flag"><use xlink:href="#iconset-flag" /></svg>'},d.DEBUG&&(b.icons.actions.flag.soyTemplateName="tiger.icons.actions.flag"),b.icons.actions.fullscreen=function(a,b,c){return'<svg class="svg-icon svg-fullscreen"><use xlink:href="#iconset-fullscreen" /></svg>'},d.DEBUG&&(b.icons.actions.fullscreen.soyTemplateName="tiger.icons.actions.fullscreen"),b.icons.actions.gear=function(a,b,c){return'<svg class="svg-icon svg-gear"><use xlink:href="#iconset-gear" /></svg>'},d.DEBUG&&(b.icons.actions.gear.soyTemplateName="tiger.icons.actions.gear"),b.icons.actions.heart=function(a,b,c){return'<svg class="svg-icon svg-heart"><use xlink:href="#iconset-heart" /></svg>'},d.DEBUG&&(b.icons.actions.heart.soyTemplateName="tiger.icons.actions.heart"),b.icons.actions.information=function(a,b,c){return'<svg class="svg-icon svg-information"><use xlink:href="#iconset-information" /></svg>'},d.DEBUG&&(b.icons.actions.information.soyTemplateName="tiger.icons.actions.information"),b.icons.actions.login=function(a,b,c){return'<svg class="svg-icon svg-login"><use xlink:href="#iconset-login" /></svg>'},d.DEBUG&&(b.icons.actions.login.soyTemplateName="tiger.icons.actions.login"),b.icons.actions.logout=function(a,b,c){return'<svg class="svg-icon svg-logout"><use xlink:href="#iconset-logout" /></svg>'},d.DEBUG&&(b.icons.actions.logout.soyTemplateName="tiger.icons.actions.logout"),b.icons.actions.lightning=function(a,b,c){return'<svg class="svg-icon svg-lightning"><use xlink:href="#iconset-lightning" /></svg>'},d.DEBUG&&(b.icons.actions.lightning.soyTemplateName="tiger.icons.actions.lightning"),b.icons.actions.moveLeft=function(a,b,c){return'<svg class="svg-icon svg-move-left"><use xlink:href="#iconset-move-left" /></svg>'},d.DEBUG&&(b.icons.actions.moveLeft.soyTemplateName="tiger.icons.actions.moveLeft"),b.icons.actions.moveRight=function(a,b,c){return'<svg class="svg-icon svg-move-right"><use xlink:href="#iconset-move-right" /></svg>'},d.DEBUG&&(b.icons.actions.moveRight.soyTemplateName="tiger.icons.actions.moveRight"),b.icons.actions.moveTop=function(a,b,c){return'<svg class="svg-icon svg-move-top"><use xlink:href="#iconset-move-top" /></svg>'},d.DEBUG&&(b.icons.actions.moveTop.soyTemplateName="tiger.icons.actions.moveTop"),b.icons.actions.moveBottom=function(a,b,c){return'<svg class="svg-icon svg-move-bottom"><use xlink:href="#iconset-move-bottom" /></svg>'},d.DEBUG&&(b.icons.actions.moveBottom.soyTemplateName="tiger.icons.actions.moveBottom"),b.icons.actions.reload=function(a,b,c){return'<svg class="svg-icon svg-reload"><use xlink:href="#iconset-reload" /></svg>'},d.DEBUG&&(b.icons.actions.reload.soyTemplateName="tiger.icons.actions.reload"),b.icons.actions.userAdd=function(a,b,c){return'<svg class="svg-icon svg-user-add"><use xlink:href="#iconset-user-add" /></svg>'},d.DEBUG&&(b.icons.actions.userAdd.soyTemplateName="tiger.icons.actions.userAdd"),b.icons.actions.userRemove=function(a,b,c){return'<svg class="svg-icon svg-user-remove"><use xlink:href="#iconset-user-remove" /></svg>'},d.DEBUG&&(b.icons.actions.userRemove.soyTemplateName="tiger.icons.actions.userRemove"),b.icons.actions.writePaper=function(a,b,c){return'<svg class="svg-icon svg-write-paper"><use xlink:href="#iconset-write-paper" /></svg>'},d.DEBUG&&(b.icons.actions.writePaper.soyTemplateName="tiger.icons.actions.writePaper"),b.icons.actions.zoomOut=function(a,b,c){return'<svg class="svg-icon svg-zoom-out"><use xlink:href="#iconset-zoom-out" /></svg>'},d.DEBUG&&(b.icons.actions.zoomOut.soyTemplateName="tiger.icons.actions.zoomOut"),b.icons.actions.clock=function(a,b,c){return'<svg class="svg-icon svg-clock"><use xlink:href="#iconset-clock" /></svg>'},d.DEBUG&&(b.icons.actions.clock.soyTemplateName="tiger.icons.actions.clock"),b.icons.actions.clockSmall=function(a,b,c){return'<svg class="svg-icon small svg-clock--small"><use xlink:href="#iconset-clock--small" /></svg>'},d.DEBUG&&(b.icons.actions.clockSmall.soyTemplateName="tiger.icons.actions.clockSmall"),b.icons.actions.write=function(a,b,c){return'<svg class="svg-icon svg-write"><use xlink:href="#iconset-write" /></svg>'},d.DEBUG&&(b.icons.actions.write.soyTemplateName="tiger.icons.actions.write"),b.icons.actions.writeSmall=function(a,b,c){return'<svg class="svg-icon small svg-write--small"><use xlink:href="#iconset-write--small" /></svg>'},d.DEBUG&&(b.icons.actions.writeSmall.soyTemplateName="tiger.icons.actions.writeSmall"),b.icons.actions.share=function(a,b,c){return'<svg class="svg-icon svg-share"><use xlink:href="#iconset-share" /></svg>'},d.DEBUG&&(b.icons.actions.share.soyTemplateName="tiger.icons.actions.share"),b.icons.actions.quote=function(a,b,c){return'<svg class="svg-icon svg-quote"><use xlink:href="#iconset-quote" /></svg>'},d.DEBUG&&(b.icons.actions.quote.soyTemplateName="tiger.icons.actions.quote"),b.icons.actions.playIcon=function(a,b,c){return'<svg class="svg-icon svg-quote"><use xlink:href="#icon-play" /></svg>'},d.DEBUG&&(b.icons.actions.playIcon.soyTemplateName="tiger.icons.actions.playIcon")}),define("app/navigation/userButton.view",["backbone.marionette","singleton/Utils","templates/tiger/components/header/notifications","templates/tiger/section/navbar","templates/tiger/icons/actions/usage"],function(a,b){"use strict";var c=a.ItemView.extend({ui:{avatar:".js_avatar"},template:tiger.section.navbarRightUserBar,modelEvents:{"change:avatar":"updateAvatar"},updateAvatar:function(){var a=this.model.get("avatar");this.ui.avatar.css("background-image","url("+b.imageUrl(a.id,"avt-small",a.format)+")")}});return c}),define("app/navigation/loginButton.view",["backbone.marionette","app/account/account.channel","templates/tiger/section/navbar"],function(a,b){"use strict";var c=a.ItemView.extend({template:tiger.section.navbarRightLogin,events:{"click .js_login-link":"onLoginClick"},onLoginClick:function(a){a.preventDefault(),b.trigger("loginRequired",{source:"loginButton"})}});return c}),define("singleton/BlogInfo",["underscore","singleton/CurrentBlog"],function(a,b){"use strict";var c={adEnabledSites:[{name:"Gizmodo",id:4},{name:"Gawker",id:7},{name:"io9",id:8},{name:"Kotaku",id:9},{name:"Deadspin",id:11},{name:"Jalopnik",id:12},{name:"Lifehacker",id:17},{name:"Jezebel",id:39},{name:"GizmodoES",id:19292},{name:"Guanabee",id:86551},{name:"studioatgawker",id:4541888},{name:"The fusion project",id:10698056},{name:"XperiaZ",id:471472023},{name:"BetterState",id:473241793},{name:"IBM",id:474911957},{name:"BusinessTravelersToolkit",id:476089313},{name:"SonyEntertainmentNetwork",id:476783795},{name:"WonderFilled",id:499874619},{name:"OreoWonderFilled",id:499964452},{name:"RandomHouseAudio",id:506884481},{name:"Gizmodo Live",id:509173099},{name:"RayDonovan",id:509473310},{name:"Kotaku Live Blog",id:510669784},{name:"Defamer",id:512288369},{name:"collaboratory",id:709976306},{name:"Doomsday Castle",id:813471273},{name:"fiestahero",id:1256311089},{name:"Metlife",id:1300181229},{name:"Porsche",id:1434801322},{name:"crashplan",id:1444734969},{name:"Quirky G.E",id:1460862244},{name:"Netflix",id:1463118792},{name:"3dprintingtoolkit",id:1467567363},{name:"goodtobebad",id:1467571985},{name:"Oliver Kovacs",id:1484116755},{name:"Over Rated",id:1521570730},{name:"biz product",id:1525133490},{name:"Playboy",id:1173588042,gptNetworkId:6487541,gptSiteName:"playboy.kinja"},{name:"Sploid",id:487662860}],gmgBlogs:["gawker","lifehacker","deadspin","kotaku","jezebel","io9","jalopnik","gizmodo"],currentBlogIsGmgBlog:function(){return a.find(this.gmgBlogs,function(a){return b.name===a})}};return c}),define("app/navigation/blogTitle.view",["backbone.marionette","singleton/CurrentBlog","singleton/EventDispatcher","singleton/BlogInfo","singleton/Feature","templates/tiger/section/navbar"],function(a,b,c,d,e){"use strict";var f=a.ItemView.extend({template:tiger.section.navbarBlogTitle,tagName:"div",className:"blog-title",ui:{blogLogo:".js_blog-title__logo",searchIcon:".js_search-button__open-icon"},triggers:{"click @ui.searchIcon":"open.searchbar"},attributes:{href:"/",title:b.displayName||""},fadeIn:function(){this.ui.blogLogo.addClass("fade-in")},fadeOut:function(){this.ui.blogLogo.removeClass("fade-in")},serializeData:function(){return{blogName:(b||{}).name,blogDisplayName:b.displayName||"",isGmgBlog:d.currentBlogIsGmgBlog(),logoSrc:this.options.logoSrc||"",imageAssetPath:this.options.imageAssetPath,showLogo:this.options.showLogo}},onRender:function(){e.isOn("gns")&&this.ui.blogLogo.removeClass("no-fade-transition"),this.listenTo(c,"logoHidden.topbar",this.fadeIn),this.listenTo(c,"logoShown.topbar",this.fadeOut)}});return f}),define("app/navigation/searchBar.view",["backbone.marionette","singleton/CurrentBlog","singleton/BlogInfo","singleton/EventDispatcher","singleton/Feature","templates/tiger/section/navbar"],function(a,b,c,d,e){"use strict";var f=a.ItemView.extend({template:tiger.section.navbarSearchBar,tagName:"div",className:"search-bar",ui:{searchForm:".js_search-bar__form",searchField:".js_search-bar__field",closeSearchIcon:".js_search-button__close-icon",blogLogo:".js_blog-title__logo"},events:{keyup:"onKeyup","click @ui.closeSearchIcon":"onCloseSearchButtonClick"},onCloseSearchButtonClick:function(){this.ui.closeSearchIcon.removeClass("fade-in"),this.ui.searchForm.removeClass("open")},onKeyup:function(a){27===a.keyCode&&this.onCloseSearchButtonClick()},fadeIn:function(){this.ui.blogLogo.addClass("fade-in")},fadeOut:function(){this.ui.blogLogo.removeClass("fade-in")},serializeData:function(){return{blogName:(b||{}).name,blogDisplayName:b.displayName||"",isGmgBlog:c.currentBlogIsGmgBlog(),logoSrc:this.options.logoSrc||"",imageAssetPath:this.options.imageAssetPath,showLogo:this.options.showLogo}},onRender:function(){this.ui.searchForm.on("transitionend webkitTransitionEnd oTransitionEnd",function(a){"width"===a.originalEvent.propertyName&&this.ui.searchForm.hasClass("open")?this.ui.closeSearchIcon.addClass("fade-in"):"width"===a.originalEvent.propertyName&&this.trigger("closed.searchbar")}.bind(this)),e.isOn("gns")&&(this.listenTo(d,"logoHidden.topbar",this.fadeIn),this.listenTo(d,"logoShown.topbar",this.fadeOut))},onDomRefresh:function(){this.ui.searchField.focus(),this.ui.searchForm.addClass("open")}});return f}),define("app/navigation/topbar.layout",["jquery","underscore","backbone.marionette","lib/foundation/foundation","app/MarionetteApp","app/notifdropdown/notifdropdown.app","app/modalmenu/globalmenu","app/navigation/userButton.view","app/navigation/loginButton.view","app/navigation/blogTitle.view","app/navigation/searchBar.view","module/ads/model/ads.slotModel","view/behaviors/googleAnalytics.behavior","singleton/EventDispatcher","singleton/CurrentUser","singleton/Feature","singleton/Utils","singleton/WindowController","module/ads/ads.events"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){"use strict";var t="splash"===q.getKinjaMeta().pageType,u=c.Layout.extend({ui:{menuDropdown:"#global-blog",mobileMenuDropdown:".js_mobile-menu-button",notifDropdown:"#global-notifications",notifDropdownButton:".js_notif",navIcon:".js_nav-icon",kinjaIcon:".js_kinja-icon",userDropdown:"#global-user",rightUserBar:".js_right-user-bar",globalSearchDropdown:"#global-search",globalSearchInput:"#global-search-input",globalSearchTrigger:"#global-search-trigger",dashboardBlogSelectorBtn:".js_show-dashboard-blogs",hamburgerBtn:".js_hamburger-trigger",mobileTitle:".js_mobile-title",dashboardMobileTitleBlogs:".js_dashboard-mobile-title-blogs"},regions:{userButtonRegion:".js_right-user-bar",blogTitleRegion:".js_blog-title-region"},behaviors:{GoogleAnalyticsBehavior:{behaviorClass:m}},events:{"opened.fndtn.dropdown @ui.menuDropdown":"onDropdownOpened","closed.fndtn.dropdown @ui.menuDropdown":"onDropdownClosed","opened.fndtn.dropdown @ui.userDropdown":"onDropdownOpened","closed.fndtn.dropdown @ui.userDropdown":"onDropdownClosed","click .right-off-canvas-toggle":"fetchNotifications","click @ui.mobileMenuDropdown":"openModalGlobalmenu","opened.fndtn.dropdown @ui.globalSearchDropdown":"onGlobalSearchOpened","closed.fndtn.dropdown @ui.globalSearchDropdown":"onGlobalSearchClosed","click @ui.dashboardBlogSelectorBtn":"openBlogSelector"},initialize:function(){this.model.onAuthStateChange(this.onModelAuthenticated.bind(this))},onRender:function(){},initializeAutohide:function(){var b,c,d,e,f=window.kinja.meta.blogSales?window.kinja.meta.blogSales.adsEnabled:!1;b=function(){this.$el.addClass("fixed"),r.scrollAutohide(this.$el,{waypoint:a(".js_page")}),this.$el.removeClass("notransition")}.bind(this),c=function(){this.$el.removeClass("fixed"),r.unbindScrollAutohide()}.bind(this),d=function(){(a(".js_site-header").length||t)&&(this.showBlogLogo(),t||(this.setupScroll(),this.refreshBlogLogo())),p.isOn("splashy_ad")?(e=function(){0!==this.$el.offset().top?r.registerWaypoint(this.$el.parent(),0,function(a){"down"===a?b():c()}.bind(this)):b()}.bind(this),p.isOn("ad_module")?f?window.kinjaads.queue.push({zoneType:l.zoneTypes.SPLASHYTOP,onRenderEnded:e}):e():this.listenToOnce(s,"kinjaads.disabled kinjaads.SPLASHYTOP.displayed kinjaads.SPLASHYTOP.hide",e)):b()}.bind(this),p.isOn("gns")?this.model.onAuth.done(d):d()},mainLogoHidden:function(){var b=a(window),c=20,d=a(".js_site-header").offset().top-c,e=b.width()>799,f=b.scrollTop();return f>d&&e},setupScroll:function(){var c,d=a(window),e=20,f=a(".js_site-header").offset().top-e,g=function(){var a=d.scrollTop();a>f&&h?n.trigger("logoHidden.topbar"):n.trigger("logoShown.topbar"),this.ui.navIcon.toggleClass("hide",a>f),this.ui.kinjaIcon.toggleClass("hide",f>a)}.bind(this),h=d.width()>799;c=b.throttle(g,100),d.on("scroll.topbar",c),this.listenTo(n,"orientation:change",function(){h=d.width()>799})},showUserButton:function(){var a=new h({model:o});this.userButtonRegion.show(a)},showLoginButton:function(){var a=new i;this.userButtonRegion.show(a)},showBlogLogo:function(){var b=this.blogTitleRegion.$el||a(this.blogTitleRegion.el),c=new j({logoSrc:b.data("logoSrc"),imageAssetPath:b.data("imageAssetPath"),showLogo:t?!1:this.mainLogoHidden()});c.on("open.searchbar",this.showSearchBar.bind(this)),this.blogTitleRegion.show(c),p.isOn("gns")||t||this.refreshBlogLogo()},refreshBlogLogo:function(){a(window).trigger("scroll")},showSearchBar:function(){var b=this.blogTitleRegion.$el||a(this.blogTitleRegion.el),c=new k({logoSrc:b.data("logoSrc"),imageAssetPath:b.data("imageAssetPath"),showLogo:t?!1:this.mainLogoHidden()});this.listenTo(c,"closed.searchbar",this.showBlogLogo),this.blogTitleRegion.show(c)},onModelAuthenticated:function(){p.isOn("fasttoken2")?this.model.isLoggedIn()?f.initialize():f.remove():this.model.isLoggedIn()?(this.showUserButton(),f.initialize()):(this.showLoginButton(),f.remove()),a(window.document).foundation()},onDropdownOpened:function(b){var c=b.target.id;a("[data-dropdown="+c+"]").addClass("active"),a("body").addClass(c+"-open")},onDropdownClosed:function(b){var c=b.target.id;a("[data-dropdown="+c+"]").removeClass("active"),a("body").removeClass(c+"-open")},manualCloseDropdown:function(){d.libs.dropdown.close(this.ui.menuDropdown)},fetchNotifications:function(){f.fetch()},onGlobalSearchOpened:function(){this.ui.globalSearchInput.focus(),this.ui.globalSearchTrigger.addClass("active")},onGlobalSearchClosed:function(){this.ui.globalSearchInput.blur(),this.ui.globalSearchTrigger.removeClass("active")},openBlogSelector:function(b){var c=this;b.stopPropagation(),a(".dashboard-blog-selector").height(a(document).height()),a(".dashboard-blog-selector").removeClass("hide"),this.ui.dashboardBlogSelectorBtn.addClass("hide"),this.ui.hamburgerBtn.removeClass("hide"),this.ui.mobileTitle.addClass("hide"),this.ui.dashboardMobileTitleBlogs.removeClass("hide"),a("body").on("click.hidemenu",function(){c.closeBlogSelector()})},closeBlogSelector:function(){this.ui.dashboardBlogSelectorBtn.removeClass("hide"),this.ui.hamburgerBtn.addClass("hide"),this.ui.mobileTitle.removeClass("hide"),this.ui.dashboardMobileTitleBlogs.addClass("hide"),a(".dashboard-blog-selector").addClass("hide"),a("body").off("click.hidemenu")},openModalGlobalmenu:function(){var a=new g({model:o});e.duimodalregion.show(a)}});return u}),define("templates/tiger/components/user/your-blogs",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.user.yourBlogsItem=function(a,c,d){var f="",g=d.features.no_offcanvas_manageblog;return f+='<a href="http://'+e.$$escapeHtmlAttribute(a.blogData.canonicalHost)+'" class="hover-icon" data-ga="[User Menu, My Blogs Click - '+e.$$escapeHtmlAttribute(a.blogData.displayName)+']">'+(a.blogData.avatar&&a.blogData.avatar.id?'<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.blogData.avatar.id,"avt-small",a.blogData.avatar.format)))+'" class="icon icon-prepend" alt="" />':'<img src="//x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png" class="icon icon-prepend" alt="" />')+e.$$escapeHtml(a.blogData.displayName)+"</a>"+(g?'<a class="icon--svg u-ultralight u-highlighted--onhover show-for-medium-down" href="https://kinja.com/manage/'+e.$$escapeHtmlAttribute(a.blogData.name)+'">'+b.icons.places.settings(null,null,d)+"</a>":"")},d.DEBUG&&(b.components.user.yourBlogsItem.soyTemplateName="tiger.components.user.yourBlogsItem")}),define("app/navigation/blogItem.view",["backbone.marionette","templates/tiger/components/user/your-blogs"],function(a){"use strict";var b=a.ItemView.extend({template:tiger.components.user.yourBlogsItem,tagName:"li",className:"ownblog js_ownblog",serializeData:function(){return{blogData:this.model.attributes}}});return b}),define("templates/tiger/components/user/profile-menu",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.user.globalProfileMenuContent=function(a,c,d){return'<ul class="user-links"><li class="display-name"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.currentUser.avatar.id,"avt-small",a.currentUser.avatar.format)))+'" class="avatar"><span data-username="'+e.$$escapeHtmlAttribute(a.currentUser.screenName)+'" class="js_display-name">'+e.$$escapeHtml(a.currentUser.displayName)+'</span></li><li class="hover-icon"><a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.currentUser.screenName)+'" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Your profile click, js_pageType]">'+b.icons.places.user(null,null,d)+'Your profile</a></li><li class="hover-icon"><a href="#" class="js_compose-post-button readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Compose Post Click, js_pageType]">'+b.icons.actions.write(null,null,d)+'Compose post</a></li><li class="hover-icon"><a href="//kinja.com/settings" class="js_settings-link readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Account Settings Click, js_pageType]">'+b.icons.actions.gear(null,null,d)+'Account Settings</a></li><li class="hover-icon">'+(d.features.activenow?'<a href="//kinja.com/dashboard/activenow" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Active Now View Click, js_pageType]">':'<a href="//kinja.com/dashboard" class="icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Private View Click, js_pageType]">')+b.icons.places.home(null,null,d)+'Dashboard</a></li><li class="hover-icon"><a href="//kinja.com/manage'+(a.currentBlogName&&a.isMemberCurrentBlog?"/"+e.$$escapeHtmlAttribute(a.currentBlogName):"")+'" data-ga="[User Menu, New Manage Blog Click, js_pageType]" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.places.settings(null,null,d)+(a.currentBlogName&&a.isMemberCurrentBlog?"Manage "+e.$$escapeHtml(a.blogName):"Manage blogs")+"</a></li>"+(d.features.superuser&&("frontpage"==a.pageType||"permalink"==a.pageType)?'<li class="js_manageblog hover-icon hide"><a href="#" class="js_manageblog-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Manage Blog Click, js_pageType]">'+b.icons.places.lock(null,null,d)+"Superuser Settings</a></li>":"")+'<li class="js_salestools hover-icon hide"><a href="#" class="js_salestools-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Business Tool Click, js_pageType]">'+b.icons.essential.bubble(null,null,d)+"Biz Tools"+(a.blogName?" for "+e.$$escapeHtml(a.blogName):"")+'</a></li><li class="js_promotions hover-icon hide"><a href="#" class="js_promotions-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Promotions Click, js_pageType]">'+b.icons.essential.starCircle(null,null,d)+'Active Promotions</a></li><li class="js_superuser-tools hover-icon hide"><a href="#" class="js_createblog-link hover-icon readonly-hide icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Create Blog Click, js_pageType]">'+b.icons.actions.blogAdd(null,null,d)+"Create blog</a></li>"+(d.features.superuser?'<li class="js_superuser-tools hide"><a href="?superuser=off" class="hover-icon icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Hide Mom Jeans Click, js_pageType]">'+b.icons.essential.star(null,null,d)+"Hide Mom Jeans</a></li>":'<li class="js_superuser-tools hide"><a href="?superuser" class="hover-icon icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Show Mom Jeans Click, js_pageType]">'+b.icons.essential.star(null,null,d)+"Show Mom Jeans</a></li>")+'<li class="hover-icon"><a href="#" class="js_logout-link icon--svg u-darkened--onhover u-prepended" data-ga="[User Menu, Logout Click, js_pageType]">'+b.icons.actions.logout(null,null,d)+'Logout</a></li></ul><div class="divider"></div><ul class="title-ownblogs"><li class="title">My blogs</li></ul><ul class="js_myblogs myblogs"></ul>'},d.DEBUG&&(b.components.user.globalProfileMenuContent.soyTemplateName="tiger.components.user.globalProfileMenuContent")}),define("templates/tiger/icons/places/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.icons.places.avatar=function(a,b,c){return'<svg class="svg-icon svg-avatar"><use xlink:href="#iconset-avatar" /></svg>'},d.DEBUG&&(b.icons.places.avatar.soyTemplateName="tiger.icons.places.avatar"),b.icons.places.avatarBig=function(a,b,c){return'<svg class="svg-icon svg-avatar-big"><use xlink:href="#iconset-avatar-big" /></svg>'},d.DEBUG&&(b.icons.places.avatarBig.soyTemplateName="tiger.icons.places.avatarBig"),b.icons.places.blog=function(a,b,c){return'<svg class="svg-icon svg-blog"><use xlink:href="#iconset-blog" /></svg>'},d.DEBUG&&(b.icons.places.blog.soyTemplateName="tiger.icons.places.blog"),b.icons.places.hashmark=function(a,b,c){return'<svg class="svg-icon svg-hashmark"><use xlink:href="#iconset-hashmark" /></svg>'},d.DEBUG&&(b.icons.places.hashmark.soyTemplateName="tiger.icons.places.hashmark"),b.icons.places.home=function(a,b,c){return'<svg class="svg-icon svg-home"><use xlink:href="#iconset-home" /></svg>'},d.DEBUG&&(b.icons.places.home.soyTemplateName="tiger.icons.places.home"),b.icons.places.key=function(a,b,c){return'<svg class="svg-icon svg-key"><use xlink:href="#iconset-key" /></svg>'},d.DEBUG&&(b.icons.places.key.soyTemplateName="tiger.icons.places.key"),b.icons.places.lock=function(a,b,c){return'<svg class="svg-icon svg-lock"><use xlink:href="#iconset-lock" /></svg>'},d.DEBUG&&(b.icons.places.lock.soyTemplateName="tiger.icons.places.lock"),b.icons.places.mail=function(a,b,c){return'<svg class="svg-icon svg-mail"><use xlink:href="#iconset-mail" /></svg>'},d.DEBUG&&(b.icons.places.mail.soyTemplateName="tiger.icons.places.mail"),b.icons.places.mailSmall=function(a,b,c){return'<svg class="svg-icon small svg-mail--small"><use xlink:href="#iconset-mail--small" /></svg>'},d.DEBUG&&(b.icons.places.mailSmall.soyTemplateName="tiger.icons.places.mailSmall"),b.icons.places.momjeans=function(a,b,c){return'<svg class="svg-icon svg-momjeans"><use xlink:href="#iconset-momjeans" /></svg>'},d.DEBUG&&(b.icons.places.momjeans.soyTemplateName="tiger.icons.places.momjeans"),b.icons.places.settings=function(a,b,c){return'<svg class="svg-icon svg-settings"><use xlink:href="#iconset-settings" /></svg>'},d.DEBUG&&(b.icons.places.settings.soyTemplateName="tiger.icons.places.settings"),b.icons.places.sharedpostSmall=function(a,b,c){return'<svg class="svg-icon small svg-sharedpost--small"><use xlink:href="#iconset-sharedpost--small" /></svg>'},d.DEBUG&&(b.icons.places.sharedpostSmall.soyTemplateName="tiger.icons.places.sharedpostSmall"),b.icons.places.user=function(a,b,c){return'<svg class="svg-icon svg-user"><use xlink:href="#iconset-user" /></svg>'},d.DEBUG&&(b.icons.places.user.soyTemplateName="tiger.icons.places.user"),b.icons.places.users=function(a,b,c){return'<svg class="svg-icon svg-users"><use xlink:href="#iconset-users" /></svg>'},d.DEBUG&&(b.icons.places.users.soyTemplateName="tiger.icons.places.users")}),define("app/navigation/userMenu.view",["jquery","underscore","backbone","backbone.marionette","app/navigation/blogItem.view","singleton/Feature","singleton/CurrentBlog","singleton/Utils","module/KinjaAnalytics","view/behaviors/googleAnalytics.behavior","templates/tiger/components/user/profile-menu","templates/tiger/icons/actions/usage","templates/tiger/icons/places/usage"],function(a,b,c,d,e,f,g,h,i,j){"use strict";require(["module/PlacesIconModule"],function(){}),require(["module/ActionsIconModule"],function(){});var k=d.CompositeView.extend({events:{"click .js_logout-link":"onLogoutClick","click .js_createblog-link":"onCreateBlogClick","click .js_manageblog-link":"onManageBlogClick","click .js_salestools-link":"onSalesClick","click .js_promotions-link":"onPromotionsClick","click .js_channels-link":"onChannelsClick"},ui:{composeButton:".js_compose-post-button",superuserButtons:".js_superuser-tools",salesButtons:".js_salestools",blogButtons:".js_manageblog",promotionsButton:".js_promotions"},collection:new c.Collection,itemView:e,itemViewContainer:".js_myblogs",template:tiger.components.user.globalProfileMenuContent,behaviors:function(){return this.options.offcanvas?{GoogleAnalyticsBehavior:{behaviorClass:j}}:{}},initialize:function(){this.listenTo(this.model.get("membership"),"add",this.render),this.listenTo(this.model,"change:screenName change:displayName",this.render)},onRender:function(){if(this.model.isLoggedIn()){var c,d=this.model.get("screenName"),e=this.model.get("defaultBlogId"),i=f.isOn("editor_own_page_test")?window.location.search:"",j=b.any(["OWNER","AUTHOR","ADMIN"],function(a){return this.model.hasRole(a,g.id)}.bind(this));i+=j?("?"===i[0]?"&":"?")+"blogid="+g.id:"",this.ui.composeButton.attr("href","//"+h.getKinjaHost()+"/write"+i),this.model.isSuperuser()?this.ui.superuserButtons.removeClass("hide"):this.ui.superuserButtons.remove(),this.model.isSalesperson()||this.model.isSuperuser()&&f.isOn("superuser")?this.ui.salesButtons.removeClass("hide"):this.ui.salesButtons.remove(),(this.model.isSalesperson()||this.model.isSuperuser()&&f.isOn("superuser")||g.isGmgBlog&&this.model.hasRole("ADMIN",g.id))&&this.ui.promotionsButton.removeClass("hide"),this.model.hasRole("ADMIN",g.id)||this.model.isSuperuser()&&g.id?this.ui.blogButtons.removeClass("hide"):this.model.isSuperuser()?this.ui.blogButtons.remove():a(".js_manageblog-link ").hide(),c=b.sortBy(this.model.getBlogs(),function(a){return a.id===e&&a.name!==d&&(a.name=d,a.canonicalHost=d+".kinja.com"),(a.id===e?"0":"1")+a.name}),this.collection.reset(c)}},serializeData:function(){var a=b.map(this.model.get("membership").models,function(a){return a.get("blogId")}),c=b.indexOf(a,g.id)>-1;return{blogName:g.displayName,currentUser:this.model.toJSON(),currentBlogName:g.name,isMemberCurrentBlog:c,pageType:h.kinjaMeta.pageType}},onLogoutClick:function(a){
var b=h.getKinjaMeta().pageType;a.preventDefault(),this.model.logout(),("dashboard"===b||"manageblog"===b)&&(window.location.pathname.indexOf("notifications")>-1?i.setContext(null,"NOTIFICATIONS"):i.setContext(null,"DASHBOARD"),i.pushEvent("LOGOUT"))},onCreateBlogClick:function(a){a.preventDefault(),require(["module/BlogSettingsModule"],function(a){a.controller.showCreateBlog()})},onManageBlogClick:function(a){a.preventDefault(),require(["module/BlogSettingsModule"],function(a){a.controller.showManageBlog()})},onSalesClick:function(a){a.preventDefault(),require(["module/BusinessModule"],function(a){a.controller.showBusinessTools()})},onPromotionsClick:function(a){a.preventDefault(),window.location.href="http://"+h.getKinjaHost()+"/dfp/promotions"},onChannelsClick:function(b){b.preventDefault(),a(".js_channels-off-canvas-toggle").click()}});return k}),define("app/modalmenu/usermenu",["backbone.marionette","view/modal/duimodal.defaultBehavior","app/navigation/userMenu.view","templates/tiger/components/duiModal","templates/tiger/components/navpanels"],function(a,b,c){"use strict";var d;return d=a.Layout.extend({template:tiger.components.duiModal.layout,regions:{bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:b}},onRender:function(){var a=new c({model:this.model,offcanvas:!0});this.bodyRegion.show(a),this.$(".dui-modal-body").addClass("nav-dropdown")}})}),define("templates/tiger/components/spinner",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.spinner.bounce=function(a,b,c){return'<span class="spinner bounce"><span class="one"></span><span class="two"></span><span class="three"></span></span>'},d.DEBUG&&(b.components.spinner.bounce.soyTemplateName="tiger.components.spinner.bounce"),b.components.spinner.gifthaw=function(a,b,c){return'<div class="animationContainer"><svg width="26" height="12" viewBox="0 0 26 12" version="1.1" xmlns="http://www.w3.org/2000/svg" class="loading-animation loading-animation--small grey"><circle cx="4" cy="6" r="3" class="circle-1" /><circle cx="4" cy="6" r="3" class="circle-2" /><circle cx="13" cy="6" r="3" class="circle-3" /><circle cx="22" cy="6" r="3" class="circle-4" /></svg></div>'},d.DEBUG&&(b.components.spinner.gifthaw.soyTemplateName="tiger.components.spinner.gifthaw")}),define("app/modalmenu/notifmenu",["jquery","backbone.marionette","collection/Notifications","view/modal/duimodal.defaultBehavior","templates/tiger/components/duiModal","templates/tiger/components/navpanels","templates/tiger/components/spinner"],function(a,b,c,d){"use strict";var e,f=b.ItemView.extend({template:tiger.components.spinner.bounce});return e=b.Layout.extend({notificationListLoaded:null,template:tiger.components.duiModal.layout,regions:{bodyRegion:".dui-modal-body"},behaviors:{DuiModalDefaultBehavior:{behaviorClass:d}},initNotificationList:function(){var b=a.Deferred();return require(["module/NotificationListModule"],function(a){b.resolve(a)}),b},onRender:function(){this.notificationListLoaded||(this.bodyRegion.show(new f),this.notificationListLoaded=this.initNotificationList()),this.notificationListLoaded.done(function(a){var b=new c,d=new a({collection:b,model:this.model});this.bodyRegion.show(d),b.fetch({reset:!0}),this.$(".dui-modal-body").addClass("nav-dropdown")}.bind(this))}})}),define("app/navigation/secondaryNav.view",["jquery","backbone","backbone.marionette"],function(a,b,c){"use strict";var d=b.Model.extend({defaults:{open:!1}}),e=c.Layout.extend({model:new d,modelEvents:{"change:open":"listEventHandler"},initialize:function(){var a,b;this.animation=this.options.animation,this.animation&&this.$el.addClass("animated-secondary-nav"),a=new f({el:".js_toggle-secondary-nav",model:this.model}),b=new g({el:".js_secondary-nav-wrapper",model:this.model})},listEventHandler:function(){var b=this;this.model.get("open")?a("body").on("click.hidemenu",function(){b.model.set("open",!1)}):a("body").off("click.hidemenu")}}),f=c.ItemView.extend({events:{click:"openSecondaryNav"},initialize:function(){var b=this.$el.parents(".js_secondary-nav-btn-wrapper");a(".js_global-nav-wrap").on("autohide.pushdown.show",function(){b.addClass("shown")}).on("autohide.pushdown.hide",function(){b.removeClass("shown")})},openSecondaryNav:function(a){a.stopPropagation(),this.model.set("open",!0)}}),g=c.ItemView.extend({modelEvents:{"change:open":"toggleOpen"},toggleOpen:function(){this.model.get("open")&&(this.$el.height(a(document).height()),a(window).scrollTop(0)),this.$el.toggleClass("hide",!this.model.get("open"))}});return e}),define("templates/tiger/section/header/success-box",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.section.header.successBox=function(a,c,d){return'<div class="proxima success-box js_success_box" style="display: none">'+(a.dismissable?'<a href="#" class="js_close close icon--svg u-darkened--onhover">'+b.icons.actions.closeSmall(null,null,d)+"</a>":"")+'<span class="msg">'+e.$$filterNoAutoescape(a.message)+"</span></div>"},d.DEBUG&&(b.section.header.successBox.soyTemplateName="tiger.section.header.successBox"),b.section.header.moreWarnings=function(a,b,c){return'<div class="proxima success-box js_additional-warnings"><a href="#">'+e.$$escapeHtml(a.count)+" more warnings</a></div>"},d.DEBUG&&(b.section.header.moreWarnings.soyTemplateName="tiger.section.header.moreWarnings")}),define("view/SuccessBox",["jquery","view/BaseView","templates/tiger/section/header/success-box"],function(a,b){"use strict";var c=b.extend({events:{"click .js_close":"close","click .js_open-channels":"openChannels"},initialize:function(b){this.options=a.extend({message:"",dismissable:!0,url:null,permanent:!1,hidden:!1,timeout:2500},b)},render:function(){var b=this.options,c=this.soyToHtml(tiger.section.header.successBox,{message:this.getHtml(b.message),dismissable:b.dismissable});a("#js_success-box-container").append(c),this.setElement(a(".js_success_box:last")),this.options.hidden||this.$el.fadeIn(300),b.warningBox&&this.$el.addClass("warning-box"),window.setTimeout(function(){this.options.permanent||this.close()}.bind(this),b.timeout),null!==this.options.url&&this.$el.on("click",function(){return window.location=this.options.url,!1}.bind(this)).addClass("linked")},close:function(a){a&&a.preventDefault&&a.preventDefault(),this.$el.slideUp("fast",this.remove.bind(this))},attachMoreWarningsBox:function(b){var c=this.soyToHtml(tiger.section.header.moreWarnings,{count:b});a("#js_success-box-container").append(c),a("#js_success-box-container .js_additional-warnings a").click(function(b){b.preventDefault(),a(this).parent().hide(),a(".js_success_box").show()})},openChannels:function(b){a(".js_channels-off-canvas-toggle").click(),b.preventDefault()}});return c}),define("templates/tiger/section/sidebar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.section.sidebar.sidebarModule=function(a,c,d){var e="",f=a.trendingStories.length&&a.adsEnabled&&!d.features.leftrail_notrending,g=a.popularStories.length;return e+='<div class="sidebar-content js_sidebar-container js_sidebar">'+(d.features.newsletter_fs?'<div class="js_newsletter-btn--subscribe"></div>':"")+(f?'<div class="sidebar-module trending-module js_leftrailmodule">'+b.section.sidebar.leftrailTrending({posts:a.trendingStories,postsJson:a.trendingStoriesJson,permalinkPost:a.permalinkPost},null,d)+"</div>"+b.section.sidebar.containedAdContainer({preload:!0},null,d):"")+(g?'<div class="sidebar-module js_leftrailmodule leftrailmodule--popular'+(f?" invisible":"")+'">'+b.section.sidebar.leftrailPopular({popularPosts:a.popularStories,permalinkPost:a.permalinkPost,blogDisplayName:a.blogDisplayName,recommendedByScreenName:a.recommendedByScreenName,recommendedByDisplayName:a.recommendedByDisplayName},null,d)+'<div class="leftrailmodule--promotion js_leftrailmodule--promotion js_ad-promotion ad-promotions-container row"><div class="column">'+b.components.ad.leftrailPromotion({pp_position:"sidebar"},null,d)+"</div></div></div>"+(f?"":b.section.sidebar.containedAdContainer({preload:!0},null,d)):"")+"</div>"},d.DEBUG&&(b.section.sidebar.sidebarModule.soyTemplateName="tiger.section.sidebar.sidebarModule"),b.section.sidebar.leftrailTrendingImage=function(a,b,c){var d="",f=a.post.image,g=""+(f?"":(null==a.post.defaultBlogLogo?null:a.post.defaultBlogLogo.id)?"placeholder--logo":"placeholder--avatar"),h=""+(f?e.$$escapeHtml(window.kinja.imageUrl(f.id,"KinjaMedium",f.frozenFormat)):(null==a.post.defaultBlogLogo?null:a.post.defaultBlogLogo.id)?e.$$escapeHtml(window.kinja.imageUrl(a.post.defaultBlogLogo.id,"original",a.post.defaultBlogLogo.frozenFormat)):(null==a.post.defaultBlogAvatar?null:a.post.defaultBlogAvatar.id)?e.$$escapeHtml(window.kinja.imageUrl(a.post.defaultBlogAvatar.id,"original",a.post.defaultBlogAvatar.frozenFormat)):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png");return d+='<span class="trending-image-wrapper"><span class="img--16x9 '+e.$$escapeHtmlAttribute(g)+'"'+(c.features.lazy_trending_module||c.features.personalized_trending_module?"":" style=\"background-image: url('"+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(h))+"')\"")+'role="img" aria-label="'+e.$$escapeHtmlAttribute(a.post.headline)+'" alt="'+e.$$escapeHtmlAttribute(a.post.headline)+'"></span></span>'},d.DEBUG&&(b.section.sidebar.leftrailTrendingImage.soyTemplateName="tiger.section.sidebar.leftrailTrendingImage"),b.section.sidebar.leftrailTrending=function(a,c,d){var f="",g=3,h=d.features.fullheadline?130:73,i=(a.posts[0],d.features.lazy_trending_module||d.features.personalized_trending_module);f+="<header><h2>"+(i?"<strong>You</strong> may also like":"<strong>Popular</strong> from all blogs")+'</h2></header><div class="trending-reel js_trending-reel clearfix'+(i?" lazy-trending":"")+'" '+(a.postsJson?'data-posts="'+e.$$escapeHtmlAttribute(a.postsJson)+'"':"")+'><div class="index-wrapper">';for(var j=a.posts,k=j.length,l=0;k>l;l++){var m=j[l],n=(m.image,"Trending module click, position "+e.$$escapeHtml(l+1)+", js_pageType");f+=g>l?'<div class="index-img-wrap reel__item js_reel__item"><div class="reel__thumb"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(m.permalink))+'" data-ga="['+e.$$escapeHtmlAttribute(n)+']">'+b.section.sidebar.leftrailTrendingImage({post:m},null,d)+'<span class="index-img-num"></span></a></div></div>':""}f+='</div><div class="trending-progress js_trending-progress clearfix">';for(var o=g,p=0;o>p;p++)f+='<div class="trending-progress__segment js_trending-progress__segment"><div class="segment__fill"></div></div>';f+='</div><div class="reel-wrap"><div class="reel js_reel">';for(var q=a.posts,r=q.length,s=0;r>s;s++){var t=q[s],u=""+b.utils.relativeTime({time:t.publishTime},null,d),v=""+(i?"[Author Name]":e.$$escapeHtml(window.kinja.stripHtmlTags(t.authorName,""))),w=i?"[Blog Name]":t.defaultBlogName,x=i?"[Headline]":t.headline,y=i?"[Publish Time]":u,z=i?"[Post Link]":t.permalink;f+='<a class="reel__feature sidebar-item js_reel__feature'+(0==s?" active":"")+'" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(z))+'" data-ga="[Trending module click, position main, js_pageType]">'+b.section.sidebar.leftrailTrendingImage({post:t},null,d)+'<div class="trending-description-wrapper"><div class="reel__feature-description" style="background-color:#ffffff;min-height:93px"><div class="meta meta--source js_trending-source"><strong>'+e.$$escapeHtml(w)+"</strong>"+(v?" &middot; "+e.$$filterNoAutoescape(v):"")+'</div><h4 class="headline js_headline">'+e.$$filterNoAutoescape(window.kinja.truncateHtml(x,h))+'</h4><div class="meta js_meta"><time>'+e.$$filterNoAutoescape(y)+"</time></div></div></div></a>"}return f+="</div></div></div>"},d.DEBUG&&(b.section.sidebar.leftrailTrending.soyTemplateName="tiger.section.sidebar.leftrailTrending"),b.section.sidebar.leftrailPopular=function(a,c,d){var f="",g=3,h=""+(a.recommendedByDisplayName&&a.recommendedByScreenName?e.$$escapeHtml(a.recommendedByScreenName):a.recommendedByDisplayName&&a.popularPosts.length?e.$$escapeHtml(a.popularPosts[0].authorScreenName):""),i=h&&a.recommendedByDisplayName;f+="<header><h2>"+(i?'<strong>Recent</strong> from <a href="//kinja.com/'+e.$$escapeHtmlAttribute(h)+'">'+e.$$escapeHtml(a.recommendedByDisplayName)+"</a>":a.blogDisplayName?"<strong>Popular</strong> from "+e.$$escapeHtml(a.blogDisplayName):"<strong>Popular</strong> in your network")+"</h2></header>";for(var j=a.popularPosts,k=j.length,l=0;k>l;l++){var m=j[l],n=m.image;f+=g>l?b.section.sidebar.leftrailPopularItem({index:l+1,headline:m.headline,imageUrl:n?window.kinja.imageUrl(n.id,"KinjaCenteredMedium",n.frozenFormat):"",permalink:m.permalink,authorName:m.authorName,isCurrentPost:a.permalinkPost?a.permalinkPost.permalink==m.permalink:!1,isRecommended:i,blogName:m.defaultBlogName,replyCount:m.replyCount,likeCount:m.likeCount,viewCount:m.viewCount,publishTime:m.publishTime},null,d):""}return f},d.DEBUG&&(b.section.sidebar.leftrailPopular.soyTemplateName="tiger.section.sidebar.leftrailPopular"),b.section.sidebar.leftrailPopularItem=function(a,c,d){var f="",g=d.features.fullheadline?130:73,h="Popular stories click, position "+e.$$escapeHtml(a.index)+", js_pageType";f+='<div class="sidebar-item'+(a.isCurrentPost?" highlighted":"")+(a.isRecommended?" recommended":"")+'"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.permalink))+'" data-ga="['+e.$$escapeHtmlAttribute(h)+']">'+(a.imageUrl?'<span class="img--16x9"><span class="data-overlay"><ul>'+(a.likeCount?"<li>"+b.section.sidebar.numberFormat({number:a.likeCount},null,d)+b.icons.essential.star(null,null,d)+"</li>":"")+(a.replyCount?"<li>"+b.section.sidebar.numberFormat({number:a.replyCount},null,d)+b.icons.essential.bubble(null,null,d)+"</li>":"")+(a.viewCount?"<li>"+b.section.sidebar.numberFormat({number:a.viewCount},null,d)+b.icons.essential.flame(null,null,d)+"</li>":"")+"</ul></span>"+(a.imageUrl?'<span class="img--16x9" style="background-image: url('+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.imageUrl))+')" role="img" aria-label="'+e.$$escapeHtmlAttribute(a.headline)+'" alt="'+e.$$escapeHtmlAttribute(a.headline)+'"></span>':"")+"</span>":"");var i=""+e.$$escapeHtml(window.kinja.stripHtmlTags(a.authorName,""));f+='<div class="meta meta--source"><strong>'+e.$$escapeHtml(a.blogName)+"</strong>"+(i?" &middot; "+e.$$filterNoAutoescape(i):"")+'</div><h4 class="headline">'+e.$$filterNoAutoescape(window.kinja.truncateHtml(a.headline,g))+"</h4>";var j=""+b.utils.relativeTime({time:a.publishTime},null,d);return f+='<div class="meta"><time>'+e.$$filterNoAutoescape(j)+"</time></div></a></div>"},d.DEBUG&&(b.section.sidebar.leftrailPopularItem.soyTemplateName="tiger.section.sidebar.leftrailPopularItem"),b.section.sidebar.containedAdContainer=function(a,c,d){return a=a||{},"<div"+(a.preload?' id="js_leftrailmodule--preloadedad"':"")+' class="sidebar-module js_contained-ad-container contained-ad-container js_leftrailmodule invisible"><div class="contained-ad-shaft js_contained-ad-shaft"><div class="contained-ad-wrapper js_contained-ad-wrapper notransform"><div class="ad-pad"></div>'+b.components.ad.leftRail(null,null,d)+'<div class="ad-pad"></div></div></div></div>'},d.DEBUG&&(b.section.sidebar.containedAdContainer.soyTemplateName="tiger.section.sidebar.containedAdContainer"),b.section.sidebar.containedAdContents=function(a,c,d){return a=a||{},'<div class="contained-ad-shaft js_contained-ad-shaft"><div class="contained-ad-wrapper js_contained-ad-wrapper">'+(a.isEmpty?"":'<div class="ad-pad"></div>'+b.components.ad.leftRail(null,null,d)+'<div class="ad-pad"></div>')+"</div></div>"},d.DEBUG&&(b.section.sidebar.containedAdContents.soyTemplateName="tiger.section.sidebar.containedAdContents"),b.section.sidebar.numberFormat=function(a,b,c){return""+(a.number<1e3?e.$$escapeHtml(a.number):a.number>1e3&&a.number<1e6?e.$$escapeHtml(Math.round(a.number/1e3*10)/10)+"K":e.$$escapeHtml(Math.round(a.number/1e6*10)/10)+"M")},d.DEBUG&&(b.section.sidebar.numberFormat.soyTemplateName="tiger.section.sidebar.numberFormat")}),define("templates/tiger/components/ad/ads",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.ad.zoneSimple=function(a,b,c){var d="",f="MOBILE"==a.type,g=Math.floor(89999999*Math.random())+1e7,h=a.media&&"INSTREAM_VIDEO"==a.media;return d+='<div class="ad-unit js_ad-unit'+(f?" hide-contents":"")+" ad-"+e.$$escapeHtmlAttribute(a.cssClass)+" js_ad-"+e.$$escapeHtmlAttribute(a.cssClass)+'">'+(f?'<div class="ad-mobile-inner"><p class="ad-label proxima"><small class=" proxima">Advertisement</small></p>':"")+'<div id="ad-container-'+e.$$escapeHtmlAttribute(g)+'" class="ad-container js_ad-container"'+(h?'data-media-type="'+e.$$escapeHtmlAttribute(a.media)+'"':"")+'data-zone-type="'+e.$$escapeHtmlAttribute(a.type)+'"'+(a.forcedAdZone?' data-forced-ad-zone="'+e.$$escapeHtmlAttribute(a.forcedAdZone)+'"':"")+(a.postId?' data-post-id="'+e.$$escapeHtmlAttribute(a.postId)+'"':"")+(a.pp_position?'data-pp-position="'+e.$$escapeHtmlAttribute(a.pp_position)+'"':"")+">"+(h?'<span id="js_instream_video-placeholder-'+e.$$escapeHtmlAttribute(g)+'" class="js_instream-video-placeholder"></span>':"")+"</div>"+(f?'<p class="ad-label-bottom"></p></div>':"")+"</div>"},d.DEBUG&&(b.components.ad.zoneSimple.soyTemplateName="tiger.components.ad.zoneSimple"),b.components.ad.tracker=function(a,c,d){return a=a||{},""+b.components.ad.zoneSimple({type:"TRACKER",cssClass:"tracker",forcedAdZone:null!=a.postAdZone?a.postAdZone:null,postId:null!=a.postId?a.postId:null},null,d)},d.DEBUG&&(b.components.ad.tracker.soyTemplateName="tiger.components.ad.tracker"),b.components.ad.topBanner=function(a,c,d){return""+b.components.ad.zoneSimple({type:"TOP_BANNER",cssClass:"top-banner"},null,d)},d.DEBUG&&(b.components.ad.topBanner.soyTemplateName="tiger.components.ad.topBanner"),b.components.ad.billboard=function(a,c,d){return""+b.components.ad.zoneSimple({type:"BILLBOARD",cssClass:"billboard"},null,d)},d.DEBUG&&(b.components.ad.billboard.soyTemplateName="tiger.components.ad.billboard"),b.components.ad.billboardDynamic=function(a,c,d){return""+b.components.ad.zoneSimple({type:"BILLBOARD_DYNAMIC",cssClass:"billboard--dynamic"},null,d)},d.DEBUG&&(b.components.ad.billboardDynamic.soyTemplateName="tiger.components.ad.billboardDynamic"),b.components.ad.leftRail=function(a,c,d){return""+b.components.ad.zoneSimple({type:"LEFT_RAIL",cssClass:"left-rail"},null,d)},d.DEBUG&&(b.components.ad.leftRail.soyTemplateName="tiger.components.ad.leftRail"),b.components.ad.mobile=function(a,c,d){return""+b.components.ad.zoneSimple({type:"MOBILE",cssClass:"mobile"},null,d)},d.DEBUG&&(b.components.ad.mobile.soyTemplateName="tiger.components.ad.mobile"),b.components.ad.mobileSecond=function(a,c,d){return"<h1>INSERT TABOOLA HERE</h1>"+b.components.ad.zoneSimple({type:"MOBILE_SECOND",cssClass:"mobile_second--dynamic"},null,d)},d.DEBUG&&(b.components.ad.mobileSecond.soyTemplateName="tiger.components.ad.mobileSecond"),b.components.ad.adhesion=function(a,c,d){return""+b.components.ad.zoneSimple({type:"ADHESION",cssClass:"adhesion"},null,d)},d.DEBUG&&(b.components.ad.adhesion.soyTemplateName="tiger.components.ad.adhesion"),b.components.ad.preroll=function(a,b,c){return'<div id="foreplay" class="reveal-modal js_foreplay foreplay proxima noskimlinks noskimwords" data-reveal><div id="jwPlayerVideo"></div><a href="#" class="close js_foreplay-close">You can skip this ad in 5 seconds.</a></div>'},d.DEBUG&&(b.components.ad.preroll.soyTemplateName="tiger.components.ad.preroll"),b.components.ad.promotion=function(a,c,d){var e="",f=""+(a.mobile?"PROMOTION_MOBILE":"PROMOTION");return e+=b.components.ad.zoneSimple({type:f,media:a.media,cssClass:"promotion",pp_position:a.pp_position},null,d)},d.DEBUG&&(b.components.ad.promotion.soyTemplateName="tiger.components.ad.promotion"),b.components.ad.leftrailPromotion=function(a,c,d){return""+b.components.ad.zoneSimple({type:"PROMOTION_SIDEBAR",cssClass:"promotion-sidebar",pp_position:a.pp_position},null,d)},d.DEBUG&&(b.components.ad.leftrailPromotion.soyTemplateName="tiger.components.ad.leftrailPromotion"),b.components.ad.splashyTop=function(a,c,d){return""+b.components.ad.zoneSimple({type:"SPLASHYTOP",cssClass:"splashy-top"},null,d)},d.DEBUG&&(b.components.ad.splashyTop.soyTemplateName="tiger.components.ad.splashyTop"),b.components.ad.splashyBottom=function(a,c,d){return""+b.components.ad.zoneSimple({type:"SPLASHYBOTTOM",cssClass:"splashy-bottom"},null,d)},d.DEBUG&&(b.components.ad.splashyBottom.soyTemplateName="tiger.components.ad.splashyBottom"),b.components.ad.instreamVideo=function(a,c,d){return'<div class="ad-instream ad-instream--elastic"><div class="elastic__wrapper">'+b.components.ad.zoneSimple({type:"INSTREAM_VIDEO",media:a.media,cssClass:"video",pp_position:a.pp_position},null,d)+"</div></div>"},d.DEBUG&&(b.components.ad.instreamVideo.soyTemplateName="tiger.components.ad.instreamVideo")}),define("lib/jquery.stickem",["jquery"],function(a){"use strict";var b=a(window),c=a(".js_global-nav-wrap"),d=c.find(".f-dropdown"),e="down",f=b.scrollTop();b.on("scroll.stickem.global",function(){var a=b.scrollTop();e="down",f>a&&(e="up"),f=a});var g=function(b,c){this.elem=b,this.$elem=a(b),this.options=c,this.metadata=this.$elem.data("stickem-options"),this.$win=a(window)};g.prototype={defaults:{item:".stickem",container:".stickem-container",stickClass:"stickit",stickPushdownClass:"pushdown",endStickClass:"stickit-end",offset:0,start:0,onStick:null,onUnstick:null},init:function(){var b=this;return b.config=a.extend({},b.defaults,b.options,b.metadata),b.setWindowHeight(),b.getItems(),b.bindEvents(),b},bindEvents:function(){var b=this;b.$win.on("scroll.stickem",a.proxy(b.handleScroll,b)),b.$win.on("resize.stickem",a.proxy(b.handleResize,b))},destroy:function(){var a=this;a.$win.off("scroll.stickem"),a.$win.off("resize.stickem")},getItem:function(b,c){var d=this,e=a(c),f={_stickemSelf:d,$elem:e,elemHeight:e.height(),$container:e.parents(d.config.container),isStuck:!1};d.windowHeight>f.elemHeight?(f.containerHeight=f.$container.outerHeight(),f.containerInner={border:{bottom:parseInt(f.$container.css("border-bottom"),10)||0,top:parseInt(f.$container.css("border-top"),10)||0},padding:{bottom:parseInt(f.$container.css("padding-bottom"),10)||0,top:parseInt(f.$container.css("padding-top"),10)||0}},f.containerStart=f.$container.offset().top-d.config.offset+d.config.start+f.containerInner.padding.top+f.containerInner.border.top,f.containerInnerHeight=f.$container.height(),f.scrollFinish=f.containerStart-d.config.start+(f.containerInnerHeight-f.elemHeight),f.containerInnerHeight>f.elemHeight&&d.items.push(f)):f.$elem.removeClass(d.config.stickClass+" "+d.config.endStickClass)},getItems:function(){var b=this;b.items=[],b.$elem.find(b.config.item).each(a.proxy(b.getItem,b))},handleResize:function(){var a=this;a.getItems(),a.setWindowHeight()},handleScroll:function(){var a=this;if(a.items.length>0)for(var b=a.$win.scrollTop(),c=0,f=a.items.length;f>c;c++){var g=a.items[c];if(g.isStuck&&(b<g.containerStart||b>g.scrollFinish)||b>g.scrollFinish){g.$elem.removeClass(a.config.stickClass).removeClass(a.config.stickPushdownClass),b>g.scrollFinish&&g.$elem.addClass(a.config.endStickClass);var h=g.isStuck;g.isStuck=!1,h&&a.config.onUnstick&&a.config.onUnstick(g,e)}else g.isStuck===!1&&b>g.containerStart&&b<g.scrollFinish&&(d.hasClass("open")&&g.$elem.addClass(a.config.stickPushdownClass),g.$elem.removeClass(a.config.endStickClass).addClass(a.config.stickClass),g.isStuck=!0,a.config.onStick&&a.config.onStick(g,e))}},setWindowHeight:function(){var a=this;a.windowHeight=a.$win.height()-a.config.offset}},g.defaults=g.prototype.defaults,a.fn.stickem=function(a){return this.destroy=function(){this.each(function(){new g(this,a).destroy()})},this.each(function(){new g(this,a).init()})}}),define("app/leftrail/leftrailContainedItem.view",["jquery","backbone.marionette","lib/amd-wrapped/modernizr","singleton/WindowController","module/ads/ads.events","templates/tiger/section/sidebar","templates/tiger/components/ad/ads","templates/tiger/section/sidebar","lib/jquery.stickem"],function(a,b,c,d,e){"use strict";var f,g=a(window);return f=b.ItemView.extend({_isStatic:!1,template:tiger.section.sidebar.containedAdContents,ui:{containedAd:".js_contained-ad-wrapper",adContainer:".js_ad-container",adShaft:".js_contained-ad-shaft",adUnit:".js_ad-unit"},tagName:"section",className:"js_contained-ad-container contained-ad-container leftrailmodule js_leftrailmodule invisible notransform",serializeData:function(){return{isEmpty:this.options.isEmpty||!1}},onRender:function(a){a&&a.hasOwnProperty("isStatic")&&(this._isStatic=a.isStatic);var b,c=this.$el.outerHeight(!0);this.listenTo(this,"dom:appended",function(){b=this.$el.offset().top-g.scrollTop(),d.isPartiallyVisible(this.$el)?this.onVisible():this.$el.offset().top+c/2>=g.scrollTop()?this.$el.waypoint({handler:function(a){"down"===a&&(this.onVisible(),this.$el.waypoint("destroy"))}.bind(this),offset:"100%"}):this.$el.waypoint({handler:function(a){"up"===a&&(this.onVisible(),this.$el.waypoint("destroy"))}.bind(this),offset:-this.$el.outerHeight()})})},onVisible:function(){var a=this.ui.adContainer,b=a.attr("id");!b||a.hasClass("initialized")?this.reveal():(this.listenTo(e,"kinjaads."+b+".displayed",function(a){this.reveal(a.zone)}),e.trigger("ads.dynamicad.load",a,"LEFT_RAIL_DYNAMIC"))},resize:function(){this.$el.addClass("short")},resizeAd:function(){this.ui.containedAd.length&&this.ui.containedAd.addClass("short")},reveal:function(a){this.ui.adContainer.length&&(this.ui.adContainer.height()<f.adHeights.LARGE&&this.resizeAd(a),c.touch||this._isStatic||this.preparePushdownSticky()),this.$el.removeClass("invisible")},preparePushdownSticky:function(){this.$el.stickem({container:this.ui.adShaft,item:".js_contained-ad-wrapper",stickClass:"waypoint--fixed js_ah-pushdown",onStick:function(a,b){a.$elem.removeClass("notransform"),"down"===b&&a.$elem.removeClass("frombottom")},endStickClass:"waypoint--unfixed",onUnstick:function(a,b){a.$elem.addClass("notransform"),d.translateElement(a.$elem),"up"===b&&a.$elem.addClass("frombottom")}.bind(this),offset:f.stickemOffset})}},{adHeights:{SMALL:250,LARGE:600},stickemOffset:20})}),define("templates/tiger/utils/relative-time",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.utils.relativeTime=function(a,c,d){return a=a||{},""+(a.time?b.messages.time.relativeTime({type:a.time.relative.type,amount:a.time.relative.amount,hmma:a.time.hmma,day:a.time.day,Mddyyhmma:a.time.Mddyyhmma},null,d):"")},d.DEBUG&&(b.utils.relativeTime.soyTemplateName="tiger.utils.relativeTime")}),define("app/leftrail/trendingReel.view",["jquery","underscore","backbone.marionette","singleton/WindowController","singleton/Utils","singleton/Renderer","singleton/Feature","templates/tiger/utils/relative-time"],function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationEnd animationend";return i=function(){return d.isLargeUp()},j=i(),h=c.ItemView.extend({_reelIndex:0,_mouseInReel:!1,_mouseInItem:!1,ui:{progressBar:".js_trending-progress",progressSegments:".js_trending-progress__segment",reel:".js_reel",reelItem:".js_reel__item",reelFeature:".js_reel__feature"},events:{"mouseenter @ui.reelItem":"onMouseenterReelItem","mouseleave @ui.reelItem":"onMouseleaveReelItem",mouseenter:"onMouseinteract",mouseleave:"onMouseinteract"},render:function(){var d=c.getOption(this,"posts")||JSON.parse(a.attr(this.el,"data-posts")||"[]"),h=a(this.el).find(".js_reel__item"),k=a(this.el).find(".js_reel__feature"),l=g.isOn("personalized_trending_module")||g.isOn("lazy_trending_module");this.bindUIElements(),this.delegateEvents(),l&&(h.find(".img--16x9").each(function(a,b){var c=d[a].image||d[a].defaultBlogLogo||d[a].defaultBlogAvatar,f=c?e.imageUrl(c.id,"KinjaMedium",c.format):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png";b.style["background-image"]="url('"+f+"')"}),k.find(".img--16x9").each(function(a,b){var c=d[a].image||d[a].defaultBlogLogo||d[a].defaultBlogAvatar,f=c?e.imageUrl(c.id,"KinjaMedium",c.format):"https://x.kinja-static.com/assets/images/logos/touchicons/default-touch-icon-200x200.png";b.style["background-image"]="url('"+f+"')"}),k.each(function(b,c){var e=d[b],g=f.renderTemplate(tiger.utils.relativeTime,{time:e.publishTime});a.attr(c,"href",e.permalink),a(c).find(".js_headline").html(e.headline),a(c).find(".js_trending-source").html("<strong>"+e.defaultBlogName+"</strong> &middot "+e.authorNameOrByline),a(c).find(".js_meta").html(a("<time>").html(g))}),a(this.el).addClass("loaded")),j&&this._startTicking(),a(window).on("resize.trendingModule",b.throttle(function(){var a=i();j&&!a?this._resetTicking():!j&&a&&this._startTicking(),j=a}.bind(this),500))},onMouseenterReelItem:function(b){this._showItem(a(b.currentTarget).index(),!0),this._mouseInItem=!0},onMouseleaveReelItem:function(){this._mouseInReel||this._showItem(this._reelIndex,!0),this._mouseInItem=!1},onMouseinteract:function(a){return this._mouseInReel="mouseenter"===a.type?!0:!1,this._mouseInItem||this._showItem(this._reelIndex,!0),!0},_startTicking:function(){this.ui.progressBar.addClass("ticking"),this._reelIndex=0,this._showItem(this._reelIndex)},_resetTicking:function(){this.ui.progressBar.removeClass("ticking"),this.ui.progressSegments.removeClass("ticking").off(k)},_showItem:function(a,b){var c=this.ui.reelItem.length,d=this.ui.reelItem.eq(a);d.hasClass("active")||(this.ui.reelItem.removeClass("active"),d.width(),d.addClass("active")),this.ui.reelFeature.filter(".active").removeClass("active").addClass("inactive").end().eq(a).removeClass("inactive").addClass("active"),b||this.ui.progressSegments.eq(a).addClass("ticking").one(k,function(){this._reelIndex=(this._reelIndex+1)%c,0===this._reelIndex&&this._resetTicking(),this._showItem(this._reelIndex)}.bind(this))}})}),define("app/leftrail/leftrailContainedList.view",["jquery","backbone.marionette","view/behaviors/googleAnalytics.behavior","app/leftrail/leftrailContainedItem.view","module/ads/model/ads.slotModel","app/leftrail/trendingReel.view","module/ads/ads.events","singleton/WindowController","singleton/Feature","singleton/Utils","lib/waypoints"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k,l=a(".js_main__content"),m=a(".js_page"),n=a(".js_sidebar-actual-container"),o=a(window).height(),p=a("#js_leftrailmodule--preloadedad").outerHeight(!0);return k=b.CollectionView.extend({_isNextEmpty:!1,behaviors:{GoogleAnalyticsBehavior:{behaviorClass:c}},ui:{leftrailmodules:".js_leftrailmodule",preloadedAd:"#js_leftrailmodule--preloadedad"},itemView:d,render:function(){var c,d,k,l,m,n=a('.js_ad-container[data-zone-type="LEFT_RAIL"]'),o=n.attr("id"),p=e.zoneTypes,q=a.Deferred(),r=a.Deferred(),s=j.getKinjaMeta(),t=s.blogSales?s.blogSales.adsEnabled:!1;this.isClosed=!1,this.bindUIElements(),h.isMediumDown()||n.length&&(n.hasClass("js_slot-hidden")||n.hasClass("js_slot-inactive"))?this.bindChildren(!1):n.length&&n.hasClass("js_slot-displayed")?this.bindChildren(!0):i.isOn("splashy_ad")?a.when(q,r).done(function(a){this.bindChildren(a)}.bind(this)):a.when(q).done(function(a){this.bindChildren(a)}.bind(this)),c=["kinjaads.disabled","kinjaads."+o+".hide","ads."+p.LEFT_RAIL+".inactive"].join(" "),d="kinjaads."+o+".displayed",this.listenToOnce(g,c,function(){q.resolve(!1)}).listenToOnce(g,d,function(){q.resolve(!0)}),i.isOn("ad_module")&&(t?(k=["kinjaads.disabled","kinjaads."+p.SPLASHYTOP+".hide","ads."+p.SPLASHYTOP+".inactive","kinjaads."+p.SPLASHYTOP+".displayed"].join(" "),this.listenToOnce(g,k,function(){r.resolve()}),window.kinjaads.queue.push({
zoneType:p.SPLASHYTOP,onRenderEnded:r.resolve})):r.resolve()),m=this.$(".js_trending-reel"),m.length>0&&(l=new f({el:this.$(".js_trending-reel"),posts:b.getOption(this,"trendingPosts")}),l.render())},bindChildren:function(a){var b,c=this,e=this._isLongPage();c.ui.leftrailmodules.each(function(){return b=new d({el:this}),b.bindUIElements(),b.$el.hasClass("contained-ad-container")&&(e||b.resize(),!a)?void b.remove():(b.delegateEvents(),c.addChildViewEventForwarding(b),c.children.add(b),b.onRender({isStatic:e?!1:!0}),void b.trigger("dom:appended"))}),e&&!h.isMediumDown()&&a&&this.bindNewAdWaypoint()},addNewModule:function(){var a,b=this.getItemView();a=this._isNextEmpty?new b({isEmpty:!0}):new b,this._isNextEmpty=!this._isNextEmpty,a.render(),this.$el.append(a.$el),a.trigger("dom:appended")},bindNewAdWaypoint:function(){this.$el.waypoint({handler:function(a){"down"===a&&(this.$el.waypoint("destroy"),this.getRemainingHeight()>2*p&&(this.addNewModule(),this.bindNewAdWaypoint()))}.bind(this),offset:o-this.$el.outerHeight()+250})},getRemainingHeight:function(){return m.outerHeight(!0)-this.$el.outerHeight(!0)},_isLongPage:function(){return l.outerHeight(!0)>n.outerHeight(!0)}})}),define("view/footer.view",["jquery","underscore","backbone.marionette","view/behaviors/googleAnalytics.behavior"],function(a,b,c,d){"use strict";var e=c.ItemView.extend({behaviors:{GoogleAnalyticsBehavior:{behaviorClass:d}},onRender:function(){var c,d=a(window),e=d.height();c=b.throttle(function(){d.scrollTop()+e>this.$el.offset().top&&(window.ga("send","event","Footer","scroll","complete",{nonInteraction:1}),d.off("scroll.footer"))}.bind(this),1e3),d.on("scroll.footer",c)}});return e}),define("templates/tiger/icons/essential/definitions",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.icons.essential.definitions=function(a,b,c){return'<svg id="svggroup--essential" class="hide"><symbol id="iconset-search" viewBox="0 0 15 15"><path d="M9.5 8C11.433 8 13 6.433 13 4.5S11.433 1 9.5 1 6 2.567 6 4.5 7.567 8 9.5 8zm-3.233-.975c.196-.195.518-.19.708 0 .195.195.19.517 0 .708l-4.95 4.95c-.195.194-.517.19-.707 0-.195-.196-.19-.518 0-.708l4.95-4.95zM9.5 9C7.015 9 5 6.985 5 4.5S7.015 0 9.5 0 14 2.015 14 4.5 11.985 9 9.5 9z" /></symbol><symbol id="iconset-add" viewBox="0 0 18 18"><path d="M9 2.494C9 2.226 8.776 2 8.5 2c-.268 0-.5.22-.5.494V8H2.494C2.226 8 2 8.224 2 8.5c0 .268.22.5.494.5H8v5.506c0 .268.224.494.5.494.268 0 .5-.22.5-.494V9h5.506c.268 0 .494-.224.494-.5 0-.268-.22-.5-.494-.5H9V2.494z" /></symbol><symbol id="iconset-add--small" viewBox="0 0 10 10"><path d="M6 1.007C6 .45 5.552 0 5 0c-.556 0-1 .45-1 1.007V4H1.007C.45 4 0 4.448 0 5c0 .556.45 1 1.007 1H4v2.993C4 9.55 4.448 10 5 10c.556 0 1-.45 1-1.007V6h2.993C9.55 6 10 5.552 10 5c0-.556-.45-1-1.007-1H6V1.007z"></path></symbol><symbol id="iconset-site-default" viewBox="0 0 18 18"><path d="M9 16.158c3.953 0 7.158-3.205 7.158-7.158 0-3.953-3.205-7.158-7.158-7.158-3.953 0-7.158 3.205-7.158 7.158 0 3.953 3.205 7.158 7.158 7.158zM9 17c-4.418 0-8-3.582-8-8s3.582-8 8-8 8 3.582 8 8-3.582 8-8 8z"/><path d="M9 16.158c1.97 0 3.79-3.143 3.79-7.158 0-4.015-1.82-7.158-3.79-7.158S5.21 4.985 5.21 9c0 4.015 1.82 7.158 3.79 7.158zM9 17c-2.558 0-4.632-3.582-4.632-8S6.442 1 9 1s4.632 3.582 4.632 8S11.558 17 9 17z"/><path d="M2.742 4.674c1.69.883 3.947 1.383 6.345 1.383 2.396 0 4.65-.5 6.34-1.38l-.39-.746c-1.564.82-3.684 1.29-5.95 1.29-2.27 0-4.39-.47-5.955-1.28l-.39.746zm.39 9.403c1.564-.817 3.686-1.288 5.955-1.288 2.266 0 4.386.47 5.95 1.28l.39-.75c-1.69-.88-3.944-1.38-6.34-1.38-2.398 0-4.654.5-6.345 1.38l.39.744z"/><path d="M8.58 8.58H1.083v.84H8.58v7.496h.84V9.42h7.496v-.84H9.42V1.083h-.84V8.58z" /></symbol><symbol id="iconset-zoom-in" viewBox="0 0 18 18"><path d="M9 4.494C9 4.226 9.224 4 9.5 4c.268 0 .5.22.5.494V7h2.506c.268 0 .494.224.494.5 0 .268-.22.5-.494.5H10v2.506c0 .268-.224.494-.5.494-.268 0-.5-.22-.5-.494V8H6.494C6.226 8 6 7.776 6 7.5c0-.268.22-.5.494-.5H9V4.494zM9.5 13C6.462 13 4 10.538 4 7.5S6.462 2 9.5 2 15 4.462 15 7.5 12.538 13 9.5 13zm-4.877-1.36l-3.48 3.51c-.194.194-.188.514 0 .703.196.195.51.196.704.002l3.48-3.51c-.304-.275-.416-.34-.704-.706zM9.5 14c3.59 0 6.5-2.91 6.5-6.5S13.09 1 9.5 1 3 3.91 3 7.5 5.91 14 9.5 14z" /></symbol><symbol id="iconset-star" viewBox="0 0 18 18"><path d="M9.005 13.115L4.083 16.88l1.895-6.07-4.943-3.563 6.094.014L9 1.01l1.866 6.25 6.093-.01-4.93 3.563 1.89 6.07z" /></symbol><symbol id="iconset-star--giant" viewBox="0 0 24 24"><path d="M12 17.8l-7.053 4.908 2.488-8.225-6.848-5.19 8.592-.176L12 1l2.82 8.117 8.593.175-6.848 5.19 2.488 8.226z" /></symbol><symbol id="iconset-star-circle" viewBox="0 0 18 18"><path d="M9 17c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zM9 3.7c.093 0 .185.06.208.158l1.146 3.39 3.413.085c.104 0 .185.073.22.17.034.097 0 .207-.08.267l-2.72 2.175.972 3.44c.03.096 0 .206-.09.266-.05.04-.097.05-.14.05-.05 0-.09-.02-.13-.05L9 11.61l-2.81 2.04c-.036.038-.082.05-.13.05-.045 0-.09-.012-.138-.05-.07-.06-.104-.17-.08-.266l.97-3.44L4.095 7.77c-.08-.06-.115-.17-.08-.267.034-.097.127-.17.22-.17l3.412-.085 1.134-3.39c.04-.098.13-.158.22-.158z" /></symbol><symbol id="iconset-chevron-right" viewBox="0 0 18 18"><path d="M6.165 3.874c-.217-.204-.22-.53-.008-.73.206-.192.56-.195.776.008l5.902 5.48c.11.102.165.236.165.37-.002.126-.055.262-.165.365l-5.902 5.478c-.217.204-.564.207-.776.007-.206-.193-.21-.525.008-.728L11.69 9 6.165 3.873z" /></symbol><symbol id="iconset-chevron-right--small" viewBox="0 0 10 10"><path d="M7.782 4.497L3.272.207c-.287-.274-.763-.278-1.054 0-.292.277-.29.724.002 1L6.205 5 2.22 8.79c-.288.273-.292.726-.002 1.002.293.28.763.276 1.054 0l4.51-4.29C7.926 5.363 8 5.18 8 5c.002-.183-.072-.364-.218-.503z" /></symbol><symbol id="iconset-flame" viewBox="0 0 18 18"><path d="M3.923 10.89c0 2.678 2.447 5.17 5.077 5.17s5.077-2.492 5.077-5.17c0-1.752-.618-3.036-1.977-4.664-1.196-1.433-1.154-3.453-1.093-3.453-.356-.04-2.164 2.918-2.49 5.764-.507 1.5-2.29 1.018-2.543-.126-.245-.62-.296-1.97-.296-2.47 0-.5-1.755 2.72-1.755 4.95zm2.962-2.617c.25.344.63.345.72.077.185-2.933 2.015-5.63 2.643-6.247.78-.766 1.7-1.444 1.984-.915.072.135-.047.438-.167.826-.267.863-.412 2.224.738 3.602C13.883 6.912 15 8.516 15 10.89c0 3.2-2.86 6.11-6 6.11s-6-2.912-6-6.11c0-2.018 1.45-5.456 2.972-6.798l.198-.17c.233-.197.806-.146.715.164-.837 2.85 0 4.187 0 4.187z" /></symbol><symbol id="iconset-flame--giant" viewBox="0 0 24 24"><path d="M9.004 10.954c.353.496.89.497 1.02.112.262-4.217 2.854-8.093 3.743-8.98C14.872.984 16.177.01 16.577.77c.103.194-.065.63-.235 1.187-.378 1.242-.583 3.198 1.046 5.18 1.532 1.86 3.112 4.166 3.112 7.58 0 4.597-4.052 8.783-8.5 8.783s-8.5-4.186-8.5-8.782c0-3.652 2.056-7.844 4.21-9.773l.28-.243c.33-.285 1.143-.212 1.014.234-1.186 4.096 0 6.018 0 6.018z" /></symbol><symbol id="iconset-logo-kinja" viewBox="0 0 18 18"><path d="M2.898 8.293c.746.24 1.423.978 1.734 1.495.31.517 2.246 3.78 2.905 4.916.726 1.253 1.743 1.294 2.308 1.294h4.125s-3.023-5.378-3.943-6.846c-.622-.994-1.452-1.11-2.374-1.11H2.1C2.093 8.042 3 7.065 5 7c2-.065 5.284.006 6.64 0 1.354-.006 2.046-.727 2.33-1.195.284-.468 2.03-3.8 2.03-3.8S8.793 1.995 6.992 2c-1.21.006-1.734.647-2.197 1.41l-2.792 4.6c-.01.017.007.07.017.098 0 0 .35.018.878.186z" /><</symbol><symbol id="iconset-bubble" viewBox="0 0 18 18"><path d="M6.292 13.952l.34-.503.577.1c.43.07.86.11 1.29.11 3.65 0 6.56-2.65 6.56-5.84 0-3.186-2.91-5.836-6.57-5.836-3.657 0-6.566 2.65-6.566 5.836 0 1.918 1.054 3.7 2.83 4.84l.437.256c0 .18-.375 2.06-.57 2.54-.054.132 1.12-.71 1.66-1.51zm-2.01-.426C2.3 12.254 1 10.182 1 7.832 1 4.06 4.358 1 8.5 1 12.642 1 16 4.06 16 7.832c0 3.774-3.36 6.833-7.5 6.833-.495 0-.978-.047-1.447-.13-.32.473-2.45 2.172-3.165 2.4-.714.226-.823-.164-.51-.713.313-.548.903-1.95.903-2.696z" /></symbol><symbol id="iconset-bubble--giant" viewBox="0 0 24 24"><path d="M6.094 18.506C3.324 16.678 1.5 13.7 1.5 10.32 1.5 4.9 6.2.5 12 .5s10.5 4.398 10.5 9.82c0 5.425-4.702 9.823-10.5 9.823-.694 0-1.37-.067-2.025-.187-.45.68-3.432 3.123-4.432 3.45-1 .326-1.15-.235-.713-1.024.438-.788 1.264-2.802 1.264-3.876z" /></symbol><symbol id="iconset-checkmark" viewBox="0 0 18 18"><path d="M14.855 5.87c.192-.195.195-.523 0-.722-.19-.194-.51-.2-.706 0l-7.418 7.62-2.88-2.978c-.19-.195-.515-.2-.71-.002-.19.194-.194.525.003.726L6.38 13.85c.095.1.224.15.353.15.128 0 .257-.047.355-.147l7.767-7.982z" /></symbol><symbol id="iconset-checkmark--small" viewBox="0 0 10 10"><path d="M.292 5.078c-.39.4-.388 1.044-.002 1.442l2.038 2.15c.313.344 1.125.526 1.703 0L9.71 2.746c.39-.402.388-1.046 0-1.445-.39-.402-1.014-.4-1.4 0l-5.11 5.39L1.69 5.075C1.31 4.683.68 4.68.293 5.078z"></path></symbol><symbol id="iconset-close" viewBox="0 0 18 18"><path d="M1.737 1.12c-.16-.158-.44-.164-.61.006-.165.165-.172.443-.005.61L7.885 8.5l-6.763 6.764c-.167.167-.16.445.005.61.17.17.45.164.61.005L8.5 9.11l6.763 6.764c.16.158.44.164.61-.006.165-.164.172-.442.005-.61L9.115 8.5l6.763-6.764c.167-.167.16-.445-.005-.61-.17-.17-.45-.164-.61-.005L8.5 7.89 1.737 1.12z" /></symbol><symbol id="iconset-close--small" viewBox="0 0 10 10"><path d="M2.884 1.47c-.394-.394-1.03-.395-1.42-.005-.392.393-.387 1.026.006 1.42L3.586 5 1.47 7.116c-.394.394-.395 1.03-.005 1.42.393.392 1.026.387 1.42-.006L5 6.414 7.116 8.53c.394.394 1.03.395 1.42.005.392-.393.387-1.026-.006-1.42L6.414 5 8.53 2.884c.394-.394.395-1.03.005-1.42-.393-.392-1.026-.387-1.42.006L5 3.586 2.884 1.47z" /></symbol><symbol id="iconset-facebook" viewBox="0 0 18 18"><path d="M7.003 17l-.006-7H4l.006-3h2.997V4.995C7.003 2.408 8.457 1 10.808 1c1.126 0 1.91.082 2.192.12v2.877h-1.447c-1.278 0-1.526.597-1.526 1.472V7h2.866l-.403 3h-2.47l.007 7H7.003z" /></symbol><symbol id="iconset-twitter" viewBox="0 0 18 18"><path d="M12.077 2c-1.812 0-3.282 1.582-3.282 3.534 0 .277.03.547.085.806-2.728-.148-5.147-1.555-6.766-3.693-.283.522-.445 1.13-.445 1.777 0 1.226.58 2.308 1.46 2.942-.54-.02-1.05-.178-1.49-.443v.045c0 1.712 1.13 3.14 2.63 3.465-.28.08-.57.124-.87.124-.21 0-.418-.022-.62-.063.418 1.404 1.63 2.426 3.067 2.455-1.125.94-2.54 1.51-4.078 1.51-.267 0-.528-.02-.785-.05 1.46 1 3.185 1.59 5.04 1.59 6.037 0 9.34-5.39 9.34-10.06 0-.153-.005-.306-.01-.457.64-.5 1.197-1.12 1.637-1.83-.59.28-1.22.47-1.885.557.677-.437 1.198-1.13 1.443-1.955-.633.405-1.336.7-2.084.858C13.88 2.43 13.028 2 12.08 2" /></symbol><symbol id="iconset-googleplus" viewBox="0 0 18 18"><path d="M13.657 13.42c0 .914-.4 1.74-1.202 2.475-.4.354-.916.62-1.545.796-.573.208-1.245.31-2.017.31-1.402 0-2.575-.264-3.52-.795C4.457 15.645 4 14.938 4 14.085c0-.62.2-1.18.6-1.68.43-.59 1.002-1.033 1.718-1.327.658-.324 1.46-.487 2.403-.487.03 0 .798-.15.827-.15-.458-.382-.653-.57-.653-1.04 0-.355.043-.665.214-.93h-.472c-1.058 0-1.903-.574-2.618-1.28-.686-.708-1.03-1.56-1.03-2.565 0-.972.43-1.812 1.288-2.52C7.106 1.37 8.09 1 9.236 1H14l-1.073.796h-1.502c.486.236.872.604 1.16 1.105.284.59.428 1.166.428 1.725 0 1.032-.472 1.9-1.416 2.608-.373.295-.63.546-.773.752-.115.147-.172.383-.172.707 0 .325.444.84 1.33 1.548.573.413 1.002.87 1.288 1.37.258.472.387 1.076.387 1.812zM11.31 4.483c-.145-.705-.46-1.29-.95-1.75-.487-.488-1.06-.73-1.72-.73-.604-.025-1.077.18-1.422.62-.373.46-.517 1.057-.43 1.787.143.73.473 1.337.99 1.824.517.51 1.076.766 1.68.766.66 0 1.162-.243 1.506-.73.373-.486.488-1.082.345-1.787zm.153 10.713c.55-.38.826-.862.826-1.445 0-1.7-2.757-2.05-3.06-2.05-.88 0-1.667.19-2.356.573-.69.403-1.033.873-1.033 1.41 0 .54.304 1.01.91 1.413.58.403 1.295.605 2.15.605 1.13 0 1.983-.167 2.56-.503z" fill-rule="evenodd"/></symbol><symbol id="iconset-external-link" viewBox="0 0 18 18"><path d="M3.006 17C1.898 17 1 16.103 1 14.994V5.006C1 3.898 1.897 3 3.006 3H5.5c.276 0 .5.224.5.5s-.224.5-.5.5H3.006C2.45 4 2 4.45 2 5.006v9.988C2 15.55 2.45 16 3.006 16h9.988C13.55 16 14 15.55 14 14.994V11.5c0-.276.224-.5.5-.5s.5.224.5.5v3.494C15 16.102 14.103 17 12.994 17H3.006zM10 1.5c0-.276.228-.5.51-.5h5.98c.51 0 .51.5.51.51v5.98c0 .282-.232.51-.5.51-.276 0-.5-.228-.5-.51V2.75l-8.095 8.1c-.206.204-.548.197-.75-.004-.207-.207-.205-.545-.002-.748L15.247 2H10.51c-.282 0-.51-.232-.51-.5z" /></symbol><symbol id="iconset-link" viewBox="0 0 18 18"><path d="M8.72 13.36l-2.044 2.017c-.954.952-2.418.797-3.05.083L2.53 14.18c-.942-.93-.59-2.446 0-3.072.96-1.017 3.698-3.656 3.698-3.656.952-.975 2.245-1.038 3.27 0 1.023 1.038.97.997.97.997.262.26.64.21.835 0 .195-.22.16-.58-.102-.85l-.94-.93c-1.31-1.35-3.322-1.3-4.61 0l-3.68 3.75c-1.28 1.26-1.28 3.38 0 4.68l.92.93c.627.63 1.45.96 2.337.96.887 0 1.71-.335 2.334-.966L9.4 14.17c.263-.266.263-.555 0-.82-.263-.266-.673 0-.673 0zm.56-8.72l2.044-2.017c.954-.952 2.418-.797 3.05-.083l1.095 1.28c.94.93.59 2.446 0 3.072-.96 1.017-3.7 3.656-3.7 3.656-.95.975-2.25 1.038-3.27 0s-.97-.997-.97-.997c-.26-.26-.64-.21-.84 0-.2.22-.16.58.1.85l.944.93c1.31 1.35 3.327 1.3 4.61 0l3.68-3.75c1.284-1.26 1.284-3.38 0-4.68l-.92-.93c-.62-.63-1.443-.96-2.33-.96-.888 0-1.71.334-2.335.965L8.6 3.825c-.262.266-.262.555 0 .82.264.266.674 0 .674 0z" /></symbol><symbol id="iconset-image" viewBox="0 0 18 18"><path d="M1 2.994v12.012c0 .548.446.994.995.994h14.01c.55 0 .995-.445.995-.994V2.994c0-.548-.446-.994-.995-.994H1.995C1.445 2 1 2.445 1 2.994zm-1 0C0 1.894.893 1 1.995 1h14.01C17.107 1 18 1.895 18 2.994v12.012c0 1.1-.893 1.994-1.995 1.994H1.995C.893 17 0 16.105 0 15.006V2.994z"/><path d="M1.38 15.804L5.807 8.24l-.86.007 3.682 6.068c.17.288.573.324.8.073l2.5-2.82-.74.01 4.514 4.832c.188.202.504.213.706.024.203-.19.213-.505.025-.707l-4.515-4.83c-.2-.216-.543-.212-.74.008l-2.5 2.82.8.07L5.8 7.728c-.197-.324-.67-.32-.86.007L.51 15.298c-.137.24-.057.545.18.684.24.14.546.06.685-.178zM12 9c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm0 1c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/></symbol><symbol id="iconset-burner" viewBox="0 0 18 18"><path d="M14.24 10.837c-.39.175-.853.28-1.387.28-.27 0-.593-.044-.955-.126-.344-.07-.713-.19-1.093-.32-.284-.1-1.218-.51-1.31-.54-.158-.06-.32-.093-.488-.093-.175 0-.336.038-.493.096-.092.035-1.035.444-1.32.545-.38.136-.748.247-1.093.326-.36.083-.68.127-.95.127-.53 0-.99-.103-1.39-.28-.22-.1-.55-.353-.65-.46-.17-.18-.34-.39-.502-.634-.38-.57-.635-1.22-.712-1.934l-.006.14c.268-1.33 1.078-2.07 2.03-2.07 1.53 0 2.884.31 4.662 1.284 0 0 .266.147.41.147.146 0 .43-.143.43-.143 1.78-.974 3.137-1.282 4.666-1.282.95 0 1.762.74 2.038 2.057l-.002-.14c-.076.72-.33 1.364-.71 1.94-.162.24-.335.453-.507.633-.1.105-.43.36-.657.46zm1.907-.61c.453-.684.76-1.463.853-2.33l-.007-.137C16.635 6.053 15.48 5 14.083 5c-1.672 0-3.175.34-5.093 1.393C7.092 5.34 5.59 5 3.916 5c-1.397 0-2.55 1.053-2.91 2.76L1 7.897c.093.867.4 1.646.853 2.33.33.498.664.846.9 1.036.114.1.332.24.64.38.503.223 1.09.357 1.754.357.346 0 .732-.052 1.154-.15.39-.086.79-.207 1.2-.354.31-.108.6-.223.87-.34.16-.068.6-.248.647-.248.045 0 .474.18.636.25.27.115.56.23.865.338.41.147.813.268 1.195.355.42.1.805.15 1.15.15.666 0 1.25-.13 1.755-.35.31-.14.528-.28.65-.39.228-.18.56-.53.89-1.03zm-9.99-2.604c-.155-.077-.316-.133-.483-.17-.53-.118-1.078-.037-1.605.164-.22.08-.38.164-.48.223l-.24.146.03.28c.07.623.45 1.266 1.22 1.502.34.11.77.117 1.27.05.3-.044.63-.115.95-.206.19-.053.373-.11.54-.167.1-.034.174-.062.22-.078l.735-.285-.628-.477c-.07-.052-.2-.145-.394-.273-.315-.21-.69-.444-1.13-.696l-.02-.013zm.243 1.19s-.447.1-.654.13c-.374.05-.68.046-.878-.017-.367-.114-.48-.485-.48-.485s.76-.2 1.093-.12c.1.02.92.5.92.5zm5.42-1.177c-.437.252-.813.485-1.128.696-.192.128-.322.22-.39.273l-.63.477.74.285c.042.016.117.044.218.078.167.057.35.114.542.167.33.09.652.162.96.205.493.068.92.06 1.27-.05.762-.235 1.146-.88 1.214-1.502l.03-.28-.24-.145c-.1-.06-.263-.142-.475-.223-.52-.2-1.07-.282-1.6-.164-.16.037-.32.093-.48.17l-.02.013zm.7.68c.333-.075 1.09.125 1.09.125s-.11.38-.475.49c-.202.07-.507.07-.88.02-.265-.032-.64-.15-.64-.15s.808-.45.904-.472z" /></symbol><symbol id="spinner" viewBox="0 0 37 12" stroke="#aaa" fill="none"><circle cx="6" cy="6" r="4"><animate attributeName="r" begin="0s" dur="0.65s" values="0;4" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/><animate attributeName="stroke-opacity" begin="0s" dur="0.65s" values="0;1" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="6" cy="6" r="4"><animate attributeName="cx" begin="0s" dur="0.65s" values="6;19" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="19" cy="6" r="4"><animate attributeName="cx" begin="0s" dur="0.65s" values="19;32" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle><circle cx="32" cy="6" r="4"><animate attributeName="r" begin="0s" dur="0.65s" values="4;0" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/><animate attributeName="stroke-opacity" begin="0s" dur="0.65s" values="1;0" calcMode="spline" keySplines="0.51 0 0.21 0.9" repeatCount="indefinite"/></circle></symbol><symbol id="iconset-tools--giant" viewBox="0 0 24 24"><path d="M12 5.5c1.38 0 2.5-1.12 2.5-2.5S13.38.5 12 .5 9.5 1.62 9.5 3s1.12 2.5 2.5 2.5zm0 18c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5-2.5 1.12-2.5 2.5 1.12 2.5 2.5 2.5zm0-9c1.38 0 2.5-1.12 2.5-2.5S13.38 9.5 12 9.5 9.5 10.62 9.5 12s1.12 2.5 2.5 2.5z" /></symbol></svg>'},d.DEBUG&&(b.icons.essential.definitions.soyTemplateName="tiger.icons.essential.definitions")}),define("templates/tiger/icons/essential/usage",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.icons.essential.search=function(a,b,c){return'<svg class="svg-icon svg-search"><use xlink:href="#iconset-search" /></svg>'},d.DEBUG&&(b.icons.essential.search.soyTemplateName="tiger.icons.essential.search"),b.icons.essential.add=function(a,b,c){return'<svg class="svg-icon svg-add"><use xlink:href="#iconset-add" /></svg>'},d.DEBUG&&(b.icons.essential.add.soyTemplateName="tiger.icons.essential.add"),b.icons.essential.adDMSall=function(a,b,c){return'<svg class="svg-icon small svg-add--small"><use xlink:href="#iconset-add--small" /></svg>'},d.DEBUG&&(b.icons.essential.adDMSall.soyTemplateName="tiger.icons.essential.adDMSall"),b.icons.essential.siteDefault=function(a,b,c){return'<svg class="svg-icon svg-site-default"><use xlink:href="#iconset-site-default" /></svg>'},d.DEBUG&&(b.icons.essential.siteDefault.soyTemplateName="tiger.icons.essential.siteDefault"),b.icons.essential.zoomIn=function(a,b,c){return'<svg class="svg-icon svg-zoom-in"><use xlink:href="#iconset-zoom-in" /></svg>'},d.DEBUG&&(b.icons.essential.zoomIn.soyTemplateName="tiger.icons.essential.zoomIn"),b.icons.essential.star=function(a,b,c){return'<svg class="svg-icon svg-star"><use xlink:href="#iconset-star" /></svg>'},d.DEBUG&&(b.icons.essential.star.soyTemplateName="tiger.icons.essential.star"),b.icons.essential.starGiant=function(a,b,c){return'<svg class="svg-icon giant stroked svg-star--giant"><use xlink:href="#iconset-star--giant" /></svg>'},d.DEBUG&&(b.icons.essential.starGiant.soyTemplateName="tiger.icons.essential.starGiant"),b.icons.essential.starCircle=function(a,b,c){return'<svg class="svg-icon svg-star-circle"><use xlink:href="#iconset-star-circle" /></svg>'},d.DEBUG&&(b.icons.essential.starCircle.soyTemplateName="tiger.icons.essential.starCircle"),b.icons.essential.chevronRight=function(a,b,c){return'<svg class="svg-icon svg-chevron chevron--right"><use xlink:href="#iconset-chevron-right" /></svg>'},d.DEBUG&&(b.icons.essential.chevronRight.soyTemplateName="tiger.icons.essential.chevronRight"),b.icons.essential.chevronRightSmall=function(a,b,c){return'<svg class="svg-icon small svg-chevron--small chevron--right"><use xlink:href="#iconset-chevron-right--small" /></svg>'},d.DEBUG&&(b.icons.essential.chevronRightSmall.soyTemplateName="tiger.icons.essential.chevronRightSmall"),b.icons.essential.chevronBottom=function(a,b,c){return'<svg class="svg-icon svg-chevron chevron--bottom"><use xlink:href="#iconset-chevron-right" /></svg>'},d.DEBUG&&(b.icons.essential.chevronBottom.soyTemplateName="tiger.icons.essential.chevronBottom"),b.icons.essential.chevronBottomSmall=function(a,b,c){return'<svg class="svg-icon small svg-chevron--small chevron--bottom"><use xlink:href="#iconset-chevron-right--small" /></svg>'},d.DEBUG&&(b.icons.essential.chevronBottomSmall.soyTemplateName="tiger.icons.essential.chevronBottomSmall"),b.icons.essential.chevronLeft=function(a,b,c){return'<svg class="svg-icon svg-chevron chevron--left"><use xlink:href="#iconset-chevron-right" /></svg>'},d.DEBUG&&(b.icons.essential.chevronLeft.soyTemplateName="tiger.icons.essential.chevronLeft"),b.icons.essential.chevronLeftSmall=function(a,b,c){return'<svg class="svg-icon small svg-chevron--small chevron--left"><use xlink:href="#iconset-chevron-right--small" /></svg>'},d.DEBUG&&(b.icons.essential.chevronLeftSmall.soyTemplateName="tiger.icons.essential.chevronLeftSmall"),b.icons.essential.chevronTop=function(a,b,c){return'<svg class="svg-icon svg-chevron chevron--top"><use xlink:href="#iconset-chevron-right" /></svg>'},d.DEBUG&&(b.icons.essential.chevronTop.soyTemplateName="tiger.icons.essential.chevronTop"),b.icons.essential.chevronTopSmall=function(a,b,c){return'<svg class="svg-icon small svg-chevron--small chevron--top"><use xlink:href="#iconset-chevron-right--small" /></svg>'},d.DEBUG&&(b.icons.essential.chevronTopSmall.soyTemplateName="tiger.icons.essential.chevronTopSmall"),b.icons.essential.flame=function(a,b,c){return'<svg class="svg-icon svg-flame"><use xlink:href="#iconset-flame" /></svg>'},d.DEBUG&&(b.icons.essential.flame.soyTemplateName="tiger.icons.essential.flame"),b.icons.essential.flameGiant=function(a,b,c){return'<svg class="svg-icon giant stroked svg-flame--giant"><use xlink:href="#iconset-flame--giant" /></svg>'},d.DEBUG&&(b.icons.essential.flameGiant.soyTemplateName="tiger.icons.essential.flameGiant"),b.icons.essential.kinja=function(a,b,c){return'<svg class="svg-icon svg-logo-kinja"><use xlink:href="#iconset-logo-kinja" /></svg>'},d.DEBUG&&(b.icons.essential.kinja.soyTemplateName="tiger.icons.essential.kinja"),b.icons.essential.bubble=function(a,b,c){return'<svg class="svg-icon svg-bubble"><use xlink:href="#iconset-bubble" /></svg>'},d.DEBUG&&(b.icons.essential.bubble.soyTemplateName="tiger.icons.essential.bubble"),b.icons.essential.bubbleGiant=function(a,b,c){return'<svg class="svg-icon giant stroked svg-bubble--giant"><use xlink:href="#iconset-bubble--giant" /></svg>'},d.DEBUG&&(b.icons.essential.bubbleGiant.soyTemplateName="tiger.icons.essential.bubbleGiant"),b.icons.essential.checkmark=function(a,b,c){return'<svg class="svg-icon svg-checkmark"><use xlink:href="#iconset-checkmark" /></svg>'},d.DEBUG&&(b.icons.essential.checkmark.soyTemplateName="tiger.icons.essential.checkmark"),b.icons.essential.checkmarkSmall=function(a,b,c){return'<svg class="svg-icon small svg-checkmark--small"><use xlink:href="#iconset-checkmark--small" /></svg>'},d.DEBUG&&(b.icons.essential.checkmarkSmall.soyTemplateName="tiger.icons.essential.checkmarkSmall"),b.icons.essential.close=function(a,b,c){return'<svg class="svg-icon svg-close"><use xlink:href="#iconset-close" /></svg>'},d.DEBUG&&(b.icons.essential.close.soyTemplateName="tiger.icons.essential.close"),b.icons.essential.closeSmall=function(a,b,c){return'<svg class="svg-icon small svg-close--small"><use xlink:href="#iconset-close--small" /></svg>'},d.DEBUG&&(b.icons.essential.closeSmall.soyTemplateName="tiger.icons.essential.closeSmall"),b.icons.essential.facebook=function(a,b,c){return'<svg class="svg-icon svg-facebook"><use xlink:href="#iconset-facebook" /></svg>'},d.DEBUG&&(b.icons.essential.facebook.soyTemplateName="tiger.icons.essential.facebook"),b.icons.essential.twitter=function(a,b,c){return'<svg class="svg-icon svg-twitter"><use xlink:href="#iconset-twitter" /></svg>'},d.DEBUG&&(b.icons.essential.twitter.soyTemplateName="tiger.icons.essential.twitter"),b.icons.essential.googleplus=function(a,b,c){return'<svg class="svg-icon svg-googleplus"><use xlink:href="#iconset-googleplus" /></svg>'},d.DEBUG&&(b.icons.essential.googleplus.soyTemplateName="tiger.icons.essential.googleplus"),b.icons.essential.externalLink=function(a,b,c){return'<svg class="svg-icon svg-external-link"><use xlink:href="#iconset-external-link" /></svg>'},d.DEBUG&&(b.icons.essential.externalLink.soyTemplateName="tiger.icons.essential.externalLink"),b.icons.essential.burner=function(a,b,c){return'<svg class="svg-icon svg-burner"><use xlink:href="#iconset-burner" /></svg>'},d.DEBUG&&(b.icons.essential.burner.soyTemplateName="tiger.icons.essential.burner"),b.icons.essential.link=function(a,b,c){return'<svg class="svg-icon svg-link"><use xlink:href="#iconset-link" /></svg>'},d.DEBUG&&(b.icons.essential.link.soyTemplateName="tiger.icons.essential.link"),b.icons.essential.image=function(a,b,c){return'<svg class="svg-icon svg-image"><use xlink:href="#iconset-image" /></svg>'},d.DEBUG&&(b.icons.essential.image.soyTemplateName="tiger.icons.essential.image"),b.icons.essential.spinner=function(a,b,c){return'<svg class="svg-icon svg-image"><use xlink:href="#spinner" /></svg>'},d.DEBUG&&(b.icons.essential.spinner.soyTemplateName="tiger.icons.essential.spinner"),b.icons.essential.toolsGiant=function(a,b,c){return'<svg class="svg-icon giant stroked svg-tools--giant"><use xlink:href="#iconset-tools--giant" /></svg>'},d.DEBUG&&(b.icons.essential.toolsGiant.soyTemplateName="tiger.icons.essential.toolsGiant"),b.icons.essential.facebook__C17=function(a,b,c){return'<svg class="svg-icon svg-facebook"><use xlink:href="#iconset-facebook" /></svg>'},d.DEBUG&&(b.icons.essential.facebook__C17.soyTemplateName="tiger.icons.essential.facebook__C17"),b.icons.essential.twitter__C17=function(a,b,c){return'<svg class="svg-icon svg-twitter"><use xlink:href="#iconset-twitter" /></svg>'},d.DEBUG&&(b.icons.essential.twitter__C17.soyTemplateName="tiger.icons.essential.twitter__C17"),b.icons.essential.googleplus__C17=function(a,b,c){return'<svg class="svg-icon svg-googleplus"><use xlink:href="#iconset-googleplus" /></svg>'},d.DEBUG&&(b.icons.essential.googleplus__C17.soyTemplateName="tiger.icons.essential.googleplus__C17"),b.icons.essential.chevronBottomSmall__C17=function(a,b,c){return'<svg class="svg-icon small svg-chevron--small chevron--bottom"><use xlink:href="#iconset-chevron-right--small" /></svg>'},d.DEBUG&&(b.icons.essential.chevronBottomSmall__C17.soyTemplateName="tiger.icons.essential.chevronBottomSmall__C17"),b.icons.essential.closeSmall__C17=function(a,b,c){return'<svg class="svg-icon small svg-close--small"><use xlink:href="#iconset-close--small" /></svg>'},d.DEBUG&&(b.icons.essential.closeSmall__C17.soyTemplateName="tiger.icons.essential.closeSmall__C17")}),define("module/EssentialIconModule",["jquery","templates/tiger/icons/essential/definitions","templates/tiger/icons/essential/usage"],function(a){"use strict";var b=a("#svggroup--essential");b&&b.length||a("#js_svg-definitions").append(a.trim(tiger.icons.essential.definitions()))}),define("model/Feature",["underscore","backbone","apiclient/feature"],function(a,b,c){"use strict";var d=b.Model.extend({defaults:{sticky:!0,regions:[]},sync:function(a,b,d){var e={};switch(a){case"create":return e=b.set({enabled:!0}).toJSON(),c.createFeature(e,d);case"update":if(b.changedAttributes())return e=b.changedAttributes(),e.modelId=b.id,c.updateFeature(e,d);window.alert("No feature settings were changed.");break;case"read":case"delete":case"enable":case"disable":return c[a+"Feature"]({modelId:b.id},d);case"segment":return c.getSegmentFeature()}},parse:function(a){var b;return b=a.meta&&a.meta.success===!0?a.data:a},validate:function(b){var c=a.extend(a.clone(this.attributes),b||{}),d=c.defaultValue||"",e=c.values||"";if(!c.name)return"Name not specified";if(!c.id||this.attributes.name!==c.name){if(!c.name.match(/^[a-z]/))return"Name must start with a lowecase letter";if(!c.name.match(/^[a-z0-9_]+$/))return"Name can only use the following: a-z 0-9 _"}return!e||e.length<2?"No values":c.abTesting!==!1||"%"===d.substr(d.length-1)||d&&-1!==e.indexOf(d)?void 0:"Invalid default value"},toggle:function(){var a=this,b=a.get("enabled")?"disable":"enable";a.sync(b,a,{success:function(b){return a.set({enabled:!a.get("enabled")})?void a.trigger("sync",a,b):!1}})}});return d}),define("collection/Feature",["backbone","model/Feature","singleton/CurrentBlog","apiclient/feature"],function(a,b,c,d){"use strict";var e=a.Collection.extend({model:b,sync:function(a,b,e){var f={};return c.canonicalHost&&(f.blog=c.canonicalHost),e.withAuthor&&(f.withAuthor=!0),e.compact&&(f.compact=!0),"read"===a?this.blogId?d.getBlogFeatures({blogId:this.blogId},e):d.getAjaxFeatures(f,e):void 0},blacklist:{476822046:"off"},getBetaFeatures:function(){return new e(this.filter(function(a){return"BETA"===a.get("type")}))},parse:function(a){return a.data},getDirtyModels:function(){var a=this.models.filter(function(a){return a.get("isDirty")}),b=this.blacklist;return a.map(function(a){var c=parseInt(a.get("id"),10);return b.hasOwnProperty(c)&&a.set("value",b[c]),a.get("id")+"="+a.get("value")}).join("&")}});return e}),define("singleton/FeatureThrottling",["jquery","backbone","underscore","lib/amd-wrapped/modernizr","singleton/Feature","singleton/CurrentUser","singleton/Utils","model/Feature","collection/Feature","apiclient/feature","gawkerlib/jquery.parseParams"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k="_",l="kinja_feature_segment",m="kinja_feature_measurement_2507",n=b.Model.extend({initialize:function(){e.isOn("throttle")&&(f.onLoggedIn.done(function(){a.removeCookie(l,{path:"/"}),this.checkFeatures()}.bind(this)),this.checkFeatures(),"off"!==e.value("throttle_measuring")&&this.measureThrottledFeature(e.value("throttle_measuring")))},checkFeatures:function(){var b=c.map(c.filter(a("body")[0].className.split(" "),function(a){return 0===a.indexOf("mf_")}),function(a){return a.substr(3)});a.when(this.getFeatureSegment(),this.getFeatures()).done(function(d,f){var g=this.lookupFeaturesToChange(d,f,b),h=c.map(c.extend({},g.reloading,g.silent),function(a,b){return b+"="+a});h.length>0&&(a.removeCookie(m,{path:"/"}),e.isOn("throttle_instant")?(e.syncCookies(h.join("&")),c.keys(g.reloading).length>0&&document.location.reload()):a(window).on("beforeunload",function(){e.syncCookies(h.join("&"),!0)}))}.bind(this))},measureThrottledFeature:function(b){var c=e.value(b),d=b+"="+c;a.cookie(m)||void 0===c||(j.sendPerHourFeatureTick({featureName:b,featureValue:c}),a.cookie(m,d,{path:"/",expires:1/24}))},getFeatureSegment:function(){var b=a.cookie(l),c=a.Deferred();return b?c.resolve(parseInt(b,10)):f.onAuth.done(function(){var a=new h;a.sync("segment",a,{success:function(a){a.meta&&a.meta.success&&a.meta.success===!0&&c.resolve(a.data)}})}),c},getFeatures:function(){var b,c=a.Deferred(),e=new i,f="kinja_feature_collection",h=!0,j=parseInt(g.getKinjaMeta().featuresLastUpdate,10),k=d.localstorage;return e.on("sync",function(){c.resolve(e),k&&(b={featuresLastUpdate:j,features:e.invoke("pick",["name","abTesting","possibleValues","source","defaultValue","blogValue"])},window.localStorage.setItem(f,JSON.stringify(b)))}),k&&(b=JSON.parse(window.localStorage.getItem(f)),b&&parseInt(b.featuresLastUpdate,10)===j&&(c.resolve(new i(b.features)),h=!1)),h=!0,h===!0&&e.fetch({compact:!0,disableToken:!0}),c},lookupFeaturesToChange:function(a,b,d){var f=a/100,g={reloading:{},silent:{}};return d=d||[],b.each(function(a){var b,h=0;c.contains(d,a.get("name"))||(a.get("abTesting")===!0?(b=c.last(c.filter(a.get("possibleValues"),function(a){var b=f>h;return h+=a.percentage,b})),e.value(a.get("name"))!==b.name&&(g.reloading[a.get("name")]=b.name)):"user"===a.get("source")&&(e.value(a.get("name"))!==a.get("defaultValue")&&e.value(a.get("name"))!==a.get("blogValue")?g.reloading[a.get("name")]=k:g.silent[a.get("name")]=k))}),g}});return new n}),define("lib/amd-wrapped/jquery.scrollTo",["jquery"],function(a){function b(a){return"object"==typeof a?a:{top:a,left:a}}var c=a.scrollTo=function(b,c,d){a(window).scrollTo(b,c,d)};c.defaults={
axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:!0},c.window=function(b){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!=a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return/webkit/i.test(navigator.userAgent)||"BackCompat"==d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"==d&&(d=9e9),f=a.extend({},c.defaults,f),e=e||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=b(f.offset),f.over=b(f.over),this._scrollable().each(function(){function g(a){j.animate(l,e,f.easing,a&&function(){a.call(this,d,f)})}if(null!=d){var h,i=this,j=a(i),k=d,l={},m=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(k)){k=b(k);break}if(k=a(k,this),!k.length)return;case"object":(k.is||k.style)&&(h=(k=a(k)).offset())}a.each(f.axis.split(""),function(a,b){var d="x"==b?"Left":"Top",e=d.toLowerCase(),n="scroll"+d,o=i[n],p=c.max(i,b);if(h)l[n]=h[e]+(m?0:o-j.offset()[e]),f.margin&&(l[n]-=parseInt(k.css("margin"+d))||0,l[n]-=parseInt(k.css("border"+d+"Width"))||0),l[n]+=f.offset[e]||0,f.over[e]&&(l[n]+=k["x"==b?"width":"height"]()*f.over[e]);else{var q=k[e];l[n]=q.slice&&"%"==q.slice(-1)?parseFloat(q)/100*p:q}f.limit&&/^\d+$/.test(l[n])&&(l[n]=l[n]<=0?0:Math.min(l[n],p)),!a&&f.queue&&(o!=l[n]&&g(f.onAfterFirst),delete l[n])}),g(f.onAfter)}}).end()},c.max=function(b,c){var d="x"==c?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])}}),define("lib/ios-orientationchange-fix",["jquery"],function(a){return function(b){function c(){var b,c="";a(document).find("input[placeholder]").each(function(){b=a(this),c=b.attr("placeholder"),b.removeAttr("placeholder").attr("placeholder",c)})}function d(){m.setAttribute("content",p),q=!0}function e(){m.setAttribute("content",o),q=!1}function f(a){l=a.accelerationIncludingGravity,i=Math.abs(l.x),j=Math.abs(l.y),k=Math.abs(l.z),b.orientation&&180!==b.orientation||!(i>7||(k>6&&8>j||8>k&&j>6)&&i>5)?q||d():q&&e()}b.addEventListener&&b.addEventListener("orientationchange",c,!1);var g=navigator.userAgent;if(/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(g)&&g.indexOf("AppleWebKit")>-1){var h=b.document;if(h.querySelector){var i,j,k,l,m=h.querySelector("meta[name=viewport]"),n=m&&m.getAttribute("content"),o=n+",maximum-scale=1",p=n+",maximum-scale=10",q=!0;m&&(b.addEventListener("orientationchange",d,!1),b.addEventListener("devicemotion",f,!1))}}}(window),{}}),define("module/BaseApp",["jquery","underscore","lib/amd-wrapped/modernizr","module/Main","view/BaseView","singleton/CurrentUser","singleton/CurrentBlog","singleton/EventDispatcher","singleton/Feature","singleton/Utils","app/navigation/topbar.layout","app/navigation/userMenu.view","app/modalmenu/usermenu","app/modalmenu/notifmenu","app/navigation/secondaryNav.view","view/SuccessBox","app/MarionetteApp","app/leftrail/leftrailContainedList.view","view/footer.view","app/account/account.channel","module/KinjaAnalytics","module/ads/ads.events","module/EssentialIconModule","singleton/FeatureThrottling","lib/jquery.cookie","lib/amd-wrapped/jquery.scrollTo","lib/ios-orientationchange-fix","lib/waypoints","templates/tiger/icons/essential/usage","templates/tiger/components/ad/ads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";var w,x;return w=function(a){require(["module/LoginModule"],function(b){a(b.controller)})},x=e.extend({successBox:null,el:a("body"),$secondaryNavBtn:a(".js_secondary-nav-btn-wrapper"),events:{"click .js_offcanvas-user":"onOffcanvasUser","click .js_offcanvas-notif":"onOffcanvasNotif","click .js_usermenu-button":"onUsermenuButtonClick"},initialize:function(){d.start(),i.isOn("tap")&&require(["lib/fastclick"],function(a){a.attach(document.body)}),"resettoken"===this.getPageType()||"gettoken"===this.getPageType()?this.resetToken():(this.initApp(),"admin"!==j.getKinjaMeta().pageType&&this.initSubViews())},start:function(){},initApp:function(){var b=function(b){var c=a.cookie("kinja_features");!b.isSuperUser()||c&&-1!==c.indexOf("all_on=")||(a.cookie.raw=!0,c&&""!==c?a.cookie("kinja_features",c+"|all_on=on"):a.cookie("kinja_features","all_on=on"),a.cookie.raw=void 0)};i.isOn("frontendtiming")&&window.markUserTime("currentuser_load"),f.load(window._user).done(function(){if(b(f),i.isOn("frontendtiming")){var a=f.isLoggedIn()?"currentuser_loaded_loggedin":"currentuser_loaded_loggedout";a+="-"+(i.isOn("webpack")?"webpack":"require"),a+="-"+(g.blogGroup||"default"),window.markUserTime(a)}}).fail(function(){a("body").addClass("read-only")}),f.onLoggedIn.done(this.handleLogin.bind(this)),h.on("modal:incompleteRegistration:success",function(){window.ga("send","event","Sign up",f.get("authName"),g.displayName)},this),h.on("all",this.trigger,this),i.isOn("userstats")&&this.statsTracker(),i.isOn("analyticstracking")&&this.initAnalyticsTracking(),a("body").addClass("js_initialized "+(c.touch?"touch":"no-touch")),a("#ad-970x250-container").length&&i.isOn("dynamic_billboard")&&a("div.basement").first().waypoint({handler:function(b){"down"===b&&(a("#ad-970x250-container").append(tiger.components.ad.billboardDynamic()),v.trigger("ads.dynamicad.load",a(".js_ad-billboard--dynamic .js_ad-container"),"BILLBOARD_DYNAMIC"))},offset:function(){return window.innerHeight+100},triggerOnce:!0}),this.listenTo(t,"loginRequired",this.onLoginRequired).listenTo(t,"loginCancelled",this.onLoginCancelled).listenTo(f,"incompleteRegistration",this.onIncompleteRegistration)},initSubViews:function(){var b,c=a(q.notificationDropdownRegion.el).length>0,d=a(".js_site-footer");this.initLeftrailContained(),i.isOn("channels")&&this.initChannels(),i.isOn("trendingfeed_mobile")&&"permalink"===j.getKinjaMeta().pageType&&this.initMobileTrendingModule(),i.isOn("newsletter_fs")&&this.initSubscriptionModule(),c&&this.initTopbar(),i.isOn("maintenance_mode")&&this.showMaintenanceMessage(),this.setupSuccessBox(),d.length&&(b=new s({el:d}),b.bindUIElements(),b.delegateEvents(),b.onRender()),i.isOn("featurepanel")&&require(["module/FeaturePanelModule"],function(a){a.start()})},isGoogleBot:function(){return window.navigator.userAgent.toLowerCase().indexOf("googlebot")>0},displayWarningMessage:function(b,c){if(0===b.length||"1"===a.cookie(c))return!1;var d=function(){return b.addClass("hide"),a.cookie(c,"1",{expires:30,path:"/"}),!1};b.removeClass("hide").find("a.close").on("click",d)},showMaintenanceMessage:function(){var b=a(".js_maintenance");b.length>0&&b.removeClass("hide")},setupSuccessBox:function(){h.on("successbox:display",function(a){null!==this.successBox&&this.successBox.close(),this.successBox=new p(a),this.successBox.render()},this),h.on("successbox:close",function(){null!==this.successBox&&this.successBox.close()},this)},initLeftrailContained:function(){var a;a=new r({el:".js_sidebar"}),a.render()},initMobileTrendingModule:function(){var b=a(".post-content > p"),c=b.length>3?2:b.length;a(b[c]).after('<div class="trendingfeed-inset-container js_trendingfeed-inset-container hide-for-large-up"></div>'),require(["module/MobileTrendingModule"],function(a){a.start()})},initTopbar:function(){var a,b,c=j.pageTypes,d=[c.editor,c.usersettings,c.splash,c.dashboard,c.manageblog,c.leaderboard,c.performancestats],e=-1!==d.indexOf(j.getKinjaMeta().pageType);a=new k({el:".js_global-nav-wrap",model:f}),a.bindUIElements(),a.onRender(),e||/iemobile/.test(window.navigator.userAgent.toLowerCase())||a.initializeAutohide(),this.$secondaryNavBtn.length>0&&(e||this.$secondaryNavBtn.addClass("transition shown"),b=new o({el:"body",animation:!e}))},onOffcanvasUser:function(){var a=new m({className:"dui-modal fullscreen-modal right dui-menu",model:f,tab:"user"});return q.duimodalregion.show(a),!1},onOffcanvasNotif:function(){var a=new n({className:"dui-modal fullscreen-modal right dui-menu",model:f,tab:"notif"});return q.duimodalregion.show(a),!1},onUsermenuButtonClick:b.once(function(){var a=new l({model:f});q.userDropdownRegion.show(a)}),initChannels:function(){require(["module/ChannelsApp"],function(a){a.start()})},initSubscriptionModule:function(){require(["module/SubscriptionModule"],function(a){a.start()})},handleLogin:function(){f.isSuperUser()&&i.isOn("superuser")&&i.isOn("superuser_notif")&&a(".js_top-nav-wrap").addClass("momjeans-notifier"),a("body").addClass("loggedin")},resetToken:function(){var a=f.get("token");return a&&0===a.indexOf("dummy-")?window.location.href=window.location.protocol+"//"+window.location.host:f.token().done(function(){window.setTimeout(function(){window.location.reload()},1e3)}).fail(function(){window.location.href="/"}),!1},statsTracker:function(){var b="__k_iut",c=a(".js_stats"),d=c.data("trackurl"),e=!1;(!a.cookie(b)||a.cookie(b)<(new Date).getTime()-2592e6)&&(e=!0,a.cookie(b,(new Date).getTime(),{path:"/",expires:365})),c.data("unique",e),d&&(e&&(d+="&unique=true"),c.append('<img src="'+d+'" style="display: none;">'))},initAnalyticsTracking:function(){f.on("logoutReset",function(){u.pushEvent("LOGOUT",null,null,null)}),h.on("modal:login:closed",function(a){u.pushEvent("LOGIN","AUTHENTICATION",f.get("authName"),{uiElement:a.source||"default"})}),h.on("modal:incompleteRegistration:success",function(a){u.pushEvent("REGISTER","AUTHENTICATION",f.get("authName"),{uiElement:a.source||"default"})}),h.on("analytics:postSaved",function(a){"PUBLISHED"===a.data.status&&a.data.id===a.data.starterId&&u.pushEvent("PUBLISH_STARTER","POST",a.data.id,null)}),h.on("analytics:replySaved",function(a){"PUBLISHED"===a.data.status&&a.data.id!==a.data.starterId&&u.pushEvent("PUBLISH_REPLY","POST",a.data.id,null)})},onLoginRequired:function(a){w(function(b){var c=a?a.source:"default";b.showOptions(c),window.ga("send","event","Authentication flow","Prompt login","source: "+c)})},onLoginCancelled:function(a){u.pushEvent("LOGIN","CANCELLED","closeModal",{uiElement:a.source||"default"})},onIncompleteRegistration:function(){w(function(a){a.showIncompleteRegistration()})}})}),define("singleton/util/loadEditor",["underscore","jquery","singleton/Feature","singleton/StringUtils"],function(a,b,c,d){"use strict";function e(c,e,f){var g,h,i,j=b("head>meta[id="+e+"-css-url]");1===j.length?(g=j.attr("content"),h=0,i=function(){var b=a.find(document.styleSheets,function(a){return d.endsWith(a.href,g)});return"undefined"!=typeof b},document.createStyleSheet?document.createStyleSheet(g):b("head").append('<link rel="stylesheet" type="text/css" href="'+g+'" />'),j.remove(),require([c],function(){if(i())f.apply();else var a=window.setInterval(function(){(i()||h>99)&&(window.clearInterval(a),f.apply()),h+=1},250)})):require([c],f)}function f(){var a=b.Deferred();return c.isOn("webpack")?require(["module/MarionetteEditor","stylesheets/editor.css"],function(){require(["app/editor/editor.app"],a.resolve)}):e("module/MarionetteEditor","editor",function(){require(["app/editor/editor.app"],a.resolve)}),a.promise()}return f}),define("app/mixins/HighlightBox",["jquery","singleton/EventDispatcher"],function(a,b){"use strict";var c={insertHighlightBox:function(c,d,e,f){var g=c===!1?d:a(c.target),h=c===!1?Math.round(g.width()*e/100):Math.round(c.pageX-g.offset().left),i=c===!1?Math.round(g.height()*f/100):Math.round(c.pageY-g.offset().top),j=g.width()-50,k=50,l=g.height()-50,m=50,n=Math.round((h>j?j-50:k>h?0:h-50)+g.offset().left),o=Math.round((i>l?l-50:m>i?0:i-50)+g.offset().top),p=c!==!1?" create-annotation":"",q='<div class="annotationHighlightBox'+p+'" style="top:'+o+"px; left:"+n+'px;"></div>';return c===!1?b.on("imageAnnotationsClose",function(){a(".annotationHighlightBox").remove()},this):b.on("removeReplyForm",function(){a(".annotationHighlightBox").remove()},this),a(".annotationHighlightBox").remove(),a("body").prepend(q),{top:o,left:n}}};return c}),define("apiclient/annotation",["config","singleton/Feature","apiclient/apirequest","singleton/Utils"],function(a,b,c,d){"use strict";var e;return e={getAnnotations:c.getJson(a.api.core.url+"/annotation/starter/{{starterId}}",{filterDismissed:!0,cache:b.isOn("cachecomments")?d.shouldGetCached:!1})}}),define("templates/tiger/components/annotation",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.annotation.newSingleAnnotation=function(a,c,d){return'<span class="js_annotation-footnote annotation-footnote" data-annotation-id="'+e.$$escapeHtmlAttribute(a.reply.id)+'"'+(null!=a.x&&null!=a.y?' data-annotation-x="'+e.$$escapeHtmlAttribute(a.x)+'" data-annotation-y="'+e.$$escapeHtmlAttribute(a.y)+'" data-image-chompid="'+e.$$escapeHtmlAttribute(a.imageChompId)+'" data-annotation-type="image"':' data-annotation-type="text" ')+' ><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.reply.permalink))+'" class="js_annotation-footnote-link annotation-footnote-link proxima">P</a>'+b.components.annotation.annotationInset(a,null,d)+"</span>"},d.DEBUG&&(b.components.annotation.newSingleAnnotation.soyTemplateName="tiger.components.annotation.newSingleAnnotation"),b.components.annotation.annotationInset=function(a,c,d){var f="",g=d.features.hide_pending_replies&&a.reply&&!(null==a.reply?null:a.reply.approved);f+='<div class="annotation-inset-under js_annotation-inset-'+e.$$escapeHtmlAttribute(a.id)+' hide" data-annotation-id="'+e.$$escapeHtmlAttribute(a.id)+'"><div class="hide-annotation right cursor-pointer" id="annotation_'+e.$$escapeHtmlAttribute(a.id)+'">'+b.icons.essential.closeSmall(null,null,d)+'</div><div class="annotation-content">'+(g&&!(null==a.reply?null:a.reply.newpost)?b.components.groupchats.unapprovedAnnotationWarning(null,null,d)+'<div class="js_annotation-content hide">':'<div class="js_annotation-content">')+e.$$filterNoAutoescape(a.reply.excerptWithAssets)+'<footer class="row proxima"><div class="medium-8 columns"><span class="floated-container img-30"><span class="avatar"><span class="img-border mbn mrm"><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.reply.author.avatar.id,"avt-large",a.reply.author.avatar.format)))+'" class="avatar" alt="" /></span></span><span class="txt blogname proxima text-upper text-strong text-light txt-30">';for(var h="",i=a.reply.blogs,j=i.length,k=0;j>k;k++){var l=i[k];h+=l.id==a.reply.author.defaultBlogId?'<a class="text-light" href="http://'+e.$$escapeHtmlAttribute(l.canonicalHost)+'" target="_self">'+e.$$escapeHtml(a.reply.author.displayName)+"</a>":""}return f+=(h?e.$$filterNoAutoescape(h):e.$$escapeHtml(a.reply.author.displayName))+'</span></span></div><div class="medium-4 columns medium-text-right text-center txt-30"><a class="text-light text-small view-discussion" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.reply.permalink))+'">View discussion&nbsp;&gt;&gt;</a></div></footer></div></div></div>'},d.DEBUG&&(b.components.annotation.annotationInset.soyTemplateName="tiger.components.annotation.annotationInset")}),define("app/AnnotationApplet",["jquery","underscore","backbone.marionette","view/BaseView","singleton/EventDispatcher","singleton/Feature","singleton/util/loadEditor","singleton/DeviceController","app/mixins/HighlightBox","apiclient/annotation","templates/tiger/components/annotation"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=a(window),l=d.extend(b.extend({},i,{annotationsFootnotesMax:5,_annotationTypeImage:"image",annotationApiResult:null,events:{"click .js_annotation-footnote-link":"toggleAnnotation","click .hide-annotation":"hideAllAnnotations","click .ellipsis":"expandFootnotes","click .js_annotatable-image":"annotateHandler","click .js_pending-reply-switch":"showPending"},initialize:a.noop,startApp:function(){this.isMobile=h.isTabletLike()||h.isMobileLike(),this.allowReplies=this.model.get("allowReplies")&&!a("body").hasClass("read-only"),(!this.isMobile||f.isOn("mobileannotation"))&&(a(".post-content").addClass("new-annotation"),!this.allowReplies||this.isMobile?this.enableImageAnnotations(!0):this.enableImageAnnotations(),this.model&&this.model.get("isStarter")===!0&&(this.model.on("AnnotationCreated",function(a){this.addNewAnnotation(a)},this),this.annotationApiResult=j.getAnnotations({starterId:this.model.get("starterId")}).then(function(a){return a.items}),this.getAnnotationReplies({type:"starter",discussions:!0})),this.model.on("annotation:remove",this.removeAnnotation.bind(this)),e.on("annotation:fromReplies",this.getAnnotationReplies.bind(this)))},getAnnotationReplies:function(a){this.annotationApiResult.done(function(c){var d;d="permalink"===a.type?b.filter(c,function(b){return b.replyId===a.replyId}):a.discussions?b.filter(c,function(a){return a.reply.approved}):c,this.renderAnnotations(d)}.bind(this))},renderAnnotations:function(c){var d,e=this,f=c,g=b.where(f,{annotationType:this._annotationTypeImage.toUpperCase()});this.$(".annotation-footnote-wrapper").empty(),g.length&&(d=b(g).filter(function(a){return a.reply}),b(d).each(function(b){var c=b.imageChompId,d=a('[data-chomp-id="'+c+'"]').parents(".has-image");0===d.children(".annotation-footnote-wrapper").length&&d.append('<span class="annotation-footnote-wrapper clearfix"></span>'),d.children(".annotation-footnote-wrapper").append(e.renderAnnotationTemplate(b))})),this.updateFotenoteNumbers(),this.addEllipsis()},renderAnnotationTemplate:function(a){var b=this.soyToHtml(tiger.components.annotation.newSingleAnnotation,a);return b},addEllipsis:function(){var c=this,d=a(".annotation-footnote-wrapper");b.each(d,function(d){var e=a(d),f=e.find(".annotation-footnote"),g=f.length;b.each(f,function(b,d){d>c.annotationsFootnotesMax-1&&d!==g-1&&a(b).addClass("ellipsable hide")}),g>c.annotationsFootnotesMax+1&&0===e.find(".ellipsis").length&&f.last().before('<span class="ellipsis">...</span>')})},updateFotenoteNumbers:function(){var c=a(".js_annotation-footnote-link");a(c).length&&b.each(c,function(b,c){a(b).html(c+1)})},expandFootnotes:function(b){var c=a(b.target);c.siblings(".ellipsable").removeClass("hide"),c.remove()},toggleAnnotation:function(b){var c=a(b.target),d=c.parents(".annotation-footnote");b.preventDefault(),d.hasClass("selected")?this.hideAllAnnotations():this.openAnnotation(b,d)},openAnnotation:function(b,c){var d,e,f=this;this.hideAllAnnotations(),c.addClass("selected").find(".annotation-inset-under").removeClass("hide"),c.data("annotation-type")===this._annotationTypeImage&&(d=c.data("image-chompid"),e=a('[data-chomp-id="'+d+'"]'),this.insertHighlightBox(!1,e,c.data("annotation-x"),c.data("annotation-y"))),k.on("keyup.hideAnnotations",function(a){(void 0!==a.keyCode&&27===a.keyCode||void 0!==a.which&&27===a.which)&&f.hideAllAnnotations()}),k.on("click.hideAnnotations",function(b){0===a(b.target).parents(".annotation-footnote-wrapper").length&&f.hideAllAnnotations()})},hideAllAnnotations:function(b){b&&b.stopPropagation(),a(".annotation-footnote").removeClass("selected"),a(".annotation-inset-under").addClass("hide"),a(".annotationHighlightBox").length&&a(".annotationHighlightBox:not(.create-annotation)").remove(),k.off("keyup.hideAnnotations"),k.off("click.hideAnnotations")},enableImageAnnotations:function(c){var d,e=a('article:not(reframe-post) img[data-chomp-id][src!=""]'),f=[];if(e.length){for(d=0,e;d<e.length;d+=1)f.push(a(e[d]).data("chomp-id"));b.each(b.unique(f),function(b){var d=a("[data-chomp-id="+b+"]").first();c||d.closest("a").length||d.addClass("js_annotatable-image cursor-crosshair")})}},annotateHandler:function(b){var c,d,e,f,h,i,j,l,m,n,o,p,q,r=this,s="image",t=a(b.currentTarget);return this.hideAllAnnotations(),e=t.offset(),f=t.width(),h=t.height(),i=t.attr("width"),j=t.attr("height"),l=t.data("asset-url"),m=t.data("chomp-id"),n=b.pageX-e.left,o=b.pageY-e.top,p=Math.round(n/f*100),q=Math.round(o/h*100),c=function(a){a.$el.find(".reply-annotation").remove(),a.$el.find("input.js_annotationType").val("IMAGE"),a.$el.find("input.js_imageUrl").val(l),a.$el.find("input.js_imageChompId").val(m),a.$el.find("input.js_imageWidth").val(i?i:f),a.$el.find("input.js_imageHeight").val(j?j:h),a.$el.find("input.js_x").val(p),a.$el.find("input.js_y").val(q)},d=function(c){g().then(function(){require(["app/editor/editor.app","app/MarionetteApp"],function(d,e){var f=r.addCommentRegion(e,a('<div class="js_replyform "/>').css({position:"absolute",top:0}).prependTo("body"));f.once("editor:post:save",function(a){r.addNewAnnotation({model:a})}),d.annotatePost(c,b,s)})})},d(this.model),k.on("keyup.hideAnnotations",function(a){(void 0!==a.keyCode&&27===a.keyCode||void 0!==a.which&&27===a.which)&&r.hideAllAnnotations()}),k.on("click.hideAnnotations",function(b){0===a(b.target).parents(".replyform").length&&r.hideAllAnnotations()}),!1},addCommentRegion:function(a,b){var d=a.commentRegion,e=d?d.currentView:!1;return(!e||e.confirmRemove())&&(d&&(d.reset(),d.off()),d=new c.Region({el:b}),a.addRegions({commentRegion:d})),d},addNewAnnotation:function(c){b.defaults(c.model,{get:function(a){return this[a]}});var d,e,f,g=c.model,h=g.get("imageChompId"),i={id:g.id,x:g.get("x")?g.get("x"):null,y:g.get("y")?g.get("y"):null,imageChompId:h,reply:{permalink:g.get("permalink"),excerptWithAssets:g.get("excerptWithAssets")?g.get("excerptWithAssets"):g.get("display"),author:g.get("author"),blogs:g.get("blogs"),id:g.id,newpost:!0}};d=a('[data-chomp-id="'+h+'"]'),f=d.parents(".has-image"),e=f.find(".annotation-footnote-wrapper"),e.length?e.append(this.renderAnnotationTemplate(i)):(f.append('<span class="annotation-footnote-wrapper clearfix"></span>'),f.find(".annotation-footnote-wrapper").append(this.renderAnnotationTemplate(i))),this.insertHighlightBox(!1,d,g.get("x"),g.get("y")),a('[data-annotation-id="'+g.get("id")+'"]').removeClass("hide").parents(".js_annotation-footnote").addClass("selected"),this.updateFotenoteNumbers(),this.addEllipsis()},removeAnnotation:function(b){a('[data-annotation-id="'+b+'"]').remove(),this.updateFotenoteNumbers(),this.addEllipsis()},showPending:function(b){b.preventDefault();var c=a(b.target).parents(".annotation-content");c.find(".js_toggle-pending").addClass("hide"),c.find(".js_annotation-content").removeClass("hide")}}));return l}),define("singleton/util/hostname",[],function(){"use strict";function a(a){return a.replace(/^www\./,"")}function b(a){var b=a.lastIndexOf(".");return-1===b?a:a.substring(0,b)}function c(c){return a(b(c))===b(d)}var d;return d=a(window.location.host),{removeWWW:a,sameHost:c}}),define("singleton/util/externalLinks",["singleton/util/hostname"],function(a){"use strict";return{openInNewTabs:function(b){b.find("a").each(function(b,c){a.sameHost(c.hostname)||c.setAttribute("target","_blank")})}}}),define("singleton/PostInsetTools",["underscore","jquery","singleton/Renderer","singleton/Utils","singleton/Feature","singleton/util/hostname","singleton/util/externalLinks"],function(a,b,c,d,e,f,g){"use strict";function h(){}var i;return h.prototype={render:function(a){var b;b=a.find(".js_inset"),g.openInNewTabs(b),this.markExternalInsets(b),e.isOn("empty_thumbnail_test")||this.hideEmptyThumbnails(a)},hideEmptyThumbnails:function(a){var c=a.find(".referenced-item img");c.each(function(a,c){function d(){c.naturalHeight&&c.naturalWidth||f.addClass("hide")}var e=b(c),f=e.parents(".referenced-item-image");c.complete?d():e.load(d)})},markExternalInset:function(a,b){var c,d,e;f.sameHost(b)||(c=a.querySelector(".js_readmore .js_external-text"),c&&(e=f.removeWWW(b),d='<span class="hostname">'+e.split(".").join(".&#x200b;")+"</span>",a.querySelector(".js_readmore").innerHTML=c.innerText+" "+d))},markExternalInsets:function(b){b.find(".referenced-item").each(function(b,c){this.markExternalInset(c,a.last(c.querySelectorAll("a")).hostname)}.bind(this))},soyToHtml:function(a,b,e){var f=d.getRenderableData(b,e);return c.renderTemplate(a,f.data,f.injected)}},i||(i=new h)}),define("app/post/common/post.layout",["underscore","backbone.marionette","singleton/CurrentUser","singleton/Utils","singleton/Feature","module/KinjaAnalytics"],function(a,b,c,d,e,f){"use strict";var g=b.Layout.extend(a.extend({regions:{post:".post"},ui:{likeButton:".js_like",likeIcon:".js_like_icon",likeCountPlaceholder:".js_like_count",replyButton:".js_reply-to-post",metaContainer:".meta-container",metaTools:".js_meta-tools"},triggers:{"click @ui.likeButton":"posttools:like","click @ui.replyButton":"posttools:reply"},events:{approval:"_removePendingStyling","click @ui.likeIcon":"onRecommendTracking"},modelEvents:{"change:liked":"_updateLikeIconClasses","posttools:post:likeCount:updated":"_updateLikeCount"},updateUserState:function(){c.onAuth.done(function(){c.isLoggedIn()?this._updateLikeIconClasses():this._removeLikeIconClass()}.bind(this)),c.onLoggedIn.done(this._updateLikeIconClasses.bind(this))},togglePostToolsVisibility:function(a){e.isOn("newstream")?this.ui.metaTools.toggleClass("hide",a):this.ui.metaContainer.toggleClass("without-dropdown",a)},onRecommendTracking:function(a){var b="groupChat"===a.currentTarget.parentElement.getAttribute("data-analytics-target");d.getKinjaMeta().pageType!==d.pageTypes.permalink||b||f.pushEvent("RECOMMENDATION","POST",this.model.id,{uiElement:a.currentTarget.getAttribute("data-analytics-target")})},_removePendingStyling:function(b,c){var d=this.$el.closest(".js_branch-list");a.each(c.approvedReplyIDs,function(a){d.find("#reply_"+a).removeClass("reply--unapproved")})},_updateLikeIconClasses:function(){this.ui.likeIcon.toggleClass("active",this.model.get("liked"))},_removeLikeIconClass:function(){this.ui.likeIcon.removeClass("active")},_updateLikeCount:function(){var a=parseInt(this.ui.likeButton.data("likecount"),10)||0,b=a>0;a=this.model.get("liked")?a+1:b?a-1:0,this.ui.likeButton.data("likecount",a),this.ui.likeCountPlaceholder.text(a||"")}}));return g}),define("app/post/mixins/post.confirmationPrompt",["jquery","singleton/Renderer"],function(a,b){"use strict";var c={_confirmationPrompt:function(c,d){return window.confirm(a(b.renderTemplate(c,d||{})).text())}};return c}),define("app/post/mixins/post.userPermissionsHelper",["singleton/Feature","singleton/CurrentUser","singleton/CurrentBlog"],function(a,b,c){"use strict";return{canEditPost:function(c){var d=15,e=function(a){var b=new Date(a+60*d*1e3),c=new Date;return b>c},f=b.isLoggedIn(),g=b.id===c.get("authorId"),h=b.hasRole("OWNER",c.get("defaultBlogId")),i=b.hasRole("ADMIN",c.get("defaultBlogId")),j=c.has("parentId"),k=f&&(g||h||i)&&!j,l=f&&j&&g&&e(c.get("publishTimeMillis"));return b.isSuperuser()&&a.isOn("superuser")||k||l},canDeletePost:function(a){var c=b.isLoggedIn(),d=b.id===a.get("authorId"),e=b.hasRole("OWNER",a.get("defaultBlogId")),f=a.has("parentId");return c&&(d||e)&&!f},canInviteToPostManually:function(c){return a.isOn("invitetoken")&&c.get("authorId")===b.id},canPromote:function(){return b.hasPermission("SALES")||b.isSuperuser()&&a.isOn("superuser")},canDismissPost:function(d){var e=b.hasRole("ADMIN",c.id)||b.hasRole("ADMIN",d.get("defaultBlogId")),f=b.id===d.get("authorId"),g=b.id===d.get("parentAuthorId"),h=d.has("parentId");return h&&(b.isSuperuser()&&a.isOn("superuser")||!f&&(e||g))},canUnshareRepostedPost:function(){return b.hasRole("ADMIN",c.id)},canBlock:function(a){return this.userIsOwner(a)||this.userIsAdmin(a)||this.userIsSuper()},canSharePost:function(){return b.isLoggedIn()},userIsAuthor:function(a){return b.hasRole("AUTHOR",a.get("defaultBlogId"))&&b.id!==a.get("authorId")},userIsOwner:function(a){return b.hasRole("OWNER",a.get("defaultBlogId"))&&b.id!==a.get("authorId")},userIsAdmin:function(a){return b.hasRole("ADMIN",a.get("defaultBlogId"))&&b.id!==a.get("authorId")},userIsSuper:function(){return b.isSuperuser()&&a.isOn("superuser")}}}),define("app/post/mixins/post.userPermissions",["underscore","app/post/mixins/post.userPermissionsHelper"],function(a,b){"use strict";var c=["canEditPost","canDeletePost","canInviteToPostManually","canPromote","canDismissPost","canUnshareRepostedPost","canBlock","canSharePost","userIsAuthor","userIsOwner","userIsAdmin","userIsSuper"];return a.reduce(c,function(c,d){return c[d]=a.wrap(b[d],function(a){return a.call(this,this.model)}),c},{})}),define("app/post/common/post.menuitemview",["backbone.marionette"],function(a){"use strict";var b=a.ItemView.extend({_show:function(){this.$el.removeClass("hide")},_hide:function(){this.$el.addClass("hide")},_isDisabled:function(){return!1},_canShow:function(){throw new Error("method _canShow not implemented!")},onRender:function(){this._canShow()?(this._show(),this._isDisabled()?this.$el.addClass("disabled"):this.$el.removeClass("disabled")):this._hide()}});return b}),define("app/post/posttools/view/posttools.menuitemview",["underscore","app/post/mixins/post.userPermissions","app/post/mixins/post.confirmationPrompt","app/post/common/post.menuitemview"],function(a,b,c,d){"use strict";var e=d.extend(a.extend({},b,c,{_canShow:function(){var b=this,c=function(a){return b[a]};return a.chain(this.permissions).map(c).invoke("call",this).all().value()},render:function(){return this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this}}));return e}),define("app/post/posttools/view/posttools.editview",["app/post/posttools/view/posttools.menuitemview","singleton/Feature","singleton/Utils"],function(a,b,c){"use strict";var d=a.extend({permissions:["canEditPost"],onRender:function(){var d=b.isOn("editor_own_page_test")?window.location.search:"",e=this.$el.find("a");a.prototype.onRender.call(this,arguments),e.attr("href","//"+c.getKinjaHost()+"/write/"+this.model.id+d)}});return d}),define("app/post/posttools/view/posttools.editreplyview",["app/post/posttools/view/posttools.menuitemview"],function(a){"use strict";var b=a.extend({permissions:["canEditPost"]});return b}),define("app/post/posttools/view/posttools.deleteview",["app/post/posttools/view/posttools.menuitemview"],function(a){"use strict";var b=a.extend({permissions:["canDeletePost"],triggers:{click:"posttools:delete"}});return b}),define("apiclient/invite",["config","apiclient/apirequest","apiclient/gettoken"],function(a,b,c){"use strict";return{addInvite:b.postJson(c.append(a.api.core.url+"/invite")),requestInviteToken:b.postJson(c.append(a.api.core.url+"/invite/create?postId={{postId}}")),approveInvitedCommenter:b.postJson(a.api.core.url+"/invite/approve")}}),define("templates/tiger/components/invites/modals",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.invites.modals.inviteToPostManually=function(a,b,c){return'<form class="invite-to-post-form js_invite-to-post-form"><div class="row"><div class="columns"><input type="url" class="mbn js_invite-manually-field" value="'+e.$$escapeHtmlAttribute(a.permalink)+"?invite="+e.$$escapeHtmlAttribute(a.inviteUid)+'" autofocus /></div></div></form>'},d.DEBUG&&(b.components.invites.modals.inviteToPostManually.soyTemplateName="tiger.components.invites.modals.inviteToPostManually")}),define("view/forms/invite/InviteToPostManuallyModalView",["backbone.marionette","singleton/EventDispatcher","templates/tiger/components/invites/modals"],function(a,b){"use strict";var c=a.ItemView.extend({id:"modal-invite-to-post-manually",template:tiger.components.invites.modals.inviteToPostManually,ui:{inviteToPostManuallyField:"#js_invite-to-post-manually-field"},initialize:function(){b.on("modal:login:close",this.close,this)}});return c}),define("app/invites/behaviors/invites.token.posttools",["backbone.marionette","apiclient/invite","app/modal/modal.controller","view/forms/invite/InviteToPostManuallyModalView"],function(a,b,c,d){"use strict";var e=a.Behavior.extend({
events:{click:"onInviteModalToPostManuallyOpen"},onInviteModalToPostManuallyOpen:function(a){a.preventDefault(),b.requestInviteToken({postId:this.view.model.id}).done(function(a){var b=c.instantiate(d,{templateData:{permalink:this.view.model.get("permalink"),inviteUid:a.inviteUid}});c.create(b,{name:"invite",className:"reveal-modal kinja-modal small proxima"})}.bind(this))}});return e}),define("app/post/posttools/view/posttools.invitemanuallyview",["app/post/posttools/view/posttools.menuitemview","app/invites/behaviors/invites.token.posttools"],function(a,b){"use strict";var c=a.extend({permissions:["canInviteToPostManually"],behaviors:{InvitesTokenPostTools:{behaviorClass:b}}});return c}),define("app/post/posttools/view/posttools.dismissview",["app/post/posttools/view/posttools.menuitemview","singleton/CurrentUser","singleton/Utils"],function(a,b,c){"use strict";var d=a.extend({permissions:["canDismissPost"],ui:{dismissButton:"a.dismiss",undismissButton:"a.undismiss"},triggers:{"click @ui.dismissButton":"posttools:dismiss","click @ui.undismissButton":"posttools:undismiss"},modelEvents:{"change:actionState":"_finishRender"},_finishRender:function(){this._setDismissState(),a.prototype.onRender.call(this)},_setDismissState:function(){var a=this.model.get("actionState"),b=this.model.get("defaultBlogId");a=a?a[b]:"","dismiss"===a?(this.$el.removeClass(".js_dismiss").addClass("js_undismiss"),this.ui.dismissButton.addClass("hide"),this.ui.undismissButton.removeClass("hide")):(this.$el.removeClass(".js_undismiss").addClass("js_dismiss"),this.ui.undismissButton.addClass("hide"),this.ui.dismissButton.removeClass("hide"))},onRender:function(){var a,d,e=this;"permalink"===c.getKinjaMeta().pageType?(a=parseInt(c.getKinjaMeta().postId||0,10),d=parseInt(c.getKinjaMeta().starterId||0,10),a!==d&&a===this.model.id?b.onAuth.always(function(){b.isLoggedIn()?e.triggerMethod("posttools:getDismissState",{model:e.model}):e._finishRender()}):this._finishRender()):this._finishRender()}});return d}),define("app/post/posttools/view/posttools.promoteview",["app/post/posttools/view/posttools.menuitemview","singleton/Utils"],function(a,b){"use strict";var c=a.extend({permissions:["canPromote"],triggers:{click:"posttools:promote"},onPosttoolsOpened:function(){var a=this.model&&parseInt(b.getKinjaMeta().postId,10)===this.model.get("sharedPostId");a&&this.$el.addClass("hide")}});return c}),define("app/post/posttools/view/posttools.blockview",["app/post/posttools/view/posttools.menuitemview","singleton/CurrentUser"],function(a,b){"use strict";var c=a.extend({permissions:["canBlock"],events:{click:"_blockBlog"},modelEvents:{"posttools:blockStatusUpdated":"_finishRender"},collectionEvents:{"posttools:block posttools:unblock sync":"_checkBlockStatus"},_checkBlockStatus:function(){this.triggerMethod("posttools:checkBlockStatus",{model:this.model,collection:this.collection})},_blockBlog:function(a){a.preventDefault(),this.triggerMethod("posttools:block",{model:this.model,collection:this.collection,targetBlogName:this._getTargetBlogName(),targetAuthorName:this._getTargetAuthorName()}),this.$el.siblings(".js_unfollowforblog").addClass("hide"),this.$el.siblings(".js_followforblog").removeClass("hide"),this.$el.siblings(".js_unfollowforuser").addClass("hide"),this.$el.siblings(".js_followforuser").removeClass("hide")},_correctBlockText:function(a){var b=this.$el.find("span"),c=b.text(),d=a?"Unblock":"Block";d=c.replace(/Unblock|Block/,d),b.text(d)},_finishRender:function(b){this._correctBlockText(b),a.prototype.onRender.call(this)},_getTargetBlogName:function(){return this.$el.data("targetblogname")},_getTargetAuthorName:function(){return this.$el.data("targetauthorname")},onRender:function(){var a=this;b.onAuth.always(function(){a._canShow()?a._checkBlockStatus():a._hide()})}});return c}),define("app/post/posttools/view/posttools.hideview",["app/post/posttools/view/posttools.menuitemview"],function(a){"use strict";var b=a.extend({permissions:["userIsSuper"],triggers:{click:"posttools:hide"}});return b}),define("app/post/posttools/view/posttools.kinjashareview",["app/post/posttools/view/posttools.menuitemview","singleton/Utils"],function(a,b){"use strict";var c=a.extend({permissions:[],events:{click:"onKinjaShareClick"},onKinjaShareClick:function(){var a=parseInt(b.getKinjaMeta().postId,10)===this.model.get("sharedPostId"),c=this.model.get("isStarter");this.trigger("posttools:kinjaShare",this.model,{showReframe:!a&&c})}});return c}),define("app/post/posttools/view/posttools.kinjaunshareview",["app/post/posttools/view/posttools.menuitemview"],function(a){"use strict";var b=a.extend({permissions:["canSharePost","canUnshareRepostedPost"],triggers:{click:"posttools:undorepost"}});return b}),define("app/post/posttools/view/posttools.externalshareview",["jquery","app/post/posttools/view/posttools.menuitemview"],function(a,b){"use strict";var c=b.extend({permissions:[],ui:{sharePostButton:".js_share-post-item"},triggers:{"click @ui.sharePostButton":"posttools:externalShare"},onRender:function(){var b=function(b){return a("<div/>").html(b).text()},c=function(a){return a?a.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(b)}):""},d=this.model.get("headline")||this.model.get("first100Characters")||this.model.get("compact"),e=this.ui.sharePostButton.attr("href");this.ui.sharePostButton.attr("href",e.replace("POST_TITLE",encodeURIComponent(b(c(d)))))}});return c}),define("templates/tiger/components/groupchats/flagreason",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.groupchats.flagreason=function(a,c,d){return'<form><label class="reason-head">Why are you flagging this?<a class="icon" href="http://help.gawker.com/customer/portal/articles/1726140-what-is-flagging-?b_id=5895" target="_blank">'+b.icons.actions.information(null,null,d)+'</a></label><div class="row radio-cont"><div class="column small-12 js_error hide proxima"><small class="warningmessage">Please select a reason</small></div><div class="columns small-12"><label><input type="radio" name="reason" value="HARASSMENT">It\'s harassment</label></div></div><div class="row radio-cont"><div class="columns small-12"><label><input type="radio" name="reason" value="HATE_SPEECH">It\'s hate speech</label></div></div><div class="row radio-cont"><div class="columns small-12"><label><input type="radio" name="reason" value="SPAM">It\'s spam</label></div></div><div class="flag-reason-ctas"><a class="button secondary tiny cancel js_cancel">Cancel</a><a class="button primary tiny submit js_submit">Save</a></div></form>'},d.DEBUG&&(b.components.groupchats.flagreason.soyTemplateName="tiger.components.groupchats.flagreason")}),define("module/flagging/view/FlagReasonDropdown",["backbone.marionette","templates/tiger/components/groupchats/flagreason"],function(a){"use strict";var b=a.ItemView.extend({template:tiger.components.groupchats.flagreason,className:"flag-reason-dropdown js_flagreason",events:{submit:"submit",click:"preventPropagation","click .js_cancel":"cancel","click .js_submit":"submit"},initialize:function(){},preventPropagation:function(a){a.stopPropagation()},cancel:function(){this.trigger("flagreason:cancel")},submit:function(a){a.preventDefault();var b=this.$('input[name="reason"]:checked').val();return b?this.trigger("flagreason:submit",this,b):this.$(".js_error").removeClass("hide"),!1}});return b}),define("templates/tiger/components/forms/modals/flagreason",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.forms.modals.flagreason=function(a,b,c){return'<div class="show-for-medium-down flag-reason-mobile"><ul class="sticky-modal-options"><li class="js_reason-harassment" data-reason="HARASSMENT">It\'s harassment</li><li class="js_reason-hate-speech" data-reason="HATE_SPEECH">It\'s hate speech</li><li class="js_reason-spam" data-reason="SPAM">It\'s spam</li></ul><footer class="row"><div class="column small-12"><input type="button" class="button tiny secondary js_cancel" tabindex="5" value="Cancel" /></div></footer></div>'},d.DEBUG&&(b.components.forms.modals.flagreason.soyTemplateName="tiger.components.forms.modals.flagreason")}),define("module/flagging/view/FlagReasonModal",["jquery","backbone.marionette","templates/tiger/components/forms/modals/flagreason"],function(a,b){"use strict";var c=b.ItemView.extend({template:tiger.components.forms.modals.flagreason,tagName:"form",events:{submit:"submit","click .js_cancel":"cancel","click .js_reason-harassment":"selectReason","click .js_reason-hate-speech":"selectReason","click .js_reason-spam":"selectReason"},cancel:function(){this.trigger("flagreason:cancel")},selectReason:function(b){var c=a(b.target).attr("data-reason");if(!c)throw new Error("Empty reason code for reason!");this.trigger("flagreason:submit",this,c)}});return c}),define("apiclient/flagging",["config","apiclient/apirequest","apiclient/gettoken"],function(a,b,c){"use strict";var d={flagPost:function(b){return b.reason?a.api.core.url+"/post/{{postId}}/flag?reason={{reason}}":a.api.core.url+"/post/{{postId}}/flag"},unflagPost:function(b){return b.reason?a.api.core.url+"/post/{{postId}}/unflag?reason={{reason}}":a.api.core.url+"/post/{{postId}}/unflag"}},e={getPosts:b.getJson(c.append(a.api.core.url+"/post/{{starterId}}/flaggedposts")),getCount:b.getJson(c.append(a.api.core.url+"/post/{{starterId}}/flaggedcount")),flagPost:b.postJson(c.append(d.flagPost)),unflagPost:b.postJson(c.append(d.unflagPost)),getBlogCount:b.getJson(c.append(a.api.core.url+"/blog/{{blogId}}/flaggedcount")),resolveFlag:b.postJson(c.append(a.api.core.url+"/post/{{postId}}/resolve")),unresolveFlag:b.postJson(c.append(a.api.core.url+"/post/{{postId}}/unresolve"))};return window.__karma__&&(e.__testonly__={urls:d}),e}),define("templates/tiger/components/groupchats/flagging-admin-link",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.groupchats.flaggingAdminLink=function(a,b,c){return"<div class=\"flagging-admin-link proxima\"><a onClick=\"window.ga('send', 'event', 'On-Page Flagging', 'click', 'Click into moderation queue');\" href=\"https://kinja.com/manage/"+e.$$escapeHtmlAttribute(a.blogName)+'/flagged">Moderate Flagged Replies ('+e.$$escapeHtml(a.flagCount)+")</a></div>"},d.DEBUG&&(b.components.groupchats.flaggingAdminLink.soyTemplateName="tiger.components.groupchats.flaggingAdminLink")}),define("module/flagging/ReplyFlaggingModule",["jquery","underscore","singleton/Feature","singleton/CurrentUser","singleton/Utils","singleton/WindowController","module/flagging/view/FlagReasonDropdown","module/flagging/view/FlagReasonModal","app/modal/modal.controller","apiclient/flagging","templates/tiger/components/groupchats/flagging-admin-link"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k={flaggedReplies:null,flaggedRepliesLoaded:a.Deferred(),flagCount:null,flagCountLoaded:a.Deferred(),tokenRenewed:!1,reasonDropdown:void 0,reasonModal:void 0,_loadFlaggedReplies:function(a){var b=this,c=function(c,e){b.flaggedReplies=[],e&&e.success===!0?(b.flaggedReplies=c.map(function(a){return a.postId}),b.flaggedRepliesLoaded.resolve()):e&&"InvalidSessionToken"===e.type&&k.tokenRenewed===!1?(k.tokenRenewed=!0,d.token().done(function(){k._loadFlaggedReplies(a)})):b.flaggedRepliesLoaded.reject()};j.getPosts({starterId:a}).done(c)},_loadFlagCount:function(a){var b=this,c=function(a,c){c&&c.success===!0&&(b.flagCount=Number(a)),b.flagCountLoaded.resolve()};j.getCount({starterId:a}).done(c)},_mergePostModelWithFlagInfo:function(a){var c=a.get("id");b.contains(this.flaggedReplies,c)&&a.set({allowReplies:!1,flagged:!0})},_postStatus:function(a){return 0!==a.parents(".all-threads").length?a.parents(".js_reply").hasClass("reply--unapproved")?"Pending":"Approved":"Featured"},_flagPost:function(a,d,e){var f,g,h=d.get("flagged")===!0,i=d.get("id"),l=h?"Unflag":"Flag",m=k._postStatus(a);d.get("flaggingInProgress")===!0&&b.isUndefined(k.reasonDropdown)||(d.set({flaggingInProgress:!0}),g=c.isOn("extendedflag")&&!b.isUndefined(e)&&"Flag"===l?l+" - "+e.toLowerCase():l,window.ga("send","event","On-Page Flagging",g,"Reply status: "+m),f=h?j.unflagPost({postId:i,reason:e}):j.flagPost({postId:i,reason:e}),f.done(function(a,b){void 0!==b&&b.success===!0&&(d.set({flagged:!h,allowReplies:h,flaggingInProgress:!1}),this._syncFlaggedReplies(!h,i))}.bind(this)))},_syncFlaggedReplies:function(a,c){null!==k.flaggedReplies&&(a?k.flaggedReplies.push(c):k.flaggedReplies=b.reject(k.flaggedReplies,function(a){return a===c})),null!==k.flagCount&&(a?k.flagCount++:k.flagCount--)},_showDropdownReasonSelection:function(b,c){var d,e;k._hideReasonDropdown(),k.reasonDropdown=new g({$reply:b,model:c}),k.reasonDropdown.on("flagreason:submit",k._handlePostFlagFromDropdown),k.reasonDropdown.on("flagreason:cancel",k._hideReasonDropdown),k.reasonDropdown.render(),c.set({flaggingInProgress:!0}),k.reasonDropdown.$el.appendTo(b),d=k.reasonDropdown.$el,a(window).scrollTop()+window.innerHeight-d.height()<d.offset().top&&(e=d.offset().top-d.height(),a("body").scrollTo(e,{duration:"slow"}))},_showModalReasonSelection:function(a,b){k.reasonModal=new h({$reply:a,model:b}),k.reasonModal.on("flagreason:cancel",function(){i.close()}),k.reasonModal.on("flagreason:submit",k._handlePostFlagFromModal),i.create(k.reasonModal,{name:"flagreason",className:"reveal-modal kinja-modal sticky-modal bottom full-width"})},_handlePostFlagFromDropdown:function(a,b){var c=a.model;a.$("a,input").addClass("disabled"),c.once("change:flagged",k._hideReasonDropdown),k._flagPost(a.options.$reply,c,b)},_handlePostFlagFromModal:function(a,b){var c=a.model;a.$("a,input").addClass("disabled"),c.once("change:flagged",function(){i.close()}),k._flagPost(a.options.$reply,c,b)},_hideReasonDropdown:function(){b.isUndefined(k.reasonDropdown)||(k.reasonDropdown.options.model.set({flaggingInProgress:!1}),k.reasonDropdown.remove(),k.reasonDropdown=void 0)},API:{flaggedRepliesLoaded:function(){return k.flaggedRepliesLoaded},flagCountLoaded:function(){return k.flagCountLoaded},flaggedReplies:function(){return k.flaggedReplies},flagCount:function(){return k.flagCount},openFlagView:function(a,b){d.requireLogin("flagPost").done(function(){f.isSmall()?k._showModalReasonSelection(a,b):k._showDropdownReasonSelection(a,b)})},unflag:function(a,b){d.requireLogin("unflagPost").done(function(){k._flagPost(a.view.$el,b)})},loadFlaggedReplies:function(a){d.onAuth.done(function(){d.isLoggedIn()&&k._loadFlaggedReplies(a)})},loadFlagCount:function(a){d.onAuth.done(function(){var b=e.getKinjaMeta().blog.id;d.isLoggedIn()&&(d.isSuperuser()&&c.isOn("superuser")||d.hasRole("OWNER",b)||d.hasRole("ADMIN",b))?k._loadFlagCount(a):k.flagCountLoaded.reject()})},extendPostModel:function(a){k.flaggedRepliesLoaded.done(function(){k._mergePostModelWithFlagInfo(a)})}}};return window.__karma__&&(k.API.__testonly__=k),k.API}),define("app/post/posttools/view/posttools.flagview",["app/post/posttools/view/posttools.menuitemview","module/flagging/ReplyFlaggingModule"],function(a,b){"use strict";var c=a.extend({modelEvents:{"change:flagged":"_flaggedChanged","change:flaggingInProgress":"_flaggedChanged"},permissions:[],events:{click:"_onFlagClicked"},_flaggedChanged:function(){this.render()},_canShow:function(){return this.model.get("flagged")!==!0},_isDisabled:function(){return this.model.get("flaggingInProgress")===!0},_onFlagClicked:function(a){a.preventDefault();var c=this.$el.parents(".js_reply");b.openFlagView(c,this.model)}});return c}),define("app/post/posttools/view/posttools.unflagview",["app/post/posttools/view/posttools.menuitemview"],function(a){"use strict";var b=a.extend({modelEvents:{"change:flagged":"_flaggedChanged","change:flaggingInProgress":"_flaggedChanged"},permissions:[],triggers:{click:"posttools:unflag"},_flaggedChanged:function(){this.render()},_canShow:function(){return this.model.get("flagged")===!0},_isDisabled:function(){return this.model.get("flaggingInProgress")===!0}});return b}),define("app/post/posttools/view/reposttools.unscheduleview",["app/post/posttools/view/posttools.menuitemview"],function(a){"use strict";return a.extend({permissions:["canSharePost"],triggers:{click:"reposttools:unschedule"}})}),define("app/post/posttools/view/posttools.pupilview",["jquery","underscore","app/post/posttools/view/posttools.menuitemview"],function(a,b,c){"use strict";var d=c.extend({permissions:["canPromote"],triggers:{click:"posttools:pupil"}});return d}),define("templates/tiger/components/post/meta/post-dropdown",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.post.meta.postDropdown=function(a,c,d){var f="",g=a.post.defaultBlogId!=(null==a.blog?null:a.blog.id)&&"POSTACTION"==(null==a.post.meta?null:a.post.meta.typ),h=null!=(null==a.blog?null:a.blog.name)?null==a.blog?null:a.blog.name:a.post.defaultBlogName,i=null!=(null==a.blog?null:a.blog.displayName)?null==a.blog?null:a.blog.displayName:h;return f+='<ul id="dropdown-'+e.$$escapeHtmlAttribute(a.post.id)+'" class="f-dropdown proxima js_post-dropdown js_follow-controls js_user-follow-controls whitelisted-links" data-postid="'+e.$$escapeHtmlAttribute(a.post.id)+'" data-starterid="'+e.$$escapeHtmlAttribute(a.post.starterId)+'" data-authorid="'+e.$$escapeHtmlAttribute(a.post.author.id)+'" data-blogid="'+e.$$escapeHtmlAttribute(a.post.authorBlogId)+'" data-sourceblogid="'+e.$$escapeHtmlAttribute(null==a.blog?null:a.blog.id)+'" data-dropdown-content>'+("reply"==a.mode?'<li class="js_edit-reply hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.actions.write(null,null,d)+"Edit</a></li>":'<li class="js_edit-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.actions.write(null,null,d)+"Edit</a></li>")+(g?'<li class="js_kinja-unshare hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.essential.externalLink(null,null,d)+"Unshare</a></li>":'<li class="js_delete-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.essential.close(null,null,d)+"Delete</a></li>")+("DRAFT"!=a.post.status?b.components.invites.menuItems.invitePostDropdownItems(null,null,d):"")+("reply"==a.mode&&"profilepage"!=a.pageType?'<li data-analytics-target="groupChat" class="js_followforuser hover-icon readonly-hide" onclick="window.ga(\'send\', \'event\', \'Group Chats\', \'click\', \'Drop down - follow user click\');"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.essential.add(null,null,d)+"Follow "+e.$$escapeHtml(a.post.authorBlogName)+'</a></li><li class="js_unfollowforuser hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.essential.checkmark(null,null,d)+"Unfollow "+e.$$escapeHtml(a.post.authorBlogName)+"</a></li>"+("private"!=a.pageType&&"dashboard"!=a.pageType?'<li class="js_followforblog js_approveforblog hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+(d.features.approvemessage?b.icons.essential.add(null,null,d)+"Approve "+e.$$escapeHtml(a.post.authorBlogName)+" on "+e.$$escapeHtml(i):b.icons.essential.add(null,null,d)+"Follow "+e.$$escapeHtml(a.post.authorBlogName)+" for "+e.$$escapeHtml(h))+'</a></li><li class="js_unfollowforblog js_unapproveforblog hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+(d.features.approvemessage?b.icons.essential.checkmark(null,null,d)+"Remove "+e.$$escapeHtml(a.post.authorBlogName)+" from "+e.$$escapeHtml(i)+" approve list":b.icons.essential.checkmark(null,null,d)+"Unfollow "+e.$$escapeHtml(a.post.authorBlogName)+" for "+e.$$escapeHtml(h))+"</a></li>":""):"DRAFT"!=a.post.status?'<li class="js_promote hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.essential.starCircle(null,null,d)+"Promote</a></li>":"")+("DRAFT"!=a.post.status&&"dashboard"!=a.pageType?"<li class=\"js_dismiss hover-icon hide readonly-hide\"><a href=\"#\" class=\"dismiss icon--svg u-darkened--onhover u-prepended\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Dismiss click');\">"+b.icons.actions.userRemove(null,null,d)+"Dismiss</a><a href=\"#\" class=\"undismiss icon--svg u-darkened--onhover u-prepended\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Undismiss click');\">"+b.icons.actions.userRemove(null,null,d)+'Undismiss</a></li><li class="js_block hover-icon hide disabled readonly-hide" data-blogid="'+e.$$escapeHtmlAttribute(a.post.defaultBlogId)+'" data-targetblogid="'+e.$$escapeHtmlAttribute(a.post.authorBlogId)+'" data-targetblogname="'+e.$$escapeHtmlAttribute(h)+'" data-targetauthorname="'+e.$$escapeHtmlAttribute(a.post.author.displayName)+'"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.actions.disabled(null,null,d)+"<span>Block for "+e.$$escapeHtml(h)+'</span></a></li><li class="js_hide-post hover-icon hide readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.actions.disabled(null,null,d)+"Hide</a></li>":"")+("permalink"==a.pageType&&"DRAFT"!=a.post.status?("reply"==a.mode?'<li class="js_flag-post hover-icon readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.actions.flag(null,null,d)+'Flag</a></li><li class="js_unflag-post unflag-post hover-icon readonly-hide"><a href="#" rel="nofollow" class="icon--svg u-darkened--onhover u-prepended">'+b.icons.actions.flag(null,null,d)+"Unflag</a></li>":d.features.pupil_rating?'<li class="js_pupil-rules-block"><a class="js_pupil-rules hover-icon icon--svg u-darkened--onhover u-prepended" href="#" rel="nofollow">'+b.icons.actions.writePaper(null,null,d)+"Open Pupil Rules</a></li>":"")+'<li class="js_kinja-share-block readonly-hide"><a class="js_kinja-share hover-icon icon--svg u-darkened--onhover u-prepended" href="#" rel="nofollow">'+b.icons.essential.externalLink(null,null,d)+'Share to Kinja</a></li><li class="js_go-to-permalink"><a class="hover-icon icon--svg u-darkened--onhover u-prepended" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+"\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Drop down - Go to permalink click');\">"+b.icons.essential.link(null,null,d)+"Go to permalink</a></li>":"")+("dashboard"==a.pageType&&"reply"==a.mode&&"DRAFT"!=a.post.status?'<li class="js_block readonly-hide" data-blogid="'+e.$$escapeHtmlAttribute(a.post.defaultBlogId)+'" data-targetblogid="'+e.$$escapeHtmlAttribute(a.post.authorBlogId)+'" data-targetblogname="'+e.$$escapeHtmlAttribute(h)+'" data-targetauthorname="'+e.$$escapeHtmlAttribute(a.post.author.displayName)+"\"><a href=\"#\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Block User click');\" class=\"icon--svg u-darkened--onhover u-prepended\">"+b.icons.essential.close(null,null,d)+"Block user for blog</a></li>":"")+"</ul>"},d.DEBUG&&(b.components.post.meta.postDropdown.soyTemplateName="tiger.components.post.meta.postDropdown"),b.components.post.meta.postDropdownTrigger=function(a,c,d){return'<a href="#" target="_self" class="post-dropdown-trigger js_post-menu-toggler icon--svg u-highlighted--onhover" data-dropdown="dropdown-'+e.$$escapeHtmlAttribute(a.post.id)+"\" onclick=\"window.ga('send', 'event', 'Group Chats', 'click', 'Drop down click');\">"+(d.features.newstream?b.icons.essential.toolsGiant(null,null,d):b.icons.essential.chevronBottom(null,null,d))+"</a>"},d.DEBUG&&(b.components.post.meta.postDropdownTrigger.soyTemplateName="tiger.components.post.meta.postDropdownTrigger")}),define("app/post/posttools/posttools.menuview",["jquery","underscore","backbone","backbone.marionette","singleton/CurrentUser","singleton/CurrentBlog","singleton/EventDispatcher","singleton/Utils","app/post/mixins/post.userPermissions","app/post/posttools/view/posttools.editview","app/post/posttools/view/posttools.editreplyview","app/post/posttools/view/posttools.deleteview","app/post/posttools/view/posttools.invitemanuallyview","app/post/posttools/view/posttools.dismissview","app/post/posttools/view/posttools.promoteview","app/post/posttools/view/posttools.blockview","app/post/posttools/view/posttools.hideview","app/post/posttools/view/posttools.kinjashareview","app/post/posttools/view/posttools.kinjaunshareview","app/post/posttools/view/posttools.externalshareview","app/post/posttools/view/posttools.flagview","app/post/posttools/view/posttools.unflagview","app/post/posttools/view/reposttools.unscheduleview","app/post/posttools/view/posttools.pupilview","templates/tiger/components/post/meta/post-dropdown"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){"use strict";var y=["profilepage","dashboard","manageblog"],z=d.ItemView.extend(b.extend({},i,{menuItemViewClasses:{".js_pupil-rules":x,".js_-post":j,".js_edit-post":j,".js_edit-reply":-1===b.indexOf(y,h.getKinjaMeta().pageType)?k:j,".js_delete-post":l,".js_invite-to-post-manually":m,".js_dismiss":n,".js_promote":o,".js_block":p,".js_hide-post":q,".js_kinja-share":r,".js_kinja-unshare":s,".js_external-share":t,".js_flag-post":u,".js_unflag-post":v,".js_unschedule-repost":w},events:{"requested.fndtn.dropdown .js_post-menu-toggler":"onPosttoolsRequested"},triggers:{"opened.fndtn.dropdown .js_post-dropdown":"posttools:opened"},menuItemViews:[],permissions:["userIsSuper","canEditPost","canPromote","canDismissPost","canSharePost"],initialize:function(a){g.on("blog:block:success"+this.model.id,this.render,this),this.blockedBlogCollection=a.blockedBlogCollection},_instantiateMenuItemViewClasses:function(a){return a=a||this.$el,Object.keys(this.menuItemViewClasses).reduce(function(c,d){var e=a.find(d),f=b.partial(this._createMenuItemClass.bind(this),d);return e.length?c.concat(b.map(e,f)):c}.bind(this),[])},_createMenuItemClass:function(b,c){var d=this.menuItemViewClasses[b],e={el:a(c),model:this.model};return".js_block"===b&&(e.collection=this.blockedBlogCollection),new d(e)},_bindEvents:function(){e.onAuthStateChange(this._refreshMenu.bind(this))},_refreshMenu:function(){var a="permalink"===h.getKinjaMeta().pageType,b=this,c=function(){return b.$("li:not(.hide)").length};b._renderMenuItems(),b.trigger("posttools:menuview:togglehidden",!a&&!c())},_renderMenuItems:function(){this.menuItemViews.call("render")},_captureMenuItemEvents:function(){this.menuItemViews.call("on","all",this.trigger,this)},_adjustMenuHeight:function(){var b,c=this.$(".js_post-dropdown"),d=a(window.document).height(),e=this.$el.offset().top,f=d-e-c.height();0>f&&(b=d-e,c.height(b+"px"),c.addClass("scroll"))},onPosttoolsOpened:function(){b.isEmpty(this.menuItemViews)?this.listenToOnce(this,"posttools:content:render",this.onPosttoolsOpened):(this.menuItemViews.call("triggerMethod","posttools:opened"),this._adjustMenuHeight())},onPosttoolsRequested:function(a,b){var c;c=d.Renderer.render(tiger.components.post.meta.postDropdown,{post:this.model.toJSON(),mode:"reply",pageType:h.getKinjaMeta().pageType,blog:f}),b.resolve(c),this.onContentRender()},render:function(){var a="permalink"===h.getKinjaMeta().pageType;return this.onContentRender(),a&&this.trigger("posttools:menuview:togglehidden",!1),this},onContentRender:function(){var a;this.menuItemViews.length||(a=this._instantiateMenuItemViewClasses(),this.menuItemViews=new c.ChildViewContainer(a),this._captureMenuItemEvents()),this._renderMenuItems(),this._bindEvents(),this.trigger("posttools:content:render")}}));return z}),define("app/post/posttools/controller/posttools.dismiss.controller",[],function(){"use strict";var a={API:{dismiss:function(a){a.setAction("dismiss",a.get("defaultBlogId"),{success:function(){a.trigger("posttools:post:dismissed"),a.trigger("annotation:remove")}.bind(this),error:function(a){throw new Error("PostTools.dismissPost(): "+a.reason)}})},undismiss:function(a){a.setAction("actionreset",a.get("defaultBlogId"),{success:function(){a.trigger("posttools:post:undismissed")}.bind(this),error:function(a){throw new Error("PostTools.undismissPost(): "+a.reason)}})}}};return a.API}),define("collection/blog.subscribersCollection",["config","underscore","backbone","singleton/CurrentUser"],function(a,b,c,d){"use strict";var e=c.Collection.extend({idCache:[],initialize:function(a,b){if(!b||b&&(!b.blogId||!b.type))throw new Error("Missing options for BlogSubscribersCollection");this.type=b.type,this.blogId=b.blogId,b.userId&&(this.userId=b.userId),void 0!==b.withNames&&(this.withNames=b.withNames),this.enableShortening=b.enableShortening||!1,this.on("add remove request sync",function(){this.idCache=[]})},parse:function(a){var c=this,d=a&&a.data?a.data:null,e=[];return d&&(e=this.withNames?d.map(function(a){return b.isUndefined(a.id)&&(a.id=a.authorId?a.defaultBlogId:a.blogId),a.sourceBlogId=c.blogId,a}):d.map(function(a){return{id:a}})),this.enableShortening===!0&&e.length>1e3&&(e=e.slice(e.length-1e3,e.length),this.shortened=!0),e},sync:function(e,f,g){var h,i;switch(this.idCache=[],e){case"read":switch(h="GET",f.type){case"followed":i=this.withNames?a.api.profile.url+"/blogfollow/views/followedByWithNames?blogId="+f.blogId:a.api.profile.url+"/blogfollow/views/followedBy?blogId="+f.blogId;break;case"followers":i=a.api.profile.url+"/blogfollow/views/followersOf?blogId="+f.blogId;break;case"followedUsers":i=a.api.profile.url+"/userfollow/views/followedUsers?userId="+f.userId+"&token="+d.get("token");break;case"followedBlogs":i=a.api.profile.url+"/userfollow/views/followedBlogs?userId="+f.userId+"&token="+d.get("token");break;case"blocked":i=this.withNames?a.api.profile.url+"/blogblock/views/byBlogWithNames?blogId="+f.blogId:a.api.profile.url+"/blogblock/views/byBlog?blogId="+f.blogId;break;default:throw new Error("blog.subscribersCollection.sync(): unsupported method in sync")}break;default:throw new Error("blog.subscribersCollection.sync(): unsupported method in sync")}return c.ajax(b.extend({type:h,dataType:"json",url:i},g))},getIds:function(){var a=this.idCache.length;return a&&a===this.length?this.idCache:this.pluck("id")}});return e}),define("templates/tiger/messages/postAction",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.messages.postAction.areYouSureToDelPost=function(a,b,c){return"Are you sure you want to delete this post?"},d.DEBUG&&(b.messages.postAction.areYouSureToDelPost.soyTemplateName="tiger.messages.postAction.areYouSureToDelPost"),b.messages.postAction.confirmHidePost=function(a,b,c){return"Are you sure you want to hide this?"},d.DEBUG&&(b.messages.postAction.confirmHidePost.soyTemplateName="tiger.messages.postAction.confirmHidePost"),b.messages.postAction.confirmDismissPost=function(a,b,c){return"Are you sure you want to dismiss this reply?"},d.DEBUG&&(b.messages.postAction.confirmDismissPost.soyTemplateName="tiger.messages.postAction.confirmDismissPost"),b.messages.postAction.confirmBlockBlog=function(a,b,c){return""+("block"==a.action?"Are you sure you want to block "+e.$$escapeHtml(a.username)+" on "+e.$$escapeHtml(a.sitename)+"?":"Are you sure you want to unblock "+e.$$escapeHtml(a.username)+" on "+e.$$escapeHtml(a.sitename)+"?")},d.DEBUG&&(b.messages.postAction.confirmBlockBlog.soyTemplateName="tiger.messages.postAction.confirmBlockBlog"),b.messages.postAction.selfBlockError=function(a,b,c){return"You should not block yourself."},d.DEBUG&&(b.messages.postAction.selfBlockError.soyTemplateName="tiger.messages.postAction.selfBlockError"),
b.messages.postAction.blogBockMember=function(a,b,c){return"Can't block a member of the blog."},d.DEBUG&&(b.messages.postAction.blogBockMember.soyTemplateName="tiger.messages.postAction.blogBockMember"),b.messages.postAction.postReposted=function(a,b,c){return"Shared to "+e.$$escapeHtml(a.blogName)+'. <a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.blogUrl))+'">View &raquo;</a>'},d.DEBUG&&(b.messages.postAction.postReposted.soyTemplateName="tiger.messages.postAction.postReposted"),b.messages.postAction.postScheduledRepost=function(a,b,c){return"Your post has been scheduled to publish."},d.DEBUG&&(b.messages.postAction.postScheduledRepost.soyTemplateName="tiger.messages.postAction.postScheduledRepost"),b.messages.postAction.repostRemoved=function(a,b,c){return"Post successfully un-shared from this blog (it may take 1-2 minutes for it to stop displaying)"},d.DEBUG&&(b.messages.postAction.repostRemoved.soyTemplateName="tiger.messages.postAction.repostRemoved"),b.messages.postAction.unsharePost=function(a,b,c){return"Removed share"},d.DEBUG&&(b.messages.postAction.unsharePost.soyTemplateName="tiger.messages.postAction.unsharePost"),b.messages.postAction.areYouSureToUnschedRepost=function(a,b,c){return"Are you sure you want to unschedule this repost?"},d.DEBUG&&(b.messages.postAction.areYouSureToUnschedRepost.soyTemplateName="tiger.messages.postAction.areYouSureToUnschedRepost"),b.messages.postAction.postDeleted=function(a,b,c){return"The post has been deleted successfully."},d.DEBUG&&(b.messages.postAction.postDeleted.soyTemplateName="tiger.messages.postAction.postDeleted"),b.messages.postAction.repostUnscheduled=function(a,b,c){return"The repost has been unscheduled successfully."},d.DEBUG&&(b.messages.postAction.repostUnscheduled.soyTemplateName="tiger.messages.postAction.repostUnscheduled"),b.messages.postAction.postRecommended=function(a,b,c){return"You recommended a post."},d.DEBUG&&(b.messages.postAction.postRecommended.soyTemplateName="tiger.messages.postAction.postRecommended"),b.messages.postAction.undoDismissMsg=function(a,b,c){return"You have successfully dismissed this reply."},d.DEBUG&&(b.messages.postAction.undoDismissMsg.soyTemplateName="tiger.messages.postAction.undoDismissMsg"),b.messages.postAction.undoBlockMsg=function(a,b,c){return"You have successfully dismissed this reply and blocked "+e.$$escapeHtml(a.userName)+" from "+e.$$escapeHtml(a.blogName)},d.DEBUG&&(b.messages.postAction.undoBlockMsg.soyTemplateName="tiger.messages.postAction.undoBlockMsg"),b.messages.postAction.undoResolveMsg=function(a,b,c){return"You have successfully resolved the flag on this reply."},d.DEBUG&&(b.messages.postAction.undoResolveMsg.soyTemplateName="tiger.messages.postAction.undoResolveMsg")}),define("app/post/posttools/controller/posttools.block.controller",["jquery","singleton/CurrentUser","singleton/EventDispatcher","collection/blog.subscribersCollection","templates/tiger/messages/postAction"],function(a,b,c,d){"use strict";var e={_blogsBlockedHash:{},_postIsBlocked:function(a,b){return-1!==b.indexOf(a.get("authorBlogId"))},_blockBlog:function(a,c){var d,f=c.targetBlogId,g=c.confirmation,h=c.blockedBlogCollection,i=a.get("defaultBlogId"),j=c.targetBlogName,k=c.targetAuthorName,l=c.forceAction;"undefined"!=typeof l?(d=l,b.set("forceAction",l)):d=e._postIsBlocked(a,c.blockedBlogIds)?"unblock":"block",("boolean"==typeof g&&g||g({action:d,username:k,sitename:j}))&&b.setBlogAction(d,i,f,{success:function(c){var e,g=b.get("forceAction");c?"block"===d?(h.add({id:f}),h.trigger("posttools:block"),a.trigger("posttools:block")):(e=h.findWhere({id:f}),e&&h.remove(e),h.trigger("posttools:unblock"),a.trigger("posttools:unblock")):("block"===g||"unblock"===g)&&(h.trigger("posttools:"+g),a.trigger("posttools:"+g))},error:function(a,b){var c;switch(b.code){case"BLOG_BLOCK_MEMBER":c=tiger.messages.postAction.blogBockMember;break;default:c=b?b.message:a.reason}e._showErrorMessage(c)}})},_blockedBlogsInitialized:function(b){var c;return e._blogsBlockedHash.hasOwnProperty(b)||(e._blogsBlockedHash[b]=e.API.getBlockedBlogCollection(b)),e._blogsBlockedHash[b].fetched?(c=a.Deferred(),c.resolve(e._blogsBlockedHash[b]),c):(e._blogsBlockedHash[b].fetched=!0,e._blogsBlockedHash[b].fetch())},_showErrorMessage:function(a){c.trigger("successbox:display",{message:a,warningBox:!0,dismissable:!0})},API:{block:function(b,c,d,f,g,h){var i,j=b.get("defaultBlogId"),k=b.get("authorBlogId");return j===k?(e._showErrorMessage(tiger.messages.postAction.selfBlockError),!1):void a.when(e._blockedBlogsInitialized(j)).then(function(){i={targetBlogId:k,blockedBlogIds:c.getIds(),blockedBlogCollection:c,confirmation:d,targetBlogName:f,targetAuthorName:g,forceAction:h},e._blockBlog(b,i)})},getBlockedBlogCollection:function(a){return e._blogsBlockedHash.hasOwnProperty(a)||(e._blogsBlockedHash[a]=new d([],{blogId:a,type:"blocked",withNames:!1})),e._blogsBlockedHash[a]},checkBlockStatus:function(b,c){var d=b.get("defaultBlogId");a.when(e._blockedBlogsInitialized(d)).then(function(){b.trigger("posttools:blockStatusUpdated",e._postIsBlocked(b,c.getIds()))})}}};return window.__karma__&&(e.API.__testonly__=e),e.API}),define("app/post/mixins/post.successMessage",["singleton/Renderer","singleton/EventDispatcher"],function(a,b){"use strict";var c={_displaySuccessMessage:function(c,d){b.trigger("successbox:display",{message:a.renderTemplate(c,d||{})})},_displayChannelMessage:function(c,d){b.trigger("successbox:display",{message:a.renderTemplate(c,d||{}),timeout:5e3})}};return c}),define("app/post/posttools/controller/posttools.like.controller",["jquery","underscore","singleton/CurrentUser","module/KinjaAnalytics","singleton/Utils","app/post/mixins/post.successMessage","templates/tiger/messages/postAction"],function(a,b,c,d,e,f){"use strict";var g={};return g=b.extend(g,f,{_trackRecommendation:function(a,b){var c,f=a.get("isStarter")?"Post":"Comment",g="sharingBottom"===b.$el.attr("data-analytics-target"),h="groupChat"===b.$el.parent().attr("data-analytics-target"),i="permalink"===e.getKinjaMeta().pageType;window.ga("send","event","Recommendation",f+" Recommended",a.get("permalink")),(!i||g||h)&&(e.getKinjaMeta().pageType===e.pageTypes.frontpage?c="homepage":e.getKinjaMeta().pageType===e.pageTypes.dashboard?c="dashboard":g?c="sharingBottom":h&&(c="groupChat"),d.pushEvent("RECOMMENDATION","POST",b.model.get("id"),{uiElement:c}))},_likePost:function(c,d){var e=c.get("liked")?"unlike":"like",f=c.setLike(e,{success:function(a){if("like"===e&&(g._trackRecommendation(c,d),g._displaySuccessMessage(tiger.messages.postAction.postRecommended),!c.get("isStarter")&&!c.get("approved"))){var f=b.pluck(a.response.approvalResult.approvedReplies,"postId"),h=d.model.get("id");-1!==b.indexOf(f,h)&&d.model.set({approved:!0})}},error:function(a){throw new Error("PostTools.likePost(): "+a.reason)}}),h=function(){c.trigger("posttools:post:likeCount:updated")};a.when(f).then(h)},API:{like:function(b,d){return a("body").hasClass("read-only")?!0:void c.requireLogin("likePost").done(function(){g._likePost(b,d)})}}}),g.API}),define("apiclient/post",["config","apiclient/apirequest","apiclient/gettoken","singleton/Feature"],function(a,b,c,d){"use strict";var e,f=d.isOn("postsecuretoken")?a.api.core.secureUrl+"/post":a.api.core.url+"/post";return e={create:b.postJson(c.append(f+"/add",d.isOn("postsecuretoken")?c.secure:c.fresh,!0)),read:b.getJson(c.append(f+"/preview/{{id}}",d.isOn("postsecuretoken")?c.secure:c.fresh)),update:b.postJson(c.append(f+"/{{id}}/update",d.isOn("postsecuretoken")?c.secure:c.fresh,!0)),"delete":b.postJson(c.append(f+"/{{id}}/delete",d.isOn("postsecuretoken")?c.secure:c.fresh,!0)),generatePostJson:function(a){return b.postJson(c.append(f+a,d.isOn("postsecuretoken")?c.secure:c.fresh,!0))},socialStats:b.getJson(a.api.core.url+"/dfp/post/{{id}}/stats")}}),define("model/post/Post",["config","jquery","backbone","underscore","singleton/CurrentUser","singleton/Utils","apiclient/gettoken","apiclient/post"],function(a,b,c,d,e,f,g,h){"use strict";var i=b("<div />"),j=function(a){var b,c=a.getHours(),d=a.getMinutes(),e=a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear();return 10>c&&(c="0"+c),10>d&&(d="0"+d),b=c+":"+d,{MdyHm:[e,b].join(" ")}},k={dateTimeFormat:/^\d{1,2}\/\d{1,2}\/\d{4} \d{1,2}:\d{2}$/,chompImgType:/img\.gawkerassets\.com\/img\/(\w+)\/[\w\-]+\./g},l=c.Model.extend({constructor:function(a){window.__postModelStorage=window.__postModelStorage||{};var b,d,e=window.__postModelStorage,f=void 0!==a&&void 0!==a.id&&void 0!==e,g={};if(f&&void 0!==e[a.id]){for(d in a)a.hasOwnProperty(d)&&null!==a[d]&&(g[d]=a[d]);return b=e[a.id],b.set(g),b}c.Model.prototype.constructor.apply(this,arguments),f&&(e[a.id]=this)},initialize:function(){k=b.extend(k,{mediaInPost:new RegExp("<("+this.mediaTags.join("|")+")","gim")})},storeInMemory:function(){var a=window.__postModelStorage||{},b=void 0!==this.id&&void 0!==a;return b&&void 0!==a[this.id]?a[this.id].set(this.attributes):a[this.id]=this,this},mediaTags:["img","embed","object","iframe","video","audio","canvas"],defaults:{promoteState:{},publishTime:j(new Date),blogs:new c.Collection,liked:!1},validationRules:{PUBLISHTIME_IS_REQUIRED:function(a){var b=!0;return"SCHEDULED"!==a.status||a.publishTimeMillis||(b=!1),b},POST_CONTENT_IS_REQUIRED:function(a){var c=!0,d=a.headline&&b.trim(i.html(a.headline)),e=a.original&&b.trim(i.html(a.original).text()),f=a.original&&(k.mediaInPost.test(a.original)||i.html(a.original).find("img").length),g=a.hasFile||a.files&&a.files.length;return d||e||f||g||(c=!1),c},POST_CONTENT_CANNOT_CONTAIN_BAD_CONTENT:function(a){var b=!0,c=["form"].join("");return i.html(a.original).find(c).length&&(b=!1),b}},savePipeline:b.Deferred().resolve(),publishTime:function(a){return j(a)},sync:function(a,c,e){var f,i,j,k,l,m;if("create"!==a&&(void 0===c.id||null===c.id))throw new Error("Post.sync(): Model undefined");switch(c.attributes.meta={},"undefined"!=typeof c.attributes.status&&(c.attributes.meta.status=c.attributes.status),"undefined"!=typeof c.attributes.allowReplies&&(c.attributes.meta.allowReplies=c.attributes.allowReplies),"undefined"!=typeof c.attributes.showByline&&(c.attributes.meta.showByline=c.attributes.showByline),"undefined"!=typeof c.attributes.byline&&(c.attributes.meta.byline=c.attributes.byline),"undefined"!=typeof c.attributes.properties&&(c.attributes.meta.properties=c.attributes.properties),a){case"create":f="POST",i=c.has("parentId")&&""!==c.get("parentId")?"/api/core/post/"+c.get("parentId")+"/jsonReplyWithApproval":"/api/core/post/add",j=JSON.stringify(c);break;case"read":f="GET",i=void 0!==e.preview&&e.preview===!0?"/api/core/post/preview/"+c.id:void 0!==e.showcase&&e.showcase===!0?"/api/core/post/showcase/"+c.id:"/api/core/post/"+c.id;break;case"update":f="POST",i="/api/core/post/"+c.id+"/update",j=JSON.stringify(c);break;case"delete":f="POST",i="/api/core/post/"+c.id+"/delete"}return k={type:f,dataType:"json",contentType:"application/json",url:i,data:j||null},l=b.Deferred(),m=l.promise(),g.secure().done(function(f){k.url=k.url+"?token="+f,"delete"===a?h[a]({id:c.id},e).done(l.resolve).fail(l.reject):b.ajax(d.extend(k,e)).done(l.resolve).fail(l.reject)}),m},parse:function(a){if(void 0===a)throw new Error("Post.parse(): no response to parse");var b={};return b=a.data?a.data:a,void 0!==b.id&&null!==b.id&&(b.id=parseInt(b.id,10)),b.tagDescriptions=b.tags.map(function(a){return a.description}),b.images&&b.images.length&&(b.images=[]),b},toFormData:function(){var a=["id","headline","original","tags","publishTimeMillis","publishTimeZone","status","blogId","defaultBlogId","annotation.annotationType","annotation.imageUrl","annotation.imageChompId","annotation.imageWidth","annotation.imageHeight","annotation.x","annotation.y","annotation.annotationText","annotation.annotationTextHash","allowReplies","sponsored","showByline","byline","salesAvatar","salesAvatarMap","share","properties","shareBlogId","sharedPostId","images","parentId","adZone"],b=["status","allowReplies","showByline","byline","properties"],c=function(a){var c=a[0],e=a[1];return-1!==d.indexOf(b,c)&&(c="meta."+c),[c,e]},e=d.pick(this.toJSON(),d.union(a,d.map(b,function(a){return"meta."+a}))),f=d.object(d.pairs(e).map(c));return f},getUrl:function(){return void 0!==this.get("permalink")?this.get("permalink"):"/"+this.id},getActionState:function(){var a=b.Deferred();return this.has("actionState")?a.resolve():this.getPostInfo().done(function(){a.resolve()}),a.promise()},getPostInfo:function(c){var d,f=this,g=parseInt(this.id,10);if(!e.isLoggedIn())throw new Error("Post.getPostInfo(): user not logged in");return c=c||{},c.success=c.success||function(){},d=[a.api.core.url,"/post/",g,"/actionstatus?token=",e.get("token")].join(""),b.ajax({type:"GET",dataType:"jsonp",jsonp:"jsonp",url:d,success:function(a){200===a.meta.status&&(f.setActionState(a.data),c.success.call(f))}})},isPublished:function(){return"PUBLISHED"===this.get("status")},setAction:function(b,c,d){var e,f={};if(!b||"repost"!==b&&"dismiss"!==b&&"actionreset"!==b)throw new Error("Post:setAction(): Invalid post action: "+b);if(!c)throw new Error("Post:setAction(): Invalid blogId: "+c);return e="repost"===b?a.api.core.url+"/post/"+this.id+"/"+b+"/"+c:"/ajax/post/"+this.id+"/"+b+"/"+c,"repost"===b&&d.publishTimeMillis&&(f.repostTime=d.publishTimeMillis),this.setLikeOrAction(d,b,e,f)},setLikeOrAction:function(a,c,d,f){var h,i,j,k;return a=a||{},f=f||{},a.success=a.success||function(){},a.error=a.error||function(){},e.isLoggedIn()||a.error.call(this,{reason:"user"}),i=b.Deferred(),j=i.promise(),k=this,g.fresh().done(function(e){f.token=e,h="repost"===c?{url:d+"?"+b.param(f),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:"{}"}:{url:d+"?"+b.param(f),type:"POST"},b.ajax(h).done(function(b){void 0!==b.meta?"repost"===c||"dismiss"===c||"actionreset"===c?(k.setActionState(b.data),a.success.call(k,{response:b.data})):(k.setLikeState(b.data),a.success.call(k,{response:b.data})):a.error.call(k,{reason:"action error"}),i.resolve()}).fail(function(b){a.error.call(this,b.responseJSON,b.status,b.statusText),i.reject(b.responseJSON,b.status,b.statusText)})}),j},setActionState:function(a){var b={};d.each(a,function(a){b[a.blogId]=a.relation.toLowerCase()},this),this.set({actionState:b})},setLike:function(a,b){var c,e=["like","unlike"];if(!a||!d.contains(e,a))throw new Error("Post:setLike(): Invalid post action: "+a);return"like"===a&&(a+="AndApprove"),c="likeAndApprove"!==a?["/api/core/post",this.id,a].join("/"):["/ajax/post",this.id,a].join("/"),this.setLikeOrAction(b,a,c)},setLikeState:function(a){var b=a||{},c=b.like||b;void 0!==c.objectId&&c.objectId===this.get("id")?this.set({liked:!0}):this.set({liked:!1})},prepareAnnotations:function(){if(this.has("annotation")){var a=this.get("annotation"),c=b().text(a.annotationText),d=170;void 0===a.annotationShortText&&c.length>d&&(a.annotationShortText=f.cut(c,d))}return this},parseFromDom:function(a){var b=JSON.parse(decodeURIComponent(a.data("model")));return new l(b)},replaceImagesWithOriginal:function(){var a=this.get("display");return this.set("display",a.replace(k.chompImgType,"img.gawkerassets.com/img/$1/original.")),this},validate:function(){var a=[],b=this.toJSON();return b.mode&&d.each(this.validationRules,function(c,d){c(b)||a.push({error:"CLIENT_VALIDATION_ERROR",reason:d})},this),a.length?a:!1},getShareOptionsForUser:function(a){var c=b.Deferred(),e=[],f=[],g=[],h=a.get("defaultBlogId"),i=!1;return this.getActionState().done(function(){d.each(this.get("actionState"),function(a,b){"repost"===a&&e.push(parseInt(b,10))}),i=-1!==d.indexOf(e,h)?!0:!1,a.get("membership").each(function(a){a.get("blogId")===h||"ENABLED"!==a.get("blog").status&&"SPAM"!==a.get("blog").status||(-1!==d.indexOf(e,a.get("blog").id)?g.push({name:a.get("blog").displayName,id:a.get("blog").id}):f.push({name:a.get("blog").displayName,id:a.get("blog").id}))},this),c.resolve({repostedTo:e,repostedToPersonal:i,personalBlogId:h,blogsUndo:g,blogsRepost:f})}.bind(this)),c.promise()}});return l}),define("app/post/posttools/controller/posttools.hide.controller",["config","jquery","singleton/Feature","singleton/CurrentUser","model/post/Post"],function(a,b,c,d,e){"use strict";var f={API:{hide:function(f,g){var h=f.get("id"),i=a.api.core.url+"/post/"+h+"/hide?token="+d.get("token"),j=null,k="/";d.isSuperuser()&&c.isOn("superuser")&&g()&&(f.has("parentId")&&(j=new e({id:f.get("parentId")}),k=j.has("permalink")?j.get("permalink"):"/"+j.id),b.ajax({url:i,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(a){void 0!==a.meta&&a.meta.success===!0&&window.setTimeout(function(){window.location.href=k},1e3)}}))}}};return f.API}),define("templates/tiger/components/fullscreen-spinner",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.fullscreenSpinner=function(a,c,d){return'<div class="loading-full animate"><div class="loading-message-box">'+b.components.spinner.bounce(null,null,d)+"</div></div>"},d.DEBUG&&(b.components.fullscreenSpinner.soyTemplateName="tiger.components.fullscreenSpinner")}),define("view/Spinner",["jquery","view/BaseView","templates/tiger/components/spinner","templates/tiger/components/fullscreen-spinner"],function(a,b){"use strict";var c=b.extend({visible:!0,fullscreen:!1,tagName:"div",className:"spinner-wrapper",initialize:function(a){this.visible=void 0===a.initiallyVisible?!0:a.initiallyVisible,this.fullscreen=void 0===a.fullscreen?!1:a.fullscreen,this.render()},render:function(){var b;return this.visible&&(b=this.fullscreen?this.soyToHtml(tiger.components.fullscreenSpinner):this.soyToHtml(tiger.components.spinner.bounce,{})),this.$el.html(b),this.fullscreen?a(this.el).find(".animate").addClass("in"):a(this.el).addClass("with-margin"),this}});return c}),define("apiclient/repost",["config","apiclient/apirequest","apiclient/gettoken"],function(a,b,c){"use strict";return{unschedule:b.postJson(c.append(a.api.core.url+"/blog/{{blogId}}/removeRepostJob/{{postId}}")),reschedule:b.postJson(c.append(a.api.core.url+"/blog/{{blogId}}/updateRepostJob/{{postId}}?repostTime={{repostTime}}"))}}),define("app/post/posttools/posttools.controller",["jquery","underscore","singleton/CurrentUser","singleton/EventDispatcher","singleton/Feature","singleton/Utils","singleton/util/loadEditor","module/KinjaAnalytics","view/BaseView","app/post/common/post.layout","app/post/mixins/post.confirmationPrompt","app/post/posttools/posttools.menuview","app/post/posttools/controller/posttools.dismiss.controller","app/post/posttools/controller/posttools.block.controller","app/post/posttools/controller/posttools.like.controller","app/post/posttools/controller/posttools.hide.controller","module/flagging/ReplyFlaggingModule","app/post/mixins/post.successMessage","app/MarionetteApp","view/Spinner","apiclient/repost","templates/tiger/messages/postAction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){"use strict";var v=b.extend({},k,r,{_openSpinnerUntil:function(c,d){d=b.defaults({},{fullscreen:!0});var e=new t(d);return e.$el.appendTo("body"),a.when(c).then(e.remove.bind(e))},_like:function(a){a.model.get("tags")&&a.model.get("tags").length&&e.isOn("channels")&&!a.model.get("liked")&&s.vent.trigger("add:channel",{channelName:a.model.get("tags")[0].name,url:a.model.get("tags")[0].urlName}),o.like(a.model,a.view)},_reply:function(){require(["module/DiscussionModule"],function(a){a.replyToStarterPost()})},_dismiss:function(a){v._confirmationPrompt(tiger.messages.postAction.confirmDismissPost)&&m.dismiss(a.model)},_undismiss:function(a){m.undismiss(a.model)},_getDismissState:function(a){a.model.getActionState()},_delete:function(a){var c,d=a.model,e=this,g="dashboard"===f.getKinjaMeta().pageType||"manageblog"===f.getKinjaMeta().pageType;v._confirmationPrompt(tiger.messages.postAction.areYouSureToDelPost)&&(d.on("destroy",function(){e._displaySuccessMessage(tiger.messages.postAction.postDeleted),c=function(){window.location=g?window.location.pathname:i.prototype.cachebuster.call(i.prototype,"/")},b.delay(c,2e3)}),d.destroy({wait:!0}))},_unscheduleRepost:function(a){var c=this,d=a.view.el.getAttribute("data-postid"),e=a.view.el.getAttribute("data-blogid"),g=function(){window.location="private"===f.getKinjaMeta().pageType?window.location.pathname:i.prototype.cachebuster.call(i.prototype,"/")},h=function(){c._displaySuccessMessage(tiger.messages.postAction.repostUnscheduled),b.delay(g,2e3)};v._confirmationPrompt(tiger.messages.postAction.areYouSureToUnschedRepost)&&u.unschedule({postId:d,blogId:e}).done(h)},_promote:function(a){var b=a.model.id,d=c.hasPermission("SALES")||c.isSuperUser(),e=window.location.port?"http://kinja.dev:9000":"http://kinja.com";d&&(window.location.href=e+"/dfp/promotions/"+b)},_checkBlockStatus:function(a){n.checkBlockStatus(a.model,a.collection)},_postIsBlocked:function(a,b){return-1!==b.indexOf(a.get("authorBlogId"))},_block:function(a){var b=function(a){return v._confirmationPrompt(tiger.messages.postAction.confirmBlockBlog,a)};n.block(a.model,a.collection,b,a.targetBlogName,a.targetAuthorName)},_hide:function(a){var b=function(){return v._confirmationPrompt(tiger.messages.postAction.confirmHidePost)};p.hide(a.model,b)},_unflag:function(a){q.unflag(a,a.model)},_kinjaShare:function(a){var b;c.requireLogin("kinjaSharePost").done(function(){b=function(){return g().then(function(b){b.sharePost(a)})},a.has("original")?this._openSpinnerUntil(b()):this._openSpinnerUntil(a.fetch({success:b,preview:"PUBLISHED"!==a.get("status")}).then(b)),h.pushEvent("SHARE","POST",a.get("id"),{uiElement:"dropdown"})}.bind(this))},_externalShare:function(a){var c=a.view.$(".js_share-post-item"),d=c.attr("href"),e={twitter:"toolbar=0,status=0,width=480,height=360",facebook:"toolbar=0,status=0,width=480,height=360",tumblr:"toolbar=0,status=0,width=450,height=430"},f=b.intersection(c.attr("class").split(/\s+/),["twitter","facebook","tumblr"])[0];window.open(d,"share"+f,e[f])},_repost:function(a,b){var d="repost",e=this,f=c.get("membership").find(function(a){return a.get("blogId")===parseInt(b,10)});a.setAction(d,b,{success:function(){e._displaySuccessMessage(tiger.messages.postAction.postReposted,{blogName:f.get("blog").displayName,blogUrl:"http://"+f.get("blog").canonicalHost})},error:function(a){throw new Error("PostTools.repostPost(): "+a.reason)}})},_undoRepost:function(a){var b="actionreset",c=a.targetBlogId,d=a.model,e=this;d.setAction(b,c,{success:function(){e._displaySuccessMessage(tiger.messages.postAction.repostRemoved)},error:function(a){throw new Error("PostTools.undoRepost(): "+a.reason)}})},_openPupilModal:function(){var b=a.Deferred();return require(["app/pupil/PupilController"],function(a){a.show().then(b.resolve.bind(b))}.bind(this)),this._openSpinnerUntil(b)},_bindEvents:function(a,b){a.on("posttools:like",this._like.bind(this)),a.on("posttools:reply",this._reply.bind(this)),b.on("posttools:dismiss",this._dismiss.bind(this)),b.on("posttools:undismiss",this._undismiss.bind(this)),b.on("posttools:getDismissState",this._getDismissState.bind(this)),b.on("posttools:delete",this._delete.bind(this)),b.on("posttools:promote",this._promote.bind(this)),b.on("posttools:block",this._block.bind(this)),b.on("posttools:checkBlockStatus",this._checkBlockStatus.bind(this)),b.on("posttools:hide",this._hide.bind(this)),b.on("posttools:unflag",this._unflag.bind(this)),b.on("posttools:kinjaShare",this._kinjaShare.bind(this)),b.on("posttools:externalShare",this._externalShare.bind(this)),b.on("posttools:repost",this._repost.bind(this)),b.on("posttools:undorepost",this._undoRepost.bind(this)),b.on("close",function(){c.off(null,null,b),d.off(null,null,b),b.model.off(null,null,b)}),b.on("posttools:menuview:togglehidden",function(b){a.togglePostToolsVisibility(b)}),b.on("reposttools:unschedule",this._unscheduleRepost.bind(this)),b.on("posttools:pupil",this._openPupilModal.bind(this))},API:{startPostTools:function(a,b){var e="undefined"!=typeof b.get("defaultBlogId")?b.get("defaultBlogId"):f.getKinjaMeta().blog.id,g=new l({el:a.find(".js_post-dropdown-ct"),model:b,blockedBlogCollection:n.getBlockedBlogCollection(e)}),h=new j({el:a,model:b});h.post.attachView(g),h.bindUIElements(),h.updateUserState(),v._bindEvents(h,g),d.on("posttools:close:"+b.get("id"),function(){g.close()}),c.onAuth.done(g.render.bind(g))},closePostTools:function(a){d.trigger("posttools:close:"+a)},bindEvents:function(a,b){v._bindEvents(a,b)}}});return v.API}),define("view/PostView",["jquery","underscore","view/BaseView","singleton/PostInsetTools","singleton/Utils","singleton/EventDispatcher","singleton/Feature","app/post/posttools/posttools.controller","view/SuccessBox"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=c.extend({postTool:null,events:{"click .lazy-gif.thawable":"thawImage"},initialize:function(){this.$(".item-content").on("click",this.navigateToArticle.bind(this)),this.$(".js_read-more").on("click",this.gaTrackClick.bind(this)),this.$(".js_entry-title").on("click",this.gaTrackClick.bind(this)),this.$(".js_meta-byline a").on("click",this.gaTrackClick.bind(this)),this.$(".js_marquee-asset a").on("click",this.gaTrackClick.bind(this)),this.$(".js_publish_time").on("click",this.gaTrackClick.bind(this)),this.handleCustomIframes()},start:function(){return h.startPostTools(this.$el,this.model),"permalink"===e.getKinjaMeta().pageType&&(g.isOn("webpack")?require.ensure(["gawkerlib/lightboxer","lib/amd-wrapped/jquery.lightbox-0.5"],function(a){var b=a("gawkerlib/lightboxer");b(this.$el)}.bind(this)):require(["gawkerlib/lightboxer","lib/amd-wrapped/jquery.lightbox-0.5"],function(a){a(this.$el)}.bind(this))),this.fixMarkup(),a.cookie("editor_warnings")&&this.showEditorWarnings(),this},showEditorWarnings:function(){var c,d,e=JSON.parse(a.cookie("editor_warnings")),f=/(http(s)?:\/\/[a-zA-Z0-9\-_]+\.[a-zA-Z]+(.)+)+/gi,h=e.length;e&&(a.removeCookie("editor_warnings"),b.each(e,function(a,b){c=a.message.match(f),d=a.message.replace(f,"");var e=new i({message:d+'<br/><a href="'+c+'" target="_blank">'+c+"</a>",permanent:!0,warningBox:!0,hidden:g.isOn("editor_warnings_collapsed")&&b>0});e.render(),g.isOn("editor_warnings_collapsed")&&0===b&&h>1&&e.attachMoreWarningsBox(h)}))},fixMarkup:function(){if("permalink"!==this.getPageType())return!1;var c=this;b.each(this.$el.find(".referenced ~ .content-ad"),function(b){var c=a(b);c.appendTo(c.prev())}),this.$el.find("blockquote .inset_placeholder").each(function(){a(this).closest("blockquote").before(this)}),d.render(this.$el),this.$el.find(".js_reel").each(function(){c.createReel(this)}),this.$el.find(".js_slider").each(function(){var b=a(this),d=b.attr("data-uri1"),e=b.attr("data-uri2"),f=b.attr("data-percent");c.renderSlider(b,d,e,f)})},renderSlider:function(b,c,d,f){function g(a,b){var c=b-a;return 6>c&&(c=6),c>630&&(c=630),c}function h(a,b,c,d){d&&(b.stop().animate({width:a},0),c.stop().animate({right:628-a},0))}var i,j=640*f*.01,k=e.imageUrl(c,"k-bigpic"),l=e.imageUrl(d,"k-bigpic"),m=a('<div id="sliderBottom" style="background-image: url('+l+');"></div>'),n=a('<div id="sliderTop" style="background-image: url('+k+');"></div>'),o=a('<div id="sliderArrows"></div>'),p=!1,q=b.offset().left;b.html('<div id="slider"></div>').append(m,n,o),i=b.find("#slider"),n.stop().animate({width:j},1e3),o.stop().animate({right:628-j},1e3),i.bind("mousedown touchstart",function(a){p=!0;var b=g(q,a.pageX);return h(b,n,o,p),i.bind("mousemove touchmove",function(a){var b=g(q,a.pageX);h(b,n,o,p)}),!1}).bind("mouseup touchend",function(){p=!1,i.stop()}).mouseleave(function(){p=!1,i.stop()})},remove:function(){h.closePostTools(this.model.get("id"))},render:function(){return this},createReel:function(b){var c,d,e=a(b),f=636,g=Math.round(f/(16/9)),h=[],i={},j=e.data("url"),k=e.data("cols"),l=e.data("rows"),m=a('<img class="greel" src="'+j+'A00.jpg" alt="" width="'+f+'" height="'+g+'" />');for(e.append(m),c=0;l>c;c++)for(d=0;k>d;d++)h.push(String.fromCharCode(c+65)+(10>d?"0":"")+d+".jpg");i={frames:k,path:j,images:h,cw:!0,revolution:{x:300,y:100},inversed:!0,suffix:"",wheelable:!1},1!==l&&(i.rows=l),require(["lib/amd-wrapped/jquery.reel"],function(){m.one("load",function(){a(this).reel(i)})})},truncatePostText:function(a,b){var c,d,f=b?"":"&hellip;",g=a||320;c=this.$el.find(".read-more").detach(),d=this.$el.find("p.first-text"),d.text().length>g&&d.html(e.cutHtml(d.html(),g,f)),d.append(c)},truncateWidePostText:function(a,b){this.$el.parent().hasClass("wide")&&this.truncatePostText(a,b)},navigateToArticle:function(b){if(2!==b.button){var c,d=a(b.target);if(!d.parents(".thumb-inset").length&&!d.closest(".js_post-menu-toggler").length&&!d.closest("a").attr("href")){if(c=this.$(".js_read-more").attr("href"),this.gaTrackClick(),1===b.button||b.ctrlKey||b.metaKey||"dashboard"===e.getKinjaMeta().pageType)return window.open(c,"_blank"),!1;window.location=c}}},thawImage:function(b){b.preventDefault(),f.trigger("thawImage",{$el:a(b.target)})},gaTrackClick:function(){var c=b.indexOf(a(".post-list .js_post_item"),this.$el[0])+1;c>0&&23>c&&window.ga("send","event","Front page click","Front page post click","position - "+c)},handleCustomIframes:function(){var b=a("iframe.custom.aspect");b.each(function(){var b=a(this);b.data("aspectRatio",b.height()/b.width()).removeAttr("height").removeAttr("width")}),b.length&&a(window).resize(function(){b.each(function(){var b=a(this),c=b.parent().width();b.width(c).height(c*b.data("aspectRatio"))})}).resize()}});return j}),define("view/posttools/ApproveToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","model/post/Post","singleton/CurrentUser","singleton/CurrentBlog"],function(a,b,c,d,e,f,g){"use strict";var h,i;return h=function(a,c,d){return b.map(c,function(b){var c=d?'[data-sourceblogid="'+d+'"]':"";return"."+a+'[data-blogid="'+b+'"]'+c}).join(", ")},i=d.extend({events:{"click .js_followforblog":"followUserForBlog","click .js_unfollowforblog":"unfollowUserForBlog"},initialize:function(){var a=b.debounce(this.update,1e3);f.onAuthStateChange(a.bind(this)),this.on("update",a,this)},update:function(c){var d;return c=c||{},d=c.el||a("body"),f.onAuth.done(function(){if(f.isLoggedIn()){var c=function(b){return parseInt(a(b).data("blogid"),10)},e=d.find(".js_follow-controls"),g=b.without(b.unique(b.map(e,c)),void 0);this.updateBlogFollows(g,e)}}.bind(this)),this},updateBlogFollows:function(a,c){var d=function(c){(f.hasRole("AUTHOR",c)||f.isSuperuser())&&g.getFollowedBlogIds().done(function(){var d=b.intersection(g.followedBlogIds,a),e=b.difference(a,d);this.updateFollowState(d,"follow",c),this.updateFollowState(e,"unfollow",c)}.bind(this))};b.chain(c).union([g.id]).unique().compact().each(d,this)},followUserForBlog:function(b){var d=a(b.currentTarget).closest(".js_follow-controls");return c.pushEvent("FOLLOW","USER",d.data("blogid"),{uiElement:"groupChat"}),this.followReplyAction("blogfollow",b),!1},unfollowUserForBlog:function(a){return this.followReplyAction("unfollow",a),!1},followReplyAction:function(c,d){var h,i,j,k=a(d.currentTarget).closest(".js_follow-controls"),l=k.data("postid"),m=k.data("blogid");h=function(){var a=g.id;return m===f.get("defaultBlogId")?!1:void f.setBlogAction(c,a,m,{success:function(a){var d;i=new e({id:l}),"blogfollow"===c&&!i.get("isStarter")&&!i.get("approved")&&a.data&&a.data.approvedReplies&&(j=b.pluck(a.data.approvedReplies,"postId"),k.closest(".js_reply").trigger("approval",{approvedReplyIDs:j})),d="unfollow"===c?b.without(g.followedBlogIds,m):b.union(g.followedBlogIds,[m]),g.followedBlogIds=d,this.update()}.bind(this),error:function(a){throw new Error("PostTools.followBlog(): "+a.reason)}})}.bind(this),f.requireLogin("blogFollowTool").done(function(){h()})},updateFollowState:function(a,b,c){this.updateFollowControls(a,b,c)},updateFollowControls:function(b,c,d){var e=h("js_follow-controls",b,d);this.$(e).each(function(b,d){var e,g,h=a(d);e=parseInt(h.data("blogid"),10),g=f.get("defaultBlogId")===e,
h.find(".js_followforblog").toggleClass("hide","follow"===c||g).end().find(".js_unfollowforblog").toggleClass("hide","unfollow"===c||g)})},removeControls:function(b){b=b||a("body"),b.find(".js_followforblog, .js_unfollowforblog").addClass("hide")}})}),define("view/posttools/UserFollowToolView",["jquery","underscore","module/KinjaAnalytics","view/BaseView","singleton/CurrentUser"],function(a,b,c,d,e){"use strict";var f,g;return f=function(a,c){return b.map(c,function(b){return"."+a+'[data-authorid="'+b+'"]'}).join(", ")},g=d.extend({events:{"click .js_followforuser":"followUserForUser","click .js_unfollowforuser":"unfollowUserForUser"},initialize:function(){var a=b.debounce(this.update,1e3);e.onLoggedIn.done(a.bind(this)),this.on("update",a,this)},update:function(b){var c,d;return b=b||{},c=b.el||a("body"),d=e.get("followedAuthorIds"),this.toggleMarker(d,"follow"),this.updateUserFollows(d,"follow"),this},updateUserFollows:function(c,d){var g=f("js_user-follow-controls",b.without(c,e.id)),h=a('.js_user-follow-controls[data-authorid="'+e.id+'"]');h.find(".js_followforuser, .js_unfollowforuser").addClass("hide"),a(g).find(".js_followforuser").toggleClass("hide","follow"===d).end().find(".js_unfollowforuser").toggleClass("hide","unfollow"===d)},followUserForUser:function(a){return this.userfollowAction(a),!1},unfollowUserForUser:function(a){return this.userunfollowAction(a),!1},userfollowAction:function(b){var d=a(b.currentTarget).closest(".js_user-follow-controls"),f=d.attr("data-authorid"),g=a(b.currentTarget).attr("data-analytics-target");g&&c.pushEvent("FOLLOW","USER",f,{uiElement:g}),e.requireLogin("userfollow").done(function(){e.followUser(f).done(function(){this.toggleMarker([f],"follow"),this.updateUserFollows([f],"follow")}.bind(this))}.bind(this))},userunfollowAction:function(b){var c=a(b.currentTarget).closest(".js_user-follow-controls"),d=c.attr("data-authorid");e.requireLogin("authorunfollow").done(function(){e.unfollowUser(d).done(function(){this.toggleMarker([d],"unfollow"),this.updateUserFollows([d],"unfollow")}.bind(this))}.bind(this))},toggleMarker:function(a,b){var c=f("js_author",a);this.$(c).toggleClass("followed","follow"===b)},resetControls:function(b){b=b||a("body"),b.find(".js_followforuser").removeClass("hide"),b.find(".js_unfollowforuser").addClass("hide")},removeAvatarMarker:function(b){b=b||a("body"),b.find(".js_author").removeClass("followed")},removePlaceholderBtn:function(b){b=b||a("body"),b.find(".js_list-control__empty").addClass("hide")}})}),define("apiclient/likestate",["config","apiclient/apirequest","apiclient/gettoken"],function(a,b,c){"use strict";var d;return d={getForPosts:b.getJson(c.append(a.api.core.url+"/like/status"),{}),getForStarter:b.getJson(c.append(a.api.core.url+"/like/{{starterId}}"),{})}}),define("singleton/PostHelper",["jquery","underscore","singleton/CurrentUser","model/post/Post","apiclient/likestate"],function(a,b,c,d,e){"use strict";var f={parsePostModelDataFromDom:function(a){return JSON.parse(decodeURIComponent(a.data("model")))},parseFromDom:function(c){var e,f=[];return e=b.isUndefined(c)?a("body").find(".js_post_item, .js_reply, .js_event_item"):c.is(".js_post_item, .js_reply, .js_event_item")?c:c.find(".js_post_item, .js_reply, .js_event_item"),b.each(e,function(b){var c=a(b),e={};void 0!==c.data("model")?(e=this.parsePostModelDataFromDom(c),f.push({model:new d(e),node:c})):void 0!==c.data("id")&&f.push({model:new d({id:c.data("id")}),node:c})},this),f},likeStatusFor:function(a){var d=b.map(a,function(a){return a.model.id});c.onAuth.done(function(){return c.isLoggedIn()&&d?void e.getForPosts({id:d},{traditional:!0}).done(function(c){b.each(c,function(c){var d=c.objectId,e=b.find(a,function(a){return a.model.id===d});e&&e.model.setLikeState(c)})}):!1}.bind(this))},getContentType:function(a){return a.get("contentType")}};return f}),define("app/mixins/PostViewLoader",["jquery","underscore","view/PostView","view/posttools/ApproveToolView","view/posttools/BlogFollowToolView","view/posttools/UserFollowToolView","singleton/PostHelper"],function(a,b,c,d,e,f,g){"use strict";var h={followtool:null,initPostTools:function(){var b=a("body");this.on("update.postlist.post",this.addPosts,this),this.userfollowtool=new f({el:b}),this.blogfollowtool=new e({el:b}),this.approvetool=new d({el:b}),this.on("update.follows",this.addFollowButtons,this),this.addPosts({el:a("body")})},addFollowButtons:function(a){this.userfollowtool.trigger("update",{el:a.el}),this.blogfollowtool.trigger("update",{el:a.el}),this.approvetool.trigger("update",{el:a.el})},addPosts:function(d){var e,f;d=d||{},f=d.el||a("body"),e=g.parseFromDom(f),b.each(e,function(a){var b=new c({model:a.model,el:a.node});b.start(),d.callback&&d.callback.call(this,b)},this),e.length>0&&g.likeStatusFor(e),this.addFollowButtons({el:f})}};return h}),define("apiclient/recommendation",["config","apiclient/apirequest","apiclient/gettoken"],function(a,b,c){"use strict";return{recommendPost:b.postJson(c.append(a.api.core.url+"/post/{{postId}}/recommendAsset")),unrecommendPost:b.postJson(c.append(a.api.core.url+"/post/{{postId}}/unrecommendAsset"))}}),define("templates/tiger/components/post/button/recommend-button",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.post.button.recommendButton=function(a,c,d){var f="",g=a.assetId?a.assetId:"";return f+='<a href="#" class="recommend js_recommend '+e.$$escapeHtmlAttribute(a.type)+"-recommend js_"+e.$$escapeHtmlAttribute(a.type)+"-recommend "+(a.isActive?" active ":"")+' readonly-hide icon--svg" data-asset-source="'+e.$$escapeHtmlAttribute(a.assetSource)+'" data-asset-id="'+e.$$escapeHtmlAttribute(g)+'"'+(a.isRecommendable?'title="Recommend':"video"==a.type?'title="Recommend (WARNING: Minimum recommended front page video thumbnail size is 640×360. This video has a smaller thumbnail. Visual degradation may occur.)':'title="Recommend (WARNING: Minimum recommended front page image size is 640×360. This '+e.$$escapeHtmlAttribute(a.type)+" is smaller. Visual degradation may occur.)")+'">'+b.icons.essential.star(null,null,d)+"</a>"},d.DEBUG&&(b.components.post.button.recommendButton.soyTemplateName="tiger.components.post.button.recommendButton")}),define("app/mixins/RecommendAssetMixin",["jquery","underscore","singleton/EventDispatcher","singleton/Utils","view/BaseView","model/post/Post","apiclient/recommendation","templates/tiger/components/post/button/recommend-button","templates/tiger/messages"],function(a,b,c,d,e,f,g){"use strict";var h=e.extend({initialize:function(a){this.model=a.model,this.assets=this.filterAssets(this.model),this.renderUI()},filterAssets:function(a){var c=b.compact(b.map(a.get("images"),this.filterAndCreateImageObject,this)),d=b.compact(b.map(a.get("videos"),this.createVideoObject,this));return c.concat(d)},filterAndCreateImageObject:function(a){var c,d;return c=null!==a.id?a.id:"",d=c?this.$('[data-chomp-id="'+c+'"]'):this.$('[src="'+(null!==a.src?a.src:"")+'"]'),b.extend(a,{$el:d,type:"image"})},createVideoObject:function(a){var c=a.src.split("#")[0],d=this.$('[data-recommend-id="'+c+'"]');return b.extend(a,{$el:d,type:"video"})},recommendAsset:function(a,b){var c=b?"image://"+String(b):a;return g.recommendPost({postId:this.model.get("id"),assetUri:c}).then(this.updateAssetsData.bind(this)).then(this.renderUI.bind(this))},unrecommendAsset:function(a,b){var c=b?"image://"+String(b):a;return g.unrecommendPost({postId:this.model.get("id"),assetUri:c}).then(this.updateAssetsData.bind(this)).then(this.renderUI.bind(this))},updateAssetsData:function(a){var b=new f(a);this.assets=this.filterAssets(b)},renderUI:function(){this.$(".js_post_item").find(".js_recommend").remove(),this.renderRecommendButtons(),this.bindRecommendEvents()},renderRecommendButtons:function(){b.each(this.assets,function(a){this.renderRecommendButton(a)},this)},renderRecommendButton:function(b){var c,d=tiger.components.post.button.recommendButton,e={isActive:b.recommended,type:b.type,assetId:void 0!==b.id?String(b.id):"",assetSource:b.src||b.uri,isRecommendable:this.calcRecommendability(b)},f=this.soyToHtml(d,e);switch(b.type){case"image":c=b.$el.closest(".img-border"),0===c.length&&(c=b.$el.closest(".columns"),a(f).addClass("marquee-recommend-btn"));break;case"video":c=b.$el.closest(".flex-video")}c.append(f)},calcRecommendability:function(a){var b=!1,c=d.getKinjaMeta();return b=a.thumbnails&&a.thumbnails.length?a.thumbnails[0].width>=c.imageSizes.KinjaExtraLarge.width:a.width>=c.imageSizes.KinjaExtraLarge.width},displayRecommendMessage:function(){c.trigger("successbox:display",{message:tiger.messages.assetRecommended})},displayUnrecommendMessage:function(){c.trigger("successbox:display",{message:tiger.messages.assetUnrecommended})},bindRecommendEvents:function(){this.$(".js_post-wrapper").off("click",".js_recommend"),this.$(".js_post-wrapper").on("click",".js_recommend",this.recommendClickHandler.bind(this))},recommendClickHandler:function(b){var c=a(b.currentTarget);return this.handleRecommendation(c.data("asset-source"),c.data("asset-id")),!1},handleRecommendation:function(c,d){var e=b.find(this.assets,function(a){return a.recommended===!0}),f=null,g=null,h=null;e&&(f=e.src||e.uri,g=e.id),f?(h=a.when(this.unrecommendAsset(f,g)),f===c?h.then(this.displayUnrecommendMessage):b.delay(function(){h.then(this.recommendAsset(c,d)),h.then(this.displayRecommendMessage)}.bind(this),600)):(h=a.when(this.recommendAsset(c,d)),h.then(this.displayRecommendMessage))}});return{startRecommendAssetMixin:function(a){if(a){var b,c=a.has("images")&&a.get("images").length>0,d=a.has("videos")&&a.get("videos").length>0;(c||d)&&(b=new h({model:a,el:this.el}))}}}}),define("view/ImageLoader",["jquery","underscore","singleton/EventDispatcher","view/BaseView","singleton/Feature","lib/waypoints","lib/jquery.browser.mobile"],function(a,b,c,d,e){"use strict";var f=a(document),g=a(window),h={initialLookaheadFactor:.8,lookaheadFactor:2.6,containerClass:"lazy-image"},i="loaded",j=d.extend({$allWrappers:a(),$allImages:a(),_watchedImages:[],viewportHeight:0,scrollTop:0,initialize:function(a){this.options=b.defaults(a||{},h),b.bindAll(this,"loadIfVisible","handleScroll","handleScrollNew"),this.registerImages(this.$el),this.addScrollEvents(),c.on("rendered.postlist.reply",function(a){this.registerImages(a.el)}.bind(this))},registerImages:function(c){var d=this.options.containerClass,e=c.find("."+d),f=e.find("img, iframe");this.$allWrappers=this.$allWrappers.add(e),this.$allImages=this.$allImages.add(f),this._watchedImages=this._watchedImages.concat(b.map(f,function(b){var c=a(b);return[c,c.outerHeight(),c.offset().top]})),this.$allImages.each(function(b,c){var e=a(c);e.data("wrapper",e.closest("."+d))}),this.trigger("images:registered")},addScrollEvents:function(){var c=b.bind(function(){this.viewportHeight=a.waypoints("viewportHeight")},this);c(),g.resize(b.debounce(c,1e3)),e.isOn("imageloader")?(g.scroll(b.throttle(b.partial(this.handleScrollNew,this.options.lookaheadFactor),500)),this.handleScrollNew(this.options.initialLookaheadFactor)):(g.scroll(b.throttle(b.partial(this.handleScroll,this.options.lookaheadFactor),500)),this.handleScroll(this.options.initialLookaheadFactor))},loadImage:function(b){var c=a(b);c.data(i)||this.waitForPlaceholder(c)},reinitializeInterchange:b.once(function(){a(document).foundation("interchange")}),updateInterchange:b.throttle(function(){this.reinitializeInterchange(),a(document).foundation("interchange","reflow")},150),_loadImage:function(a){var c,d=a.data("src"),e=a.data("lazyInterchange");this.trigger("imageLoading",{$el:a}),c=b.bind(function(){a.off("load",c).addClass("lazy-loaded"),this.trigger("imageLoaded",{$el:a}),this._watchedImages=this._watchedImages.filter(function(b){return!a.is(b[0])})},this),a.load(c).data(i,!0),d?a.attr("src",d):e?(a.attr("data-interchange",e),this.updateInterchange()):a.load()},waitForPlaceholder:function(a){var c,d="await-placeholder",e=a.data("wrapper");e.hasClass("asset-loading")?a.data(d)||(a.data(d,!0),c=b.bind(function(){a.off("load",c),this._loadImage(a)},this),a.load(c)):this._loadImage(a)},loadIfVisible:function(a,b,c){!a.data(i)&&this.inViewPort(a,b,c)&&this.loadImage(a)},loadIfVisibleNew:function(a,b,c,d){!a.data(i)&&this.inViewPortNew(a,b,c,d)&&this.loadImage(a)},inViewPort:function(a,b,c,d){var e=this.scrollTop,f=d||this.options.lookaheadFactor,g=this.viewportHeight,h=g*f,i=e+g+h,j=e-h,k=Math.round(c),l=Math.round(k+b),m=l>j,n=i>k;return m&&n},inViewPortNew:function(a,b,c,d){var e=this.scrollTop,f=d||this.options.lookaheadFactor,g=this.viewportHeight,h=g*f,i=e+g+h,j=e-h,k=Math.round(c),l=Math.round(k+b),m=l>j,n=i>k;return m&&n},handleScrollNew:function(a){this._watchedImages.length&&(this.scrollTop=window.pageYOffset||f.scrollTop(),b.each(this._watchedImages,function(b){var c=b[0],d=b[1],e=b[2];this.loadIfVisibleNew(c,d,e,a)},this))},handleScroll:function(a){this._watchedImages.length&&(this.scrollTop=window.pageYOffset||f.scrollTop(),b.each(this._watchedImages,function(b){var c=b[0],d=b[1],e=b[2];this.loadIfVisible(c,d,e,a)},this))}});return j}),define("view/GifImageLoader",["jquery","underscore","singleton/EventDispatcher","singleton/Feature","view/ImageLoader","lib/jquery.browser.mobile","templates/tiger/components/spinner"],function(a,b,c,d,e){"use strict";var f,g={mobileGifs:!0,gifClass:"lazy-gif",thawableClass:"thawable",thawingClass:"thawing",thawedClass:"thawed"};return f=e.extend({initialize:function(a){b.extend(this.options,b.defaults(a||{},g)),this.addEvents(),this.on("images:registered",this.markImagesThawable),e.prototype.initialize.apply(this,arguments)},addEvents:function(){var b=this.options.gifClass,e=function(a){return a.data("wrapper").hasClass(b)};a.browser.mobile||(d.isOn("webm")||this.on("imageLoading",function(b){var c=b.$el,d=new Image,f=c.data("anim-src");e(c)&&a(d).attr("src",f)},this),this.on("imageLoaded",function(a){var b=a.$el;e(b)&&this.thawImage(b)},this)),c.on("thawImage",function(a){var b=a.$el;"IMG"!==b.prop("tagName")&&(b=b.find("img")),this.thawImage(b)},this)},markImagesThawable:function(){var b=this.options;a.browser.mobile&&b.mobileGifs&&this.$allWrappers.addClass(b.thawableClass)},thawImage:function(b){var c,e,f,g;d.isOn("webm")?(c=a("<video>"),e=c[0].canPlayType("video/webm")?b.data("webm-src"):b.data("mp4-src"),c.attr({autoplay:!0,controls:a.browser.mobile,loop:!0,muted:!0,src:e,poster:b.attr("src"),"class":b.attr("class"),style:b.attr("style"),width:b.attr("width"),height:b.attr("height"),"data-chomp-id":b.data("chomp-id")}),c.data("wrapper",b.data("wrapper")),this.startLoadIndicator(c),b.replaceWith(c)):(f=b.data("animSrc")||b.data("assetUrl"),g=b.data("animInterchange"),this.startLoadIndicator(b),f&&b.attr("src",f),g&&(b.attr("data-interchange",g),this.updateInterchange()))},startLoadIndicator:function(b){var c=a(b),e=c.data("wrapper"),f=this.options,g=function(){e.removeClass(f.thawingClass).addClass(f.thawedClass),h.remove()},h=a(tiger.components.spinner.gifthaw()).appendTo(e);e.removeClass(f.thawableClass).addClass(f.thawingClass),c.load(g).error(g),d.isOn("webm")&&c.on("loadedmetadata",g)}})}),function(a){function b(a,b,k){var l=0,m=[0],o="",p=null,o=k||"UTF8";if("UTF8"!==o&&"UTF16"!==o)throw"encoding must be UTF8 or UTF16";if("HEX"===b){if(0!==a.length%2)throw"srcString of HEX type must be in byte increments";p=d(a),l=p.binLen,m=p.value}else if("TEXT"===b)p=c(a,o),l=p.binLen,m=p.value;else if("B64"===b)p=f(a),l=p.binLen,m=p.value;else{if("BYTES"!==b)throw"inputFormat must be HEX, TEXT, B64, or BYTES";p=e(a),l=p.binLen,m=p.value}this.getHash=function(a,b,c,d){var e,f=null,k=m.slice(),o=l;if(3===arguments.length?"number"!=typeof c&&(d=c,c=1):2===arguments.length&&(c=1),c!==parseInt(c,10)||1>c)throw"numRounds must a integer >= 1";switch(b){case"HEX":f=g;break;case"B64":f=h;break;case"BYTES":f=i;break;default:throw"format must be HEX, B64, or BYTES"}if("SHA-1"!==a)throw"Chosen SHA variant is not supported";for(e=0;c>e;e+=1)k=n(k,o),o=160;return f(k,j(d))},this.getHMAC=function(a,b,k,p,q){var r,s,t,u,v=[],w=[];switch(r=null,p){case"HEX":p=g;break;case"B64":p=h;break;case"BYTES":p=i;break;default:throw"outputFormat must be HEX, B64, or BYTES"}if("SHA-1"!==k)throw"Chosen SHA variant is not supported";if(s=64,u=160,"HEX"===b)r=d(a),t=r.binLen,r=r.value;else if("TEXT"===b)r=c(a,o),t=r.binLen,r=r.value;else if("B64"===b)r=f(a),t=r.binLen,r=r.value;else{if("BYTES"!==b)throw"inputFormat must be HEX, TEXT, B64, or BYTES";r=e(a),t=r.binLen,r=r.value}if(a=8*s,b=s/4-1,t/8>s){if("SHA-1"!==k)throw"Unexpected error in HMAC implementation";r=n(r,t),r[b]&=4294967040}else s>t/8&&(r[b]&=4294967040);for(s=0;b>=s;s+=1)v[s]=909522486^r[s],w[s]=1549556828^r[s];if("SHA-1"!==k)throw"Unexpected error in HMAC implementation";return k=n(w.concat(n(v.concat(m),a+l)),a+u),p(k,j(q))}}function c(a,b){var c,d,e=[],f=[],g=0;if("UTF8"===b)for(d=0;d<a.length;d+=1)for(c=a.charCodeAt(d),f=[],128>c?f.push(c):2048>c?(f.push(192|c>>>6),f.push(128|63&c)):55296>c||c>=57344?f.push(224|c>>>12,128|c>>>6&63,128|63&c):(d+=1,c=65536+((1023&c)<<10|1023&a.charCodeAt(d)),f.push(240|c>>>18,128|c>>>12&63,128|c>>>6&63,128|63&c)),c=0;c<f.length;c+=1)(g>>>2)+1>e.length&&e.push(0),e[g>>>2]|=f[c]<<24-g%4*8,g+=1;else if("UTF16"===b)for(d=0;d<a.length;d+=1)(g>>>2)+1>e.length&&e.push(0),e[g>>>2]|=a.charCodeAt(d)<<16-g%4*8,g+=2;return{value:e,binLen:8*g}}function d(a){var b,c,d=[],e=a.length;if(0!==e%2)throw"String of HEX type must be in byte increments";for(b=0;e>b;b+=2){if(c=parseInt(a.substr(b,2),16),isNaN(c))throw"String of HEX type contains invalid characters";d[b>>>3]|=c<<24-b%8*4}return{value:d,binLen:4*e}}function e(a){var b,c,d=[];for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),(c>>>2)+1>d.length&&d.push(0),d[c>>>2]|=b<<24-c%4*8;return{value:d,binLen:8*a.length}}function f(a){var b,c,d,e,f,g=[],h=0;if(-1===a.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(b=a.indexOf("="),a=a.replace(/\=/g,""),-1!==b&&b<a.length)throw"Invalid '=' found in base-64 string";for(c=0;c<a.length;c+=4){for(f=a.substr(c,4),d=e=0;d<f.length;d+=1)b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[d]),e|=b<<18-6*d;for(d=0;d<f.length-1;d+=1)g[h>>2]|=(e>>>16-8*d&255)<<24-h%4*8,h+=1}return{value:g,binLen:8*h}}function g(a,b){var c,d,e="",f=4*a.length;for(c=0;f>c;c+=1)d=a[c>>>2]>>>8*(3-c%4),e+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(15&d);return b.outputUpper?e.toUpperCase():e}function h(a,b){var c,d,e,f="",g=4*a.length;for(c=0;g>c;c+=3)for(e=(a[c>>>2]>>>8*(3-c%4)&255)<<16|(a[c+1>>>2]>>>8*(3-(c+1)%4)&255)<<8|a[c+2>>>2]>>>8*(3-(c+2)%4)&255,d=0;4>d;d+=1)f=8*c+6*d<=32*a.length?f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-d)&63):f+b.b64Pad;return f}function i(a){var b,c,d="",e=4*a.length;for(b=0;e>b;b+=1)c=a[b>>>2]>>>8*(3-b%4)&255,d+=String.fromCharCode(c);return d}function j(a){var b={outputUpper:!1,b64Pad:"="};try{a.hasOwnProperty("outputUpper")&&(b.outputUpper=a.outputUpper),a.hasOwnProperty("b64Pad")&&(b.b64Pad=a.b64Pad)}catch(c){}if("boolean"!=typeof b.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof b.b64Pad)throw"Invalid b64Pad formatting option";return b}function k(a,b){return a<<b|a>>>32-b}function l(a,b){var c=(65535&a)+(65535&b);return((a>>>16)+(b>>>16)+(c>>>16)&65535)<<16|65535&c}function m(a,b,c,d,e){var f=(65535&a)+(65535&b)+(65535&c)+(65535&d)+(65535&e);return((a>>>16)+(b>>>16)+(c>>>16)+(d>>>16)+(e>>>16)+(f>>>16)&65535)<<16|65535&f}function n(a,b){var c,d,e,f,g,h,i,j,n,o=[],p=[1732584193,4023233417,2562383102,271733878,3285377520];for(a[b>>>5]|=128<<24-b%32,a[(b+65>>>9<<4)+15]=b,n=a.length,i=0;n>i;i+=16){for(c=p[0],d=p[1],e=p[2],f=p[3],g=p[4],j=0;80>j;j+=1)o[j]=16>j?a[j+i]:k(o[j-3]^o[j-8]^o[j-14]^o[j-16],1),h=20>j?m(k(c,5),d&e^~d&f,g,1518500249,o[j]):40>j?m(k(c,5),d^e^f,g,1859775393,o[j]):60>j?m(k(c,5),d&e^d&f^e&f,g,2400959708,o[j]):m(k(c,5),d^e^f,g,3395469782,o[j]),g=f,f=e,e=k(d,30),d=c,c=h;p[0]=l(c,p[0]),p[1]=l(d,p[1]),p[2]=l(e,p[2]),p[3]=l(f,p[3]),p[4]=l(g,p[4])}return p}"function"==typeof define&&define.amd?define("lib/sha1",[],function(){return b}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=b:exports=b:a.jsSHA=b}(this),define("gawkerlib/urlUtil",["underscore"],function(a){"use strict";var b={toQueryString:function(b){var c=a.reduce(b,function(a,b,c){return a.push(c+"="+encodeURIComponent(b)),a},[]).join("&");return c.length>0&&(c="?"+c),c},fromQueryString:function(b){return a.reduce(b.replace("?","").split("&"),function(b,c){return c.length>0&&a.extend(b,a.object([a.map(c.split("="),decodeURIComponent)])),b},{})}};return b}),define("module/discussion/discussion.channel",["backbone","underscore"],function(a,b){"use strict";return b.extend({},a.Events)}),define("view/sharingfooter.view",["jquery","underscore","backbone.marionette","singleton/WindowController","module/discussion/discussion.channel","app/post/posttools/controller/posttools.like.controller"],function(a,b,c,d,e,f){"use strict";var g=c.ItemView.extend({ui:{likeButton:".js_like",likeIcon:".js_like_icon",likeCountPlaceholder:".js_like_count",replyButton:".js_reply-to-post",replyCount:".js_reply-count",sharePostButton:".js_share-post-item"},modelEvents:{"change:liked":"_updateLikeIconClasses","posttools:post:likeCount:updated":"_updateLikeCount"},events:{"click a":function(a){a.preventDefault()},"click @ui.replyButton":"reply","click @ui.likeButton":"like","click @ui.sharePostButton":"externalShare","touchstart a":"onTouchStart","touchend a":"onTouchEnd"},onTouchStart:function(b){a(b.target).addClass("hovered")},onTouchEnd:function(b){window.setTimeout(function(){a(b.target).removeClass("hovered")},200)},reply:function(){var c=a(".replies-wrapper"),e=1e3;return d.isPartiallyVisible(c)||b.throttle(a.scrollTo(a(c),{duration:e,easing:"easeInOutQuad"}),e),!1},like:b.debounce(function(){return f.like(this.model,this),!1},300),externalShare:function(c){var d=a(c.currentTarget),e=d.attr("href"),f={twitter:"toolbar=0,status=0,width=480,height=360,top="+(window.screen.height/2-180)+",left="+(window.screen.width/2-240),facebook:"toolbar=0,status=0,width=480,height=360,top="+(window.screen.height/2-180)+",left="+(window.screen.width/2-240)},g=b.intersection(d.attr("class").split(/\s+/),["twitter","facebook"])[0];return window.open(e,"share"+g,f[g]),d.addClass("used"),!1},initialize:function(){a.easing.easeInOutQuad=function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c};var b=function(b){return a("<div/>").html(b).text()},c=function(a){return a?a.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(b)}):""},d=this.model.get("headline")||this.model.get("first100Characters")||this.model.get("compact");this.$(this.ui.sharePostButton).each(function(e,f){var g=a(f),h=g.attr("href");g.attr("href",h.replace("POST_TITLE",encodeURIComponent(b(c(d)))))}),this.listenTo(e,"newComment",this.updateCommentCount)},updateCommentCount:function(){var a=this.$(this.ui.replyCount);a.html(parseInt(a.html(),10)+1)},_updateLikeIconClasses:function(){this.$(this.ui.likeIcon).toggleClass("active",this.model.get("liked"))},_updateLikeCount:function(){var b=parseInt(a(".js_like.button-recommend-post").data("likecount"),10)||0;this.$(this.ui.likeCountPlaceholder).text(b||"0")}});return g}),define("lib/amd-wrapped/base64",[],function(){"use strict";function a(a){var b,c,d=[],e=0;for(a=encodeURI(a),b=a.length;b>e;)c=a[e],e+=1,"%"!==c?d.push(c.charCodeAt(0)):(c=a[e]+a[e+1],d.push(parseInt(c,16)),e+=2);return d}function b(a){for(var b,c,d,e=[],f=0,g=a.length;g>f;)b=a[f],c=a[f+1],d=a[f+2],128>b?(e.push(String.fromCharCode(b)),f+=1):b>191&&224>b?(e.push(String.fromCharCode((31&b)<<6|63&c)),f+=2):(e.push(String.fromCharCode((15&b)<<12|(63&c)<<6|63&d)),f+=3);return e.join("")}function c(b){var c,d="",e=a(b),h=e.length;for(c=0;h-2>c;c+=3)d+=g[e[c]>>2],d+=g[((3&e[c])<<4)+(e[c+1]>>4)],d+=g[((15&e[c+1])<<2)+(e[c+2]>>6)],d+=g[63&e[c+2]];return h%3&&(c=h-h%3,d+=g[e[c]>>2],h%3===2?(d+=g[((3&e[c])<<4)+(e[c+1]>>4)],d+=g[(15&e[c+1])<<2],d+=f):(d+=g[(3&e[c])<<4],d+=f+f)),d}function d(a){var c,d,g=0,i=[],j=0,k=0;for(g=0;g<a.length;g++)d=a.charCodeAt(g),c=h[127&d],-1===c?e("WARN: Illegal characters (code="+d+") in position "+g):(k=k<<6|c,j+=6,j>=8&&(j-=8,f!==a.charAt(g)&&i.push(k>>j&255),k&=(1<<j)-1));return j?(e("ERROR: Corrupted base64 string"),null):b(i)}var e=function(){},f="=",g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return window.console&&window.console.log&&(e=function(a){window.console.log(a)}),{encode:c,decode:d}}),define("module/promotions/promotions.model",["underscore","backbone","apiclient/post","lib/amd-wrapped/base64"],function(a,b,c,d){"use strict";var e=b.Model.extend({defaults:{starCount:0,replyCount:0,viewCount:0},initialize:function(){var a=this.get("id");"PROMOTION_SIDEBAR"===this.get("zoneType")&&c.socialStats({id:a}).done(function(a,b){200===b.status&&(this.set("starCount",a.likes),this.set("replyCount",a.replies),this.set("viewCount",a.views))}.bind(this))},parse:function(a){var b={postUrl:a.postUrl,dfpTracker:a.dfpTracker,version:a.version,headline:a.version>=12?d.decode(a.post_headline):a.post_headline,plaintext:a.post_plaintext,shortExcerpt:a.version>=12?d.decode(a.post_shortExcerpt):a.post_shortExcerpt,promotionByline:a.version>=12?d.decode(a.post_promotionByline):a.post_promotionByline,authorByline:a.version>=12?d.decode(a.post_authorByline):a.post_authorByline,permalinkPath:a.post_permalinkPath,trackingPixel:a.trackingPixel,publishTime:a.publishTime,hasReadMore:a.hasReadMore,sponsored:a.sponsored,author:a.author,headlineImage:a.headlineImage,id:a.postId,impressionTracker:a.impressionTracker,zoneType:a.zoneType};return b},toSoyData:function(){return{post:{id:this.get("id"),title:this.get("headline"),url:this.get("permalinkPath"),shortExcerpt:this.get("shortExcerpt"),authorByline:this.get("authorByline"),author:this.get("author"),sponsored:this.get("sponsored"),promotionByline:this.get("promotionByline"),headlineImage:this.get("headlineImage"),trackingPixel:this.get("trackingPixel"),publishTime:this.get("publishTime"),modelData:encodeURIComponent(JSON.stringify(a.clone(this.attributes)))}}}});return e}),define("templates/tiger/utils/crop-type",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.utils.cropType=function(a,b,c){return""+e.$$escapeHtml("centered"==a.name?"KinjaCentered":"uncropped"==a.name?"KinjaUncropped":"Kinja")},d.DEBUG&&(b.utils.cropType.soyTemplateName="tiger.utils.cropType"),b.utils.cropType__Ce4=function(a,b,c){return""+e.$$filterHtmlAttributes("centered"==a.name?"KinjaCentered":"uncropped"==a.name?"KinjaUncropped":"Kinja")},d.DEBUG&&(b.utils.cropType__Ce4.soyTemplateName="tiger.utils.cropType__Ce4")}),define("templates/tiger/components/promotions/post",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.promotions.post=function(a,c,d){var f='<article class="post hentry js_post_item status-published post-item-frontpage js_promoted" data-id="'+e.$$escapeHtmlAttribute(a.post.id)+'" id="post_'+e.$$escapeHtmlAttribute(a.post.id)+'" data-model="'+e.$$escapeHtmlAttribute(a.post.modelData)+'">'+b.components.promotions.head({headline:a.post.title,permalink:a.post.url,headerLevel:5},null,d)+'<div class="meta-container without-dropdown">'+b.components.promotions.meta(a,null,d)+b.components.promotions.postDropDownWrapper(a,null,d)+"</div>",g=0,h=""+(0==g?"large-12":1==g?"medium-9":2==g?"medium-6":"");f+='<div class="row package standard-package"><div class="'+e.$$escapeHtmlAttribute(h)+' columns item-content hover-highlight entry-summary">'+b.components.promotions.mainMedia(a,null,d);var i=""+b.components.promotions.readMore(a,null,d);return f+=(a.post.shortExcerpt?e.$$filterNoAutoescape(a.post.shortExcerpt)+e.$$filterNoAutoescape(i):'<p class="first-text">'+e.$$filterNoAutoescape(a.post.plaintext)+e.$$filterNoAutoescape(i)+"</p>")+"</div></div>"+(a.post.trackingPixel?'<img style="position:absolute" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.trackingPixel))+'" width="1" height="1">':"")+"</article>"},d.DEBUG&&(b.components.promotions.post.soyTemplateName="tiger.components.promotions.post"),b.components.promotions.head=function(a,b,c){return""+(a.headline?'<header><h1 class="headline'+e.$$escapeHtmlAttribute(a.headerLevel&&a.headerLevel>1?" h"+a.headerLevel:"")+' hover-highlight entry-title"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.permalink))+'">'+e.$$filterNoAutoescape(a.headline)+"</a></h1></header>":"")},d.DEBUG&&(b.components.promotions.head.soyTemplateName="tiger.components.promotions.head"),b.components.promotions.meta=function(a,c,d){return'<div class="meta">'+b.components.promotions.postInfo(a,null,d)+'<div class="meta-byline js_meta-byline"><span class="display-name author vcard">'+(a.post.authorByline?e.$$filterNoAutoescape(window.kinja.stripHtmlTags(a.post.authorByline,"")):'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.author.screenName)+'" rel="nofollow">'+e.$$filterNoAutoescape(a.post.author.displayName)+"</a>")+"</span>"+b.components.promotions.promotedByline(a,null,d)+"</div></div>"},d.DEBUG&&(b.components.promotions.meta.soyTemplateName="tiger.components.promotions.meta"),b.components.promotions.promotedByline=function(a,c,d){var f='<span class="meta-promoted"><span class="promoted-dot">&middot;</span> '+(a.post.sponsored?'<span class="sponsored-label text-upper">Sponsored</span><span class="icon--svg u-prepended u-appended">'+b.icons.essential.starCircle(null,null,d)+"</span>":""),g=""+(a.post.promotionByline&&""!=a.post.promotionByline?e.$$escapeHtml(a.post.promotionByline):a.post.author&&a.post.author.displayName?e.$$escapeHtml(a.post.author.displayName):"");return f+='Promoted by <span class="js_promoted_displayName">'+e.$$filterNoAutoescape(g)+"</span></span>"},d.DEBUG&&(b.components.promotions.promotedByline.soyTemplateName="tiger.components.promotions.promotedByline"),b.components.promotions.mainMediaInterchange=function(a,c,d){var f="",g=""+b.utils.cropType({name:a.cropName},null,d),h=a.animated?a.image.format:a.image.frozenFormat,i="["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (default)], ["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (small)], ["+window.kinja.imageUrl(a.image.id,g+"Medium",h)+", (medium)], ["+(d.features.facethumbs?window.kinja.imageUrl(a.image.id,"KinjaThumb",h):window.kinja.imageUrl(a.image.id,g+"Small",h))+", (large)]";return f+=(a.animated?'data-anim-interchange="'+e.$$escapeHtml(i)+'"':a.lazyload?'data-lazy-interchange="'+e.$$escapeHtml(i)+'"':'data-interchange="'+e.$$escapeHtml(i)+'"')+'data-webm-src="'+e.$$escapeHtml(window.kinja.imageUrl(a.image.id,g+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtml(window.kinja.imageUrl(a.image.id,g+"-xlarge","mp4"))+'"'},d.DEBUG&&(b.components.promotions.mainMediaInterchange.soyTemplateName="tiger.components.promotions.mainMediaInterchange"),b.components.promotions.mainMediaImage=function(a,c,d){var f="",g=""+b.utils.cropType({name:a.cropName},null,d);return f+='<img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(window.kinja.imageUrl(a.image.id,g+"-xlarge",a.image.format)))+'"'+b.components.promotions.mainMediaInterchange__Ce4(a,null,d)+(a.image.isAnimated?b.components.promotions.mainMediaInterchange__Ce4(e.$$augmentMap(a,{animated:!0}),null,d):"")+'width="132" height="74">';
},d.DEBUG&&(b.components.promotions.mainMediaImage.soyTemplateName="tiger.components.promotions.mainMediaImage"),b.components.promotions.mainMedia=function(a,c,d){var f="";if(a.post.headlineImage&&a.post.headlineImage.type){var g="video"==a.post.headlineImage.type;f+='<div class="main-media fullwidth-for-small">'+("image"==a.post.headlineImage.type||g?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.url))+"\" rel=\"nofollow\" onclick=\"window.ga('send', 'event', 'Front page click', 'click', 'Front page click - post image', 'standard recommended');\"><span class=\""+(g?"video-thumb-play":"")+' img-border">'+b.components.promotions.mainMediaImage(e.$$augmentMap(a,{cropName:g?"centered":"default",image:a.post.headlineImage}),null,d)+(g?'<span class="play-icon">'+b.icons.actions.playIcon(null,null,d)+"</span>":"")+"</span></a>":"")+"</div>"}return f},d.DEBUG&&(b.components.promotions.mainMedia.soyTemplateName="tiger.components.promotions.mainMedia"),b.components.promotions.readMore=function(a,b,c){return'<span class="read-more hide-for-billboard"> <a class="js_read-more" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.url))+'" rel="nofollow">&raquo;</a><span class="timestamp proxima text-tiny nowrap"><span class="publish-time js_publish_time"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.url))+'" rel="nofollow"><span class="published updated">'+e.$$escapeHtml(a.post.publishTime.Mddyyhmma)+"</span></a></span></span></span>"},d.DEBUG&&(b.components.promotions.readMore.soyTemplateName="tiger.components.promotions.readMore"),b.components.promotions.postInfo=function(a,c,d){return'<span class="meta-tools"><div class="view-count-container"></div><a data-likecount="'+e.$$escapeHtmlAttribute(null!=a.post.likes?a.post.likes:0)+'" href="#" class="js_like button-recommend-post hover-icon icon--svg u-darken--onhover js_like_icon" title="Recommend"><span class="js_like_count">'+(a.post.likes&&a.post.likes>0?e.$$escapeHtml(a.post.likes):"")+"</span>"+b.icons.essential.star(null,null,d)+"</a></span>"},d.DEBUG&&(b.components.promotions.postInfo.soyTemplateName="tiger.components.promotions.postInfo"),b.components.promotions.postDropDownWrapper=function(a,c,d){return'<div class="post-dropdown-ct js_post-dropdown-ct">'+b.components.promotions.postDropdown(a,null,d)+"</div>"},d.DEBUG&&(b.components.promotions.postDropDownWrapper.soyTemplateName="tiger.components.promotions.postDropDownWrapper"),b.components.promotions.postDropdown=function(a,c,d){return'<ul id="dropdown-'+e.$$escapeHtmlAttribute(a.post.id)+'" class="f-dropdown proxima js_post-dropdown js_follow-controls js_user-follow-controls whitelisted-links" data-postid="'+e.$$escapeHtmlAttribute(a.post.id)+'" data-starterid="'+e.$$escapeHtmlAttribute(a.post.id)+'" data-authorid="'+e.$$escapeHtmlAttribute(a.post.author.id)+'" data-blogid="'+e.$$escapeHtmlAttribute(a.post.defaultBlogId)+'" data-sourceblogid="'+e.$$escapeHtmlAttribute(null==a.blog?null:a.blog.id)+'" data-dropdown-content><li class="js_edit-post hover-icon hide readonly-hide"><a href="#" rel="nofollow"><span class="icon--svg u-prepended">'+b.icons.actions.write(null,null,d)+'</span></a></li><li class="js_delete-post hover-icon hide readonly-hide"><a href="#" rel="nofollow"><span class="icon--svg u-prepended">'+b.icons.essential.close(null,null,d)+'</span></a></li></ul><a href="#" target="_self" class="secondary transparent toggle-30 js_post-menu-toggler post-dropdown-trigger icon--svg u-highlighted--onhover" data-dropdown="dropdown-'+e.$$escapeHtmlAttribute(a.post.id)+'">'+b.icons.essential.chevronBottom(null,null,d)+"</a>"},d.DEBUG&&(b.components.promotions.postDropdown.soyTemplateName="tiger.components.promotions.postDropdown"),b.components.promotions.mainMediaInterchange__Ce4=function(a,c,d){var f="",g=""+b.utils.cropType__Ce4({name:a.cropName},null,d),h=a.animated?a.image.format:a.image.frozenFormat,i="["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (default)], ["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (small)], ["+window.kinja.imageUrl(a.image.id,g+"Medium",h)+", (medium)], ["+(d.features.facethumbs?window.kinja.imageUrl(a.image.id,"KinjaThumb",h):window.kinja.imageUrl(a.image.id,g+"Small",h))+", (large)]";return f+=(a.animated?'data-anim-interchange="'+e.$$escapeHtmlAttribute(i)+'"':a.lazyload?'data-lazy-interchange="'+e.$$escapeHtmlAttribute(i)+'"':'data-interchange="'+e.$$escapeHtmlAttribute(i)+'"')+'data-webm-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(a.image.id,g+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(a.image.id,g+"-xlarge","mp4"))+'"'},d.DEBUG&&(b.components.promotions.mainMediaInterchange__Ce4.soyTemplateName="tiger.components.promotions.mainMediaInterchange__Ce4")}),define("templates/tiger/components/promotions/sidebar",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.promotions.sidebar=function(a,c,d){var f="",g=d.features.fullheadline?130:73;f+='<div class="sidebar-item sidebar-module js_leftrailmodule leftrailmodule--promoted"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.url))+'" class="js_promoted-sidebar--link">'+(a.post.headlineImage&&a.post.headlineImage.src?'<span class="thumbnail-wrapper img--16x9"><span class="data-overlay hide"><ul><li class="js_promoted-sidebar--starcount hide"><span class="text"></span>'+b.icons.essential.star(null,null,d)+'</li><li class="js_promoted-sidebar--replycount hide"><span class="text"></span>'+b.icons.essential.bubble(null,null,d)+'</li><li class="js_promoted-sidebar--viewcount hide"><span class="text"></span>'+b.icons.essential.flame(null,null,d)+'</li></ul></span><img src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.headlineImage.src))+'" alt="'+e.$$escapeHtmlAttribute(a.post.headline)+'" /><span class="sponsored-overlay">Sponsored</span></span>':"");var h=""+(a.post.promotionByline&&""!=a.post.promotionByline?e.$$escapeHtml(a.post.promotionByline):a.post.author&&a.post.author.displayName?e.$$escapeHtml(a.post.author.displayName):"");f+='<div class="meta meta--source"><div class="icon--svg">'+b.icons.actions.dollar(null,null,d)+'</div><div class="byline-text"><strong>Promoted by '+e.$$filterNoAutoescape(h)+"</strong> &middot; "+(a.post.authorByline?e.$$filterNoAutoescape(window.kinja.stripHtmlTags(a.post.authorByline,"")):'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.author.screenName)+'" rel="nofollow">'+e.$$filterNoAutoescape(a.post.author.displayName)+"</a>")+'</div></div><h4 class="headline">'+e.$$filterNoAutoescape(window.kinja.truncateHtml(a.post.title,g))+"</h4>";var i=""+b.utils.relativeTime({time:a.post.publishTime},null,d);return f+='<div class="meta"><time>'+e.$$filterNoAutoescape(i)+"</time></div>"+(a.post.trackingPixel?'<img style="position:absolute" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.trackingPixel))+'" width="1" height="1">':"")+"</a></div>"},d.DEBUG&&(b.components.promotions.sidebar.soyTemplateName="tiger.components.promotions.sidebar")}),define("templates/tiger/components/invites/menu-items",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.invites.menuItems.invitePostDropdownItems=function(a,c,d){return'<li class="js_invite-to-post-manually hover-icon hide"><a href="#" rel="nofollow" class="icon--svg">'+b.icons.places.mail(null,null,d)+"Invite manually</a></li>"},d.DEBUG&&(b.components.invites.menuItems.invitePostDropdownItems.soyTemplateName="tiger.components.invites.menuItems.invitePostDropdownItems")}),define("templates/tiger/components/post/pe-list-item",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.post.pe_item=function(a,c,d){var f="",g=(a.post.isPromoted?!1:a.excerptOnly,""+e.$$escapeHtml(a.post.isBillboardPost&&a.post.showByline&&""!=a.post.byline?" billboard":"")+e.$$escapeHtml(a.sharingPost?" shared":"")+e.$$escapeHtml("true"==a.stream?" stream":""));return f+=(a.post.ads&&a.post.ads.ad16x9?b.components.ad.preroll(null,null,d):"")+'<div class="post-wrapper js_post-wrapper '+e.$$escapeHtmlAttribute(g)+'" '+(a.post.isPromoted?"data-postIdWrapper='"+e.$$escapeHtmlAttribute(a.post.id)+"' data-promotionData=\""+e.$$escapeHtmlAttribute(a.post.promotionJson)+'" data-adZone="'+e.$$escapeHtmlAttribute(a.post.adZone)+'" data-headline="'+e.$$escapeHtmlAttribute(a.post.headline)+'" data-tagUrlNames="'+e.$$escapeHtmlAttribute(a.post.tagUrlNames)+'"':"")+" >"+b.components.post.pe_article(a,null,d)+"</div>"+(a.post.ads&&a.post.ads.ad1x1&&a.post.sponsored?b.components.ad.tracker({postAdZone:a.post.adZone,postId:a.post.id},null,d):"")},d.DEBUG&&(b.components.post.pe_item.soyTemplateName="tiger.components.post.pe_item"),b.components.post.pe_article=function(a,c,d){var f="",g=""+("DRAFT"==a.post.status?"status-draft":"SCHEDULED"==a.post.status?"status-scheduled":"status-published"),h="postlist__item hentry js_post_item "+e.$$escapeHtml(g)+" post-item-"+e.$$escapeHtml(a.pageType)+(a.post.isPromoted?" js_promoted":"")+(1==a.post.isRecommended?" marquee-post":""),i=a.index&&a.index>2,j=!a.post.aboveHeadline&&a.post.leftOfHeadline;return f+='<article class="'+e.$$escapeHtmlAttribute(h)+'" data-id="'+e.$$escapeHtmlAttribute(a.post.id)+'" id="post_'+e.$$escapeHtmlAttribute(a.post.id)+'"'+(a.post.jsModelJson?' data-model="'+e.$$escapeUri(a.post.jsModelJson)+'"':"")+">"+b.components.post.secondaryByline(a,null,d)+'<header><h1 class="headline entry-title js_entry-title'+(a.post.isRecommended?" featured":"")+'"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'"'+(a.post.isPromoted?' rel="nofollow"':"")+">"+e.$$filterNoAutoescape(a.post.headline)+"</a></h1>"+b.components.post.peMeta(a,null,d)+'</header><div class="item__content'+(j?" item__content--thumb":"")+'">'+(a.post.aboveHeadline?b.components.post.media.large({lazyload:i,image:a.post.aboveHeadline,permalink:a.post.permalink,nofollow:a.post.isPromoted},null,d):a.post.leftOfHeadline?b.components.post.media.medium({lazyload:i,image:a.post.leftOfHeadline,permalink:a.post.permalink,nofollow:a.post.isPromoted},null,d):"")+'<div class="excerpt entry-summary">'+e.$$filterNoAutoescape(a.post.shortExcerpt)+"</div></div></article>"+(null==a.index||0!=a.index||a.post.sponsored||a.post.isPromoted?"":b.components.ad.mobile(null,null,d))},d.DEBUG&&(b.components.post.pe_article.soyTemplateName="tiger.components.post.pe_article"),b.components.post.secondaryByline=function(a,c,d){var f="",g=a.post&&a.post.postAction&&"REPOST"==a.post.postAction.relation,h=(a.post.sharedPost?a.post.sharedPost.replyCount:a.post.replyCount?a.post.replyCount:0,a.post.sponsored||a.post.isPromoted),i=""+(a.post.promotionByline&&""!=a.post.promotionByline?e.$$escapeHtml(a.post.promotionByline):a.post.author&&a.post.author.displayName?e.$$escapeHtml(a.post.author.displayName):""),j=a.post.sponsored;return f+="permalink"!=a.pageType?'<div class="meta--pe secondary-byline">'+(h?'<div class="meta__text">Promoted by '+e.$$escapeHtml(i)+"</div>":g?'<div class="meta__text">'+b.icons.places.sharedpostSmall(null,null,d)+" Shared from "+e.$$escapeHtml(a.post.defaultBlogName)+"</div>":"")+(j?'<div class="meta__label meta__label--sponsored">Sponsored</div>':"")+"</div>":""},d.DEBUG&&(b.components.post.secondaryByline.soyTemplateName="tiger.components.post.secondaryByline"),b.components.post.peMeta=function(a,c,d){var g="",h=a.post&&a.post.postAction&&"REPOST"==a.post.postAction.relation,i=a.post.sharedPost?a.post.sharedPost.replyCount:a.post.replyCount?a.post.replyCount:0,j=(a.post.sponsored||a.post.isPromoted,""+(a.post.promotionByline&&""!=a.post.promotionByline?e.$$escapeHtml(a.post.promotionByline):a.post.author&&a.post.author.displayName?e.$$escapeHtml(a.post.author.displayName):""),a.post.sponsored),k=""+(a.post.showByline&&""==a.post.byline&&(null==a.post.author?null:a.post.author.avatar)?"//kinja.com/"+e.$$escapeHtml(a.post.author.screenName):"");k=f.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(k);var l=a.post.byline&&""!=a.post.byline?a.post.byline:a.post.author.displayName,m=a.scheduledRepost;if(g+='<div class="meta--pe">'+("permalink"==a.pageType?'<div class="meta__avatar'+(j?" sponsored":"")+'">'+(h?b.components.post.streamMetaSharedAvatars({post:a.post,sharerAuthor:a.post.postAction.author},null,d):m?b.components.post.streamMetaSharedAvatars({post:a.post,sharerAuthor:a.scheduledRepost.author},null,d):b.components.post.streamMetaAvatar(a,null,d))+'<span class="avatar__badge avatar__badge--sponsored">'+b.icons.actions.dollarCircle(null,null,d)+"</span></div>":"")+'<div class="meta__text"><div class="meta__byline author">'+(k?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(k))+'">'+e.$$escapeHtml(l)+"</a>":e.$$escapeHtml(l))+'</div><time class="meta__time updated" datetime="'+e.$$escapeHtmlAttribute(a.post.publishTime.yMdHmsZ)+'"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'" target="_self" title="'+e.$$escapeHtmlAttribute(a.post.publishTime.Mddyyhmma)+'" '+(a.post.isPromoted?'rel="nofollow"':"")+">"+(m?"<b>Scheduled share:</b> "+e.$$escapeHtml(window.kinja.formatTime(a.scheduledRepost.repostTime,"M/dd/yy h:mma",a.post.timezone,"en-US")):"DRAFT"==a.post.status?"<b>Draft:</b> "+e.$$escapeHtml(window.kinja.formatTime(a.post.publishTime.timestamp,"M/dd/yy h:mma",a.post.timezone,"en-US")):"SCHEDULED"==a.post.status?"<b>Scheduled:</b> "+e.$$escapeHtml(window.kinja.formatTime(a.post.publishTime.timestamp,"M/dd/yy h:mma",a.post.timezone,"en-US")):b.messages.time.relativeTime({type:a.post.publishTime.relative.type,amount:a.post.publishTime.relative.amount,hmma:a.post.publishTime.hmma,day:a.post.publishTime.day,Mddyyhmma:a.post.publishTime.Mddyyhmma,timestamp:a.post.publishTime.timestamp},null,d))+"</a></time>",a.tags&&a.tags[0]){if(g+='<div class="tags-container"><a class="first-tag" href="/tag/'+e.$$escapeHtmlAttribute(a.tags[0].urlName)+'" data-urlname="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.tags[0].urlName))+"\" data-dropdown=\"taglist\" data-options=\"is_hover:true;autoalign:true;\" onclick=\"window.ga('send', 'event', 'Permalink meta', 'Tag click', 'First tag click');\">Filed to: <span>"+e.$$escapeHtml(a.tags[0].desc)+"</span>"+b.icons.essential.chevronBottom(null,null,d)+"</a>",a.tags.length>1){g+='<div id="taglist" class="tiny f-dropdown text-upper" data-dropdown-content><div><ul>';for(var n=a.tags,o=n.length,p=0;o>p;p++){var q=n[p];g+=p>=1?'<li><a href="/tag/'+e.$$escapeHtmlAttribute(q.urlName)+'" data-urlname="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(q.urlName))+"\" onclick=\"window.ga('send', 'event', 'Permalink meta', 'Tag click', 'Dropdown tag click');\">"+e.$$escapeHtml(q.desc)+"</a></li>":""}g+="</ul></div></div>"}g+="</div>"}return g+='</div><div class="meta__right"><div class="'+(d.features.newstream?"meta__data":"")+' view-count-container"></div>'+(i&&i>0?'<a class="meta__data meta__data--comment" href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'#replies">'+b.icons.essential.bubbleGiant(null,null,d)+"<span>"+e.$$escapeHtml(i)+"</span></a>":"")+'<a href="#" class="meta__data meta__data--recommend js_like icon--svg u-darkened--onhover js_like_icon" title="Recommend" data-likecount="'+e.$$escapeHtmlAttribute(null!=a.post.likes?a.post.likes:0)+'" data-analytics-target="starterTop">'+b.icons.essential.starGiant(null,null,d)+'<span class="js_like_count">'+(a.post.likes&&a.post.likes>0?e.$$escapeHtml(a.post.likes):"")+'</span></a><div class="meta__tools js_meta-tools post-dropdown-ct js_post-dropdown-ct hide">'+b.components.post.meta.postDropdown({post:a.post,mode:"post",pageType:a.pageType,blog:a.blog},null,d)+'<a href="#" target="_self" class="post-dropdown-trigger js_post-menu-toggler icon--svg u-darkened--onhover" data-dropdown="dropdown-'+e.$$escapeHtmlAttribute(a.post.id)+'">'+b.icons.essential.toolsGiant(null,null,d)+"</a></div></div></div>"},d.DEBUG&&(b.components.post.peMeta.soyTemplateName="tiger.components.post.peMeta"),b.components.post.streamMetaAvatar=function(a,c,d){var g="",h="gif"==(null==a.post.author.avatar?null:a.post.author.avatar.format)?"jpg":null==a.post.author.avatar?null:a.post.author.avatar.format,i=""+(a.post.showByline&&""==a.post.byline&&(null==a.post.author?null:a.post.author.avatar)?""+window.kinja.imageUrl(a.post.author.avatar.id,"avt-small",h):a.post.salesAvatarMap&&a.post.salesAvatarMap.id?""+window.kinja.imageUrl(a.post.salesAvatarMap.id,"avt-small",h):"");i=f.$$markUnsanitizedTextForInternalBlocks(i);var j=""+(a.post.showByline&&""==a.post.byline&&(null==a.post.author?null:a.post.author.avatar)?"//kinja.com/"+e.$$escapeHtml(a.post.author.screenName):"");j=f.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(j);a.post.byline&&""!=a.post.byline?a.post.byline:a.post.author.displayName;return g+=(j?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(j))+'" class="avatar__link"'+(a.post.isPromoted?' rel="nofollow"':"")+">":"")+(i?'<img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" />':b.icons.places.avatarBig(null,null,d))+(j?"</a>":"")},d.DEBUG&&(b.components.post.streamMetaAvatar.soyTemplateName="tiger.components.post.streamMetaAvatar"),b.components.post.streamMetaSharedAvatars=function(a,b,c){var d="",g="gif"==(null==a.post.author.avatar?null:a.post.author.avatar.format)?"jpg":null==a.post.author.avatar?null:a.post.author.avatar.format,h="gif"==(null==a.sharerAuthor.avatar?null:a.sharerAuthor.avatar.format)?"jpg":null==a.sharerAuthor.avatar?null:a.sharerAuthor.avatar.format,i=""+(a.post.showByline&&""==a.post.byline&&(null==a.post.author?null:a.post.author.avatar)?""+window.kinja.imageUrl(a.post.author.avatar.id,"avt-small",g):a.post.salesAvatarMap&&a.post.salesAvatarMap.id?""+window.kinja.imageUrl(a.post.salesAvatarMap.id,"avt-small",g):"");i=f.$$markUnsanitizedTextForInternalBlocks(i);var j=window.kinja.imageUrl(a.sharerAuthor.avatar.id,"avt-small",h),k=""+(a.post.showByline&&""==a.post.byline&&(null==a.post.author?null:a.post.author.avatar)?"//kinja.com/"+e.$$escapeHtml(a.post.author.screenName):"");k=f.VERY_UNSAFE.$$ordainSanitizedHtmlForInternalBlocks(k);var l="//kinja.com/"+a.sharerAuthor.screenName;l=f.$$markUnsanitizedTextForInternalBlocks(l);a.post.byline&&""!=a.post.byline?a.post.byline:a.post.author.displayName,a.sharerAuthor.displayName;return d+='<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(l))+'" class="avatar__link"'+(a.post.isPromoted?' rel="nofollow"':"")+">"+(a.sharerAuthor.id==a.post.author.id?'<img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" />':'<span class="avatar-wrapper sharedauthor"><img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" /></span><span class="avatar-wrapper sharingauthor"><img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(j))+'" /></span>')+'</a><div class="avatar__popover hide">'+(k?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(k))+'" class="avatar__link"'+(a.post.isPromoted?' rel="nofollow"':"")+'><img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" /></a>':i?'<img class="avatar__img" src="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(i))+'" />':"")+"</div>"},d.DEBUG&&(b.components.post.streamMetaSharedAvatars.soyTemplateName="tiger.components.post.streamMetaSharedAvatars")}),define("templates/tiger/components/post/media/medium",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.post.media.medium=function(a,c,d){var f="",g=a.image.isVideo;return f+='<figure class="asset main-media fullwidth-for-small"><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.permalink))+'"'+(a.nofollow?' rel="nofollow"':"")+'><span class="'+(g?"video-thumb-play":"")+" img-border"+(a.image.isAnimated?" lazy-gif lazy-image ":a.lazyload?" lazy-image":"")+'">'+b.components.post.media.mainMediaImage({cropName:g?"centered":"default",image:a.image,lazyload:a.lazyload,animated:a.image.isAnimated},null,d)+(g?'<span class="play-icon">'+b.icons.actions.playIcon(null,null,d)+"</span>":"")+"</span></a></figure>"},d.DEBUG&&(b.components.post.media.medium.soyTemplateName="tiger.components.post.media.medium"),b.components.post.media.mainMediaImage=function(a,c,d){var f="",g=""+b.utils.cropType({name:a.cropName},null,d),h=a.image.isAnimated,i=a.image.height?a.image.height:74,j=a.image.width?a.image.width:132,k=h?a.image.frozenFormat:a.image.format,l=""+e.$$escapeHtml(window.kinja.imageUrl(a.image.id,g+"Medium",k)),m=h&&a.lazyload;return f+='<img src="'+(a.lazyload?"data:image/svg+xml;charset=utf-8,%3Csvg xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg' viewBox%3D'0 0 "+e.$$escapeHtmlAttribute(j)+" "+e.$$escapeHtmlAttribute(i)+"'%2F%3E":e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(l)))+'"'+(m?'data-src="'+e.$$escapeHtmlAttribute(l)+'"':"")+b.components.post.media.mainMediaInterchange__Ce4(a,null,d)+(h?b.components.post.media.mainMediaInterchange__Ce4(e.$$augmentMap(a,{animated:!0}),null,d):"")+"/>"},d.DEBUG&&(b.components.post.media.mainMediaImage.soyTemplateName="tiger.components.post.media.mainMediaImage"),b.components.post.media.mainMediaInterchange=function(a,c,d){var f="",g=""+b.utils.cropType({name:a.cropName},null,d),h=""+(a.animated?e.$$escapeHtml(a.image.format):e.$$escapeHtml(a.image.frozenFormat)),i="["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (default)], ["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (small)], ["+window.kinja.imageUrl(a.image.id,g+"Medium",h)+", (medium)], ["+(d.features.facethumbs?window.kinja.imageUrl(a.image.id,"KinjaThumb",h):window.kinja.imageUrl(a.image.id,g+"Small",h))+", (large)]";return f+=(a.animated?'data-anim-interchange="'+e.$$escapeHtml(i)+'"':a.lazyload?'data-lazy-interchange="'+e.$$escapeHtml(i)+'"':'data-interchange="'+e.$$escapeHtml(i)+'"')+(d.features.webm?'data-webm-src="'+e.$$escapeHtml(window.kinja.imageUrl(a.image.id,g+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtml(window.kinja.imageUrl(a.image.id,g+"-xlarge","mp4"))+'"':"")},d.DEBUG&&(b.components.post.media.mainMediaInterchange.soyTemplateName="tiger.components.post.media.mainMediaInterchange"),b.components.post.media.mainMediaInterchange__Ce4=function(a,c,d){var f="",g=""+b.utils.cropType__Ce4({name:a.cropName},null,d),h=""+(a.animated?e.$$filterHtmlAttributes(a.image.format):e.$$filterHtmlAttributes(a.image.frozenFormat)),i="["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (default)], ["+window.kinja.imageUrl(a.image.id,g+"ExtraLarge",h)+", (small)], ["+window.kinja.imageUrl(a.image.id,g+"Medium",h)+", (medium)], ["+(d.features.facethumbs?window.kinja.imageUrl(a.image.id,"KinjaThumb",h):window.kinja.imageUrl(a.image.id,g+"Small",h))+", (large)]";return f+=(a.animated?'data-anim-interchange="'+e.$$escapeHtmlAttribute(i)+'"':a.lazyload?'data-lazy-interchange="'+e.$$escapeHtmlAttribute(i)+'"':'data-interchange="'+e.$$escapeHtmlAttribute(i)+'"')+(d.features.webm?'data-webm-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(a.image.id,g+"-xlarge","webm"))+'" data-mp4-src="'+e.$$escapeHtmlAttribute(window.kinja.imageUrl(a.image.id,g+"-xlarge","mp4"))+'"':"")},d.DEBUG&&(b.components.post.media.mainMediaInterchange__Ce4.soyTemplateName="tiger.components.post.media.mainMediaInterchange__Ce4")}),define("module/promotions/promotions.itemview",["jquery","underscore","backbone.marionette","singleton/EventDispatcher","singleton/Feature","singleton/Renderer","module/promotions/promotions.model","templates/tiger/utils/crop-type","templates/tiger/components/promotions/post","templates/tiger/components/promotions/sidebar","templates/tiger/components/invites/menu-items","templates/tiger/components/post/pe-list-item","templates/tiger/components/post/media/medium","templates/tiger/utils/relative-time","templates/tiger/section/sidebar","templates/tiger/messages"],function(a,b,c,d,e,f,g){"use strict";var h=c.ItemView.extend({model:g,template:e.isOn("newstream")?tiger.components.post.pe_item:tiger.components.promotions.post,readMorePlaceholder:'<span class="read-more-placeholder"></span></p>',$container:null,className:"post-wrapper js_post-wrapper",ui:{headline:".headline",excerpt:".package",promotedSidebarLink:".js_promoted-sidebar--link",dataOverlay:".data-overlay",starCount:".js_promoted-sidebar--starcount",replyCount:".js_promoted-sidebar--replycount",viewCount:".js_promoted-sidebar--viewcount"},modelEvents:{"change:starCount":"updateDataOverlay","change:replyCount":"updateDataOverlay","change:viewCount":"updateDataOverlay"},events:{"click @ui.headline":"onPostClicked","click @ui.promotedSidebarLink":"onPostClicked","click @ui.excerpt":"onPostClicked"},initialize:function(a){var b="",c=a.innerEl,d=this.model.get("zoneType");this.$container=c.closest(".ad-promotions-container"),d&&"PROMOTION_SIDEBAR"===d&&(this.template=tiger.components.promotions.sidebar),b=this.$container.data("mobile")?"show-for-medium-down":"hide-for-medium-down animate-slidedown animate-closed",this.$el.addClass(b)},serializeData:function(){var a;return e.isOn("newstream")?(a=this.model.toSoyData(),a.post.headline=a.post.title,a.post.byline=a.post.authorByline,a.post.leftOfHeadline=a.post.headlineImage,a.post.permalink=a.post.url):(this.injectReadMorePlaceholder(),a=this.model.toSoyData()),a},injectReadMorePlaceholder:function(){var a=this.model.get("shortExcerpt");a&&(a=a.replace(/<\/p>$/,this.readMorePlaceholder),this.model.set({shortExcerpt:a}))},onPostClicked:function(b){var c,d=a(b.target);(!d.attr("href")||d.hasClass("js_read-more"))&&(b.preventDefault(),c=this.constructPermalink(),window.location.href=c)},updateDataOverlay:function(a,c){var d,e=b.keys(this.model.changedAttributes())[0],g=this.ui[e];g&&c>0&&(d=f.renderTemplate(tiger.section.sidebar.numberFormat,{number:c}),g.find(".text").html(d),g.removeClass("hide"),this.ui.dataOverlay.removeClass("hide"))},constructPermalink:function(){var a,b=window.location.protocol+"//"+window.location.host,c=this.model.get("dfpTracker"),d=this.model.get("permalinkPath");return a=c+b+d},onRender:function(){this.$container.before(this.el),this.$el.removeClass("animate-closed"),d.trigger("update.postlist.post",{el:this.$el})}});return h}),define("module/promotions/promotions.controller",["jquery","module/ads/ads.events","module/promotions/promotions.model","module/promotions/promotions.itemview"],function(a,b,c,d){"use strict";var e={views:[],_startPromotions:function(){window.location.search.match(/startTime/)||this._registerEvents()},_registerEvents:function(){b.on("ads.zonedisplayed",this.onPromotionAdded,this),b.on("ads.forcedisplay",this._renderPromotedPost)},onPromotionAdded:function(a){var b=a.model.get("zoneType");("PROMOTION"===b||"PROMOTION_MOBILE"===b||"PROMOTION_SIDEBAR"===b)&&e.renderPromotedPost(a)},renderPromotedPost:function(a){var b,c=this.getPromotedPost(a);c&&(b=new d({innerEl:a.$el.closest(".js_ad-promotion"),model:c}),b.render(),this.views.push(b))},_renderPromotedPost:function(){var b,c=a(".js_ad-promotion-desktop iframe").first(),f=e._getPromotedPost(c);f&&(b=new d({innerEl:c.closest(".js_ad-promotion"),model:f}),b.render(),e.views.push(b))},getPromotedPost:function(a){var b,d,e=this,f=a.$el.find("div > iframe");return f.length>0&&(d=e.extractPromotionData(f),d&&(d.zoneType=a.model.get("zoneType"),b=new c(d,{parse:!0}))),b},_getPromotedPost:function(a){var b,d,f=a;return f.length>0&&(d=e.extractPromotionData(f),d&&(b=new c(d,{parse:!0}))),b},parseJsonFuture:function(a){var b;try{return a=a.replace(/"\\&quot;/gm,'\\"'),a=a.replace(/\\&quot;/gm,"\\"),b=JSON.parse(a)}catch(c){return window.console.warn("parseJsonFuture failed for promoted post, trying parseJsonV4 next"),this.parseJsonV4(a)}},parseJsonV4:function(a){var b;try{return b=JSON.parse(a)}catch(c){return window.console.warn("parseJsonV4 failed for promoted post, trying native parseJson next"),this.parseJson(a)}},parseJson:function(a){var b;a=a.replace(/"\\&quot;/gm,'\\"'),a=a.replace(/\\&quot;/gm,"\\");try{b=JSON.parse(a)}catch(c){window.console.error("Unable to parse JSON string of promoted post"),window.console.error(a),window.console.error(c)}return b},getJsonVersion:function(a){var b,c;return b=a.match(/"version"\:\s*"([0-9]+)"/),c=null!==b&&2===b.length?parseInt(b[1],10):0},cleanJsonString:function(a){var b,c,d,e=a;if(c=a.match(/<a href="tel:[0-9]+">[0-9]+<\/a>/gi),d=c?c.length:0)try{for(b=0;d>b;b++)e=e.replace(c[b],c[b].match(/([0-9]+)/)[0])}catch(f){window.console.warn("Error while cleaning json string for promoted post"),window.console.warn(f)}return e},extractPromotionData:function(b){var c,d,e,f,g;return c=a(b).contents().find("body").html(),d=c.search(/<script/),e=c.slice(0,d),g=this.getJsonVersion(e),e=this.cleanJsonString(e),""===e?!1:f=g>=6?this.parseJsonFuture(e):g>=4?this.parseJsonV4(e):this.parseJson(e)},API:{startPromotions:function(){e._startPromotions()},forcedisplay:function(){b.trigger("ads.forcedisplay")}}};return window.kinjaads=window.kinjaads||{},window.kinjaads.queue=window.kinjaads.queue||[],window.kinjaads.forcedisplay=e.API.forcedisplay,e.API}),define("templates/tiger/components/post/meta/meta-components",["overlord","tiger","mantle","lib/amd-wrapped/soy/goog","lib/amd-wrapped/soy/soy","lib/amd-wrapped/soy/soydata"],function(a,b,c,d,e,f){b.components.post.meta.byline=function(a,b,c){var d=""+("repost"==a.mode&&a.reposter?e.$$escapeHtml(a.reposter.displayName)+' <span class="text-italic">shared a post by</span> '+(""==a.post.byline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.author.screenName)+'" class="text-light fn url"'+(a.post.isPromoted?' rel="nofollow"':"")+">"+e.$$escapeHtml(a.post.author.displayName)+"</a>":e.$$escapeHtml(window.kinja.stripHtmlTags(a.post.byline,""))):"");if(a.post.showByline&&(!a.post.postAction||!a.post.postAction.author)&&"repost"!=a.mode){if(d+='<span class="display-name author vcard">'+(""==a.post.byline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.author.screenName)+"\" onclick=\"window.ga('send', 'event', 'byline', 'click', "+(a.pageType?" '"+e.$$escapeHtmlAttribute(e.$$escapeJsString(a.pageType))+"' ":" 'private'")+');" '+(a.post.isPromoted?' rel="nofollow"':"")+' class="fn url">'+e.$$escapeHtml(a.post.author.displayName)+"</a>":e.$$escapeHtml(window.kinja.stripHtmlTags(a.post.byline,"")))+"</span>",a.post.allowReplies&&"reply"!=a.mode){var f=a.post.sharedPost?a.post.sharedPost.replyCount:a.post.replyCount?a.post.replyCount:0;d+=f&&f>0?' <a href="'+("permalink"!=a.pageType?e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink)):"")+'#replies" class="text-light" rel="nofollow">'+(1==f?"and "+e.$$escapeHtml(f)+" other":"and "+e.$$escapeHtml(f)+" others")+"</a>":""}d+="reply"==a.mode&&a.post.replyMeta.parentAuthor?'&nbsp;replied to a post by&nbsp;<span class="strong">'+(""==a.post.replyMeta.parentByline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.replyMeta.parentAuthor.screenName)+'" class="text-light fn url"'+(a.post.isPromoted?' rel="nofollow"':"")+">"+e.$$escapeHtml(a.post.replyMeta.parentAuthor.displayName)+"</a>":e.$$escapeHtml(a.post.replyMeta.parentByline))+"</span>":""}return d+=(a.post.postAction&&a.post.postAction.author&&"repost"!=a.mode?e.$$escapeHtml(a.post.postAction.author.displayName)+' <span class="text-italic">'+("shared-reply"==a.mode?"shared a reply by":"shared a post by")+'</span> <span class="author vcard">'+(""==a.post.byline?'<a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.author.screenName)+'" class="text-light fn url"'+(a.post.isPromoted?' rel="nofollow"':"")+">"+e.$$escapeHtml(a.post.author.displayName)+"</a>":e.$$escapeHtml(window.kinja.stripHtmlTags(a.post.byline,"")))+"</span>":"")+("profileposts"==a.pageType?'<p class="posted-on-blog">posted on<a href="//'+e.$$escapeHtmlAttribute(a.post.defaultBlogHost)+'"> '+e.$$escapeHtml(a.post.defaultBlogName)+"</a></p>":"");
},d.DEBUG&&(b.components.post.meta.byline.soyTemplateName="tiger.components.post.meta.byline"),b.components.post.meta.topByline=function(a,c,d){var f="";if(a.post.showByline)if(""==a.post.byline){f+='<span class="display-name author vcard"><a href="//kinja.com/'+e.$$escapeHtmlAttribute(a.post.author.screenName)+'" target="_self" '+(a.post.isPromoted?'rel="nofollow"':"")+" class=\"fn url\" onclick=\"window.ga('send', 'event', 'byline', 'click', 'permalink');\" >"+e.$$escapeHtml(a.post.author.displayName)+"</a>";var g=(null==d.replyData?null:d.replyData.atUser)==a.post.authorBlogName;if(f+=(g?'<span class="moderator-name">, Host</span>':"")+("reply"==a.mode&&(null==a.post.replyMeta?null:null==a.post.replyMeta.parentAuthor?null:a.post.replyMeta.parentAuthor.displayName)?'<span class="reply-author replyto-author"><span class="icon--svg u-downsized">'+b.icons.essential.chevronRight(null,null,d)+"</span>"+((null==a.post.replyMeta?null:a.post.replyMeta.showParentByline)&&""!=(null==a.post.replyMeta?null:a.post.replyMeta.parentByline)?e.$$escapeHtml(window.kinja.stripHtmlTags(a.post.replyMeta.parentByline,"")):e.$$escapeHtml(a.post.replyMeta.parentAuthor.displayName))+"</span>":"")+(a.contributors?' <span class="text-normal text-tiny">'+(1==a.contributors?"and 1 other":a.contributors>1?"and "+e.$$escapeHtml(a.contributors)+" others":"")+"</span>":"")+"</span>",a.blog&&a.post.isStarter&&a.post.defaultBlogId!=a.post.author.defaultBlogId&&a.post.defaultBlogId!=a.blog.id||a.forSharedPost){f+='<span class="published-on">';for(var h=a.post.blogs,i=h.length,j=0;i>j;j++){var k=h[j];f+=k.id==a.post.defaultBlogId?' on <a class="blog-name" href="http://'+e.$$escapeHtmlAttribute(k.canonicalHost)+'" target="_self" '+(a.post.isPromoted?'rel="nofollow"':"")+">"+e.$$escapeHtml(k.displayName)+"</a>":""}f+="</span>"}}else f+='<span class="display-name">'+e.$$escapeHtml(window.kinja.stripHtmlTags(a.post.byline,""))+"</span>";return f+=a.post.postAction&&a.post.postAction.author&&a.post.postAction.author.displayName?'<span class="reposted-by">shared by <span class="text-upper">'+e.$$escapeHtml(a.post.postAction.author.displayName)+"</span></span>":""},d.DEBUG&&(b.components.post.meta.topByline.soyTemplateName="tiger.components.post.meta.topByline"),b.components.post.meta.promotedByline=function(a,c,d){var f='<span class="meta-promoted"><span class="promoted-dot">&middot;</span> '+(a.post.sponsored||a.post.isBillboardPost?'<span class="sponsored-label text-upper">Sponsored</span><span class="icon--svg">'+b.icons.essential.starCircle(null,null,d)+"</span>":"");if(a.post.isPromoted){var g=""+(a.post.promotion&&a.post.promotion.byline&&""!=a.post.promotion.byline?e.$$escapeHtml(a.post.promotion.byline):a.post.promotion&&a.post.promotion.authorDisplayName?e.$$escapeHtml(a.post.promotion.authorDisplayName):"");f+='Promoted by <span class="js_promoted_displayName">'+e.$$filterNoAutoescape(g)+"</span>"}return f+="</span>"},d.DEBUG&&(b.components.post.meta.promotedByline.soyTemplateName="tiger.components.post.meta.promotedByline"),b.components.post.meta.publishTime=function(a,c,d){return'<span class="publish-time js_publish_time" data-publishtime="'+e.$$escapeHtmlAttribute(a.post.publishTimeMillis)+'">'+(a.post.postAction&&a.post.postAction.createTime?'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'" target="_self" '+(a.post.isPromoted?'rel="nofollow"':"")+(a.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(a.post.postAction.createTime.Mddyyhmma)+'"':"")+">"+(a.showRelativeTime?b.components.post.meta.relativeTime({time:a.post.postAction.createTime},null,d):"")+'<span class="'+(a.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(a.post.postAction.createTime.Mddyyhmma)+"</span></a>":a.post.publishTime?"SCHEDULED"==a.post.status?'Scheduled:<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'" target="_self" '+(a.post.isPromoted?'rel="nofollow"':"")+(a.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(a.post.publishTime.Mddyyhmma)+'"':"")+">"+(a.showRelativeTime?b.components.post.meta.relativeTime({time:a.post.publishTime},null,d):"")+'<span class="'+(a.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(a.post.publishTime.Mddyyhmma)+'</span></a><span class="icon--svg u-prepended">'+b.icons.actions.clock(null,null,d)+"</span>":"DRAFT"==a.post.status?'Draft<span class="icon--svg u-prepended">'+b.icons.actions.write(null,null,d)+'</span><a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'" target="_self" '+(a.post.isPromoted?'rel="nofollow"':"")+(a.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(a.post.publishTime.Mddyyhmma)+'"':"")+">"+(a.showRelativeTime?b.components.post.meta.relativeTime({time:a.post.publishTime},null,d):"")+'<span class="'+(a.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(a.post.publishTime.Mddyyhmma)+"</span></a>":'<a href="'+e.$$escapeHtmlAttribute(e.$$filterNormalizeUri(a.post.permalink))+'" target="_self" '+(a.post.isPromoted?'rel="nofollow"':"")+(a.showRelativeTime?' title="'+e.$$escapeHtmlAttribute(a.post.publishTime.Mddyyhmma)+'"':"")+">"+(a.showRelativeTime?b.components.post.meta.relativeTime({time:a.post.publishTime},null,d):"")+'<span class="'+(a.showRelativeTime?"hide ":"")+'published updated">'+e.$$escapeHtml(a.post.publishTime.Mddyyhmma)+"</span></a>":"")+"</span>"},d.DEBUG&&(b.components.post.meta.publishTime.soyTemplateName="tiger.components.post.meta.publishTime"),b.components.post.meta.avatarContainer=function(a,c,d){var e="",f="avt-small";if(a.post.showByline&&""==a.post.byline&&(null==a.post.author?null:a.post.author.avatar)){var g="gif"==a.post.author.avatar.format?"jpg":a.post.author.avatar.format;e+=b.components.post.meta.avatarDisplay({url:"//kinja.com/"+a.post.author.screenName,avatar:window.kinja.imageUrl(a.post.author.avatar.id,f,g),nofollow:a.post.isPromoted},null,d)}else e+=a.post.salesAvatarMap&&a.post.salesAvatarMap.id?b.components.post.meta.avatarDisplay({avatar:window.kinja.imageUrl(a.post.salesAvatarMap.id,f)},null,d):b.components.post.meta.avatarDisplay(null,null,d);return e},d.DEBUG&&(b.components.post.meta.avatarContainer.soyTemplateName="tiger.components.post.meta.avatarContainer"),b.components.post.meta.postInfo=function(a,c,d){return'<span class="meta-tools"><div class="view-count-container"></div><a data-likecount="'+e.$$escapeHtmlAttribute(null!=a.post.likes?a.post.likes:0)+'" href="#" data-analytics-target="starterTop" class="js_like button-recommend-post hover-icon icon--svg u-darkened--onhover js_like_icon" title="Recommend"><span class="js_like_count">'+(a.post.likes&&a.post.likes>0?e.$$escapeHtml(a.post.likes):"")+"</span>"+b.icons.essential.star(null,null,d)+"</a></span>"},d.DEBUG&&(b.components.post.meta.postInfo.soyTemplateName="tiger.components.post.meta.postInfo"),b.components.post.meta.postViewCount=function(a,c,d){return""+(a.isBlip&&!a.isBillboardPost||a.forSharedPost?"":a.viewstats&&a.viewstats.nonUniqueFormatted&&"0"!=a.viewstats.nonUniqueFormatted&&("permalink"==a.pageType||"dashboard"==a.pageType||"manageblog"==a.pageType)?(d.features.newstream?b.icons.essential.flameGiant(null,null,d):"")+'<span class="view-count '+(d.features.newstream?"":"icon--svg")+'" '+(a.viewstats.uniqueFormatted?' title="'+e.$$escapeHtmlAttribute(a.viewstats.uniqueFormatted)+' New Visitors"':"")+">"+e.$$escapeHtml(a.viewstats.nonUniqueFormatted)+(d.features.newstream?"":b.icons.essential.flame(null,null,d))+"</span>":"")},d.DEBUG&&(b.components.post.meta.postViewCount.soyTemplateName="tiger.components.post.meta.postViewCount")}),define("module/PostApp",["jquery","underscore","singleton/Utils","singleton/CurrentUser","singleton/CurrentBlog","singleton/Feature","singleton/IframeResizer","module/BaseApp","module/KinjaAnalytics","app/MarionetteApp","app/AnnotationApplet","app/mixins/PostViewLoader","app/mixins/RecommendAssetMixin","model/post/Post","view/GifImageLoader","lib/sha1","gawkerlib/urlUtil","view/sharingfooter.view","singleton/WindowController","module/promotions/promotions.controller","app/leftrail/leftrailContainedList.view","module/ads/ads.events","lib/jquery.cookie","templates/tiger/components/post/meta/meta-components","templates/tiger/section/sidebar"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";var w,x=h.extend(b.extend({},l,m,{starterPost:null,initApp:function(){h.prototype.initApp.call(this),this.starterPost=new n(c.getKinjaMeta().post),this.initPostTools(this.starterPost.id),this.imageLoader=new o({el:document}),a(".js_ad-mobile-second").length&&a(".js_ad-mobile-waypoint").length&&s.isSmall()&&a(".js_ad-mobile-waypoint").waypoint({handler:function(b){"down"===b&&v.trigger("ads.dynamicad.load",a(".js_ad-mobile-second .js_ad-container"),"MOBILE_SECOND")},offset:"50%",triggerOnce:!0})},start:function(){var h,i=e.blogGroup||"default";f.isOn("delaydiscussion")&&!c.isCommentPermalinkPage()?s.registerWaypointWithTimeout(a(j.discussionRegion.el),"150%",this.startDiscussionApplet.bind(this),1e4):this.startDiscussionApplet(),this.startAnnotations(),f.isOn("nosocialscripts")||s.registerWaypointWithTimeout(a(".fb-like"),"150%",this.loadFacebook.bind(this),3e3),this.startAmazonStats(),this.startAmazonTextLinksWithSha(),this.insertViewstats(),f.isOn("no3rdparty")||((f.isOn("moatads_promoted")||f.isOn("moatads_headertag"))&&this.insertMoatAdScript(),(f.isOn("taboola")||f.isOn("only_taboola"))&&this.addTaboola()),d.onLoggedIn.done(b.bind(this.initAssetRecommendation,this)),f.isOn("analyticstracking")&&this.initPermalinkViewTracking(),g.start(),f.isOn("post_completion")&&this.trackPostCompletion(),t.startPromotions(),h=a("#sharingfooter"),h.length>0&&(this.sharingfooter=new r({el:h,model:this.starterPost})),window.markUserTime("JS - After PostApp start - "+(f.isOn("webpack")?"Webpack":"Require")+" - "+i)},initLeftrailContained:function(){var c;f.isOn("personalized_trending_module")||f.isOn("trending_test_c")?a.ajax("//kinja.com/api/analytics/kala/recommendedPostsForUser",{xhrFields:{withCredentials:!0},crossDomain:!0}).done(function(d){var e=d.data||[],f="?"+e.map(function(a){return"id="+a}).join("&");a.ajax("/api/core/corepost/getList"+f).done(function(d){var e=d.data||[],f=e.map(function(c){return a.extend(c,{authorNameOrByline:c.author.displayName||c.byline,image:c.sharingMainImage||(c.images||[])[0],defaultBlogName:(b.find(c.blogs,function(a){return a.id===c.defaultBlogId})||{}).displayName})}).slice(0,3);c=new u({el:".js_sidebar",trendingPosts:f.length>2?f:void 0}),c.render()})}).fail(function(){c=new u({el:".js_sidebar"}),c.render()}):(c=new u({el:".js_sidebar"}),c.render())},startDiscussionApplet:function(){return require(["module/DiscussionIconModule"],function(){}),this.shouldLoadReplies()&&require(["module/DiscussionModule"],function(a){j.discussionRegion.show(a)}),!1},shouldLoadReplies:function(){return!(this.starterPost.get("allowReplies")===!1&&0===this.starterPost.get("replyCount"))},startAnnotations:function(){new k({model:this.starterPost,el:a("body")}).startApp()},startAmazonStats:function(){var b=this;d.onLoggedIn.done(function(){d.hasPermission("SALES")&&"on"===c.getParameterByName("amazonstats")&&require(["module/AmazonStats"],function(c){var d=a(".post-wrapper article.post"),e=new c({postId:b.starterPost.id});d.prepend(e.$el)})}.bind(this))},startAmazonTextLinks:function(){if(""===document.referrer)return!1;var c=b.filter(a(".post-content a"),function(b){return!!a(b).data("amazontag")}),d=document.referrer.match(/:\/\/([^/]+)\//);null!==d&&(d=d[1],b.each(c,function(b){var c=a(b).attr("href").replace("&ascsubtag=","&ascsubtag=[r|"+d);a(b).attr("href",c)}))},startAmazonTextLinksWithSha:function(){var c=function(a){var b=new p(a,"TEXT");return b.getHash("SHA-1","HEX")},d=function(a){var b=document.referrer;return""===b?a:"[r|"+b+a},e=function(a){return a.split("?")[0]},f=function(a){return q.fromQueryString(a.split("?")[1])},g=function(a){var b=f(a),c=b.ascsubtag;return b.rawdata=c,e(a)+q.toQueryString(b)},h=function(){return b.filter(a(".post-content a"),function(b){return!!a(b).data("amazontag")})},i=function(a){var b=f(a),c=b.rawdata;return c},j=function(a,b){var c=e(b),d=f(b),g=d.ascsubtag,h=a(g);return d.ascsubtag=h,c+q.toQueryString(d)},k=function(a){return j(d,a)},l=function(a){return j(c,a)},m=function(b){a(b).click(function(){var d=i(a(b).attr("href")),e=encodeURIComponent(d);a.ajax("/api/ecommerce/amazon/putSubtag?data="+e,{type:"GET",error:function(a){require(["module/Raven"],function(Raven){Raven.captureMessage("Analytics: Could not send subtag",{extra:{subtag:d,subtagSha:c(d),analyticsResponse:a.status,analyticsResponseStatusText:a.statusText,analyticsResponseText:a.responseText}})})}})})},n=function(b,c){var d=String(a(c).attr("href")),e=b(d);return a(c).attr("href",e),e},o=function(a){n(b.compose(l,g,k),a)};b.forEach(h(),function(a){o(a),m(a)})},initUserTools:function(){var a,b=this.options.id;c.getKinjaMeta().post&&c.getKinjaMeta().post.id!==this.options.id&&(b=c.getKinjaMeta().post.id),a=new n({id:b})},trackPostCompletion:function(){var c=a(window),d=a(".post-bottom").offset().top,e=function(){var a=c.height(),b=a+c.scrollTop();b>d&&(window.ga("send","event","post completion","post completion",{nonInteraction:1}),c.off("scroll.postCompletion"))};c.on("scroll.postCompletion",b.throttle(e,1e3))},insertMoatAdScript:function(){if(!c.getKinjaMeta().post.sponsored)return!1;var b=['<script type="text/javascript">',"(function(){",'var a=document,b=a.createElement("script"),a=a.getElementsByTagName("script")[0];','b.type="text/javascript";b.async=!0;','b.src="http://js.moatads.com/gawkersppage4859385728/moatcontent.js";',"a.parentNode.insertBefore(b,a)","})();","</script>"];a("body").append(b.join(""))},initAssetRecommendation:function(){var a=new n(c.getKinjaMeta().post),b=d.hasRole("ADMIN",a.get("defaultBlogId")),e=d.isSuperuser()&&f.isOn("superuser");(b||e)&&this.startRecommendAssetMixin(a)},insertViewstats:function(){var b=this,c=this.starterPost.get("id"),d=this.options.id,e=new n({id:c}),f=function(a,c){var d=b.soyToHtml(tiger.components.post.meta.postViewCount,{isBlip:e.get("isBlip"),isBillboardPost:e.get("isBillboardPost"),viewstats:a});b.$el.find(".view-count-container").eq(c).html(d)},g=function(a){return a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},h=function(b,c){a.ajax("/api/analytics/kala/viewsForPost?id="+b).done(function(a){var b=a.data[0]||{},d=g(b.views||0),e=g(b.uniqueViews||0);b.nonUniqueFormatted=d,b.uniqueFormatted=e,f(b,c)})};c!==d?(h(c,0),h(d,1)):h(c,0)},initPermalinkViewTracking:function(){var b=this.starterPost.get("id"),c=a(".js_stats").data("unique")||!1,f=a("#analytics-permalink-view").data(),g=f.authorId,h=(f.tagIds||"").toString().split(",");i.setContext(e.id,"PERMALINK",b),i.pushEvent("PERMALINK_VIEW","POST",b,{blogName:e.canonicalHost,unique:c,authorId:g.toString(),isLoggedIn:d.isLoggedIn()?1:0},{tagIds:h})},loadFacebook:function(){a.getScript("https://connect.facebook.net/en_US/sdk.js",function(){window.fbAsyncInit=function(){window.FB.init({appId:c.getKinjaMeta().blog&&c.getKinjaMeta().blog.fbAppId?c.getKinjaMeta().blog.fbAppId:"36368793975",version:"v2.0",status:!0,cookie:!0,xfbml:!0})}})},addTaboola:function(){var a=this.starterPost.get("sponsored"),b="Below Article Thumbnails Organic",c=window.parseInt(f.value("discussion_truncation")||0,10);c&&(b+=" - "+c+" Threads"),window._taboola=window._taboola||[],window._taboola.push({article:"auto"}),window._taboola.push({mode:a?"organic-thumbnails-a":"thumbnails-a",container:"taboola-below-article-thumbnails",placement:b,tracking:"utm_source=taboola",target_type:"mix"})}}));return w=parseInt(c.getKinjaMeta().postId,10),"permalink"!==c.getKinjaMeta().pageType||isNaN(w)?!1:new x({id:w}).start()});