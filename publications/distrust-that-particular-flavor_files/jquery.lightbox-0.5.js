define(["jquery"],function(e){e.fn.lightBox=function(t){t=e.extend({overlayBgColor:"#000",overlayOpacity:.85,fixedNavigation:!1,containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:" / ",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},t);var v=this;function g(){return p(this,v),!1}function p(i,o){var s,r,a=e(i).siblings("span").find("img");if(e("embed, object, select").css({visibility:"hidden"}),h(),t.imageArray.length=0,t.activeImage=0,o.length==1)t.imageArray.push(new Array(a.attr("data-original-src"),i.getAttribute("title")));else for(s=0;s<o.length;s++)r=o.eq(s).siblings("span").find("img"),t.imageArray.push(new Array(r.attr("data-original-src"),o[s].getAttribute("title")));for(;t.imageArray[t.activeImage][0]!=a.attr("data-original-src");)t.activeImage++;n()}function h(){e("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber" class="proxima"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose" class="icon--svg svg-icon--white u-giant u-full--onhover"><svg class="svg-icon svg-close"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#iconset-close"></use></svg></a></div></div></div><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div></div></div>');var a,n=i();e("#jquery-overlay").css({backgroundColor:t.overlayBgColor,opacity:t.overlayOpacity,width:n[0],height:n[1]}).fadeIn(),a=o(),e("#jquery-lightbox").css({top:a[1]+n[3]/10,left:a[0]}).show(),e("#jquery-overlay,#jquery-lightbox").click(function(){s()}),e("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){return s(),!1}),e(window).resize(function(){var n,t=i();e("#jquery-overlay").css({width:t[0],height:t[1]}),n=o(),e("#jquery-lightbox").css({top:n[1]+t[3]/10,left:n[0]})})}function n(){t.fixedNavigation?e("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide():e("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var n=new Image;n.onload=function(){e("#lightbox-image").attr("src",t.imageArray[t.activeImage][0]),d(n.width,n.height),n.onload=function(){}},n.src=t.imageArray[t.activeImage][0],t.activeImage>-1}function d(n,i){e("#lightbox-container-image-box").hide();var a=e("#lightbox-container-image-box").width(),l=e("#lightbox-container-image-box").height(),s=n+t.containerBorderSize*2,o=i+t.containerBorderSize*2,d=a-s,u=l-o;e("#lightbox-container-image-box").css({width:s,height:o}),c(),d==0&&u==0&&(e.browser.msie?r(250):r(100)),e("#lightbox-container-image-data-box").css({width:n+20})}function c(){e("#lightbox-image").fadeIn(function(){l(),b(),e("#lightbox-container-image-box").show()}),f()}function l(){e("#lightbox-container-image-data-box").slideDown("fast"),e("#lightbox-image-details-caption").hide(),t.imageArray[t.activeImage][1]&&e("#lightbox-image-details-caption").html(t.imageArray[t.activeImage][1]).show(),t.imageArray.length>1}function b(){t.activeImage!=0?t.fixedNavigation?e("#lightbox-nav-btnPrev").unbind().html('<span class="button-box"><span class="icon icon-white icon-chevron-left"></span></span>').bind("click",function(){return t.activeImage=t.activeImage-1,n(),!1}):e("#lightbox-nav-btnPrev").unbind().hover(function(){e(this).html('<span class="button-box"><span class="icon icon-white icon-chevron-left"></span></span>')},function(){e(this).html('')}).show().bind("click",function(){return t.activeImage=t.activeImage-1,n(),!1}):e("#lightbox-nav-btnPrev").html(''),t.activeImage!=t.imageArray.length-1?t.fixedNavigation?e("#lightbox-nav-btnNext").unbind().html('<span class="button-box"><span class="icon icon-white icon-chevron-right"></span></span>').bind("click",function(){return t.activeImage=t.activeImage+1,n(),!1}):e("#lightbox-nav-btnNext").unbind().hover(function(){e(this).html('<span class="button-box"><span class="icon icon-white icon-chevron-right"></span></span>')},function(){e(this).html('')}).show().bind("click",function(){return t.activeImage=t.activeImage+1,n(),!1}):(e("#lightbox-nav-btnNext").unbind(),e("#lightbox-nav-btnNext").html('')),u()}function u(){e(document).keydown(function(e){m(e)})}function a(){e(document).unbind()}function m(e){e==null?(keycode=event.keyCode,escapeKey=27):(keycode=e.keyCode,escapeKey=e.DOM_VK_ESCAPE||27),key=String.fromCharCode(keycode).toLowerCase(),(key==t.keyToClose||key=="x"||keycode==escapeKey)&&s(),(key==t.keyToPrev||keycode==37)&&t.activeImage!=0&&(t.activeImage=t.activeImage-1,n(),a()),(key==t.keyToNext||keycode==39)&&t.activeImage!=t.imageArray.length-1&&(t.activeImage=t.activeImage+1,n(),a())}function f(){t.imageArray.length-1>t.activeImage&&(objNext=new Image,objNext.src=t.imageArray[t.activeImage+1][0]),t.activeImage>0&&(objPrev=new Image,objPrev.src=t.imageArray[t.activeImage-1][0])}function s(){e("#jquery-lightbox").remove(),e("#jquery-overlay").fadeOut(function(){e("#jquery-overlay").remove()}),e("embed, object, select").css({visibility:"visible"})}function i(){var e,t,n,s;return window.innerHeight&&window.scrollMaxY?(n=window.innerWidth+window.scrollMaxX,s=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(n=document.body.scrollWidth,s=document.body.scrollHeight):(n=document.body.offsetWidth,s=document.body.offsetHeight),self.innerHeight?(document.documentElement.clientWidth?e=document.documentElement.clientWidth:e=self.innerWidth,t=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,t=document.body.clientHeight),s<t?pageHeight=t:pageHeight=s,n<e?pageWidth=n:pageWidth=e,arrayPageSize=new Array(pageWidth,pageHeight,e,t),arrayPageSize}function o(){var e,t;return self.pageYOffset?(t=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(t=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(t=document.body.scrollTop,e=document.body.scrollLeft),arrayPageScroll=new Array(e,t),arrayPageScroll}function r(t){var n=new Date,e=null;do e=new Date;while(e-n<t)}return this.unbind("click").click(g)}})