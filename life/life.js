var generation=0,interval=100,colors=["#360","red","blue","black","#606","#660","#ff0"],element=function(e){return document.getElementById(e)},generateBoard=function(){stopGame();for(var t,e=["<table>"],s=element("boardSize").value,n=0;n<s;n++){e.push("<tr>");for(t=0;t<s;t++)e.push("<td id='"+t+","+n+"'>&nbsp;</td>");e.push("</tr>")}e.push("</table>"),element("gameBoard").innerHTML=e.join(""),resetGame()},toggleLiveness=function(){stopGame(),setClass(this.id,"live"==this.className?"dead":"live")},getState=function(){for(var t,n=[],s=element("boardSize").value,e=0;e<s;e++){n[e]=[];for(t=0;t<s;t++)n[e][t]="live"==element(e+","+t).className?1:0}return n},setClass=function(e,t){var n=element(e);n.className=t,n.setAttribute("class",t),n.setAttribute("className",t)},liveNeighbors=function(e,t,n){var s=0,o=element("boardSize").value;return t!=0&&(n!=0&&(s+=e[t-1][n-1]),s+=e[t-1][n],n!=o-1&&(s+=e[t-1][n+1])),n!=0&&(s+=e[t][n-1]),n!=o-1&&(s+=e[t][n+1]),t!=o-1&&(n!=0&&(s+=e[t+1][n-1]),s+=e[t+1][n],n!=o-1&&(s+=e[t+1][n+1])),s},nextGeneration=function(){for(var e,t,n,s,i,a,c=getState(),r=element("boardSize").value,o=0;o<r;o++)for(t=0;t<r;t++)e=liveNeighbors(c,o,t),a=o+","+t,n=element(a),(e<0||e>8)&&die("Something is fucked up: "+a+" has "+e+" neighbors"),"live"==n.className?(e<2||e>3)&&(n.className="dead"):"dead"==n.className&&3==e&&(n.className="live");generation++,element("generation").innerHTML=generation+"",clearInterval(interval);for(i=document.getElementsByName("interval"),s=0;s<i.length;++s)if(i[s].checked){interval=setInterval(nextGeneration,i[s].value+0);break}},die=function(e){stopGame(),alert(e)},playGame=function(){var e=element("playButton");e.onclick=stopGame,e.innerHTML="Stop",nextGeneration()},resetGame=function(){generation=0,element("generation").innerHTML=generation+"";for(var e,n,s=element("boardSize").value,t=0;t<s;t++)for(e=0;e<s;e++)n=element(t+","+e),setClass(n.id,"dead"),n.onclick=toggleLiveness},randomGame=function(){stopGame();for(var e,n=element("boardSize").value,t=0;t<n;t++)for(e=0;e<n;e++)Math.random()>.8&&setClass(t+","+e,"live");playGame()},stopGame=function(){clearInterval(interval);var e=element("playButton");e.onclick=playGame,e.innerHTML="Play"};element("boardSize").onkeyup=generateBoard,element("playButton").onclick=nextGeneration,element("playButton").onclick=playGame,element("resetButton").onclick=resetGame,element("randomButton").onclick=randomGame,generateBoard()