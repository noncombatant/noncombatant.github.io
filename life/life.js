var generation=0,interval=100,colors=["#360","red","blue","black","#606","#660","#ff0"],element=function(e){return document.getElementById(e)},generateBoard=function(){stopGame();for(var t,e=["<table>"],s=element("boardSize").value,n=0;n<s;n++){e.push("<tr>");for(t=0;t<s;t++)e.push("<td id='"+t+","+n+"'>&nbsp;</td>");e.push("</tr>")}e.push("</table>"),element("gameBoard").innerHTML=e.join(""),resetGame()},toggleLiveness=function(){stopGame(),setClass(this.id,"live"==this.className?"dead":"live")},getState=function(){for(var t,n=[],s=element("boardSize").value,e=0;e<s;e++){n[e]=[];for(t=0;t<s;t++)n[e][t]="live"==element(e+","+t).className?1:0}return n},setClass=function(n,e){var t=element(n);t.className=e,t.setAttribute("class",e),t.setAttribute("className",e)},liveNeighbors=function(s,t,e){var n=0,o=element("boardSize").value;return t!=0&&(e!=0&&(n+=s[t-1][e-1]),n+=s[t-1][e],e!=o-1&&(n+=s[t-1][e+1])),e!=0&&(n+=s[t][e-1]),e!=o-1&&(n+=s[t][e+1]),t!=o-1&&(e!=0&&(n+=s[t+1][e-1]),n+=s[t+1][e],e!=o-1&&(n+=s[t+1][e+1])),n},nextGeneration=function(){for(var e,t,n,s,o,a,c=getState(),r=element("boardSize").value,i=0;i<r;i++)for(s=0;s<r;s++)e=liveNeighbors(c,i,s),a=i+","+s,t=element(a),(e<0||e>8)&&die("Something is fucked up: "+a+" has "+e+" neighbors"),"live"==t.className?(e<2||e>3)&&(t.className="dead"):"dead"==t.className&&3==e&&(t.className="live");generation++,element("generation").innerHTML=generation+"",clearInterval(interval),o=document.getElementsByName("interval");for(n=0;n<o.length;++n)if(o[n].checked){interval=setInterval(nextGeneration,o[n].value+0);break}},die=function(e){stopGame(),alert(e)},playGame=function(){var e=element("playButton");e.onclick=stopGame,e.innerHTML="Stop",nextGeneration()},resetGame=function(){generation=0,element("generation").innerHTML=generation+"";for(var e,n,s=element("boardSize").value,t=0;t<s;t++)for(e=0;e<s;e++)n=element(t+","+e),setClass(n.id,"dead"),n.onclick=toggleLiveness},randomGame=function(){stopGame();for(var e,n=element("boardSize").value,t=0;t<n;t++)for(e=0;e<n;e++)Math.random()>.8&&setClass(t+","+e,"live");playGame()},stopGame=function(){clearInterval(interval);var e=element("playButton");e.onclick=playGame,e.innerHTML="Play"};element("boardSize").onkeyup=generateBoard,element("playButton").onclick=nextGeneration,element("playButton").onclick=playGame,element("resetButton").onclick=resetGame,element("randomButton").onclick=randomGame,generateBoard()